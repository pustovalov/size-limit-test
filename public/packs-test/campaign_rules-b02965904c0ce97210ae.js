(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[18],{"+/g7":function(e,t){e.exports="/assets/v1/packs/icon-tremendous@2x-6f3d61ea020a1710f91a37701cf724b7.png"},"+edb":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n("kMSe"),i=n("DzDc");function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var o=function(t){return function(n){var o=Object(r.d)(n);return _.flow(i.b.mobxForm)((function(n){var r=n.mobxForm.$(t);return e.createElement(o,a({},n,{field:r}))}))}},c=function(t){return function(n){var o=Object(r.d)(n);return _.flow(i.b.SectionHeaders)((function(n){var r=n.SectionHeaders[t];return e.createElement(o,a({},n,{SectionHeader:r}))}))}},l=function(t){var n=Object(r.d)(t);return _.flow(r.d,Object(r.c)("rulesStore"))((function(t){return t.rulesStore.campaign.gleam?null:e.createElement(n,t)}))}}).call(this,n("q1tI"))},"+hpU":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return P}));var r,i,a,o=n("Ty5D"),c=n("vOnD"),l=n("55Ip"),s=n("kMSe"),u=n("ZVfT"),p=n("L0cm"),f=n("M+GS"),d=n("zwcX"),m=n("GaHK"),b=n("vnvS"),h=n("3YY3"),v=n("DzDc");function y(e){return(y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),e}function C(e,t){return!t||"object"!==y(t)&&"function"!==typeof t?S(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=Object(c.default)(m.UILink).withConfig({displayName:"incentive__LinkWithIcon",componentId:"sc-1kqq8bx-0"})(["&:hover{.sign-svg-goblet{path{stroke:#ff4f00;transition:0.25s;}path:nth-child(2),path:nth-child(3){fill:#ff4f00;}}.sign-svg-eye{path{transition:0.25s;}path.sign-svg-main,path.sign-svg-border{fill:#ff4f00;transition:0.25s;}}}"]),k=Object(c.default)(m.UIButton).withConfig({displayName:"incentive__WinnerButton",componentId:"sc-1kqq8bx-1"})(["&&{position:relative;width:140px;height:40px;border:none;background:#30a32f;pointer-events:none;}span{margin-left:15px;}"]),N=Object(c.default)(m.UIIcon).withConfig({displayName:"incentive__WinnerIcon",componentId:"sc-1kqq8bx-2"})(["position:absolute;left:8px;top:50%;transform:translateY(-50%);"]),P=(i=Object(s.c)((function(e,t){return{deleteIncentive:e.incentiveFormStore.delete,view_setups:e.rulesStore.campaign.data.view_setups,isNewIncentive:e.rulesStore.incentiveNewId===t.data.id,incentiveHighlightNewId:e.rulesStore.incentiveHighlightNewId,incentiveHighlightEditId:e.rulesStore.incentiveHighlightEditId,clearIncentiveHighlightId:e.rulesStore.clearIncentiveHighlightId}})),Object(o.o)(a=i(a=Object(s.d)(a=function(t){function n(t){var r;return g(this,n),(r=C(this,O(n).call(this,t))).state={expand_criteria:!1,showModal:null,isHighlightChanges:!1},r.getIncentiveIdFromUrl=function(){var e=r.props.history.location;return parseInt(_.replace(e.hash,"#incentive_",""))},r.checkIncentiveRoute=function(){var e=r.props,t=e.data.id,n=e.history.location;_.includes(n.hash,"#incentive_")&&t===r.getIncentiveIdFromUrl()&&r.scrollToIncentive()},r.scrollToIncentive=function(){var e=$(r.incentiveRef.current).offset().top-135;Object(u.s)({position:e}),r.setState({isHighlightChanges:!0},(function(){setTimeout((function(){r.props.clearIncentiveHighlightId(),r.setState({isHighlightChanges:!1})}),3500)}))},r.couponCodeType=function(){var t=r.props.data,n=t.multi_use_coupon,i=t.coupon_list_id,a=t.available_coupons_count,o=t.latest_coupon_expiration_date,c=t.type;return e.createElement("div",null,e.createElement("div",{className:"incentive-key"},"Coupon ",n?"code":"list",":"),e.createElement("div",{className:"incentive-value"},n?n.code:e.createElement(F,{id:i,type:c,available_coupons_count:a,latest_coupon_expiration_date:o})))},r.incentiveType=function(){return e.createElement("div",null,"discount_coupon"===r.props.data.incentive_type?r.couponCodeType():void 0,r.props.data.custom_description?e.createElement("div",null,e.createElement("div",{className:"incentive-key"},"Custom Description:"),e.createElement("div",{className:"incentive-value"},r.props.data.custom_description)):void 0)},r.discount=function(){return r.props.data.short_description+("discount_coupon"===r.props.data.incentive_type?r.props.data.multi_use_coupon?" multi-use coupon code":" single-use coupon code":"rebate"===r.props.data.incentive_type?" rebate":void 0)},r.incentiveCriteria=function(){var t,n,i;return i=r.props.data.human_criterias,n=r.props.data,e.createElement("div",null,i.length?e.createElement("div",null,e.createElement("div",{className:"incentive-key"},"Reward Criteria:"),e.createElement("ul",{className:"incentive-criteria-list"},(t=0,_.map(i,(function(n){return e.createElement("li",{key:t++},n)}))))):void 0,n.criteria?e.createElement("div",null,e.createElement("div",{className:"incentive-key"},"Advanced Criteria:"),e.createElement("div",{className:"incentive-criteria ".concat(r.state.expand_criteria||r.props.data.criteria.lineCount()<=4?"is-expanded":"")},e.createElement("pre",{className:"incentive-criteria-value"},n.criteria),n.criteria.lineCount()<=4?void 0:e.createElement("div",{className:"incentive-criteria-actions"},e.createElement("a",{href:"#",className:"base-btn is-smaller",onClick:r.expandCriteria},r.state.expand_criteria?"Collapse":"Expand"," Criteria")))):void 0)},r.expandCriteria=function(e){return r.setState({expand_criteria:!r.state.expand_criteria}),e.preventDefault()},r.findViewByViewCategory=function(e){return _.find(r.props.view_setups,(function(t){return t.view_category===e}))},r.toggleViewSetup=function(e,t,n){return $.ajax({type:"PATCH",url:Routes.site_campaign_view_setup_path(window.Site,window.Campaign,e),data:{view_setup:{is_disabled:t}},success:function(e){if(n)return n()}})},r.deleteLastFriendIncentive=function(e){return r.toggleViewSetup(e,1,r.deleteIncentive)},r.deleteIncentive=function(){r.props.deleteIncentive(r.props.data.id,(function(){window.location.hash="#/#incentives",r.setState({showModal:!1})}))},r.isFriendIncentive=function(){return r.props.data.for_friend},r.isLastFriendIncentive=function(){return 1===r.props.friend_incentives.length},r.validateFriendIncentiveRemove=function(e){return r.isFriendIncentive()&&r.isLastFriendIncentive()&&e&&!e.is_disabled&&!e.disabled_by_configuration},r.handleDeleteIncentive=function(){r.setState({showModal:!0})},r.handleCloseModal=function(){r.setState({showModal:!1})},r.handleDestinationClick=function(){r.handleCloseModal(),$("html, body").animate({scrollTop:$("#friend_destination_url").offset().top-$(".js-sub-subnav").height()},500)},r.incentiveForm=function(){return e.createElement(h.a,{action:"edit",data:r.props.data})},r.incentiveRef=e.createRef(),r}return I(n,t),E(n,[{key:"componentDidMount",value:function(){this.props.incentiveHighlightNewId===this.props.data.id&&this.scrollToIncentive(),this.checkIncentiveRoute()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){(e.incentiveHighlightEditId===e.data.id&&!_.isEqual(this.props.data,e.data)||e.incentiveHighlightNewId===e.data.id)&&this.scrollToIncentive()}},{key:"render",value:function(){var t=this.findViewByViewCategory("offers_claim"),n=this.validateFriendIncentiveRemove(t),r=this.props,i=r.allowEdit,a=r.noSuchWinnerIncentive,c=this.state.isHighlightChanges,s=_.get(this.props.data,"split_test_variant.winner");return e.createElement(e.Fragment,null,this.state.showModal&&e.createElement(b.a,{action:"delete",handleCloseModal:this.handleCloseModal,deleteIncentive:this.deleteIncentive,deleteLastFriendIncentive:this.deleteLastFriendIncentive,handleDestinationClick:this.handleDestinationClick,claimPage:t,validateFriendIncentiveRemove:n}),e.createElement("div",{className:"incentive js-incentive",ref:this.incentiveRef,key:this.props.data.id},e.createElement("div",{className:"incentive-anchor",id:"incentive_".concat(this.props.data.id)}),e.createElement("div",{className:classNames("incentive-container",{"is-highlight":c,"is-winner":s,"is-not-winner":!a&&_.get(this.props.data,"split_test_variant.winner_selected_at")&&!_.get(this.props.data,"split_test_variant.winner")})},this.props.data.split_tested&&this.props.data.split_test_variant&&e.createElement(e.Fragment,null,s&&e.createElement("div",{className:"incentive-container-winner"},e.createElement(k,{className:"mbm",size:"small",trait:"success"},e.createElement(N,{className:"mrn",name:"goblet",stroke:"#fff",fill:"#fff"}),e.createElement("span",null,"Winner")),e.createElement("span",{className:"incentive-container-winner-date"},"Selected on ".concat(moment(_.get(this.props.data,"split_test_variant.winner_selected_at")).format("MM/DD/YY")))),e.createElement("div",{className:"mbm"},e.createElement("span",{className:classNames("incentive-badge",{"is-winner":s})},this.props.data.index),e.createElement("div",{className:"incentive-distribution-info"},this.props.data.distribution_rate,":",this.props.data.absolute_distribution," \u2013"," ",this.props.data.percentage_probability," distribution"))),"other"!==this.props.data.incentive_type?e.createElement("div",null,e.createElement("div",{className:"incentive-key"},"Value:"),e.createElement("div",{className:"incentive-value"},this.discount())):null,this.incentiveType(),e.createElement("div",null,e.createElement("div",{className:"incentive-key"},"Identifier:"),e.createElement("div",{className:"incentive-value"},this.props.data.identifier)),this.incentiveCriteria(),e.createElement("div",{className:"incentive-actions"},e.createElement("div",{className:"incentive-key"},e.createElement("div",null,e.createElement(l.Link,{to:"/incentives/edit/".concat(this.props.data.id),className:"base-btn is-small mrm"},"Edit"),i&&e.createElement("div",{className:"base-btn is-error is-small",onClick:this.handleDeleteIncentive},"Delete"))),e.createElement("div",{className:"flex align-items-center"},_.get(this.props.data,"split_test_variant")&&!_.get(this.props.data,"split_test_variant.winner_selected_at")&&e.createElement(x,{className:"mrl",href:Routes.site_split_test_path(_.get(window.Site,"cached_slug"),_.get(this.props.data,"split_test_variant.split_test_id"))},e.createElement(m.UIIcon,{name:"goblet",stroke:"#0070d9",fill:"#0070d9"}),"Select winner"),this.props.data.split_tested&&e.createElement(x,{href:"/sites/".concat(window.Site.cached_slug,"/campaigns/").concat(window.Campaign.id,"/preview?selected_variant_ids[]=").concat(_.get(this.props.data,"split_test_variant.id"))},e.createElement(m.UIIcon,{name:"eye"}),"Preview")))),e.createElement(o.d,{path:d.a.incentiveEdit.pathPrefix+this.props.data.id,component:this.incentiveForm})))}}]),n}(e.Component))||a)||a)||a),F=Object(s.c)((function(e){e.store;var t=e.rootStore,n=e.rulesStore;return{site:t.models.site,integrationPage:t.pages.integrationPage,currentUser:t.models.currentUser,currentCampaign:n.campaign}}))(r=Object(s.d)(r=function(t){function n(e){var t;return g(this,n),(t=C(this,O(n).call(this,e))).fetchData=t.fetchData.bind(S(t)),t.state={data:{}},t}return I(n,t),E(n,[{key:"componentDidMount",value:function(){this.fetchData(this.props.id)}},{key:"componentDidUpdate",value:function(e){_.isEqual(e,this.props)||this.fetchData(this.props.id)}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.serverRequest)||void 0===e||e.abort()}},{key:"fetchData",value:function(e){var t=this;return this.serverRequest=$.ajax({url:Routes.internal_site_coupon_list_path(Site.cached_slug,e),type:"GET",dataType:"json",success:function(e){return t.setState({data:e.result.coupon_list})}})}},{key:"couponAutoSync",value:function(){var t=this.props,n=t.site,r=n.couponAutoSyncStatus,i=n.couponAutoSyncEnabled,a=n.couponAutoSyncLink,o=t.currentUser.isWriteRole,c=classNames("badge badge-link",{"badge-success":i,"badge-none":!i});return e.createElement("span",null,", Auto-sync:"," ",e.createElement("span",{className:c},o?e.createElement("a",{href:a,className:"js-ga-click","data-category":p.k,target:"_blank","data-action":"auto-sync click"},r):e.createElement("span",null,r)))}},{key:"render",value:function(){var t=this.state.data,n=t.total_coupons_count,r=t.name,i=t.id,a=t.expires_at,o=this.props,c=o.site.showCouponAutoSyncBadge,l=o.available_coupons_count,s=o.latest_coupon_expiration_date,u=o.type,p=_.isNil(n)?void 0:"".concat(n," coupon codes in total"),d=i?Routes.site_coupon_list_path(Site,i):"";return e.createElement("div",null,e.createElement(m.UILink,{href:d,target:"_blank",className:"mrm"},r),e.createElement("small",{title:p},e.createElement("span",{className:"incentive-value-number"},numeral(_.isNil(l)?void 0:l).format("0.[0]a")),1===(_.isNil(l)?void 0:l)?" coupon left":" coupons left",c&&this.couponAutoSync()),a&&e.createElement("div",null,e.createElement("small",null,"Coupon list expires at: ",moment(a).format("MM/DD/YYYY"))),Object(f.b)({coupon_list_expires_at:a,latest_coupon_expiration_date:s})&&e.createElement(v.a,{type:u,latest_coupon_expiration_date:s}))}}]),n}(e.Component))||r)||r}).call(this,n("q1tI"))},"/rkz":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("99Ma"),i=n("DF6E"),a=n("nKCY"),o=function(){return i.a.incentiveData.percentage_discount?"".concat(i.a.incentiveData.amount,"%"):"".concat(window.Site.currency_unit).concat(i.a.incentiveData.amount)},c=r.types.model({name:r.types.maybeNull(r.types.string),coupons_mode:"manual",coupons_codes:"",upload_file:r.types.frozen(),upload_file_root:"",expires_at:""}).views((function(e){return{get title(){return o()},get amount(){return i.a.incentiveData.amount},get percentage_discount(){return i.a.incentiveData.percentage_discount}}})).actions((function(e){return{initialData:function(){e.name="".concat(o()," list | ").concat(moment().format("MMMM YYYY"))},clearData:function(){e.name=null,e.coupons_mode="manual",e.coupons_codes="",e.upload_file=null,e.upload_file_root="",e.expires_at=""},updateKey:function(t){var n=t.target,r=n.name,i=n.value;e[r]=i},updateExpiresAt:function(t){e.expires_at=t},updateUploadFile:function(t){e.upload_file=null!==t.target.files?t.target.files[0]:"",e.upload_file_root=t.target.value},clearUploadFile:function(){e.upload_file=null,e.upload_file_root=""}}})),l=r.types.model({id:r.types.identifierNumber,amount:r.types.maybeNull(r.types.number),name:r.types.maybeNull(r.types.string),percentage_discount:r.types.maybeNull(r.types.boolean),site_id:r.types.maybeNull(r.types.number),total_coupons_count:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),expires_at:r.types.maybeNull(r.types.string),updated_at:r.types.maybeNull(r.types.string)}),s=r.types.model("CouponListStore",{coupon_lists:r.types.optional(r.types.map(l),{}),fetchedLists:!1,isShowCouponForm:!1,couponForm:r.types.optional(c,{}),errors:r.types.optional(r.types.map(r.types.array(r.types.string)),{})}).views((function(e){return{get optionsCouponLists(){var t=[{label:"Please choose",value:""}],n=[];return e.coupon_lists.forEach((function(e){Number(e.amount)===Number(i.a.incentiveData.amount)&&e.percentage_discount===i.a.incentiveData.percentage_discount&&n.push(e)})),n.forEach((function(e){var n=e.percentage_discount?"".concat(e.amount,"%"):"".concat(window.Site.currency_unit).concat(e.amount);t.push({label:"".concat(e.name," (").concat(n,"), ").concat(e.expires_at?"expires at ".concat(moment(e.expires_at).format("MM/DD/YYYY")):"not expired"," "),value:String(e.id),expires:e.expires_at})})),t},findCouponListsByValue:function(t){var n=t.value;return e.optionsCouponLists.find((function(e){return String(e.value)===String(n)}))}}})).actions((function(e){return{fetchData:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&(e.fetchedLists||$.get(Routes.internal_site_coupon_lists_path(window.Site,{no_spinner:!0})).then((function(t){e.updateLists(t.result.coupon_lists)})).fail((function(e){Widget.Utils.notifyDevelopers({name:"Unable to get coupon lists",message:"Ajax failure",xhr:e})})))},updateLists:function(t){e.fetchedLists=!0,t.forEach((function(t){return e.coupon_lists.set(t.id,l.create(t))}))},addItemToLists:function(t){e.coupon_lists.set(t.id,l.create(t))},toggleCouponForm:function(){e.isShowCouponForm=!e.isShowCouponForm,e.isShowCouponForm?e.couponForm.initialData():(e.couponForm.clearData(),e.clearData())},create:function(){var t;return(t=new FormData).append("coupon_list[name]",e.couponForm.name),t.append("coupon_list[amount]",e.couponForm.amount),t.append("coupon_list[expires_at]",e.couponForm.expires_at),t.append("coupon_list[percentage_discount]",e.couponForm.percentage_discount),"manual"===e.couponForm.coupons_mode?t.append("coupon_list[coupons_codes]",e.couponForm.coupons_codes):t.append("coupon_list[upload_file]",e.couponForm.upload_file),$.ajax({url:Routes.internal_site_coupon_lists_path(window.Site),type:"POST",contentType:!1,processData:!1,data:t}).then((function(t){var n=t.result.coupon_list;e.addItemToLists(n),i.a.incentiveData.onChangeByKey({target:{name:"coupon_list_id",value:n.id}}),e.clearErrors(),e.toggleCouponForm()})).fail((function(t){var n=_.get(t,"responseJSON.result.errors",{});e.updateErrors(n);var r=_.mapKeys(n,(function(e,t){return"couponList.".concat(t)}));Validation.fail(r,!1)}))},clearData:function(){Validation.clear(),e.isShowCouponForm=!1,e.couponForm={},e.clearErrors()},updateErrors:function(t){e.errors.replace(t)},clearErrors:function(){e.errors.clear()}}})),u=Object(a.a)(s.create())},"0Sfy":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var r,i=n("kMSe"),a=n("GaHK");function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==o(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=Object(i.c)((function(e){return{friendType:e.incentiveFormStore.sub_type}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),l(this,s(n).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props.friendType;return e.createElement("div",{className:"mbl"},e.createElement(a.UILabel,{text:"Basic criteria:",id:"basic_criteria"}),function(){switch(t){case"NewCustomer":return e.createElement("div",null,e.createElement("div",null,"Friend should be a new customer"));case"ExistingCustomer":return e.createElement("div",null,e.createElement("div",null,"Friend should be an existing customer"));case"SelfReferral":return e.createElement("div",null,"Friend should be a self referral");case"ExpiredOffer":return e.createElement("div",null,"Reward Friend only when their offer expires");case"NewSubscriber":return e.createElement("div",null,"Friend should be a new subscriber");default:return null}}())}}])&&c(r.prototype,i),o&&c(r,o),n}(e.Component))||r)||r}).call(this,n("q1tI"))},"3YY3":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return k}));var r,i,a,o,c,l=n("Ty5D"),s=n("vOnD"),u=n("kMSe"),p=n("GaHK"),f=n("CBbb"),d=n("fRW6");function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function b(e){return(b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}function g(e,t){return!t||"object"!==b(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var O={marginBottom:0},S={marginBottom:"20px"},I=s.default.div.withConfig({displayName:"incentives_form__ButtonInline",componentId:"sc-9gv4kx-0"})(["display:inline-block;font-family:'gotham-htf-medium';color:#0070d9;font-size:14px;line-height:1;cursor:pointer;&:hover{color:#ff4f00;text-decoration:none;}"]),j="incentive-form-advanced-settings-title",x=Object(u.d)(r=function(t){function n(){return h(this,n),g(this,w(n).apply(this,arguments))}return E(n,t),y(n,[{key:"render",value:function(){var t=this.props,n=t.incentiveFormStore,r=n.action,i=n.buttonTextOnSave,a=n.pristine,o=n.submitting,c=n.isDisabledSubmitButton,l=t.onSaveChanges,s=t.handleActionClose;return e.createElement(p.UIFormFooter,{disabled:"new"!==r&&a||c},e.createElement(u.a,null,(function(){return e.createElement(e.Fragment,null,"new"!==r&&!a&&!c&&e.createElement(I,{className:"mrl",onClick:s},"Cancel"),e.createElement(p.UIButton,{trait:"success",onClick:l,disabled:"new"!==r&&a||o||c,type:"submit"},i))})))}}]),n}(e.Component))||r,k=(i=Object(u.c)((function(e){return{incentiveFormStore:e.incentiveFormStore,couponListsStore:e.couponListsStore}})),Object(l.o)(a=i(a=Object(u.d)((c=o=function(t){function n(t){var r;return h(this,n),(r=g(this,w(n).call(this,t))).onSaveChanges=function(e){e.preventDefault();var t=r.props,n=t.incentiveFormStore,i=n.create,a=n.needConfirmationFlushCampaignData,o=n.toggleShowConfirmationFlushCampaignData;switch(t.action){case"new":i(r.closeModal);break;case"edit":a?o():r.editAction()}},r.editAction=function(){var e=r.props;(0,e.incentiveFormStore.edit)(e.data.id,r.closeModal)},r.closeModal=function(){var e=r.props,t=e.action,n=e.onClose,i=e.history,a=e.incentiveFormStore;switch(t){case"new":n(a.incentiveData.prepareDataForServer);break;case"edit":i.push("/");break;default:return null}},r.modalActions=function(){return e.createElement(x,m({onSaveChanges:r.onSaveChanges,handleActionClose:r.handleActionClose},r.props))},r.handleActionClose=function(){r.props.incentiveFormStore.pristine?r.closeModal():r.props.incentiveFormStore.toggleConfirmation()},r.handleClickSpoiler=function(e){e.target&&($(e.target).hasClass(j)||$(e.target).parent().hasClass(j))&&setTimeout((function(){r.spoilerRef.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}),0)},r.getSpoilerRef=function(e){return r.spoilerRef=e},t.incentiveFormStore.getInitialData(t),r}return E(n,t),y(n,[{key:"componentWillUnmount",value:function(){this.props.incentiveFormStore.clearData(),this.props.couponListsStore.clearData()}},{key:"render",value:function(){var t=this.props.incentiveFormStore,n=t.title,r=t.uiFields,i=t.errors,a=t.confirmation,o=t.toggleConfirmation,c=t.showConfirmationFlushCampaignData,l=t.toggleShowConfirmationFlushCampaignData;return e.createElement(p.UIModal,{width:"620px",title:n,actions:this.modalActions,actionClose:this.handleActionClose,actionOverlay:this.handleActionClose,scrollContent:!0,noContentPaddingBottom:!0},_.get(r,"main",[]).map((function(t){var n=f.a[t];return e.createElement(n,{key:t})})),e.createElement("div",{onClick:this.handleClickSpoiler,id:"incentive-form-advanced-settings",className:"-mtm ptm",ref:this.getSpoilerRef},_.some(_.get(r,"advanced",[]))&&e.createElement(p.UISpoiler,{text:"Advanced Settings",styleContainer:O,styleTitle:S,classNameTitle:j},_.get(r,"advanced",[]).map((function(t){var n=f.a[t];return e.createElement(n,{key:t})})))),Object(d.a)(i.get("base"))&&e.createElement("div",{className:"mbm"},Object(d.a)(i.get("base"))),a&&e.createElement(p.UIModalConfirmation,{onPrimaryAction:this.closeModal,onCloseModal:o},e.createElement("p",null,"All unsaved changes will be lost")),c&&e.createElement(p.UIModalConfirmation,{onPrimaryAction:this.editAction,onCloseModal:l},e.createElement("p",null,"This action will flush campaign data (shares, clicks, visits metrics, etc.). Are you sure?")))}}]),n}(e.Component),o.propTypes={action:PT.string.isRequired,data:PT.object.isRequired},a=c))||a)||a)||a)}).call(this,n("q1tI"))},"3fie":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return j}));var r,i,a,o=n("kMSe"),c=n("QWlW"),l=n("L0cm"),s=n("uy5f"),u=n("O4V+"),p=n("G/5i"),f=n("52sZ"),d=n("Ty5D"),m=n("zwcX"),b=n("DF6E"),h=n("/rkz"),v=n("ZVfT");function y(e){return(y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return!t||"object"!==y(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=Object(d.o)((a=i=function(t){function n(){var t,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(r=C(this,(t=O(n)).call.apply(t,[this].concat(a)))).scrollToIpAddressFiltering=function(){var e=$("#ip_address_filtering").offset().top-135;Object(v.s)({position:e})},r.checkIpAddressRoute=function(){var e=r.props.history.location;_.includes(e.hash,"#ip_address_filtering")&&r.scrollToIpAddressFiltering()},r.campaignRulesRoute=function(){return e.createElement(e.Fragment,null,e.createElement(s.a,null),e.createElement(u.a,null))},r}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(n,t),r=n,(i=[{key:"componentDidMount",value:function(){_.delay(this.checkIpAddressRoute,200),"1"===_.get(window.current_user,"show_campaign_wizard")&&Wizard.init();var e=this.props,t=e.eventsProvider.subscribe,n=e.rulesStore,r=e.rootStore.pages.integrationPage,i=r.shopifyFetchInitialData,a=r.shopifyInitialDataFetched;"shopify"===window.Site.platform&&!a&&i(),window.addEventListener("keydown",n.saveOnEnter),$((function(){return n.updateCampaignData({reloadWizard:!1})})),$('[data-toggle="tooltip"]').tooltip(),t(),Utils.trackGAEvent(l.k,"show campaign rules")}},{key:"componentDidUpdate",value:function(){this.updateBrowserPageTitle()}},{key:"componentWillUnmount",value:function(){var e=this.props.rulesStore.saveOnEnter;window.removeEventListener("keydown",e)}},{key:"updateBrowserPageTitle",value:function(){var e=this.props.rulesStore.campaign;document.title="Campaign Rules | ".concat(e.name," | Talkable")}},{key:"render",value:function(){return e.createElement(d.d,{ignoreScrollBehavior:!0,path:m.a.root.path,render:this.campaignRulesRoute})}}])&&E(r.prototype,i),a&&E(r,a),n}(e.Component),i.displayName="CampaignRules",i.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},c.a.propTypes),r=a))||r,j=_.flow(c.d,Object(c.a)({subscriber:UI.subscribe.bind(UI),events:{CampaignRules_save_succeeded:function(){Validation.succeed(),UI.publish("CampaignRules_changes_made",!0)},CampaignRules_show_success:function(e){Validation.succeed(e)},CampaignRules_save_failed:function(e){Validation.fail(_.get(e,"responseJSON.result.errors",[]))}},CampaignRules_save_failed:function(e){Validation.fail(_.get(e,"responseJSON.result.errors",[]))}}),Object(c.c)({rulesStore:p.a,rootStore:f.b,incentiveFormStore:b.a,couponListsStore:h.a}),o.d)(I);j.displayName="CampaignRulesApp"}).call(this,n("q1tI"))},"5v/m":function(e,t,n){"use strict";(function(e){var r=n("GaHK"),i=n("vOnD"),a=Object(i.default)(r.UIButton).withConfig({displayName:"discount_type__ButtonDollar",componentId:"sc-1egk2mh-0"})(["border-top-right-radius:0;border-bottom-right-radius:0;height:34px;padding:0 10px;font-size:14px;font-family:'gotham-htf-medium';",";"],(function(e){return e.checked&&Object(i.css)(["background:#f9f0cd;border-color:#c8bd8e;&:hover{background:#f9f0cd;border-color:#c8bd8e;}"])})),o=Object(i.default)(r.UIButton).withConfig({displayName:"discount_type__ButtonPercent",componentId:"sc-1egk2mh-1"})(["border-top-left-radius:0;border-bottom-left-radius:0;border-left:none;height:34px;padding:0 10px;font-size:14px;font-family:'gotham-htf-medium';",";"],(function(e){return e.checked&&Object(i.css)(["background:#f9f0cd;border-color:#c8bd8e;&:hover{background:#f9f0cd;border-color:#c8bd8e;}"])})),c=i.default.div.withConfig({displayName:"discount_type__DiscountTypeWrapper",componentId:"sc-1egk2mh-2"})(["display:flex;align-items:center;"]),l=i.default.div.withConfig({displayName:"discount_type__DiscountTypeText",componentId:"sc-1egk2mh-3"})(["color:#999;font-family:'gotham-htf-light',Gotham,sans-serif;font-size:14px;font-weight:300;line-height:1;margin-left:5px;"]),s=function(t){var n=t.name,r=t.amount,i=t.isPercentage,s=t.onChange,u=t.disabled,p=t.type,f=function(e){return function(){s({target:{name:n,value:e}})}},d=_.get(window,"Site.currency_unit","$");return e.createElement(c,{className:"mlm"},"rebate"!==p&&e.createElement(e.Fragment,null,e.createElement(a,{checked:!i,onClick:f(!1),disabled:u},d),e.createElement(o,{checked:i,onClick:f(!0),disabled:u},"%")),e.createElement(l,null,"\u2014 ",r,i?"%":d))};s.propTypes={name:PT.string.isRequired,isPercentage:PT.bool,onChange:PT.func.isRequired,amount:PT.any,type:PT.string},t.a=s}).call(this,n("q1tI"))},"9/zI":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var r,i=n("kMSe"),a=n("GaHK"),o=n("S2h9"),c=n("fRW6");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=Object(i.c)((function(e){var t=e.incentiveFormStore;return{disabledCouponCodeType:t.incentiveData.disabledCouponCodeType,coupon_codes:t.incentiveData.coupon_codes,multi_use_coupon_code:t.incentiveData.multi_use_coupon_code,coupon_list_id:t.incentiveData.multi_use_coupon,onChange:t.incentiveData.onChangeByKey,onChangeCouponCodes:t.incentiveData.onChangeCouponCodes,error:t.errors.get("coupon_list"),errorMultiUseCoupon:t.errors.get("multi_use_coupon"),errorMultiUseCouponCode:t.errors.get("multi_use_coupon.code"),errorCouponType:t.errors.get("coupon_type"),errorExpiration:t.errors.get("expires_at"),errorFriendDeadline:t.errors.get("friend_deadline")}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),u(this,p(n).apply(this,arguments))}var r,i,l;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.multi_use_coupon_code,r=t.coupon_codes,i=t.onChangeCouponCodes,l=t.onChange,s=t.error,u=t.errorCouponType,p=t.errorMultiUseCoupon,f=t.errorMultiUseCouponCode,d=t.errorExpiration,m=t.errorFriendDeadline,b=t.disabledCouponCodeType;return e.createElement("div",{className:"mbl"},e.createElement(a.UILabel,{text:"Coupon code type:"}),e.createElement("div",null,e.createElement(a.UIInputRadio,{id:"multi",name:"coupon_codes",value:"multi",labelText:"Multi-use",className:"mbs",checked:"multi"===r,onChange:i,disabled:b}),e.createElement(a.UIInputRadio,{id:"single",name:"coupon_codes",value:"single",className:"mbl",checked:"single"===r,labelText:"Single-use",onChange:i,disabled:b}),Object(c.a)(u),"multi"===r&&!b&&e.createElement("div",null,e.createElement(a.UILabel,{text:"Multi-use coupon code:"}),e.createElement(a.UIInputText,{name:"multi_use_coupon_code",value:n,onChange:l,size:"medium",error:p||f||s,width:"300px"}),Object(c.a)(p),Object(c.a)(f)),"single"===r&&!b&&e.createElement(o.a,null),Object(c.a)(s),Object(c.a)(d),Object(c.a)(m)))}}])&&s(r.prototype,i),l&&s(r,l),n}(e.Component))||r)||r}).call(this,n("q1tI"))},CBbb:function(e,t,n){"use strict";var r=n("m+Fy"),i=n("TVI0"),a=n("9/zI"),o=n("bpe6"),c=n("ZZHx"),l=n("CnXT"),s=n("Vubd"),u=n("eprO"),p=n("Uaz8"),f=n("cnfd"),d=n("x7mL"),m=n("qVMk"),b=n("bmFi"),h=n("pwLL"),v=n("0Sfy"),y=n("T/Lf"),g=n("VCMo");t.a={RewardType:r.b,RewardAmountField:i.a,CouponCodesType:a.a,CustomDescription:o.a,Identifier:c.a,OncePerPerson:l.a,NewCustomer:s.a,RewardUniqueness:u.a,FriendEventCategory:p.a,Criteria:f.a,Referrals:d.a,Subtotal:m.a,EmailShares:b.a,SharingChannel:h.a,BasicCriteria:v.a,RewardTypeDescription:y.a,RybbonInfo:g.a,TremendousInfo:g.b,RewardTypeWithGiftCards:r.a}},CnXT:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r,i=n("kMSe"),a=n("fRW6"),o=n("GaHK");function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==c(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=Object(i.c)((function(e){var t=e.incentiveFormStore;e.rulesStore;return{value:t.incentiveData.once_per_person,onChange:t.incentiveData.onChangeByKey,disabled:!t.allowEdit,error:t.errors.get("once_per_person")}}))(r=Object(i.d)(r=function(t){function n(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=s(this,(e=u(n)).call.apply(e,[this].concat(i)))).onChange=function(e){var n=_.cloneDeep(e);n.target.value=e.target.value?"1":"0",t.props.onChange(n)},t}var r,i,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.error,r=t.value,i=t.disabled;return e.createElement("div",{className:"mbl"},e.createElement(o.UIInputCheckbox,{disabled:i,id:"once_per_person",name:"once_per_person",labelText:"Triggers only once per person",checked:Boolean(Number(r)),value:r,onChange:this.onChange}),e.createElement("div",{className:"mls mbs inline","aria-label":"Once the reward has been issued, the person will never receive another reward from this incentive.","data-balloon-pos":"down","data-balloon-length":"large"},e.createElement("i",{className:"icon icon-question"},e.createElement("span",null,"@"))),Object(a.a)(n))}}])&&l(r.prototype,i),c&&l(r,c),n}(e.Component))||r)||r}).call(this,n("q1tI"))},DF6E:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("o0o1"),i=n.n(r),a=n("99Ma"),o=n("UlA6"),c=n("G/5i"),l=n("L0cm"),s=n("nKCY"),u=n("M+GS"),p=n("/rkz");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=a.types.union(a.types.number,a.types.string,a.types.null,a.types.undefined),b=a.types.model({id:a.types.maybeNull(a.types.number),type:a.types.maybeNull(a.types.string),incentive_type:a.types.maybeNull(a.types.string),amount:m,latest_coupon_expiration_date:a.types.maybeNull(a.types.string),percentage_discount:a.types.maybeNull(a.types.boolean),multi_use_coupon_code:a.types.maybeNull(a.types.string),coupon_list_id:m,custom_description:a.types.maybeNull(a.types.string),identifier:a.types.maybeNull(a.types.string),criteria:a.types.maybeNull(a.types.string),sharing_channels:a.types.maybeNull(a.types.string),email_shares:m,new_customer:m,subtotal_min:m,subtotal_max:m,referrals_min:m,referrals_max:m,reward_uniqueness:a.types.maybeNull(a.types.string),friend_event_category:a.types.maybeNull(a.types.string),new_optin:a.types.union(a.types.string,a.types.null,a.types.undefined),allow_on_expired_offer:m,allow_on_self_referral:m,once_per_person:m}).actions((function(e){return{updateData:function(t){_.keys(t).forEach((function(n){"multi_use_coupon"===n?e.updateKey("multi_use_coupon_code",_.get(t,"".concat(n,".code"))):e.updateKey(n,t[n])}))},updateKey:function(t,n){_.has(e,t)&&(e[t]=n)}}})),h=a.types.model({id:a.types.maybeNull(a.types.number),type:a.types.maybeNull(a.types.string),incentive_type:a.types.maybeNull(a.types.string),amount:m,latest_coupon_expiration_date:a.types.maybeNull(a.types.string),percentage_discount:a.types.maybeNull(a.types.boolean),multi_use_coupon_code:a.types.maybeNull(a.types.string),coupon_list_id:m,custom_description:a.types.maybeNull(a.types.string),identifier:a.types.maybeNull(a.types.string),criteria:a.types.maybeNull(a.types.string),sharing_channels:a.types.maybeNull(a.types.string),email_shares:m,new_customer:m,subtotal_min:m,subtotal_max:m,referrals_min:m,referrals_max:m,reward_uniqueness:a.types.maybeNull(a.types.string),friend_event_category:a.types.maybeNull(a.types.string),new_optin:a.types.union(a.types.string,a.types.null,a.types.undefined),allow_on_expired_offer:m,allow_on_self_referral:m,once_per_person:m}).views((function(e){return{get normalizeData(){var t=_.cloneDeep(e.toJSON());return _.update(t,"friend_event_category",(function(e){return"any"!==e?e:null})),t},get prepareDataForServer(){return _.pick(e.normalizeData,_.keys(_.pickBy(o.c,(function(t){return t.includes(e.type)}))))},get coupon_codes(){return _.isNull(e.multi_use_coupon_code)?"single":"multi"},get disabledCouponCodeType(){return e.amount<0||""===e.amount},get sharingChannelsValueForSelect(){return e.sharing_channels?e.sharing_channels.split(", "):[]},get friendEventCategoryValueForSelect(){var t=_.isNull(e.friend_event_category)?"any":e.friend_event_category;return l.G.includes(t)?t:"other"}}})).actions((function(e){return{onChangeByKey:function(t){var n=t.target,r=n.name,i=n.value;_.has(e,r)&&(e[r]=i,"incentive_type"===r&&Utils.trackGAEvent(l.k,"change incentive type",i))},onChangeRewardType:function(t){var n=t.target,r=n.name,i=n.value;switch(i){case"rebate":e.onChangeByKey({target:{name:"percentage_discount",value:!1}});break;default:e.onChangeByKey({target:{name:r,value:i}})}},updateData:function(t){_.keys(t).forEach((function(n){"multi_use_coupon"===n?e.updateKey("multi_use_coupon_code",_.get(t,"".concat(n,".code"))):e.updateKey(n,t[n])}))},updateKey:function(t,n){_.has(e,t)&&(e[t]=n)},onChangeCouponCodes:function(t){"multi"===t.target.value?(e.coupon_list_id=null,e.multi_use_coupon_code=""):e.multi_use_coupon_code=null,Object(a.getParent)(e).deleteErrorByKey("coupon_list"),Object(a.getParent)(e).deleteErrorByKey("multi_use_coupon")}}})),v=a.types.model({data:a.types.optional(a.types.frozen(),{}),isFetched:!1,isShow:!1}).actions((function(e){return{updateData:function(t){e.data=t},updateFetched:function(t){e.isFetched=t},hide:function(){e.isShow=!1}}})),y=a.types.model("IncentiveFormStore",{action:"",type:"",sub_type:a.types.maybeNull(a.types.string),incentiveData:a.types.maybeNull(h),initialData:a.types.maybeNull(b),errors:a.types.optional(a.types.map(a.types.array(a.types.string)),{}),submitting:!1,interpolations:v,confirmation:!1,showConfirmationFlushCampaignData:!1}).views((function(e){return{get allowEdit(){var t=!1;return"new"===e.action&&(t=!0),"edit"===e.action&&(t=c.a.campaign.data.test_mode||!c.a.campaign.data.has_activities),t},get allowEditFriendEventCategory(){return"ReferredIncentive"!==e.incentiveData.type&&e.allowEdit},get needConfirmationFlushCampaignData(){return c.a.campaign.data.test_mode&&c.a.campaign.data.has_activities&&"edit"===e.action},get title(){var t="new"===e.action?"Create ":"",n="".concat(e.type,".").concat(e.sub_type,".title");return"".concat(t).concat(_.get(o.f,n,""))},get buttonTextOnSave(){switch(e.action){case"new":return"Create Incentive";case"edit":return"Save Incentive";default:return""}},get uiFields(){return o.f[e.type][e.sub_type][e.incentiveData.incentive_type]},get pristine(){return _.isEqual(e.incentiveData,e.initialData)},get supportsNonMonetary(){return["ReferrerIncentive","ReferredIncentive"].includes(e.sub_type)},get isDisabledSubmitButton(){return"tremendous"===e.incentiveData.incentive_type||"rybbon"===e.incentiveData.incentive_type},get selectedPersonalCouponListOption(){return p.a.findCouponListsByValue({value:e.incentiveData.coupon_list_id})},get showCouponListExpirationWarning(){var t,n;return Object(u.b)({coupon_list_expires_at:null===(t=e.selectedPersonalCouponListOption)||void 0===t?void 0:t.expires,latest_coupon_expiration_date:null===(n=e.incentiveData)||void 0===n?void 0:n.latest_coupon_expiration_date})}}})).actions((function(e){return{setSubmitting:function(t){e.submitting=t},setAction:function(t){e.action=t},setType:function(t){e.type=t.type,"edit"===e.action?e.sub_type=Object(o.h)(c.a.incentives.find((function(e){return e.id===t.id}))):e.sub_type=t.sub_type},getInitialData:function(t){var n=t.action,r=t.data;switch(n){case"edit":e.incentiveData.updateData(c.a.incentives.find((function(e){return e.id===r.id}))),e.initialData.updateData(c.a.incentives.find((function(e){return e.id===r.id})));break;case"new":e.incentiveData.updateData(c.a.incentives.find((function(e){return e.id===r.id})));if(r.test_variant){var i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(n,!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},c.a.incentives.find((function(e){return e.id===r.id})),{id:null,amount:0,percentage_discount:!1,multi_use_coupon_code:null,coupon_list_id:null});e.incentiveData.updateData(i),e.initialData.updateData(i)}else{var a=function(e){var t=o.b[e.type][e.sub_type];switch(e.type){case"ClickIncentive":Number(c.a.campaign.data.require_email_to_claim)&&(t.once_per_person="1");break;case"SharingIncentive":Number(c.a.campaign.data.require_email_to_share)&&(t.once_per_person="1")}return _.has(e,"identifier")&&(t.identifier=e.identifier),t}(r);e.incentiveData.updateData(a),e.initialData.updateData(a)}}e.setAction(n),e.setType(r)},updateErrors:function(t){e.errors.replace(t)},deleteErrorByKey:function(t){e.errors.delete(t)},cancelChanges:function(){e.incentiveData.updateData(e.initialData),e.clearErrors()},clearErrors:function(){e.errors.clear()},clearData:function(){e.action="",e.incentiveData={},e.initialData={},e.interpolations={},e.clearErrors(),e.confirmation=!1,e.showConfirmationFlushCampaignData=!1},create:Object(a.flow)(i.a.mark((function t(n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setSubmitting(!0),t.prev=1,t.next=4,$.ajax({type:"POST",url:Routes.internal_site_campaign_incentives_path(window.Site,window.Campaign),data:{incentive:e.incentiveData.prepareDataForServer}});case 4:e.getAll(n),t.next=13;break;case 7:t.prev=7,t.t0=t.catch(1),e.setSubmitting(!1),r=_.get(t.t0,"responseJSON.result.errors",{}),Validation.showErrorFlash(),e.updateErrors(r);case 13:case"end":return t.stop()}}),t,null,[[1,7]])}))),edit:Object(a.flow)(i.a.mark((function t(n,r){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setSubmitting(!0),t.prev=1,t.next=4,$.ajax({type:"PATCH",url:Routes.internal_site_campaign_incentive_path(window.Site,window.Campaign,{id:n}),data:{incentive:e.incentiveData.prepareDataForServer}});case 4:e.getAll(r,e.incentiveData.id),t.next=21;break;case 7:if(t.prev=7,t.t0=t.catch(1),e.setSubmitting(!1),a=_.get(t.t0,"responseJSON.result.errors",{}),"Single-use or multi-use code must be specified"!==_.get(a,"coupon_list.0")){t.next=19;break}t.t1=e.incentiveData.coupon_codes,t.next="single"===t.t1?15:"multi"===t.t1?17:19;break;case 15:return a.coupon_list=["Please choose coupon list"],t.abrupt("break",19);case 17:return a.coupon_list=["Is too short (minimum is 3 characters)"],t.abrupt("break",19);case 19:Validation.showErrorFlash(),e.updateErrors(a);case 21:case"end":return t.stop()}}),t,null,[[1,7]])}))),delete:Object(a.flow)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$.ajax({type:"DELETE",url:Routes.internal_site_campaign_incentive_path(window.Site,window.Campaign,{id:t})});case 3:c.a.updateCampaignData(),n&&n(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),Validation.showErrorFlash(),Widget.Utils.notifyDevelopers({name:"Unable delete incentive",message:"Ajax failure",xhr:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),getAll:Object(a.flow)(i.a.mark((function t(){var n,r,a,o,l=arguments;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>0&&void 0!==l[0]?l[0]:_.identity,r=l.length>1?l[1]:void 0,t.prev=2,t.next=5,$.ajax({type:"GET",url:Routes.internal_site_campaign_incentives_path(window.Site,window.Campaign,{no_spinner:!0})});case 5:a=t.sent,o=a.result.incentives,c.a.updateIncentives(o,r),Validation.showSuccessFlash(),e.setSubmitting(!1),n(),t.next=18;break;case 13:t.prev=13,t.t0=t.catch(2),e.setSubmitting(!1),Validation.showErrorFlash(),Widget.Utils.notifyDevelopers({name:"Unable get incentives",message:"Ajax failure",xhr:t.t0});case 18:case"end":return t.stop()}}),t,null,[[2,13]])}))),toggleInterpolations:function(){var t=!e.interpolations.isShow;t&&!e.interpolations.isFetched&&e.fetchInterpolations(),e.interpolations.isShow=t},fetchInterpolations:function(){$.get(Routes.criteria_sample_interpolations_internal_site_campaign_incentives_path(window.Site,window.Campaign,{type:e.incentiveData.type,no_spinner:!0})).then((function(t){var n=t.result.criteria_sample_interpolations;e.interpolations.updateFetched(!0),e.interpolations.updateData(n)})).fail((function(e){Widget.Utils.notifyDevelopers({name:"Unable to get interpolations of incentive",message:"Ajax failure",xhr:e})}))},toggleConfirmation:function(){e.confirmation=!e.confirmation},toggleShowConfirmationFlushCampaignData:function(){e.showConfirmationFlushCampaignData=!e.showConfirmationFlushCampaignData}}})),g=Object(s.a)(y.create({incentiveData:{},initialData:{},interpolations:{}}))},DQTY:function(e,t,n){"use strict";n.r(t);var r=n("ho87"),i=n("3fie");n("GgMs");r.a.render(i.a,"CampaignRulesApp")},DzDc:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n("QWlW"),i=n("GaHK"),a=_.partial(r.b,"rulesStore"),o={mobxForm:a((function(e){return{mobxForm:e.mobxForm,rulesStore:e}})),SectionHeaders:a((function(e){return{SectionHeaders:e.SectionHeaders,rulesStore:e}}))},c=function(t){var n=t.type,r=t.latest_coupon_expiration_date;return e.createElement(i.UIInlineNotification,{type:"warning",className:"mtm"},"Selected coupon list expires too soon. As a result"," ",function(e){switch(e.type){case"SignupIncentive":case"SharingIncentive":case"ReferrerIncentive":return"Advocate";case"PersonalCouponIncentive":case"ClickIncentive":case"ReferredIncentive":return"Friend";default:return"Friend or Advocate"}}({type:n})," will not have enough time to use their coupon. Consider choosing another coupon list that expires on"," ",e.createElement("span",{style:{color:i.Theme.color.red}},moment.parseZone(r).add(1,"day").format("MM/DD/YYYY")," ","or latter"),".")}}).call(this,n("q1tI"))},ENtk:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return b}));var r,i=n("GaHK"),a=n("vOnD"),o=n("kMSe");function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==c(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=a.default.div.withConfig({displayName:"incentive_group_settings__ButtonInline",componentId:"sc-1fnpezz-0"})(["display:inline-block;font-family:'gotham-htf-medium';color:#0070d9;font-size:14px;line-height:1;cursor:pointer;&:hover{color:#ff4f00;text-decoration:none;}"]),b=Object(o.c)((function(e){return{getIncentives:e.incentiveFormStore.getAll}}))(r=Object(o.d)(r=function(t){function n(t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=p(this,f(n).call(this,t))).closeModal=function(){return r.props.onClose()},r.transformDataToValues=function(e,t){var n=t.split_test_variant.id;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,s({},n,{id:n,distribution_rate:r.getIncentiveDistributionRate(t)}))},r.getIncentiveDistributionRate=function(e){var t=_.get(r.state,"values.".concat(e.split_test_variant.id));return t?t.distribution_rate:e.distribution_rate},r.getIncentivePercentageProbability=function(e){var t=100/r.totalDistributionPoints*r.getIncentiveDistributionRate(e);return _.round(t,2)},r.handleChange=function(e){return function(t){var n=_.cloneDeep(r.state.values),i=Number(t.target.value);n[e]={id:e,distribution_rate:i},Validation.clearCustomMessage("incentives[{".concat(e,"}].distribution_rate")),0===i&&Validation.failCustomMessage("incentives[{".concat(e,"}].distribution_rate"),"Variants distribution rate must be greater than 0"),r.setState({values:n})}},r.saveChanges=function(){return $.ajax({url:Routes.internal_site_split_test_path(window.Site.cached_slug,r.state.split_test_id),type:"PUT",dataType:"json",data:{split_test:{variants_attributes:r.state.values}}}).then((function(){r.props.getIncentives(r.closeModal())})).fail((function(e){Validation.showErrorFlash()}))},r.modalActions=function(){return e.createElement(i.UIFormFooter,null,e.createElement(m,{className:"mrl",onClick:r.closeModal},"Cancel"),e.createElement(i.UIButton,{trait:"success",onClickLoad:r.saveChanges,type:"submit"},"Save Distribution"))},r.state={split_test_id:_.get(t,"incentives.0.split_test_variant.split_test_id"),values:_.reduce(t.incentives,r.transformDataToValues,{})},r}var r,a,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,t),r=n,(a=[{key:"componentDidUpdate",value:function(e){_.isEqual(this.props.incentives,e.incentives)||this.setState({values:_.reduce(this.props.incentives,this.transformDataToValues,{})})}},{key:"render",value:function(){var t=this;return e.createElement(i.UIModal,{title:"A/B Test Distribution",actionClose:this.closeModal,noContentPaddingBottom:!0,actions:this.modalActions},e.createElement("div",{className:"pbl"},e.createElement("table",{className:"base-table incentive-settings-table"},e.createElement("tbody",null,e.createElement("tr",null,e.createElement("th",null,"Variants"),e.createElement("th",null,"Relative frequency distribution",e.createElement("a",{title:"Specify relative frequency number for each A/B test variant. For example: setting 4 to A variant and 1 to B variant will make 4 to 1 distribution, which is equal to 80% to 20%.","data-toggle":"tooltip","data-placement":"left"},e.createElement("i",{className:"icon icon-question"},e.createElement("span",{className:"sign"},"?"))))),this.props.incentives.map((function(n,r){var a=t.getIncentiveDistributionRate(n),o=t.getIncentivePercentageProbability(n);return e.createElement("tr",{key:"".concat(n.id)},e.createElement("td",null,e.createElement("span",{className:"incentive-badge"},n.index),e.createElement("div",{className:"incentive-settings-table-title-value"},n.split_test_variant.value)),e.createElement("td",{className:"span5"},e.createElement("div",{className:"input-container "},e.createElement(i.UIInputNumber,{value:a,name:"incentives.distribution_rate",type:"number",min:1,onChange:t.handleChange(n.split_test_variant.id)}),e.createElement("span",{className:"mlm"},o,"% distribution")),e.createElement("div",{"data-validate-message":"incentives[{".concat(n.split_test_variant.id,"}].distribution_rate"),className:"hidden pts pbm"})))}))))))}},{key:"totalDistributionPoints",get:function(){return _.reduce(_.values(this.state.values),(function(e,t){return e+t.distribution_rate}),0)}}])&&u(r.prototype,a),o&&u(r,o),n}(e.Component))||r)||r}).call(this,n("q1tI"))},"G/5i":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return me}));var r,i,a,o,c,l,s,u,p,f,d,m,b,h,v,y,g,w,E,C,O,S,I,j,x,k,N,P,F,D,T,U,R,A,L,M,z,V=n("o0o1"),B=n.n(V),q=n("dhqo"),H=n.n(q),W=n("L0cm"),K=n("2vnA"),G=n("N5mh"),Y=n.n(G),J=n("ZVfT"),Z=n("Ty5D"),Q=n("oqc9"),X=n("V/h/"),ee=n("52sZ");function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(n,!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ie(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e,t,n){return t&&ae(e.prototype,t),n&&ae(e,n),e}function ce(e,t,n,r,i){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(l){i=!0,a=l}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var se='<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner no-max-width h-wabs-5"></div></div>',ue={NO_INITIALIZE:"Can't initialize store. window.Campaign should be defined",AGE_INVALID:"Advocate origin max age must be greater than advocate origin min age",FLUSH_CAMPAIGN_DATA:"This action will flush campaign data (shares, clicks, visits metrics, etc.). Are you sure?",DISABLED_BY_OPTIN_INCENTIVE:"You need to remove subscription incentives in order to enable this field."},pe={extra:{inputProps:{min:1}}},fe=function(t){return Object(Z.o)((function(n){var r=n.tipLink,i=n.history,a=t.to,o=t.label;return e.useEffect((function(){var e="#".concat(a);_.includes(i.location.hash,e)&&Object(J.s)({position:$(e).offset().top+50})}),[]),e.createElement("div",null,e.createElement(Q.Element,{id:a}),e.createElement("h2",null,o,r&&e.createElement("a",{href:r,target:"_blank"},e.createElement("i",{className:"icon icon-question is-middle is-mls",title:"Click here to learn more","data-toggle":"tooltip"},e.createElement("span",{className:"sign"}," &#63 ")))))}))},de=(z=M=function(){function e(){var t=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ie(this,"tagName",i,this),ie(this,"currentIp",a,this),ie(this,"personal_coupon_list_id",o,this),ie(this,"showCurrentIp",c,this),ie(this,"fetchingCurrentIp",l,this),ie(this,"campaign",s,this),ie(this,"errors",u,this),ie(this,"updateErrors",p,this),ie(this,"clearErrors",f,this),ie(this,"isInitialLoading",d,this),ie(this,"tags",m,this),ie(this,"updateTags",b,this),ie(this,"addTag",h,this),ie(this,"removeTag",v,this),ie(this,"fetchCurrentIp",y,this),ie(this,"filterRealTag",g,this),ie(this,"incentives",w,this),ie(this,"incentiveHighlightNewId",E,this),ie(this,"incentiveHighlightEditId",C,this),ie(this,"updateIncentives",O,this),ie(this,"updateIncentiveHighlightId",S,this),ie(this,"clearIncentiveHighlightId",I,this),ie(this,"variables",j,this),ie(this,"toggleShowVariables",x,this),ie(this,"getVariables",k,this),ie(this,"updateVariables",N,this),ie(this,"dataIsSaving",P,this),ie(this,"showFlashingMessage",F,this),this.isOriginAgeInvalid=function(){var e=t.mobxForm.values(),n=e.origin_max_age,r=e.origin_min_age;return n&&r&&n<r},this.updateCampaignName=function(){$(".Campaign-management-header-title.js-campaign-head-title").text(t.campaign.data.name),document.title="Campaign Rules | ".concat(t.campaign.data.name," | Talkable")},ie(this,"updateCampaignData",D,this),ie(this,"initialCampaignDataValues",T,this),ie(this,"savePersonalCouponList",U,this),ie(this,"handleStaticWidget",R,this),ie(this,"saveChanges",A,this),ie(this,"saveOnEnter",L,this),this.getFormattedCampaignTime=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=t.campaign.data[e];return i?i.format(n):r},this.createField=function(e){return{name:e,value:t.campaign.data[e]||""}},this.createTimeField=function(e){return{name:e,fields:[{name:"date",value:t.getFormattedCampaignTime(e,"MM/DD/YYYY")},{name:"hour",value:t.getFormattedCampaignTime(e,"HH","00")},{name:"minute",value:t.getFormattedCampaignTime(e,"mm","00")},{name:"zone",value:t.getFormattedCampaignTime(e,"Z",t.campaign.data.created_at&&t.campaign.data.created_at.format("Z"))}]}},this.createAgeField=function(n){var r=t.campaign.data,i=e.buildOriginAge(r[n]),a=i.unit,o=i.value;return{name:n,output:function(e){return e.value*e.unit},fields:[ne({name:"value",value:o},pe),{name:"unit",value:a,extra:{options:e.timeUnitOptions}},{name:"isUnlimited",value:0===Number(o)}]}},!window.Campaign)throw new Error(ue.NO_INITIALIZE);this.mobxForm=new Y.a({fields:this.formFields})}return oe(e,null,[{key:"buildOriginAge",value:function(t){var n={value:null,unit:W.P.UNIT};if(!t)return n;var r=_.map(e.timeUnitOptions,"value");return _.forEach(r,(function(e){t%e===0&&(n={value:t/e,unit:e})})),n}}]),oe(e,[{key:"makeDurationHumanReadable",value:function(e){return 0===e?"":e?e<W.P.HOURS_IN_DAY?H()("hour",e,!0):H()("day",Math.floor(e/W.P.HOURS_IN_DAY),!0):"unlimited"}},{key:"updateCampaignDataValues",value:function(e){var t=_.update(e,"tags_attributes",(function(e){return _.filter(e,(function(e){return""!==e.name}))})),n=_.chain(t).thru(_.partial(J.x,"campaign")).value();return _.values(_.get(n,"campaign",{}))}},{key:"normalizeIpFilteringData",value:function(e){var t=e.campaign.ip_address_filtering,n=t.mode,r=t.value;e.campaign.ip_address_filtering_mode=n,e.campaign.ip_address_filtering_value=n?r:null,delete e.campaign.ip_address_filtering}},{key:"normalizePersonalizedCouponData",value:function(e){var t=ee.b.pages.personalCouponFormStore,n=t.mode,r=t.selectedPersonalCouponListId;n&&(e.campaign.personal_coupon_list_id=r)}},{key:"isCampaignDeactivated",get:function(){return this.campaign.data.expires_at&&"Disabled"===this.campaign.status}},{key:"personalCouponListId",get:function(){return this.personal_coupon_list_id||this.campaign.personal_coupon_list_id}},{key:"advocateIncentives",get:function(){return _.filter(this.campaign.data.incentives,"for_advocate")}},{key:"advancedSettingsCheckboxesConfig",get:function(){var e=this,t=this.campaign.data,n=_.some(this.campaign.data.incentives,_.matchesProperty("new_optin",W.Q)),r="";return t.has_activities&&(r="You cannot change the value because this campaign already has activity (shares, affiliate members, etc)."),n&&(r+=" ".concat(ue.DISABLED_BY_OPTIN_INCENTIVE)),{redirect_on_expired_claim:{label:"Redirect a Friend to a Site URL when his offer is expired"},require_email_to_share:{label:"Email Gating for Advocate",extra:{tips:[{title:"Require Advocate to enter their email address in order to share with Friends."}],warning:{text:"Please be aware that without Advocate email gating,\n                  Talkable will not capture email addresses for Advocates who are not logged in to your site.\n                  That means those users will be considered anonymous and will not be eligible for rewards or able\n                  to be identified in reports.",checkVisibility:function(t){return!t&&e.advocateIncentives.length}}}},require_email_to_claim:{label:"Email Gating for Friend",extra:{tips:[{title:"Require Friend to enter their email address in order to get a coupon code on the Friend Claim Page."},{title:ue.DISABLED_BY_OPTIN_INCENTIVE,hideWhen:!n}],inputProps:{disabled:n},warning:{text:"Impossible to enter Friend email on a disabled Claim page. Either enable Friend Claim Page or disable email gating.",checkVisibility:function(t){return t&&_.some(e.campaign.data.view_setups,(function(e){return"offers_claim"===e.view_category&&!e.enabled}))}}}},use_facebook_app_id:{label:"Use Facebook App Share instead of sharer.php"},show_claim_page_for_self_referral:{label:"Show Claim Page to self-referral"},single_visitor_for_direct_shares:{label:"Single Visitor for Email shares",extra:{tips:[{title:"<ol className='h-hgap-s'>\n              <li>Allows to embed Coupon Code into Friend Share Email and its reminder</li>\n              <li>Only one Coupon Code is given per Email Share per Offer. That means if multiple Friends click on the Share link they all get the same Coupon Code. It works great for Fraud prevention as the Coupon Code will be applied only once by a first Friend who buys.</li>\n              <li>Friends automatically skip Email Gating on the Friend Claim Page</li>\n              <li>Friend's email address is available for use on the Friend Claim Page at all times</li>\n              <li>Friend Share Email will not be sent if Friend Incentive Criteria does not succeed</li>\n            </ol>"}],warning:{text:r,checkVisibility:function(e){return t.has_activities||n}},tipTemplate:se,inputProps:{disabled:t.has_activities||n}}},smart_advocate_signup:{label:"Smart Advocate signup",extra:{tips:[{title:"Advocate Signup page will be skipped in a case when Advocate email address is known from their previous activity, there are no other emails associated with this Advocate, and the email was not passed through the integration."}],tipTemplate:se}},static_widget:{label:"Optimize campaign performance",extra:{staffOnly:!0,tips:[{title:"Use static trigger widget"}],inputProps:{disabled:!ee.b.models.currentUser.staffMember},warning:{text:"Require integration v. ".concat(Site.min_suitable_version_for_static_widget,"+"),checkVisibility:function(e){return e&&!Site.is_version_suitable_for_static_widget}}}}}}},{key:"allowEdit",get:function(){return this.campaign.data.test_mode||!this.campaign.data.has_activities}},{key:"advancedSettingsCheckboxesFields",get:function(){var e=this.campaign.data,t=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ne({type:"checkbox",name:t,value:Boolean(Number(e[t])),output:function(e){return String(Number(e))}},n)};return _.reduce(this.advancedSettingsCheckboxesConfig,(function(e,n,r){return[].concat(e,[t(r,n)])}),[])}},{key:"plainCampaignData",get:function(){return Object(K.toJS)(this.campaign)}},{key:"unsavedCampaignData",get:function(){var e=this.mobxForm,t=_.update(e.values(),"tags_attributes",(function(e){return _.filter(e,(function(e){return""!==e.name}))}));return _.chain(t).pickBy((function(t,n){return e.$(n).isDirty})).thru(_.partial(J.x,"campaign")).value()}},{key:"hasUnsavedChanges",get:function(){return this.initialCampaignDataValues.length>0&&!_.isEqual(this.updateCampaignDataValues(this.mobxForm.values()),Object(K.toJS)(this.initialCampaignDataValues))}},{key:"formFields",get:function(){var t=this.campaign.gleam;return[ne({},this.createField("name"),{label:"Campaign name:",extra:{description:"Example: Offer for friends"}}),ne({},this.createField("description"),{label:"Campaign description:",extra:{description:"Describe the main idea of the campaign and what it is unique for"}}),ne({},this.createTimeField("expires_at"),{extra:ne({},t?{title:"Campaign Expiration:",description:"Campaign state will be switched 'Disabled', it will not be visible in production"}:{title:"Campaign Expiration:",description:"Advocate won\u2019t be able to share after this date, but still can be rewarded for previous shares. Campaign state will be switched to \u2018Disabled\u2019, it will not be visible in production.",tip:"Set offer expiration for Advocate and Friend by specifying specific dates or setting them in hours."})}),ne({},this.createTimeField("friend_deadline"),{extra:{title:"Friend's offer deadline:",description:"Friend won't be able to claim their rewards after this date."}}),{name:"offer_duration",output:function(e){return e.value},fields:[ne({name:"value",value:this.campaign.data.offer_duration},pe),{name:"isUnlimited",value:!this.campaign.data.offer_duration}],extra:ne({},pe.extra,{title:"Friend's offer expiration in hours:",description:"Set a delay when Friend's offer will expire after Advocate's share. Leave blank for unlimited."})},ne({},this.createField("new_customer"),{label:"Advocate is new customer:",extra:{options:e.criteriaBooleanOptions}}),{name:"ip_address_filtering",label:"IP address filter:",fields:[{name:"mode",value:this.campaign.data.ip_address_filtering_mode||"",extra:{options:e.ipFilteringModeOptions}},{name:"value",value:this.campaign.data.ip_address_filtering_value}]},this.createAgeField("origin_min_age"),this.createAgeField("origin_max_age"),ne({},this.createField("criteria"),{extra:ne({},t?{title:"Campaign join criteria:",description:"Liquid condition defines when the Gleam is shown",example:"{% if gleam_reward.incentive.for_friend %} true {% endif %}"}:{title:"Advocate campaign join criteria:",description:"Liquid condition to allow creation only for specific offers",example_title:"Limit Advocate offer creation (and showing Advocate Share Page as a result) with specific rules.",info_sidebar_title:"For example: create an offer only if the Advocate referred between 2-5 Friends:",example:"{% if advocate_info.referrals_count > 1 and advocate_info.referrals_count < 6 %} true {% endif %}"})}),ne({},this.createField("destination_url_override"),{label:"Friend destination URL:",extra:{tip:"UTM parameters can be included to pass campaign source, sharing channel, as well as any other parameters you wish to pass.",description:"This is the ultimate destination URL upon click-thru on an Advocates share link.  This URL will deliver the Friend to your website from the Claim page.",subDescription:"Example: http://site.com/products"}})].concat(this.advancedSettingsCheckboxesFields,[{name:"tags_attributes",value:[]}])}},{key:"navLinksConfig",get:function(){var e=this.campaign.gleam;return{offers:{to:"offers",label:"Offers",invisible:e},incentives:{to:"incentives",label:"Incentives",invisible:e},tags:{to:"tags",label:"Tags"},settings:{to:"settings",label:"Advanced"}}}},{key:"SectionHeaders",get:function(){return _.mapValues(this.navLinksConfig,fe)}},{key:"originAgeFieldData",get:function(){return this.campaign.gleam?{label:"Timeframe when the Gleam is shown",extra:{tip:"An example would be: Setting 'From' timeframe to 1 day will make the new visitor who is coming to a site don't see the Gleam. However when they return back to a site in 24 hours they will be able to see it.",tipTemplate:se}}:{label:"Timeframe when an offer is available to Advocate",extra:{tip:"An example would be: show Floating Widget to existing visitors only (people who previously landed on the site at least once). Setting 'From' timeframe to 1 day will make all Advocates see the campaign only in 1 day from the first page visit. If the new visitor who is coming to a site they will not see the campaign. However when they return back to a site after 24 hours timeframe they will be able to see it.",tipTemplate:se}}}}]),e}(),M.campaignDataSerializer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _.mapValues(t,(function(t,n){var r=_.reduce(e,(function(e,t){var r=le(t,2),i=r[0],a=r[1];return _.includes(i,n)?[].concat(e,[a]):e}),[]);return _.flow(r)(t)}))}}([[["expires_at","friend_deadline","created_at"],function(e){return moment.parseZone(e).isValid()?moment.parseZone(e):e}]]),M.criteriaBooleanOptions=[{label:"",value:""},{label:"Yes",value:1},{label:"No",value:0}],M.ipFilteringModeOptions=[{label:"Show everywhere",value:""},{label:"Hide on",value:"hide"},{label:"Show on",value:"show"}],M.timeUnitOptions=[{label:"sec",value:W.P.UNIT},{label:"min",value:W.P.SECONDS_IN_MINUTE},{label:"hour",value:W.P.SECONDS_IN_HOUR},{label:"day",value:W.P.SECONDS_IN_DAY},{label:"week",value:W.P.SECONDS_IN_WEEK}],i=ce((r=z).prototype,"tagName",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),a=ce(r.prototype,"currentIp",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),o=ce(r.prototype,"personal_coupon_list_id",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=ce(r.prototype,"showCurrentIp",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=ce(r.prototype,"fetchingCurrentIp",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=ce(r.prototype,"campaign",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ne({},window.Campaign,{data:{}})}}),u=ce(r.prototype,"errors",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),p=ce(r.prototype,"updateErrors",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.errors.replace(t)}}}),f=ce(r.prototype,"clearErrors",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.errors.clear()}}}),d=ce(r.prototype,"isInitialLoading",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),m=ce(r.prototype,"tags",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),b=ce(r.prototype,"updateTags",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.tags.replace(t)}}}),h=ce(r.prototype,"addTag",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.updateTags([].concat(Object(K.toJS)(e.tags),[{name:e.tagName}])),e.saveChanges()}}}),v=ce(r.prototype,"removeTag",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(K.flow)(B.a.mark((function e(t){var n,r,i;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.tags.find((function(e){return e.id===t})),r=this.tags.findIndex((function(e){return e.id===t})),this.updateTags(this.tags.filter((function(e){return e.id!==t}))),e.prev=3,e.next=6,$.ajax({url:Routes.internal_site_campaign_path(window.Site,window.Campaign),type:"PUT",dataType:"json",data:{campaign:{tags_attributes:{id:t,_destroy:!0}}}});case 6:Validation.showSuccessFlash(),e.next=15;break;case 9:e.prev=9,e.t0=e.catch(3),(i=Object(K.toJS)(this.tags)).splice(r,0,n),this.updateTags(i),Widget.Utils.notifyDevelopers({name:"Unable delete tag Campaign Rules",message:"Ajax failure",xhr:e.t0});case 15:case"end":return e.stop()}}),e,this,[[3,9]])}))).bind(this)}}),y=ce(r.prototype,"fetchCurrentIp",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showCurrentIp=!0,e.fetchingCurrentIp=!0,$.ajax({url:Routes.ip_address_internal_site_campaigns_path(window.Site)}).then((function(t){e.currentIp=t.result.ip_address,e.fetchingCurrentIp=!1})).fail((function(t){e.fetchingCurrentIp=!1,Widget.Utils.notifyDevelopers({name:"Unable to get ip address",message:"Ajax failure",xhr:t})})),Utils.trackGAEvent(W.k,"fetch current ip")}}}),g=ce(r.prototype,"filterRealTag",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.tags.replace(e.tags.filter((function(e){return _.has(e,"id")})))}}}),w=ce(r.prototype,"incentives",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E=ce(r.prototype,"incentiveHighlightNewId",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=ce(r.prototype,"incentiveHighlightEditId",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=ce(r.prototype,"updateIncentives",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){t.length>e.incentives.length&&t.forEach((function(t){e.incentives.find((function(e){return e.id===t.id}))||e.updateIncentiveHighlightId("new",t.id)})),e.updateIncentiveHighlightId("edit",n),e.incentives.replace(t)}}}),S=ce(r.prototype,"updateIncentiveHighlightId",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t){case"new":e.incentiveHighlightNewId=n;break;case"edit":e.incentiveHighlightEditId=n}}}}),I=ce(r.prototype,"clearIncentiveHighlightId",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.incentiveHighlightNewId=null,e.incentiveHighlightEditId=null}}}),j=ce(r.prototype,"variables",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{join_criteria_interpolations:{show:!1,isFetched:!1,data:new Map},destination_url_interpolations:{show:!1,isFetched:!1,data:new Map}}}}),x=ce(r.prototype,"toggleShowVariables",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){_.mapKeys(e.variables,(function(n,r){e.variables[r].show=r===t&&!e.variables[r].show}))}}}),k=ce(r.prototype,"getVariables",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(K.flow)(B.a.mark((function e(t){var n,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.variables[t].isFetched){e.next=12;break}return e.prev=1,e.next=4,$.ajax({url:Routes["".concat(t,"_internal_site_campaign_path")](window.Site,window.Campaign),data:{no_spinner:!0}});case 4:n=e.sent,r=n.result,this.updateVariables(t,r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),Widget.Utils.notifyDevelopers({name:"Unable get ".concat(t," variables Campaign Rules"),message:"Ajax failure",xhr:e.t0});case 12:case"end":return e.stop()}}),e,this,[[1,9]])}))).bind(this)}}),N=ce(r.prototype,"updateVariables",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){e.variables[t].data.replace(n[t]),e.variables[t].isFetched=!0}}}),P=ce(r.prototype,"dataIsSaving",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),F=ce(r.prototype,"showFlashingMessage",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ce(r.prototype,"isCampaignDeactivated",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"isCampaignDeactivated"),r.prototype),ce(r.prototype,"personalCouponListId",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"personalCouponListId"),r.prototype),ce(r.prototype,"advocateIncentives",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"advocateIncentives"),r.prototype),ce(r.prototype,"advancedSettingsCheckboxesConfig",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"advancedSettingsCheckboxesConfig"),r.prototype),ce(r.prototype,"allowEdit",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"allowEdit"),r.prototype),ce(r.prototype,"advancedSettingsCheckboxesFields",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"advancedSettingsCheckboxesFields"),r.prototype),ce(r.prototype,"plainCampaignData",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"plainCampaignData"),r.prototype),D=ce(r.prototype,"updateCampaignData",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(K.flow)(B.a.mark((function e(){var t,n,r,i,a,o=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{reloadWizard:!0},e.prev=1,e.next=4,$.ajax({url:Routes.internal_site_campaign_path(window.Site,window.Campaign.id)});case 4:n=e.sent,r=n.result,this.isInitialLoading=!1,this.campaign.data=de.campaignDataSerializer(r),this.personal_coupon_list_id=r.personal_coupon_list_id,this.incentives.replace(r.incentives),this.updateTags(r.tags),this.updateCampaignName(),i=this.formFields.reduce((function(e,t){return t.fields?t.fields.forEach((function(n){e[t.name]=ne({},e[t.name],re({},n.name,n.value))})):e[t.name]=t.value,e}),{}),this.mobxForm.set("default",i),this.mobxForm.set("initial",i),this.mobxForm.set("value",i),a=_.find(this.formFields,{name:"single_visitor_for_direct_shares"}).extra,this.mobxForm.$("single_visitor_for_direct_shares").set("extra",a),this.dataIsSaving=!1,this.initialCampaignDataValues.replace(this.updateCampaignDataValues(this.mobxForm.values())),t.reloadWizard&&window.current_user.wizard_enabled===W.Q&&Wizard.reload(),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(1),Widget.Utils.notifyDevelopers({name:"Unable campaign data Campaign Rules",message:"Ajax failure",xhr:e.t0});case 26:case"end":return e.stop()}}),e,this,[[1,23]])}))).bind(this)}}),T=ce(r.prototype,"initialCampaignDataValues",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ce(r.prototype,"unsavedCampaignData",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"unsavedCampaignData"),r.prototype),ce(r.prototype,"hasUnsavedChanges",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"hasUnsavedChanges"),r.prototype),U=ce(r.prototype,"savePersonalCouponList",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){if(!e.dataIsSaving){e.dataIsSaving=!0,e.showFlashingMessage=!1;var t=ee.b.pages.personalCouponFormStore,n=t.hidePersonalCouponForm,r=t.hidePersonalCouponRemoveModal,i=Object(X.a)({campaign:{}},(function(t){e.normalizePersonalizedCouponData(t)}));$.ajax({url:Routes.internal_site_campaign_path(window.Site,e.campaign),type:"PUT",dataType:"json",data:i}).then((function(){e.clearErrors(),n(),r(),e.updateCampaignData(),Validation.succeed()})).fail((function(t){e.filterRealTag();var n=_.get(t,"responseJSON.result.errors",{});e.updateErrors(n),Validation.fail(n),e.dataIsSaving=!1})),Utils.trackGAEvent(W.k,"update personal coupon list")}}}}),R=ce(r.prototype,"handleStaticWidget",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){"1"===e?window.StaticWidgetProvider.render():"0"===e&&window.StaticWidgetProvider.unmount()}}}),A=ce(r.prototype,"saveChanges",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(K.flow)(B.a.mark((function e(){var t,n,r,i,a,o=this;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dataIsSaving){e.next=2;break}return e.abrupt("return");case 2:if(this.dataIsSaving=!0,this.showFlashingMessage=!1,!this.isOriginAgeInvalid()){e.next=8;break}return Validation.showErrorFlash(ue.AGE_INVALID),this.dataIsSaving=!1,e.abrupt("return",!1);case 8:return t=function(e){return 0!==e?e:null},n=function(e,n){return _.hasIn(e,n)?_.update(e,n,t):e},r=Object(X.a)(this.unsavedCampaignData,(function(e){n(e,"campaign.origin_min_age"),n(e,"campaign.origin_max_age"),n(e,"campaign.offer_duration"),o.normalizeIpFilteringData(e)})),e.prev=11,e.next=14,$.ajax({url:Routes.internal_site_campaign_path(window.Site,this.campaign),type:"PUT",dataType:"json",data:r});case 14:this.clearErrors(),this.updateCampaignData(),(i=r.campaign.static_widget)?(Campaign.static_widget="1",this.handleStaticWidget(i)):Campaign.static_widget="0",Validation.succeed(),this.tagName="",this.showFlashingMessage=!1,e.next=30;break;case 23:e.prev=23,e.t0=e.catch(11),this.filterRealTag(),a=_.get(e.t0,"responseJSON.result.errors",{}),this.updateErrors(a),Validation.fail(a),this.dataIsSaving=!1;case 30:case"end":return e.stop()}}),e,this,[[11,23]])}))).bind(this)}}),L=ce(r.prototype,"saveOnEnter",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t.which&&(t.metaKey||t.ctrlKey)&&t.which===W.J.S&&(t.preventDefault(),e.saveChanges())}}}),ce(r.prototype,"formFields",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"formFields"),r.prototype),ce(r.prototype,"navLinksConfig",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"navLinksConfig"),r.prototype),ce(r.prototype,"SectionHeaders",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"SectionHeaders"),r.prototype),ce(r.prototype,"originAgeFieldData",[K.computed],Object.getOwnPropertyDescriptor(r.prototype,"originAgeFieldData"),r.prototype),r),me=new de}).call(this,n("q1tI"))},GgMs:function(e,t,n){},HCbX:function(e,t){e.exports="/assets/v1/packs/reward-type-tremendous@2x-ab32f96bd9fb689943f8abbb0f839265.png"},JOlu:function(e,t){e.exports="/assets/v1/packs/image-incentives-dcdc538db41ef2eed7e27a79f1806716.png"},KzCQ:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return E}));var r,i,a=n("Ty5D"),o=n("55Ip"),c=n("vOnD"),l=n("kMSe"),s=n("zwcX"),u=n("GaHK"),p=n("L0cm"),f=n("dhqo"),d=n.n(f),m=n("oqc9");function b(e){return(b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return!t||"object"!==b(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w=c.default.div.withConfig({displayName:"personal_coupon_list__CampaignsCount",componentId:"sc-1oxvcnr-0"})(["font-size:13px;"]),E=(r=Object(l.c)((function(e){return{rulesStore:e.rulesStore,rootStore:e.rootStore}})),Object(a.o)(i=r(i=Object(l.d)(i=function(t){function n(t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=v(this,y(n).call(this,t))).getPersonalCouponListIdFromUrl=function(){var e=r.props.history.location;return parseInt(_.replace(e.hash,"#personal_coupon_",""))},r.checkPersonalCouponRoute=function(){var e=r.props,t=e.history.location,n=e.rootStore.models.sitePersonalCouponLists.currentPersonalCouponList;_.includes(t.hash,"#personal_coupon_")&&n.id===r.getPersonalCouponListIdFromUrl()&&r.scrollToPersonalCoupon()},r.scrollToPersonalCoupon=function(){var e=$(r.personalCouponRef.current).offset().top-135;m.animateScroll.scrollTo(e,{duration:500,smooth:!0})},r.handleRemovePersonalCouponList=function(e){e.preventDefault(),(0,r.props.rootStore.pages.personalCouponFormStore.showPersonalCouponRemoveModal)()},r.detachPersonalCouponList=function(){var e=r.props,t=e.rootStore.pages.personalCouponFormStore.detachPersonalCouponList,n=e.rulesStore.savePersonalCouponList;t(),n()},r.personalCouponRef=e.createRef(),r}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(n,t),r=n,(i=[{key:"componentDidMount",value:function(){var e=this.props,t=e.history.location.pathname,n=e.rootStore.pages.personalCouponFormStore.activateEditMode;_.includes(t,s.a.personalCouponListEdit.pathPrefix)?n():this.checkPersonalCouponRoute()}},{key:"render",value:function(){var t=this.props,n=t.rootStore,r=n.models,i=r.currentUser.staffMember,a=r.site.siteCachedSlug,c=r.sitePersonalCouponLists,l=c.currentPersonalCouponList,s=c.currentPersonalCouponListDataFetched,f=n.pages.personalCouponFormStore,m=f.activateEditMode,b=f.removeModalVisibility,h=f.hidePersonalCouponRemoveModal,v=t.rulesStore.allowEdit;return e.createElement("div",{className:"incentive-group"},e.createElement("div",{className:"incentive-group-wrapper"},e.createElement("h4",{className:"incentive-group-title"},"Advocate Personal Coupon Incentive"),e.createElement("p",{className:"mbm"},"Given to an Advocate who have successfully referred a Friend"),e.createElement("div",{className:"incentive",ref:this.personalCouponRef},e.createElement("div",{className:"incentive-anchor",id:"personal_coupon_list_".concat(l.id)}),s?e.createElement("div",{className:"incentive-container"},e.createElement("div",{className:"incentive-key"},"Value:"),e.createElement("div",{className:"incentive-value"},l.description),e.createElement("div",{className:"incentive-key"},"Personal Coupon List:"),e.createElement("div",{className:"incentive-value"},i?e.createElement(u.UILink,{href:Routes.site_personal_coupon_list_path(a,l.id),target:"_blank",className:"js-ga-click","data-category":p.k,"data-action":"manage personal coupon list"},l.name):e.createElement("span",null,l.name),e.createElement(w,null,"Used in ",l.campaigns_count," ",d()("campaign",l.campaigns_count))),v&&e.createElement("div",{className:"incentive-actions"},e.createElement("div",{className:"incentive-key"},e.createElement("div",null,e.createElement(o.Link,{onClick:m,to:"/personal_coupon/edit/".concat(l.id),className:"base-btn is-small mrm"},"Edit"),e.createElement("div",{className:"base-btn is-error is-small",onClick:this.handleRemovePersonalCouponList},"Delete"))))):e.createElement(u.UILoader,null))),b&&e.createElement(u.UIModalConfirmation,{type:"confirmation",onCloseModal:h,onPrimaryAction:this.detachPersonalCouponList},e.createElement("p",null,"Are you sure you want to delete this Incentive?")))}}])&&h(r.prototype,i),a&&h(r,a),n}(e.Component))||i)||i)||i)}).call(this,n("q1tI"))},"O4V+":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return W}));var r=n("2vnA"),i=n("kMSe"),a=n("vOnD"),o=n("L0cm"),c=n("fRW6"),l=n("GaHK"),s=n("J63I"),u=n("bhi+"),p=n("DzDc"),f=n("+edb"),d=n("Ty5D"),m=n("cMjv"),b=n("exPC"),h=n("u7Uh");function v(e){return(v="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return!t||"object"!==v(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(n,!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var j=window.Widget.Rangepicker,x=a.default.div.withConfig({displayName:"campaign_rules_form_ui__IpFieldContainer",componentId:"oj1q19-0"})(["display:flex;align-items:baseline;"]),k=a.default.div.withConfig({displayName:"campaign_rules_form_ui__FlexContainer",componentId:"oj1q19-1"})(["display:flex;justify-content:flex-start;align-items:flex-start;flex-direction:row;"]),N=a.default.div.withConfig({displayName:"campaign_rules_form_ui__IpFieldWrapper",componentId:"oj1q19-2"})(["width:190px;"]);function P(t){var n=t.main,r=t.side;return e.createElement("div",{className:"clearfix"},e.createElement("div",{className:"col2of3 row-fluid"},n),e.createElement("div",{className:"col1of3"},e.createElement("div",{className:"mll pll"},r)))}function F(e){var t,n,r=[];if("hour"===e)for(t=0;t<o.P.HOURS_IN_DAY;)t<10&&(t="0"+t),r.push({value:""+t,label:""+t}),t++;if("minute"===e)for(n=0;n<o.P.MINUTES_IN_HOUR;)n<10&&(n="0"+n),r.push({value:""+n,label:""+n}),n++;return r}var D=_.flow(Object(i.c)("rulesStore"))((function(t){var n=t.subField,r=t.fieldName,i=(t.field,t.rulesStore);return e.createElement(c.b,I({},n.bind(),{name:r+"."+n.name,className:"base-input is-medium",options:F(n.name),disabled:i.isCampaignDeactivated}))})),T=function(t){return Object(f.a)(t)((function(n){var r=n.mobxForm,i=n.field,a=n.rulesStore,o=_.reduce(["date","hour","minute","zone"],(function(e,n){return O({},e,S({},n,r.$("".concat(t,".").concat(n))))}),{});return e.createElement("div",null,e.createElement(l.UILabel,{text:i.extra.title}),e.createElement("div",{className:"h-hgap-s"},e.createElement("div",{className:"inline"},e.createElement(j,{inputProps:{value:o.date.value,name:t+"."+o.date.name},onInputChange:function(e,t,n){o.date.sync(t)},onCancel:function(){o.date.reset(),o.date.sync(""),o.hour.sync("00"),o.minute.sync("00")},isMergedRange:!0,futureOnly:!0,disabled:a.isCampaignDeactivated,errorInput:_.some(a.errors.get(t))})),e.createElement("span",null,"at"),e.createElement("div",{className:"h-wabs-1"},e.createElement(D,{field:i,fieldName:t,subField:o.hour})),e.createElement("span",null,":"),e.createElement("div",{className:"h-wabs-1"},e.createElement(D,{field:i,fieldName:t,subField:o.minute})),e.createElement("span",{className:"muted"},"Time zone: ",i.value.zone),e.createElement("div",{className:"hidden","data-validate-message":t})),e.createElement(l.UIFormTip,null,i.extra.description))}))},U=_.flow(p.b.mobxForm)((function(t){var n=t.fieldName,r=t.label,i=t.mobxForm,a=i.$("".concat(n,".value")),o=i.$("".concat(n,".unit")),u=i.$("".concat(n,".isUnlimited")),p=a.bind(),f=u.bind(),d={style:{width:150}},m=i.$("static_widget").value;return e.createElement(s.a,{type:"v",size:"x"},e.createElement(l.UIFormTip,null,r),e.createElement("div",{className:"h-hgap-m"},e.createElement("div",d,e.createElement(l.UIInputNumber,I({},a.extra.inputProps,p,{label:"",size:"medium",type:"text",onChange:function(e){"0"===e.target.value&&u.set(!0),p.onChange(e)},unlimited:u.value,disabled:m}))),e.createElement("div",d,e.createElement(c.b,I({},o.bind(),{options:o.extra.options,className:"base-input is-medium",disabled:m||u.value})))),e.createElement(l.UIInputCheckbox,I({size:"small"},f,{labelText:"Unlimited",checked:f.value,onChange:function(e){a.set(e.target.value?null:1),o.set(1),f.onChange(e)},disabled:m})),e.createElement("div",{className:"hidden","data-validate-message":n}))})),R=Object(a.default)(l.UIInputCheckbox).withConfig({displayName:"campaign_rules_form_ui__UIInputCheckboxWithoutValidation",componentId:"oj1q19-3"})([".form-validation{display:none;}"]),A=Object(i.d)((function(t){var n=t.field,r=n.extra||{},i=r.staffOnly,a=r.tips,o=r.tipTemplate,c=r.inputProps,p=void 0===c?{}:c,f=r.warning,d=void 0===f?{}:f;return e.createElement("div",null,e.createElement(R,I({},n.bind(),p,{size:"normal",render:function(){return e.createElement(s.a,{type:"h",size:"s"},e.createElement("span",null,n.label),e.createElement(u.a,{tips:a,template:o}))}})),i&&e.createElement(l.UIStaffBadge,{text:!1,className:"mls",size:"micro"}),_.isFunction(d.checkVisibility)&&d.checkVisibility(n.value)?e.createElement("div",{className:"Notice is-info is-tooltip is-bottom is-right is-color-fix mts mbl"},d.text):null,e.createElement("div",{className:"hidden","data-validate-message":n.name}))})),L={Name:Object(f.a)("name")((function(t){var n=t.field;return e.createElement("div",null,e.createElement(l.UILabel,{text:n.label}),e.createElement(l.UIInputText,I({},n.bind(),{size:"medium"})),e.createElement(l.UIFormTip,null,n.extra.description))})),Description:Object(f.a)("description")((function(t){var n=t.field;return e.createElement("div",null,e.createElement(l.UILabel,{text:n.label}),e.createElement(l.UIInputTextarea,I({},n.bind(),{minRows:5,resize:"none",autoSize:!0})),e.createElement(l.UIFormTip,null,n.extra.description))})),AdvocateOfferDeadline:T("expires_at"),FriendOfferDeadline:T("friend_deadline"),FriendOfferExpiration:Object(f.a)("offer_duration")((function(t){var n=t.mobxForm,r=t.rulesStore,i=t.field,a=n.$("offer_duration.value"),o=n.$("offer_duration.isUnlimited"),c=o.bind();return e.createElement("div",null,e.createElement(l.UILabel,{text:i.extra.title}),e.createElement(s.a,{type:"h",size:"m"},e.createElement(l.UIInputNumber,I({},a.bind(),i.extra.inputProps,{type:"text",size:"medium",unlimited:o.value})),!o.value&&e.createElement("div",{className:"muted Rules-offer-duration-days-counter"},r.makeDurationHumanReadable(Number(a.value)))),e.createElement("div",{"data-validate":"offer_duration"}),e.createElement("div",{className:"mts"},e.createElement(l.UIInputCheckbox,I({size:"small"},c,{checked:c.value,labelText:"Unlimited",onChange:function(e){a.set(e.target.value?null:1),c.onChange(e)}}))),e.createElement(l.UIFormTip,null,i.extra.description))})),NewCustomer:_.flow(f.c,Object(f.a)("new_customer"))((function(t){var n=t.field;t.rulesStore;return e.createElement("div",null,e.createElement(l.UILabel,{text:n.label}),e.createElement("div",{style:{width:190}},e.createElement(c.b,I({className:"base-input is-medium",options:n.extra.options,allowSingleDeselect:!0,disableSearch:!0},n.bind()))))})),IpFiltering:_.flow(Object(f.a)("ip_address_filtering"))((function(t){var n=t.mobxForm,r=t.rulesStore,i=t.field,a=n.$("ip_address_filtering.mode"),o=n.$("ip_address_filtering.value");return e.createElement("div",{className:"mbl",id:"ip_address_filtering"},e.createElement(l.UILabel,{text:i.label}),e.createElement(x,null,e.createElement(N,null,e.createElement(c.b,I({className:"base-input is-medium",options:a.extra.options,allowSingleDeselect:!0,disableSearch:!0},a.bind()))),_.some(a.value)&&e.createElement(e.Fragment,null,e.createElement(N,{className:"mlm mrl"},e.createElement(l.UIInputText,I({size:"medium"},o.bind())),e.createElement("div",{className:"hidden","data-validate-message":"ip_address_filtering_mode"}),e.createElement("div",{className:"hidden","data-validate-message":"ip_address_filtering_value"})),r.showCurrentIp?e.createElement(e.Fragment,null,"Your current IP address: ",r.currentIp||"...",e.createElement(l.UIButton,{disabled:r.fetchingCurrentIp,trait:"transparent",size:"small",onClick:r.fetchCurrentIp},"Fetch IP address again")):e.createElement(e.Fragment,null,e.createElement(l.UIButton,{trait:"transparent",size:"small",disabled:r.fetchingCurrentIp,onClick:r.fetchCurrentIp},"Show my current IP address")))))})),OriginAge:_.flow(p.b.mobxForm)((function(t){t.field,t.mobxForm;var n=t.rulesStore.originAgeFieldData,r=n.extra,i=r.tip,a=r.tipTemplate,o=n.label;return e.createElement("div",null,e.createElement("div",null,e.createElement(l.UILabel,{text:o},i&&e.createElement(u.b,{className:"mls",title:i,template:a}))),e.createElement(k,{className:"h-hgap-m -mts"},e.createElement(U,{fieldName:"origin_min_age",label:"From:"}),e.createElement("span",{className:"Rules-origin-age-fields-separator"},"\u2014"),e.createElement(U,{fieldName:"origin_max_age",label:"To:"})))})),JoinCriteria:_.flow(Object(f.a)("criteria"),Object(i.c)("rulesStore"))((function(t){var n=t.mobxForm,i=t.rulesStore,a=t.field,o=a.extra,c=o.title,s=o.description,u=o.example_title,p=o.info_sidebar_title,f=o.example;return e.createElement(P,{main:e.createElement("div",null,e.createElement(l.UILabel,{text:c}),e.createElement(l.UIInputTextarea,I({},a.bind(),{disabled:n.$("static_widget").value,minRows:5,resize:"none",autoSize:!0})),e.createElement(l.UIFormTip,null,s),e.createElement("div",{className:"mts"},e.createElement(h.a,{needUseShowProp:!0,show:i.variables.join_criteria_interpolations.show,toggleShow:i.toggleShowVariables.bind(null,"join_criteria_interpolations"),title:function(){return"Join criteria variables"},fetchData:i.getVariables.bind(null,"join_criteria_interpolations"),data:Object(r.toJS)(i.variables.join_criteria_interpolations.data),isFetched:i.variables.join_criteria_interpolations.isFetched,render:function(t){return e.createElement(l.UILink,{onClick:t},"All available variables")}}))),side:e.createElement(l.UIFormTip,null,e.createElement("div",{className:"mtm"},e.createElement("div",{className:"mbs"},u),e.createElement("div",{className:"mbl"},e.createElement("div",{className:"mbs"},p),e.createElement("code",{dangerouslySetInnerHTML:{__html:f}}))))})})),DestinationUrlOverride:_.flow(Object(f.a)("destination_url_override"),f.c)((function(t){var n=t.field,i=t.rulesStore,a=n.extra,o=a.tip,c=a.description,s=a.subDescription;return e.createElement(P,{main:e.createElement("div",null,e.createElement(l.UILabel,{text:n.label,id:"friend_destination_url"},e.createElement(u.b,{className:"mls",title:o})),e.createElement(l.UIInputTextarea,I({},n.bind(),{id:"friend_destination_url",minRows:5,autoSize:!0})),e.createElement("div",{className:"h-hgap-m mts"},e.createElement(h.a,{needUseShowProp:!0,show:i.variables.destination_url_interpolations.show,toggleShow:i.toggleShowVariables.bind(null,"destination_url_interpolations"),title:function(){return"Destination URL variables"},fetchData:i.getVariables.bind(null,"destination_url_interpolations"),data:Object(r.toJS)(i.variables.destination_url_interpolations.data),isFetched:i.variables.destination_url_interpolations.isFetched,render:function(t){return e.createElement(l.UILink,{onClick:t},"All available variables")}}),e.createElement(l.UIFormTip,null,s))),side:e.createElement("div",{className:"mtm"},e.createElement(l.UIFormTip,{className:"ptxs"},c))})})),Tags:_.flow(Object(f.a)("tags_attributes"))((function(t){var n=t.field,r=t.rulesStore;return e.createElement(m.a,{noSpacing:!0,tags:r.tags,tagName:r.tagName,handleTagChanges:function(e){n.set([{name:e}]),r.tagName=e},addTag:r.addTag,removeTag:r.removeTag})}))},M=Object(i.d)((function(){return e.createElement("div",{className:"clearfix"},e.createElement("div",{className:"col2of3 row-fluid h-vgap-l"},e.createElement(L.Name,null),e.createElement(L.Description,null)))})),z=_.flow(f.c,Object(f.a)("expires_at"),Object(f.b)("offers"))((function(t){var n=t.field,r=t.SectionHeader;return e.createElement("div",null,e.createElement(r,{tipLink:documentationURL("campaigns/offers_expiration.html")}),e.createElement(P,{main:e.createElement("div",{className:"h-vgap-l"},e.createElement(L.AdvocateOfferDeadline,null),e.createElement(L.FriendOfferDeadline,null),e.createElement(L.FriendOfferExpiration,null)),side:e.createElement("div",null,e.createElement("div",{className:"mbs"},e.createElement(l.UIFormTip,null,n.extra.tip)),e.createElement(l.UILink,{target:"_blank",href:documentationURL("campaigns/offers_expiration.html")},"Learn more"))}))})),V=_.flow(f.c,Object(f.b)("incentives"),d.o)((function(t){var n=t.SectionHeader,i=t.rulesStore,a=t.match;return e.createElement(b.a,{SectionHeader:n,data:O({},Object(r.toJS)(i.campaign.data)),routes:a.params,incentives:Object(r.toJS)(i.incentives),fetchData:i.updateCampaignData})})),B=_.flow(Object(f.b)("tags"))((function(t){var n=t.SectionHeader;return e.createElement("div",{className:"h-vgap-l"},e.createElement(n,null),e.createElement(L.Tags,null))})),q=_.flow(f.c,p.b.mobxForm)((function(t){var n=t.mobxForm,r=t.rulesStore,i=_.mapValues(r.advancedSettingsCheckboxesConfig,(function(e,t){return n.$(t)}));return e.createElement("div",{className:"mtm h-vgap-m"},e.createElement("div",{className:"clearfix"},e.createElement("div",{className:"col2of3 row-fluid h-vgap-s"},_.map(i,(function(t,n){return e.createElement(A,{field:t,key:n})})))))})),H=_.flow(Object(f.b)("settings"))((function(t){var n=t.SectionHeader,r=t.rulesStore;return e.createElement("div",{className:"h-vgap-l"},e.createElement(n,null),e.createElement(L.NewCustomer,null),e.createElement(L.IpFiltering,null),r.campaign.gleam&&e.createElement(L.AdvocateOfferDeadline,null),e.createElement(L.OriginAge,null),e.createElement(L.JoinCriteria,null),e.createElement(L.DestinationUrlOverride,null),e.createElement(q,null))})),W=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),g(this,w(n).apply(this,arguments))}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){return e.createElement("div",{className:"h-vgap-xxl App-container-inner Rules-container"},e.createElement(M,null),e.createElement(z,null),e.createElement(V,null),e.createElement(B,null),e.createElement(H,null))}}])&&y(r.prototype,i),a&&y(r,a),n}(e.Component)}).call(this,n("q1tI"))},S2h9:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y}));var r,i=n("kMSe"),a=n("vOnD"),o=n("GaHK"),c=n("zfZb"),l=n("DzDc");function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=Object(a.default)(o.UILink).withConfig({displayName:"coupon_lists__Link",componentId:"rnwtt0-0"})(["svg{path{transition:0.25s;}}&:hover,&:focus{svg{path{fill:#ff4e00;}}}"]),b=a.default.div.withConfig({displayName:"coupon_lists__CouponAction",componentId:"rnwtt0-1"})(["display:flex;"]),h=Object(a.default)(o.UIButton).withConfig({displayName:"coupon_lists__CreateCouponButton",componentId:"rnwtt0-2"})(["padding:9px 12px;"]),v=a.default.div.withConfig({displayName:"coupon_lists__SelectWrapper",componentId:"rnwtt0-3"})(["z-index:1;width:auto;"]),y=Object(i.c)((function(e){var t=e.incentiveFormStore,n=e.couponListsStore;return{onChangeByKey:t.incentiveData.onChangeByKey,coupon_list_id:t.incentiveData.coupon_list_id,fetchCouponLists:n.fetchData,isShowCouponForm:n.isShowCouponForm,toggleCouponForm:n.toggleCouponForm,optionsCouponLists:n.optionsCouponLists,fetchedLists:n.fetchedLists,incentiveFormStore:t}}))(r=Object(i.d)(r=function(t){function n(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=p(this,(e=f(n)).call.apply(e,[this].concat(i)))).onChangeSelect=function(e){var n=e.name,r=e.selectedOption.value;t.props.onChangeByKey({target:{name:n,value:r}})},t.onFocusSelect=function(e){var t=e.target;setTimeout((function(){t.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}),0)},t}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,t),r=n,(i=[{key:"componentDidMount",value:function(){this.props.fetchCouponLists()}},{key:"render",value:function(){var t=this.props,n=t.coupon_list_id,r=t.toggleCouponForm,i=t.isShowCouponForm,a=t.optionsCouponLists,s=t.fetchedLists,u=t.incentiveFormStore;return e.createElement("div",null,e.createElement(o.UILabel,{text:"Coupon list:"}),e.createElement("div",null,e.createElement(b,{className:"mbs"},e.createElement("div",{className:"flex col1of1"},e.createElement(v,{className:"flex-grow-1"},e.createElement(o.UIInputSelect,{name:"coupon_list_id",options:a,onChange:this.onChangeSelect,loading:!s,value:n?String(n):null,defaultValue:null,placeholder:"Choose coupon list",onFocus:this.onFocusSelect})),e.createElement(h,{className:"mlm",type:"button",size:"small",trait:i?"pressed":null,onClick:r},"+ New Coupon List"))),s&&(a.length>1?e.createElement(o.UIFormTip,null,"You only see coupon lists for the specified amount. You can use one coupon list in multiple incentives."):e.createElement("div",{className:"form-validation mbs"},"You have no coupon lists for this amount.")),u.showCouponListExpirationWarning&&e.createElement(l.a,{type:u.incentiveData.type,latest_coupon_expiration_date:u.incentiveData.latest_coupon_expiration_date}),e.createElement(m,{className:"mts",href:Routes.site_coupon_lists_path(window.Site),target:"_blank"},"Manage Coupon Lists",e.createElement(o.UIIcon,{name:"redirect",className:"mls"})),e.createElement(o.UISpoilerHOC,{isShow:i},e.createElement(c.a,{isShow:i}))))}}])&&u(r.prototype,i),a&&u(r,a),n}(e.Component))||r)||r}).call(this,n("q1tI"))},"T/Lf":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var r,i=n("kMSe"),a=n("GaHK");function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==o(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=Object(i.c)((function(e){return{value:e.incentiveFormStore.incentiveData.incentive_type}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),l(this,s(n).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this;return e.createElement("div",{className:"mbl"},function(){switch(t.props.value){case"rebate":return e.createElement("div",{className:"muted"},"To use store credit you need to set up"," ",e.createElement(a.UILink,{href:documentationURL("web_hooks/reward.html"),target:"_blank"},"Reward Webhook")," ","to pass information from Talkable to your site to reward customers."," ",e.createElement(a.UILink,{href:"mailto:".concat(Constants.SUPPORT_EMAIL),target:"_blank"},"Contact us")," ","if you have any questions.");case"other":return e.createElement("div",{className:"muted"},"Use this type of reward only if you want to give away some specific products rather than coupons or in-store credit. It works great when you","'","re running completely manual campaigns. Make sure that"," ",e.createElement(a.UILink,{href:Routes.fraud_site_path(window.Site),target:"_blank",inherit:!0},"referral approval")," ","is set to manual, otherwise you won","'","t know which customers to reward."," ",e.createElement(a.UILink,{href:"mailto:".concat(Constants.SUPPORT_EMAIL),target:"_blank",inherit:!0},"Contact us")," ","if you have any questions.")}}())}}])&&c(r.prototype,i),o&&c(r,o),n}(e.Component))||r)||r}).call(this,n("q1tI"))},TVI0:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r,i=n("kMSe"),a=n("vOnD"),o=n("5v/m"),c=n("GaHK"),l=n("fRW6");function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=a.default.div.withConfig({displayName:"reward_amount__Wrapper",componentId:"sc-40zwsd-0"})(["display:flex;"]),b=a.default.input.withConfig({displayName:"reward_amount__Input",componentId:"sc-40zwsd-1"})(["&&{width:80px;text-align:center;}"]),h=Object(i.c)((function(e){var t=e.incentiveFormStore;return{amount:t.incentiveData.amount,isPercentage:t.incentiveData.percentage_discount,onChange:t.incentiveData.onChangeByKey,disabled:!t.allowEdit,errorAmount:t.errors.get("amount"),errorPercentage:t.errors.get("percentage_discount"),type:t.incentiveData.incentive_type}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),p(this,f(n).apply(this,arguments))}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.amount,r=t.isPercentage,i=t.onChange,a=t.disabled,s=t.type,u=t.errorAmount,p=t.errorPercentage,f=classNames("base-input is-medium",{"validation-error":u});return e.createElement("div",{className:"mbl"},e.createElement(c.UILabel,{text:"Reward amount:"}),e.createElement(m,null,e.createElement(b,{className:f,name:"amount",type:"number",value:n,onChange:i,disabled:a,min:0}),e.createElement(o.a,{name:"percentage_discount",type:s,amount:n,isPercentage:r,onChange:i,disabled:a})),Object(l.a)(u),Object(l.a)(p))}}])&&u(r.prototype,i),a&&u(r,a),n}(e.Component))||r)||r}).call(this,n("q1tI"))},UOkJ:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r=n("GaHK"),i=n("vOnD"),a=n("fRW6");function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==o(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=Object(i.default)(r.UIInputRange).withConfig({displayName:"range_values__UIInputRangeStyle",componentId:"fj7sko-0"})([".sign-svg{margin:0;}.sign-svg-infoCircled{path.sign-svg-main,path.sign-svg-border{fill:#999;}}"]),f=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),l(this,s(n).apply(this,arguments))}var i,o,f;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(n,t),i=n,(o=[{key:"render",value:function(){var t=this.props,n=t.minValue,i=t.maxValue,o=t.minName,c=t.maxName,l=t.onChange,s=t.labelText,u=t.minError,f=t.maxError,d=t.disabled;return e.createElement("div",{className:"mbl"},e.createElement(r.UILabel,{text:s}),e.createElement(p,{minValue:n,maxValue:i,onChangeMin:l,onChangeMax:l,minName:o,maxName:c,minError:u,maxError:f,disabled:d}),Object(a.a)(u),Object(a.a)(f))}}])&&c(i.prototype,o),f&&c(i,f),n}(e.Component)}).call(this,n("q1tI"))},Uaz8:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var r,i,a,o=n("kMSe"),c=n("vOnD"),l=n("fRW6"),s=n("GaHK"),u=n("Vubd");function p(e){return(p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==p(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=c.default.div.withConfig({displayName:"friend_event_category__FriendEventCategoryWrapper",componentId:"sc-1qvz9xi-0"})(["display:flex;"]),v=Object(o.c)((function(e){return{incentiveFormStore:e.incentiveFormStore}}))(r=Object(o.d)((a=i=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),d(this,m(n).apply(this,arguments))}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.options,r=t.incentiveFormStore,i=r.errors,a=r.allowEditFriendEventCategory,o=r.incentiveData,c=o.onChangeByKey,p=o.friend_event_category,f=o.friendEventCategoryValueForSelect;return e.createElement("div",{className:"mbl"},e.createElement(s.UILabel,{text:"Friend event category:",id:"friend_event_category"},e.createElement("div",{className:"mls","aria-label":"Friend origin event category criteria specifies event type of friend origins that advocate should be rewarded.","data-balloon-pos":"up","data-balloon-length":"large"},e.createElement("i",{className:"icon icon-question"},e.createElement("span",null,"@")))),e.createElement(h,null,e.createElement(l.b,{id:"friend_event_category",name:"friend_event_category",options:n,onChange:c,value:f,disableSearch:!0,disabled:!a}),e.createElement(u.a,null)),"other"===f&&e.createElement("div",{className:"mtm"},e.createElement(s.UIInputText,{width:"220px",size:"medium",name:"friend_event_category",value:p,onChange:c,disabled:!a}),e.createElement(s.UIFormTip,null,"Ex: purchase")),Object(l.a)(i.get("friend_event_category")))}}])&&f(r.prototype,i),a&&f(r,a),n}(e.Component),i.defaultProps={options:[{label:"purchase",value:"purchase"},{label:"android_app_installed",value:"android_app_installed"},{label:"ios_app_installed",value:"ios_app_installed"},{label:"any",value:"any"},{label:"other",value:"other"}]},r=a))||r)||r}).call(this,n("q1tI"))},VCMo:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return y}));var r,i=n("kMSe"),a=n("GaHK"),o=n("L0cm"),c=n("vOnD");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=c.default.div.withConfig({displayName:"reward_type_info__RewardTypeInfoBox",componentId:"sc-1sdybrt-0"})(["margin:48px 0;display:flex;"]),m=c.default.div.withConfig({displayName:"reward_type_info__RewardTypeInfoImgBox",componentId:"sc-1sdybrt-1"})(["margin-right:27px;img{max-width:none;}"]),b=c.default.div.withConfig({displayName:"reward_type_info__RewardTypeInfoText",componentId:"sc-1sdybrt-2"})(["font-size:16px;color:#333333;letter-spacing:-0.24px;line-height:24px;"]),h=Object(i.c)((function(e){return{site:e.rootStore.models.site}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),u(this,p(n).apply(this,arguments))}var r,i,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.icon,r=t.name,i=t.url,c=t.site;return e.createElement(d,null,e.createElement(m,null,n),e.createElement(b,null,"We partnered with ",r," to reward advocates with 50+ US & international digital gifts including: PayPal, Visa prepaid cards, Amazon gift cards, iTunes gift cards, and"," ",e.createElement(a.UILink,{className:"js-ga-click","data-category":o.k,"data-action":"much more: ".concat(r),href:i,rel:"noopener noreferrer",target:"_blank",inherit:!0},"much more"),".",e.createElement("div",{className:"mtm"},e.createElement(a.UILink,{href:"mailto:".concat(c.focused?c.success_manager_email||"success@talkable.com":Constants.SUPPORT_EMAIL),className:"js-ga-click","data-category":o.k,"data-action":"contact talkable: ".concat(r),target:"_blank",inherit:!0},"Contact Talkable team")," ","to enable ",r,".")))}}])&&s(r.prototype,i),c&&s(r,c),n}(e.Component))||r)||r,v=function(){return e.createElement(h,{icon:e.createElement("img",{src:n("gnFl"),height:"128",width:"128"}),name:"Rybbon",url:"https://www.rybbon.net/talkable-integration"})},y=function(){return e.createElement(h,{icon:e.createElement("img",{src:n("HCbX"),height:"128",width:"128"}),name:"Tremendous",url:"https://www.tremendous.com"})}}).call(this,n("q1tI"))},Vubd:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var r,i=n("kMSe"),a=n("vOnD"),o=n("fRW6"),c=n("GaHK");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=a.default.div.withConfig({displayName:"new_customer__Wrapper",componentId:"sc-15q5l6e-0"})(["display:flex;align-items:center;"]),m=Object(i.c)((function(e){return{incentiveFormStore:e.incentiveFormStore}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),u(this,p(n).apply(this,arguments))}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props.incentiveFormStore,n=t.allowEdit,r=t.errors,i=t.incentiveData,a=i.onChangeByKey,l=i.new_customer;return e.createElement(e.Fragment,null,e.createElement(d,{className:"mlm"},e.createElement(c.UIInputRadio,{checked:""===l||!l,disabled:!n,id:"new_customer_any",labelText:"Any",name:"new_customer",onChange:a,value:""}),e.createElement(c.UIInputRadio,{checked:"1"===l,className:"mls",disabled:!n,id:"new_customer_yes",labelText:"First-time",name:"new_customer",onChange:a,value:1}),e.createElement(c.UIInputRadio,{checked:"0"===l,className:"mls",disabled:!n,id:"new_customer_false",labelText:"Subsequent",name:"new_customer",onChange:a,value:0})),Object(o.a)(r.get("new_customer")))}}])&&s(r.prototype,i),a&&s(r,a),n}(e.Component))||r)||r}).call(this,n("q1tI"))},ZZHx:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r,i=n("kMSe"),a=n("GaHK"),o=n("fRW6");function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==c(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=Object(i.c)((function(e){var t=e.incentiveFormStore;return{value:t.incentiveData.identifier,onChange:t.incentiveData.onChangeByKey,error:t.errors.get("identifier"),disabled:!t.allowEdit}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),s(this,u(n).apply(this,arguments))}var r,i,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.value,r=t.onChange,i=t.error,c=t.disabled;return e.createElement("div",{className:"mbl"},e.createElement(a.UILabel,{text:"Identifier:",id:"identifier"}),e.createElement(a.UIInputText,{id:"identifier",name:"identifier",value:n,size:"medium",onChange:r,error:i,disabled:c}),Object(o.a)(i),e.createElement(a.UIFormTip,null,"Unique incentive identifier by which you can refer to it inside HTML & CSS Editor"))}}])&&l(r.prototype,i),c&&l(r,c),n}(e.Component))||r)||r}).call(this,n("q1tI"))},"bhi+":function(e,t,n){"use strict";(function(e){function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return d}));var f=function(t){function n(t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=s(this,u(n).call(this,t))).tooltipRef=e.createRef(),r}var r,i,f;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,t),r=n,(i=[{key:"componentDidUpdate",value:function(e){this.props.title!==e.title&&$(this.tooltipRef.current).attr("title",nextProps.title).tooltip("fixTitle")}},{key:"componentDidMount",value:function(){var e=this.props.title;$(this.tooltipRef.current).tooltip({title:e})}},{key:"render",value:function(){var t=this.props.template,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(n,!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.props,{"data-html":"true","data-toggle":"tooltip","data-container":"body"}),r=_.omit(n,"title");return t&&(r["data-template"]=t),e.createElement("span",a({},r,{ref:this.tooltipRef}),e.createElement("i",{className:"icon icon-question"},e.createElement("span",{className:"sign"}," ? ")))}}])&&l(r.prototype,i),f&&l(r,f),n}(e.Component);function d(t){var n=t.tips,r=t.tipSeparator,o=void 0===r?"<br/>":r,c=i(t,["tips","tipSeparator"]),l=_.every(n,_.matchesProperty("showWhen",!1));if(!n||!n.length||l)return!1;var s=_(n).reject("hideWhen").map("title").join(o);return e.createElement(f,a({},c,{title:s}))}f.propTypes={title:PT.string.isRequired,template:PT.string},d.propTypes={tips:PT.arrayOf(PT.shape(f.propTypes)),tipSeparator:PT.string}}).call(this,n("q1tI"))},bmFi:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var r,i=n("kMSe"),a=n("vOnD"),o=n("GaHK"),c=n("fRW6");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=a.default.div.withConfig({displayName:"email_shares__Wrapper",componentId:"sc-1spll5j-0"})(["display:flex;align-items:center;"]),m=Object(i.c)((function(e){var t=e.incentiveFormStore;return{value:t.incentiveData.email_shares,onChange:t.incentiveData.onChangeByKey,error:t.errors.get("email_shares"),disabled:!t.allowEdit}}))(r=Object(i.d)(r=function(t){function n(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=u(this,(e=p(n)).call.apply(e,[this].concat(i)))).handleChangeUnlimited=function(e){return function(n){t.props.onChange({target:{name:e,value:n.target.value?null:1}})}},t}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.value,r=t.onChange,i=t.error,a=t.disabled;return e.createElement("div",{className:"mbl"},e.createElement(o.UILabel,{text:"Minimum number of email shares:"}),e.createElement(d,null,e.createElement(o.UIInputNumber,{className:"mrm",name:"email_shares",value:n,type:"text",size:"medium",onChange:r,disabled:a,error:i,min:1,unlimited:null===n}),e.createElement(o.UIInputCheckbox,{className:"mlm",id:"email_shares",name:"email_shares",checked:null===n,labelText:"Unlimited",onChange:this.handleChangeUnlimited("email_shares"),size:"small",disabled:a})),Object(c.a)(i))}}])&&s(r.prototype,i),a&&s(r,a),n}(e.Component))||r)||r}).call(this,n("q1tI"))},bpe6:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r,i=n("kMSe"),a=n("GaHK"),o=n("fRW6");function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==c(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=Object(i.c)((function(e){var t=e.incentiveFormStore;e.rulesStore;return{value:t.incentiveData.custom_description,onChange:t.incentiveData.onChangeByKey,error:t.errors.get("custom_description"),disabled:!t.allowEdit}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),s(this,u(n).apply(this,arguments))}var r,i,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.value,r=t.onChange,i=t.error,c=t.disabled;return e.createElement("div",{className:"mbl"},e.createElement(a.UILabel,{text:"Custom description:",id:"custom_description"},e.createElement("div",{className:"mls","aria-label":"Custom description overrides a default generated description in Talkable admin pages and campaign templates. Use this field when the discount amount just does not describe the incentive well to a customer.","data-balloon-pos":"down","data-balloon-length":"large"},e.createElement("i",{className:"icon icon-question"},e.createElement("span",null,"@")))),e.createElement(a.UIInputText,{id:"custom_description",name:"custom_description",value:n,size:"medium",onChange:r,error:i,disabled:c}),Object(o.a)(i),e.createElement(a.UIFormTip,null,"ex. 1 Month free"))}}])&&l(r.prototype,i),c&&l(r,c),n}(e.Component))||r)||r}).call(this,n("q1tI"))},cMjv:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var r,i,a=n("GaHK"),o=n("kMSe");function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function p(e,t){return!t||"object"!==c(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=Object(o.d)(r=function(t){function n(){var e,t;l(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=p(this,(e=f(n)).call.apply(e,[this].concat(i)))).removeTag=function(e){e.preventDefault(),t.props.removeTag(t.props.data.id)},t}return d(n,t),u(n,[{key:"render",value:function(){return e.createElement("div",{className:"campaign-tag js-tag","data-id":this.props.data.id},e.createElement("div",{className:"campaign-tag-name"},this.props.data.name),this.props.total>1?e.createElement("div",{className:"campaign-tag-remove",onClick:this.removeTag},"\xd7"):e.createElement("span",{className:"mlm pls"}))}}]),n}(e.Component))||r,h=function(t){function n(){var e,t;l(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=p(this,(e=f(n)).call.apply(e,[this].concat(i)))).handleChange=function(e){t.props.onTagChanges(e.target.value)},t.handleKeyPress=function(e){e.which&&13===e.which&&t.addTag()},t.addTag=function(){t.props.tagName&&t.props.addTag()},t}return d(n,t),u(n,[{key:"render",value:function(){return e.createElement("div",{className:"mbm"},e.createElement("div",{className:"campaign-tag-form"},e.createElement(a.UIInputText,{type:"text",value:this.props.tagName,className:"campaign-tag-input js-campaign-tag-input",onChange:this.handleChange,onKeyPress:this.handleKeyPress,"data-validate-block":"tags.name",placeholder:"New tag",size:"medium",width:"220px"}),e.createElement("div",{onClick:this.addTag,className:"btn"},"+")),e.createElement("div",{"data-validate-message":"tags.name",className:"hidden"}))}}]),n}(e.Component),v=Object(o.d)(i=function(t){function n(){return l(this,n),p(this,f(n).apply(this,arguments))}return d(n,t),u(n,[{key:"render",value:function(){var t=this.props,n=t.noSpacing,r=t.tagName,i=t.addTag,a=t.handleTagChanges,o=t.removeTag,c=t.tags;return e.createElement("div",{className:"clearfix ".concat(n?"":"mbl pbl")},e.createElement("div",{className:"col2of3 ".concat(n?"":"pbl mbm")},e.createElement("div",{className:"mbl muted"},"Tags are designed to target different Campaigns on your site. To target the Campaign make sure you have added a unique Tag name that only this Campaign has. Note: when multiple campaigns have the same tag, Talkable shows random campaign."),e.createElement(h,{addTag:i,onTagChanges:a,tagName:r}),e.createElement("div",{className:"campaign-tag-list"},c.map((function(t,n){return e.createElement(b,{total:c.length,data:t,key:n,removeTag:o})})))))}}]),n}(e.Component))||i}).call(this,n("q1tI"))},ckif:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r,i=n("vOnD"),a=n("+hpU"),o=n("ENtk"),c=n("M+GS"),l=n("kMSe"),s=n("GaHK");function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==u(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=Object(i.default)(s.UILink).withConfig({displayName:"incentives_group__LinkWithIcon",componentId:"sc-123pzjx-0"})(["&:hover{.sign-svg-accountSettings{path:nth-child(2){fill:#ff4f00;transition:0.25s;}}.sign-svg-create g{path,path.sign-svg-border{fill:#ff4f00;transition:0.25s;}}.sign-svg-table g{fill:#ff4f00;transition:0.25s;}}"]),h=Object(l.c)((function(e){return{allowEdit:e.rulesStore.allowEdit}}))(r=Object(l.d)(r=function(t){function n(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=f(this,(e=d(n)).call.apply(e,[this].concat(i)))).state={toggleGroupSettingsForm:!1},t.toggleGroupSettingsForm=function(){t.setState((function(e){return{toggleGroupSettingsForm:!e.toggleGroupSettingsForm}}))},t.addVariantHandle=function(e){return function(){t.props.onAddVariant(e)}},t.addTieringHandle=function(e){return function(){t.props.onAddTiering(e)}},t.isSplitTested=function(){return t.props.incentives.length>1},t.haveWinnerIncentive=function(){return-1!==t.props.incentives.findIndex((function(e){return _.get(e,"split_test_variant.winner")&&_.get(e,"split_test_variant.winner_selected_at")}))},t.noSuchWinnerIncentive=function(){return t.props.incentives.every((function(e){return!_.get(e,"split_test_variant.winner")&&_.get(e,"split_test_variant.winner_selected_at")}))},t.sortByWinner=function(e,t){return!0===_.get(t,"split_test_variant.winner")},t.getIncentives=function(e){return t.haveWinnerIncentive()?e.sort(t.sortByWinner):e},t}var r,i,l;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this,n=this.props.allowEdit,r=this.noSuchWinnerIncentive();return e.createElement("div",{className:"incentive-group"},e.createElement("div",{className:"incentive-group-wrapper"},e.createElement("h4",{className:"incentive-group-title"},_.get(Object(c.a)(this.props.incentives[0]),"title"),this.isSplitTested()&&" A/B Test"),e.createElement("p",{className:"mbm"},_.get(Object(c.a)(this.props.incentives[0]),"description")),r&&e.createElement("div",{className:"Notice is-info mbl"},"This A/B test has a winner selected but there is no such incentive in this campaign. As a result incentives rotate randomly as it would be for an active A/B test"),this.getIncentives(this.props.incentives).map((function(i,o){return e.createElement(a.a,{data:i,friend_incentives:t.props.friend_incentives,allowEdit:n,key:"incentive_".concat(i.id),routes:t.props.routes,onClose:t.props.onClose,noSuchWinnerIncentive:r})})),this.props.incentive_amount_warning&&e.createElement("div",{className:"incentive-group-warning"},"The incentive amount looks too high. Please double check your incentive setup.")),n&&e.createElement("div",{className:"incentive-group-actions mtm"},e.createElement("div",{className:"flex align-items-center"},this.isSplitTested()&&e.createElement(b,{className:"mrl",onClick:this.toggleGroupSettingsForm},e.createElement(s.UIIcon,{name:"accountSettings",fill:"#0070d9"}),"Distribution"),e.createElement(b,{className:"mrl",onClick:this.addVariantHandle(this.props.incentives[0])},e.createElement(s.UIIcon,{name:"create",borderFill:"#B0CEE1",contentFill:"#0070d9"}),"Add A/B Test Variant"),_.get(window.current_user,"staff_member")&&this.props.for_advocate&&"tiered"===this.props.preset_name&&e.createElement(e.Fragment,null,e.createElement(b,{onClick:this.addTieringHandle(this.props.incentives[0]),className:"mrs"},e.createElement(s.UIIcon,{name:"create",borderFill:"#B0CEE1",contentFill:"#0070d9"}),"Add Tiering Incentive"),e.createElement(s.UIStaffBadge,{size:"micro"}))),this.isSplitTested()&&e.createElement(b,{href:Routes.site_split_test_path(window.Site,_.get(this.props.incentives,"0.split_test_variant.split_test_id"))},e.createElement(s.UIIcon,{name:"table"}),"View report")),this.state.toggleGroupSettingsForm&&e.createElement(o.a,{incentives:this.props.incentives,onClose:this.toggleGroupSettingsForm}))}}])&&p(r.prototype,i),l&&p(r,l),n}(e.Component))||r)||r}).call(this,n("q1tI"))},cnfd:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var r,i=n("kMSe"),a=n("GaHK"),o=n("fRW6"),c=n("u7Uh");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=Object(i.c)((function(e){var t=e.incentiveFormStore;return{value:t.incentiveData.criteria,onChange:t.incentiveData.onChangeByKey,error:t.errors.get("criteria"),disabled:!t.allowEdit,toggleInterpolations:t.toggleInterpolations,fetchInterpolations:t.fetchInterpolations,interpolations:t.interpolations}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),u(this,p(n).apply(this,arguments))}var r,i,l;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),r=n,(i=[{key:"componentWillUnmount",value:function(){this.props.interpolations.hide()}},{key:"render",value:function(){var t=this.props,n=t.value,r=t.onChange,i=t.error,l=t.disabled,s=t.toggleInterpolations,u=t.fetchInterpolations,p=t.interpolations;return e.createElement("div",{className:"mbl"},e.createElement(a.UILabel,{text:"Incentive criteria:",id:"criteria"},e.createElement("div",{className:"mls","aria-label":"Liquid condition consists of advanced criteria for this Incentive. IMPORTANT: Define {% else %}, so that a specific reason is shown in the reports when the criteria is not satisfied.","data-balloon-pos":"up","data-balloon-length":"large"},e.createElement("i",{className:"icon icon-question"},e.createElement("span",null,"@")))),e.createElement(a.UIInputTextarea,{id:"criteria",name:"criteria",value:n,onChange:r,height:"140px",error:i,disabled:l,minRows:4,resize:"none",autoSize:!0}),Object(o.a)(i),e.createElement(c.a,{needUseShowProp:!0,show:p.isShow,title:function(){return"Variables"},toggleShow:s,isFetched:p.isFetched,data:p.data,fetchData:u,render:function(t){return e.createElement("div",{className:"mbl"},e.createElement(a.UILink,{className:"mts mbl",onClick:t},"All available variables"))}}))}}])&&s(r.prototype,i),l&&s(r,l),n}(e.Component))||r)||r}).call(this,n("q1tI"))},eprO:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var r,i,a,o=n("kMSe"),c=n("fRW6"),l=n("GaHK");function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=Object(o.c)((function(e){var t=e.rootStore,n=e.incentiveFormStore;return{currentUser:t.models.currentUser,value:n.incentiveData.reward_uniqueness,onChange:n.incentiveData.onChangeByKey,error:n.errors.get("reward_uniqueness"),disabled:!n.allowEdit}}))(r=Object(o.d)((a=i=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=p(this,f(n).call(this,e))).getOptions=function(e){if(e.currentUser.staffMember)return e.options;var t=[].concat(e.options);return t[2].disabled=!0,t},t.state={options:t.getOptions(e)},t}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.value,r=t.onChange,i=t.error,a=t.disabled,o=this.state.options;return e.createElement("div",{className:"mbl"},e.createElement(l.UILabel,{text:"Advocate Is Rewarded:",id:"reward_uniqueness"},e.createElement("div",{className:"mls","aria-label":'Choose how many rewards one Advocate can get for this Incentive: "Once per each Friend" - Advocate gets a reward only once per each Friend, even if such Friend makes multiple purchases "Once per Incentive" - Advocate gets a reward only once for the first Friend who makes a purchase "Multiple times per the same Friend" (STAFF ONLY) - Advocate gets multiple rewards: each time the Friend makes a purchase',"data-balloon-pos":"up","data-balloon-length":"large"},e.createElement("i",{className:"icon icon-question"},e.createElement("span",null,"@")))),e.createElement(c.b,{id:"reward_uniqueness",name:"reward_uniqueness",options:o,onChange:r,value:n||"",allowSingleDeselect:!0,disableSearch:!0,disabled:a,width:"310px"}),Object(c.a)(i))}}])&&u(r.prototype,i),a&&u(r,a),n}(e.Component),i.defaultProps={options:[{label:"Once per each Friend",value:"once_per_friend"},{label:"Once per Incentive",value:"once_per_incentive"},{label:"Multiple times per the same Friend (STAFF ONLY)",value:""}]},r=a))||r)||r}).call(this,n("q1tI"))},exPC:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return P}));var r,i,a=n("vOnD"),o=n("bhi+"),c=n("J63I"),l=n("ckif"),s=n("KzCQ"),u=n("3YY3"),p=n("y6Bb"),f=n("vnvS"),d=n("M+GS"),m=n("kMSe"),b=n("UlA6"),h=n("GaHK"),v=n("lhCq"),y=n("2vnA"),g=n("Ty5D");function w(e){return(w="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return!t||"object"!==w(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=a.default.div.withConfig({displayName:"incentives__Container",componentId:"sc-1nbtaq6-0"})(["display:flex;",";"],(function(e){var t=e.justifyContent;return t&&Object(a.css)(["justify-content:",";"],t)})),j=a.default.div.withConfig({displayName:"incentives__Col2of3",componentId:"sc-1nbtaq6-1"})(["display:flex;flex:2;flex-direction:column;"]),x=a.default.div.withConfig({displayName:"incentives__Col1of3",componentId:"sc-1nbtaq6-2"})(["display:flex;flex:1;"]),k=a.default.div.withConfig({displayName:"incentives__UILoaderContainer",componentId:"sc-1nbtaq6-3"})(["display:flex;height:100%;"]),N=Object(a.default)(h.UIStaffBadge).withConfig({displayName:"incentives__StaffBadge",componentId:"sc-1nbtaq6-4"})(["position:absolute !important;top:50%;margin-top:-8px;right:5px;"]),P=(r=Object(m.c)((function(e){var t=e.rulesStore,n=e.rootStore;return{allowIncentivesEdit:t.campaign.data.test_mode||!t.campaign.data.has_activities,isInitialLoading:t.isInitialLoading,rootStore:n,rulesStore:t,personalCouponFormStore:n.pages.personalCouponFormStore}})),Object(g.o)(i=r(i=Object(m.d)(i=function(t){function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=C(this,O(r).call(this,e))).existingCustomerIncentive=function(e){return"0"===e.new_customer&&!_.toInteger(e.allow_on_self_referral)&&!_.toInteger(e.allow_on_expired_offer)&&!_.toInteger(e.new_optin)},t.fetchFriendIncentives=function(){var e,n,r,i,a,o,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.props.incentives,l=t.props.rulesStore.personalCouponListId,s={},u=function(e,t,n){e[t]?e[t].push(n):e[t]=[n]};r=c.filter((function(e){return e.for_friend}));var p=function(e){return"1"===e.new_optin},f={subTypes:t.extractSubTypes((function(e){return _.filter(e,p)})),incentives:_.filter(c,p)},d={subTypes:t.extractSubTypes((function(e){return _.reject(e,p)})),incentives:_.reject(c,p)};return i=r.filter((function(e){return null===e.new_customer&&!_.toInteger(e.allow_on_self_referral)&&!_.toInteger(e.allow_on_expired_offer)&&!_.toInteger(e.new_optin)})),o=r.filter((function(e){return"1"===e.new_customer})),a=r.filter((function(e){return"0"===e.new_customer})),e=_.minBy(_.filter(o,{percentage_discount:!1}),"amount"),n=_.minBy(_.filter(o,{percentage_discount:!0}),"amount"),f.incentives.length&&(_.forEach(d.subTypes,(function(e){u(s,e,"You need to remove all subscription incentives")})),_.forEach(f.subTypes,(function(e){delete s[e]}))),d.incentives.length&&(_.forEach(f.subTypes,(function(e){u(s,e,"You need to remove all non-subsription incentives")})),_.forEach(d.subTypes,(function(e){delete s[e]}))),l&&u(s,"PersonalCouponIncentive","This incentive is already used. You need to remove all personal sharing incentives"),o.length||a.length?u(s,"ClickIncentive",'You need to remove "Friend incentive New Customer" or "Friend Incentive Existing Customer"'):i.length&&(u(s,"NewCustomer",'You need to remove "Friend incentive"'),u(s,"ExistingCustomer",'You need to remove "Friend incentive"')),t.setState({friendIncentives:r,friendIncentiveNewCustomerNumber:e||!1,friendIncentiveNewCustomerPercent:n||!1,incentivesToBlock:s})},t.toggleCreatePersonalCouponForm=function(e,n){n&&n.preventDefault();var r=t.props.personalCouponFormStore.activateCreateMode;if(t.state.incentivesToBlock[e.sub_type])return!1;r()},t.toggleCreateForm=function(e,n){if(n&&n.preventDefault(),t.state.incentivesToBlock[e?e.sub_type:void 0])return!1;t.setState({toggleCreateForm:!t.state.toggleCreateForm},(function(){$("body").toggleClass("is-cut",t.state.toggleCreateForm)})),e&&t.setState({new_incentive_data:{id:e.id,type:e.type,sub_type:e.sub_type}})},t.openCopyModal=function(e){return Object(v.a)({campaign:t.props.data,site:window.Site,currentUser:window.current_user}),e.preventDefault()},t.addVariantHandle=function(e){t.setState({toggleCreateForm:!t.state.toggleCreateForm,new_incentive_data:{test_variant:!0,id:e.id,type:e.type,sub_type:Object(b.h)(e)}})},t.newIncentiveIdentifier=function(e){var n,r,i;if(r=_.max(_.map(t.props.incentives,"id")),i=t.incrementLastNumber(e),n=_.map(t.props.incentives,"identifier"),i===e)return e+"_".concat(++r);for(;_.includes(n,i);)i=t.incrementLastNumber(i);return i},t.addTieringHandle=function(e){t.setState({toggleCreateForm:!t.state.toggleCreateForm,new_incentive_data:{id:e.id,type:e.type,sub_type:Object(b.h)(e),identifier:t.newIncentiveIdentifier(e.identifier)}})},t.findViewByViewCategory=function(e){return _.find(t.props.data.view_setups,(function(t){return t.view_category===e}))},t.toggleViewSetup=function(e,t,n){return $.ajax({type:"PATCH",url:Routes.site_campaign_view_setup_path(Site,Campaign,e),data:{view_setup:{is_disabled:t}},success:function(e){if(Validation.succeed(),n)return n()}})},t.isFriendIncentive=function(e){return"ClickIncentive"===e.type||"ReferredIncentive"===e.type},t.handleAddIncentive=function(e){if(e){var n=t.findViewByViewCategory("offers_claim");t.isFriendIncentive(e)&&t.validateViewSetupWhenAddIncentive(n)&&1===t.state.friendIncentives.length&&t.setState({showModalFor:"add-friend-incentive"})}},t.validateViewSetupWhenAddIncentive=function(e){return e&&e.is_disabled&&!e.disabled_by_configuration},t.validateAddIncentive=function(e,n){return t.isFriendIncentive(e)&&t.validateViewSetupWhenAddIncentive(n)&&1===t.state.friendIncentives.length&&t.state.showModal},t.closeModal=function(e){t.setState({showModalFor:!1,toggleCreateForm:!1},(function(){"#/incentives"!==window.location.hash&&(window.location.hash="#/incentives"),t.handleAddIncentive(e)}))},t.handleToggleClaimPage=function(){return t.props.fetchData(),t.closeModal()},t.turnOnClaimPage=function(){return t.toggleClaimPage("on")},t.toggleClaimPage=function(e){var n;if(n=t.findViewByViewCategory("offers_claim"),"on"===e)return t.toggleViewSetup(n,0,t.handleToggleClaimPage)},t.state={new_incentive_data:{},toggleCreateForm:!1,friendIncentiveNewCustomerNumber:!1,friendIncentiveNewCustomerPercent:!1,incentivesToBlock:{},friendIncentives:[],showModalFor:!1},Object(y.reaction)((function(){return t.props.rulesStore.personalCouponListId}),(function(e){var n=t.props.rootStore.models.sitePersonalCouponLists.fetchCurrentPersonalCouponList;e&&n(e),t.fetchFriendIncentives(t.props.incentives)})),t}var i,a,m;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(r,t),i=r,(a=[{key:"UNSAFE_componentWillMount",value:function(){this.fetchFriendIncentives()}},{key:"componentDidUpdate",value:function(e){_.isEqual(e.incentives,this.props.incentives)||this.fetchFriendIncentives(this.props.incentives)}},{key:"extractSubTypes",value:function(e){return _(this.incentiveSettings()).thru(e).map("sub_type").compact().uniq().value()}},{key:"incrementLastNumber",value:function(e){return e.replace(/\d+$/,(function(e){return+e+1}))}},{key:"incentiveSettings",value:function(){return[{type:"SignupIncentive",sub_type:"SignupIncentive",header:"Advocate Incentives"},{type:"SharingIncentive",sub_type:"SharingIncentive",staff_member:!0},{type:"PersonalCouponIncentive",sub_type:"PersonalCouponIncentive",staff_member:!0},{type:"ReferrerIncentive",sub_type:"ReferrerIncentive"},{type:"ReferrerIncentive",sub_type:"ReferrerSubscription",new_optin:"1",event_category:"friend_signup",staff_member:!0},{type:"ClickIncentive",sub_type:"ClickIncentive",header:"Friend Incentives"},{type:"ClickIncentive",sub_type:"NewCustomer",new_customer:"1"},{type:"ClickIncentive",sub_type:"ExistingCustomer",new_customer:"0"},{type:"ClickIncentive",sub_type:"ExpiredOffer",allow_on_expired_offer:"1"},{type:"ClickIncentive",sub_type:"SelfReferral",allow_on_self_referral:"1"},{type:"ClickIncentive",sub_type:"NewSubscriber",new_optin:"1",staff_member:!0},{type:"ReferredIncentive",sub_type:"ReferredIncentive",staff_member:!0}]}},{key:"render",value:function(){var t,r,i=this,a=this.props,m=a.allowIncentivesEdit,b=a.isInitialLoading,v=a.rootStore.models.sitePersonalCouponLists.currentPersonalCouponListDataFetched,y=a.personalCouponFormStore.personalCouponFormVisibility,g=a.rulesStore.personalCouponListId;return r=[],t=_.groupBy(this.props.incentives,"identifier"),g&&v&&r.push(e.createElement(s.a,{key:"personal_coupon_list"})),_.forEach(t,(function(t,n){var a,o;return o=!1,a=97,t.map((function(e,t){var n,r;if(e.index=String.fromCharCode(a).toUpperCase(),a++,e.for_friend&&i.existingCustomerIncentive(e)){if(!e.percentage_discount&&e.amount>(null!==(n=i.state.friendIncentiveNewCustomerNumber)?n.amount:void 0))return o=!0;if(e.percentage_discount&&e.amount>(null!==(r=i.state.friendIncentiveNewCustomerPercent)?r.amount:void 0))return o=!0}})),r.push(e.createElement(l.a,{friend_incentives:i.state.friendIncentives,incentives:t,for_advocate:t[0].for_advocate,key:n,routes:i.props.routes,incentive_amount_warning:o,preset_name:i.props.data.preset_name,onAddVariant:i.addVariantHandle,onAddTiering:i.addTieringHandle,onClose:i.closeModal}))})),e.createElement(I,null,"add-friend-incentive"===this.state.showModalFor&&e.createElement(f.a,{action:"add",handleCloseModal:this.closeModal,turnOnClaimPage:this.turnOnClaimPage}),this.state.toggleCreateForm&&e.createElement("div",null,e.createElement(u.a,{action:"new",data:this.state.new_incentive_data,onClose:this.closeModal})),y&&e.createElement(p.a,null),e.createElement(j,null,e.createElement(I,{justifyContent:"space-between"},this.props.SectionHeader&&e.createElement(this.props.SectionHeader,null),m?e.createElement("div",null,e.createElement("div",{className:"dropdown pull-right"},e.createElement("div",{className:"base-btn is-small pull-right dropdown-toggle","data-toggle":"dropdown",href:"#"},e.createElement("i",{className:"icon icon-plus"}),"Create New Incentive"),e.createElement("ul",{className:"Rules-incentives-dropdown dropdown-menu is-ovv"},_.map(this.incentiveSettings(),(function(t,n){var r=i.state.incentivesToBlock[t.sub_type],a=r&&!_.isEmpty(r),l=classNames("dropdown-link",{"is-disabled":a,"is-super-admin-only":t.staff_member});if(window.current_user.staff_member||!t.staff_member)return e.createElement("li",{key:n},t.header&&e.createElement("div",{className:"dropdown-item dropdown-header"},t.header),e.createElement("a",{href:"#",className:l,onClick:"PersonalCouponIncentive"===t.type?i.toggleCreatePersonalCouponForm.bind(i,t):i.toggleCreateForm.bind(i,t)},e.createElement(c.c,{text:_.get(Object(d.a)(t),"title"),element:a&&e.createElement(o.b,{className:"mls",title:r.join(". ")+" in order to create this incentive."})}),t.staff_member&&e.createElement(N,{text:!1,size:"micro"})))}))))):void 0),e.createElement("div",{className:"clearfix"}),e.createElement("div",{className:"incentive-list"},m?null:e.createElement("div",{className:"incentive-blocker alert"},"You can only change some of the Incentive fields because this campaign already has activity.",e.createElement("div",{className:"incentive-blocker-actions"},e.createElement("a",{className:"btn",href:Routes.site_new_campaign_path(Site)},"Create New Campaign"),e.createElement("a",{className:"btn mlm",href:"#",onClick:this.openCopyModal},"Copy This Campaign"))),b?e.createElement(k,null,e.createElement(h.UILoader,null)):r.length?r:e.createElement("div",{className:"incentive-zerocase"},"You have no Incentives."))),e.createElement(x,null,e.createElement("div",{className:"incentive-help"},e.createElement("img",{src:n("JOlu"),className:"incentive-help-image"}),e.createElement("div",{className:"incentive-help-title"},"Incentive types"),e.createElement("p",{className:"mbl"},"Each incentive describes a reward that is given after certain user action:"),e.createElement("ul",null,e.createElement("li",null,e.createElement("strong",null,"1. Advocate Signup Incentive")," \u2014 given to an Advocate after signing up to Standalone campaign with his\xa0email"),e.createElement("li",null,e.createElement("strong",null,"2. Advocate Sharing Incentive")," \u2014 given to an Advocate after sharing via social network or email"),e.createElement("li",null,e.createElement("strong",null,"3. Advocate Referral Incentive")," \u2014 given to an Advocate who have successfully referred a\xa0Friend"),e.createElement("li",null,e.createElement("strong",null,"4. Friend Incentive")," \u2014 given to a Friend upon visiting a referral link"),e.createElement("li",null,e.createElement("strong",null,"5. Friend Referred Incentive")," \u2014 given to a Friend after they make referral purchase")),e.createElement("p",null,"You can also A/B test each incentive. Click on the \u201dA/B Test This Incentive\u201d button to add another variant with different amount and setup a distribution between variants."))),e.createElement("div",{className:"pbm"}))}}])&&E(i.prototype,a),m&&E(i,m),r}(e.Component))||i)||i)||i)}).call(this,n("q1tI"))},gnFl:function(e,t){e.exports="/assets/v1/packs/reward-type-rybbon@2x-a41b0251aefa17a0763424c1312963e3.png"},jxWw:function(e,t){e.exports="/assets/v1/packs/icon-rybbon@2x-f076f42b484ce37bd4056f3185a1b05a.png"},"m+Fy":function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return w}));var r,i,a,o=n("kMSe"),c=n("vOnD"),l=n("GaHK"),s=n("fRW6");function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==u(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var v=c.default.div.withConfig({displayName:"reward_type__RewardTypeLabelWrapper",componentId:"sc-12tgpbv-0"})(["display:flex;align-items:center;img{margin:0 10px 0 5px;}"]),y=c.default.span.withConfig({displayName:"reward_type__RewardTypeDescription",componentId:"sc-12tgpbv-1"})(["font-size:14px;color:#999999;letter-spacing:-0.1px;line-height:22px;"]),g=function(t){var n=t.text,r=h(t,["text"]);return e.createElement(v,null,e.createElement(l.UIIcon,b({className:"mls mrm"},r)),n)},_=Object(o.c)((function(e){var t=e.rootStore,n=e.incentiveFormStore;return{supportsNonMonetary:n.supportsNonMonetary,value:n.incentiveData.incentive_type,onChangeByKey:n.incentiveData.onChangeByKey,error:n.errors.get("incentive_type"),disabled:!n.allowEdit,currentUser:t.models.currentUser}}))(r=Object(o.d)((a=i=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),f(this,d(n).apply(this,arguments))}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.value,r=t.onChangeByKey,i=t.error,a=t.disabled,o=t.currentUser.staffMember,c=t.supportsNonMonetary,u=t.additionalFields;return e.createElement("div",{className:"mbl"},e.createElement(l.UILabel,{text:"Reward type:"}),e.createElement(l.UIInputRadio,{className:"mbs",id:"discount_coupon",name:"incentive_type",render:function(){return e.createElement(g,{name:"couponCode",fill:"#0070d9",stroke:"#0070d9",text:"Coupon code"})},value:"discount_coupon",checked:"discount_coupon"===n,onChange:r,disabled:a}),e.createElement(l.UIInputRadio,{className:"mbs",id:"rebate",name:"incentive_type",render:function(){return e.createElement(v,null,e.createElement(g,{name:"rebate",stroke:"#0070d9",text:"Rebate (store credit)"}))},value:"rebate",checked:"rebate"===n,onChange:r,disabled:a}),o&&c&&e.createElement(l.UIInputRadio,{className:"mbs",id:"other",name:"incentive_type",render:function(){return e.createElement(v,null,e.createElement(g,{name:"nonMonetary",stroke:"#0070d9",text:"Non-monetary (distributes manually)"}),e.createElement(l.UIStaffBadge,{className:"mls",text:!1,size:"micro"}))},value:"other",checked:"other"===n,onChange:r,disabled:a}),u(n,r,a),Object(s.a)(i))}}])&&p(r.prototype,i),a&&p(r,a),n}(e.Component),i.defaultProps={additionalFields:function(){}},r=a))||r)||r,w=function(){return e.createElement(_,{additionalFields:function(t,r,i){return e.createElement(e.Fragment,null,e.createElement(l.UIInputRadio,{className:"mbs",id:"rybbon",name:"incentive_type",render:function(){return e.createElement(v,null,e.createElement("img",{src:n("jxWw"),width:"84",height:"23",alt:"rybbon"}),e.createElement(y,null,"Enterprise feature"))},value:"rybbon",checked:"rybbon"===t,onChange:r,disabled:i}),e.createElement(l.UIInputRadio,{className:"mbs",id:"tremendous",name:"incentive_type",render:function(){return e.createElement(v,null,e.createElement("img",{src:n("+/g7"),width:"105",height:"12",alt:"tremendous"}),e.createElement(y,null,"Enterprise feature"))},value:"tremendous",checked:"tremendous"===t,onChange:r,disabled:i}))}})}}).call(this,n("q1tI"))},pwLL:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var r,i,a,o=n("kMSe"),c=n("fRW6"),l=n("GaHK");function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=Object(o.c)((function(e){var t=e.incentiveFormStore;return{value:t.incentiveData.sharingChannelsValueForSelect,onChange:t.incentiveData.onChangeByKey,error:t.errors.get("sharing_channels"),disabled:!t.allowEdit}}))(r=Object(o.d)((a=i=function(t){function n(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=p(this,(e=f(n)).call.apply(e,[this].concat(i)))).handleChange=function(e){var n=_.reduce(e.target.options,(function(e,t){return t.selected?[].concat(e,[t.value]):e}),[]);t.props.onChange({target:{name:e.target.name,value:n.join(", ")}})},t}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.value,r=t.options,i=t.error,a=t.disabled;return e.createElement("div",{className:"mbl"},e.createElement(l.UILabel,{text:"Sharing channel:",id:"sharing_channels"}),e.createElement(c.b,{id:"sharing_channels",name:"sharing_channels",options:r,onChange:this.handleChange,value:n,disableSearch:!0,multiple:!0,width:"100%",disabled:a,maxSelectedOptions:5}),Object(c.a)(i))}}])&&u(r.prototype,i),a&&u(r,a),n}(e.Component),i.defaultProps={options:[].concat(_.get(window,"Site.sharing_channels",[])).map((function(e){return{label:e.identifier,value:e.identifier}}))},r=a))||r)||r}).call(this,n("q1tI"))},qVMk:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r,i=n("kMSe"),a=n("UOkJ");function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==o(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=Object(i.c)((function(e){var t=e.incentiveFormStore;return{minValue:t.incentiveData.subtotal_min,maxValue:t.incentiveData.subtotal_max,onChange:t.incentiveData.onChangeByKey,minError:t.errors.get("subtotal_min"),maxError:t.errors.get("subtotal_max"),disabled:!t.allowEdit}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),s(this,u(n).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){return e.createElement(a.a,c({minName:"subtotal_min",maxName:"subtotal_max",labelText:"Friend's order subtotal:"},this.props))}}])&&l(r.prototype,i),o&&l(r,o),n}(e.Component))||r)||r}).call(this,n("q1tI"))},uy5f:function(e,t,n){"use strict";(function(e){var r,i=n("kMSe"),a=n("QWlW"),o=n("ZVfT"),c=n("Ty5D"),l=n("oqc9"),s=n("5nEI"),u=n.n(s);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function m(e){return(m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function y(e,t){return!t||"object"!==m(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=Object(c.o)(r=function(t){function n(){var e,t;b(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=y(this,(e=g(n)).call.apply(e,[this].concat(i)))).handleClick=function(){t.props.history.push("#".concat(t.props.to))},t}return w(n,t),v(n,[{key:"render",value:function(){var t=this.props,n=t.label,r=t.to;return e.createElement("li",null,e.createElement(l.Link,{to:r,smooth:!0,offset:-50,onClick:this.handleClick},n))}}]),n}(e.Component))||r,O=_.flow(a.e)(C),S=function(t){function n(){var e,t;b(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=y(this,(e=g(n)).call.apply(e,[this].concat(i)))).subNavStickyRef=function(e){return t.subNavSticky=e},t}return w(n,t),v(n,[{key:"componentDidMount",value:function(){u.a.add($(this.subNavSticky))}},{key:"render",value:function(){var t=this.props,n=t.rulesStore,r=t.rulesStore,i=r.campaign.data.test_mode,a=r.navLinksConfig,c=r.dataIsSaving,l=r.hasUnsavedChanges,s=c?{onClick:n.saveChanges,children:"Saving...",disabled:!0}:{onClick:n.saveChanges,children:"Save changes"};return e.createElement("div",{className:"sub-subnav-sticky",ref:this.subNavStickyRef},e.createElement("div",{className:"js-sub-subnav sub-subnav is-no-margin"},e.createElement("div",{className:"App-container-inner"},e.createElement("ul",null,_.map(a,Object(o.m)(O)),i&&e.createElement("li",null,e.createElement("a",{"data-confirm":"Are you sure you want to delete data (offers, purchases, referrals, rewards, ...)?","data-method":"delete",href:"flush_data",rel:"nofollow"},"Flush all data")),e.createElement("li",{className:"is-right"},l&&!c&&e.createElement("div",{className:"badge-unsaved is-left"},e.createElement("div",{className:"badge-unsaved-arrow"}),e.createElement("div",{className:"badge-unsaved-inner"},"You have unsaved changes")),e.createElement("span",d({className:"base-btn is-warning ac-save-changes"},s)))))))}}]),n}(e.Component);S.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},a.a.propTypes);var I=_.flow(i.d,Object(i.c)("rulesStore"),Object(a.a)({subscriber:UI.subscribe.bind(UI),events:{Incentives_changes_made:function(e){Validation.succeed(e)}}}))(S);t.a=I}).call(this,n("q1tI"))},vnvS:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r,i=n("55Ip"),a=n("kMSe"),o=n("GaHK");function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==c(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=Object(a.c)((function(e){return{has_activities:e.rulesStore.campaign.data.has_activities}}))(r=Object(a.d)(r=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t=s(this,u(n).call(this,e)),"delete"===e.action&&(t.deleteLastFriendIncentive=e.deleteLastFriendIncentive.bind(null,e.claimPage)),t}var r,a,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,t),r=n,(a=[{key:"render",value:function(){var t=this.props,n=t.validateFriendIncentiveRemove,r=t.handleCloseModal,a=t.deleteIncentive,c=t.has_activities,l=t.handleDestinationClick,s=t.action,u=t.turnOnClaimPage,p={};return p.onCloseModal=r,"delete"===s?(n?(p.lastFriendIncentive=!0,p.style="three-sections",p.onPrimaryAction=this.deleteLastFriendIncentive,p.primaryButtonText="Turn It Off",p.secondaryButtonText="Keep It On",p.onSecondaryAction=a):(p.lastFriendIncentive=!1,p.style="two-sections",p.onPrimaryAction=a),p.lastFriendIncentive?p.modalConfirmationContent=c?e.createElement("p",null,"You are removing the last ",e.createElement("b",null,"Friend Incentive")," in this Campaign. This action will flush Campaign data (shares, clicks, visits metrics, etc.).",e.createElement("br",null),e.createElement("br",null),"Do you also want to turn the ",e.createElement("b",null,"Friend claim page")," view off, so that Friends are redirected to the\xa0",e.createElement(i.Link,{to:"/friend_destination_url",onClick:l},"Friend Destination URL"),"\xa0on your site?"):e.createElement("p",null,"You are removing the last ",e.createElement("b",null,"Friend Incentive")," in this Campaign.",e.createElement("br",null),e.createElement("br",null),"Do you also want to turn the ",e.createElement("b",null,"Friend claim page")," view off, so that Friends are redirected to the\xa0",e.createElement(i.Link,{to:"/friend_destination_url",onClick:l},"Friend Destination URL"),"\xa0on your site?"):p.modalConfirmationContent=c?e.createElement("p",null,"This action will flush campaign data (shares, clicks, visits metrics, etc.). Are you sure you want to delete this Incentive?"):e.createElement("p",null,"Are you sure you want to delete this Incentive?")):(p.style="three-sections",p.primaryButtonText="Turn It On",p.secondaryButtonText="Keep It Off",p.onPrimaryAction=u,p.onSecondaryAction=r,p.modalConfirmationContent=e.createElement("p",null,"You have just added the first ",e.createElement("b",null,"Friend Incentive")," to your Campaign.",e.createElement("br",null),e.createElement("br",null),"Do you also want to turn the ",e.createElement("b",null,"Friend claim page")," view on, so that Friends have a place where to claim their incentive rewards?")),e.createElement(o.UIModalConfirmation,p,p.modalConfirmationContent)}}])&&l(r.prototype,a),c&&l(r,c),n}(e.Component))||r)||r}).call(this,n("q1tI"))},x7mL:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r,i=n("kMSe"),a=n("UOkJ");function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==o(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=Object(i.c)((function(e){var t=e.incentiveFormStore;return{minValue:t.incentiveData.referrals_min,maxValue:t.incentiveData.referrals_max,onChange:t.incentiveData.onChangeByKey,minError:t.errors.get("referrals_min"),maxError:t.errors.get("referrals_max"),disabled:!t.allowEdit}}))(r=Object(i.d)(r=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),s(this,u(n).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){return e.createElement(a.a,c({minName:"referrals_min",maxName:"referrals_max",labelText:"Advocate's referrals count:"},this.props))}}])&&l(r.prototype,i),o&&l(r,o),n}(e.Component))||r)||r}).call(this,n("q1tI"))},y6Bb:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var r,i,a=n("Ty5D"),o=n("kMSe"),c=n("GaHK"),l=n("L0cm");function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=(r=Object(o.c)((function(e){return{personalCouponFormStore:e.rootStore.pages.personalCouponFormStore,rulesStore:e.rulesStore,rootStore:e.rootStore,sitePersonalCouponLists:e.rootStore.models.sitePersonalCouponLists}})),Object(a.o)(i=r(i=Object(o.d)(i=function(t){function n(){var t,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(r=p(this,(t=f(n)).call.apply(t,[this].concat(a)))).handleActionClose=function(){var e=r.props,t=e.history,n=e.personalCouponFormStore.hidePersonalCouponForm;t.push("/"),n()},r.saveChanges=function(e){e&&e.preventDefault(),(0,r.props.rulesStore.savePersonalCouponList)()},r.modalActions=function(){var t=r.props.personalCouponFormStore,n=t.selectedPersonalCouponListId,i=t.actionButtonText;return e.createElement(c.UIFormFooter,null,e.createElement(c.UIButton,{disabled:!n,trait:"success",onClick:r.saveChanges,type:"submit"},i))},r.onFocusSelect=function(e){var t=e.target;setTimeout((function(){t.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}),0)},r}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,t),r=n,(i=[{key:"componentDidMount",value:function(){(0,this.props.sitePersonalCouponLists.fetchPersonalCouponLists)()}},{key:"componentWillUnmount",value:function(){this.props.history.push("/")}},{key:"render",value:function(){var t=this.props,n=t.personalCouponFormStore,r=n.formTitle,i=n.handlePersonalCouponLists,a=n.selectedPersonalCouponListIdSelectValue,o=t.sitePersonalCouponLists,s=o.personalCouponListsForSelect,u=o.personalCouponListsDataFetched,p=t.rootStore.models.site.siteCachedSlug;return e.createElement(c.UIModal,{title:r,actions:this.modalActions,actionClose:this.handleActionClose,actionOverlay:this.handleActionClose,scrollContent:!0,noContentPaddingBottom:!0},e.createElement(c.UILabel,{text:"Personal Coupon List:"}),e.createElement(c.UIInputSelect,{name:"personal_coupon_list_id",options:s,onChange:i,loading:!u,onFocus:this.onFocusSelect,value:a,placeholder:"Choose person coupon list"}),e.createElement("p",{className:"mts"},"Each Advocate will be assigned with a unique coupon code taken from the Advocate Personal Coupon List. As a result, this incentive allows Advocates to share their personal coupon code instead of sharing a link."),e.createElement("p",null,"Such user experience simplifies friend experience because they can instantly use the coupon code at checkout without clicking on the link."),e.createElement(c.UILink,{href:Routes.site_personal_coupon_lists_path(p),target:"_blank",className:"js-ga-click mbm","data-category":l.k,"data-action":"manage personal coupon lists"},"Manage personal coupon lists"))}}])&&u(r.prototype,i),a&&u(r,a),n}(e.Component))||i)||i)||i)}).call(this,n("q1tI"))},zfZb:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r,i=n("kMSe"),a=n("vOnD"),o=n("GaHK"),c=n("fRW6");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=a.default.div.withConfig({displayName:"coupon_form__Form",componentId:"cacmt1-0"})(["&&{box-shadow:0 1px 5px rgba(0,0,0,0.1);color:#333;padding:20px;margin:0;",";}"],(function(e){return e.isShow&&"\n      margin: 20px 5px 0 5px;\n    "})),m=a.default.div.withConfig({displayName:"coupon_form__Title",componentId:"cacmt1-1"})(["font-size:24px;"]),b=[{label:"List coupons manually",value:"manual"},{label:"Upload as CSV file",value:"csv"}],h=Object(i.c)((function(e){var t=e.couponListsStore;return{couponForm:t.couponForm,toggleCouponForm:t.toggleCouponForm,create:t.create,errors:t.errors}}))(r=Object(i.d)(r=function(t){function n(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=u(this,(e=p(n)).call.apply(e,[this].concat(i)))).onExpiresAtInputChange=function(e,n,r){(0,t.props.couponForm.updateExpiresAt)(n)},t}var r,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),r=n,(i=[{key:"render",value:function(){var t=this.props,n=t.couponForm,r=n.name,i=n.title,a=n.coupons_mode,l=n.coupons_codes,s=n.updateKey,u=n.upload_file_root,p=n.updateUploadFile,f=n.clearUploadFile,h=n.expires_at,v=t.toggleCouponForm,y=t.create,g=t.errors,_=t.isShow;return e.createElement(d,{"data-form":"couponList",isShow:_},e.createElement(m,{className:"App-title mbl"},"Create New Coupon List for ",i),e.createElement("div",{className:"mbl"},e.createElement(o.UILabel,{id:"name",text:"Coupon list name:"}),e.createElement(o.UIInputText,{id:"name",size:"medium",name:"name",value:r,onChange:s,error:g.get("name")}),e.createElement("div",{"data-validate-message":"couponList.name",className:"hidden"})),e.createElement("div",{className:"mbl"},e.createElement(o.UILabel,{id:"name",text:"Coupon list expiration date:"}),e.createElement(Widget.Rangepicker,{inputProps:{value:h,name:"expires_at"},futureOnly:!0,isMergedRange:!0,errorInput:g.get("expires_at"),onInputChange:this.onExpiresAtInputChange,fixedPositioning:!0,trackScroll:!0,alignModal:"top"}),e.createElement("div",{"data-validate-message":"couponList.expires_at",className:"hidden"})),e.createElement("div",{className:"mbs"},e.createElement(o.UILabel,{text:"Add coupon codes:"}),e.createElement(c.b,{options:b,value:a,name:"coupons_mode",onChange:s,disableSearch:!0}),e.createElement("div",{"data-validate-message":"couponList.coupons_mode",className:"hidden"})),"manual"===a&&e.createElement("div",{className:"mbl"},e.createElement(o.UIInputTextarea,{size:"small",height:"76px",name:"coupons_codes",value:l,onChange:s,placeholder:"List coupon codes manually. Each coupon should start with a new line.",error:g.get("coupons_codes")}),e.createElement("div",{"data-validate-message":"couponList.coupons_codes",className:"hidden"}),e.createElement(o.UIFormTip,null,"The field is limited to 200,000 characters (approx. 10,000 coupons).")),"csv"===a&&e.createElement("div",{className:"mbl"},e.createElement("div",{className:"well"},e.createElement("input",{name:"upload_file",type:"file",onChange:p,onClick:f,value:u,error:g.get("coupons_codes"),accept:".csv, .txt"}),e.createElement("div",{"data-validate-message":"couponList.upload_file",className:"hidden"}),e.createElement(o.UIFormTip,null,"CSV file should either contain just one column with coupon codes or multiple columns that come with headers. Coupon header name should be"," ",'"',"coupon",'"',"."))),e.createElement("div",null,e.createElement(o.UIButton,{className:"mrm",size:"small",trait:"success",onClickLoad:y},"Create & Apply"),e.createElement(o.UIButton,{size:"small",onClick:v},"Cancel")))}}])&&s(r.prototype,i),a&&s(r,a),n}(e.Component))||r)||r}).call(this,n("q1tI"))},zwcX:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={root:{path:"/",name:"campaignRules"},incentiveEdit:{name:"incentiveEdit",pathPrefix:"/incentives/edit/"},personalCouponListEdit:{name:"personalCouponEdit",pathPrefix:"/personal_coupon/edit/"}}}},[["DQTY",0,1]]]);