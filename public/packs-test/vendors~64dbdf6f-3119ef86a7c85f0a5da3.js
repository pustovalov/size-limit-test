(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[4,65],{"+CAZ":function(e,t,a){"use strict";function r(e,t){return _.set(e,"id",e.referral.id),_.set(e,"page",t),_.set(e,"advocate.person.type","advocate"),_.set(e,"friend.person.type","friend"),e}a.d(t,"a",(function(){return r}))},"+FEe":function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a("99Ma"),n=a("V0vo"),i=a("2TKB"),o=a("1Vml");const s=r.types.model("ChartConfig",{data_url:"",from:r.types.maybeNull(r.types.number),to:r.types.maybeNull(r.types.number)}).views((()=>({}))).actions((()=>({}))),l=r.types.model("MetricsDateRange",{start_date:"",end_date:""}).views((()=>({}))).actions((()=>({}))),c=r.types.model("TagData",{id:r.types.maybeNull(r.types.number),name:""}).views((()=>({}))).actions((()=>({}))),p=r.types.compose("CampaignDashboard",i.b,r.types.model({affiliate:r.types.boolean,created_at:r.types.string,chart_config:r.types.optional(s,{}),metrics_date_range:r.types.optional(l,{}),origin_class:r.types.string,parent:r.types.maybeNull(o.a),recent_offer_date:r.types.maybeNull(r.types.string),version_suitable_for_placements:r.types.boolean,expires_at:r.types.maybeNull(r.types.string),friend_deadline:r.types.maybeNull(r.types.string),offer_duration:r.types.maybeNull(r.types.number),public_key:r.types.string,supports_offer_blasts:r.types.boolean,tags:r.types.array(c)}).views((e=>({get humanizedRecentOfferDate(){return e.site.getDateInSiteTimezone(e.recent_offer_date).fromNow()},get tagNames(){return e.tags.map((e=>e.name))},get humanizedOfferDuration(){return _.upperFirst(Object(n.E)(e.offer_duration))},get isOfferBlastAvailable(){return e.rootStore.isStaffMember&&e.supports_offer_blasts&&!e.rootStore.isLoyaltySpace},get humanizedActivatesAt(){return e.activates_at?Object(n.a)({value:e.activates_at,timeZoneName:e.siteTimeZoneName,timeZoneIdentifier:e.siteTimeZoneIdentifier}):"Manual"},get humanizedExpiresAt(){return e.expires_at?Object(n.a)({value:e.expires_at,timeZoneName:e.siteTimeZoneName,timeZoneIdentifier:e.siteTimeZoneIdentifier}):"Not set"},get humanizedFriendDeadline(){return e.friend_deadline?Object(n.a)({value:e.friend_deadline,timeZoneName:e.siteTimeZoneName,timeZoneIdentifier:e.siteTimeZoneIdentifier}):"Unlimited"}}))))},"+K82":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("EAOr"),i=a("pm75"),o=a("B9cq");const s=r.types.compose(n.b,i.c,r.types.model().views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},getPlacementById:t=>e.campaign_placements.find((e=>Number(e.id)===Number(t)))}))).actions((e=>({updateData:t=>{Object(r.applySnapshot)(e.campaign_placements,t)},apiPut:Object(r.flow)((function*(t,a={no_spinner:!1}){const{result:r}=yield Object(o.ajax)({url:Routes.internal_site_campaign_placements_path(e.siteCachedSlug,a),type:"PUT",data:{site:{placements_attributes:t}}});return r})),apiPost:Object(r.flow)((function*(t,a={no_spinner:!1}){return yield Object(o.ajax)({url:Routes.internal_site_campaign_placements_path(e.siteCachedSlug,a),type:"POST",data:{campaign_placement:t}})}))}))))},"+XQG":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return d}));var r=a("GaHK"),n=a("vOnD"),i=a("V0vo"),o=a("qfPl"),s=a("ne91");function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const c=n.default.div.withConfig({displayName:"header_user_menu__MenuIconWrapper"})(["border-radius:4px;height:24px;width:24px;display:flex;align-items:center;justify-content:center;"," svg{margin:0 !important;}",""],(({disabled:e})=>!e&&Object(n.css)(["cursor:pointer;"])),(({isOpened:e})=>e&&Object(n.css)(["background-color:",";svg{width:12px;height:12px;}"],r.Theme.color.black25))),p=n.default.div.withConfig({displayName:"header_user_menu__DividerWrapper"})(["margin:0 10px;"]),u=Object(n.default)(r.UIMenuDropdown).withConfig({displayName:"header_user_menu__UserMenuDropDown"})(["","{width:235px;z-index:5;}"],r.UIMenuDropdown.CLASS_NAMES.list);let d=function(t){var a,n;function d(){return t.apply(this,arguments)||this}return n=t,(a=d).prototype=Object.create(n.prototype),a.prototype.constructor=a,l(a,n),d.prototype.render=function(){const{site:t,account:a,locationRouter:n,currentUser:l,editor:d}=this.props,m=Object(i.d)(l,"admin"),g=Object(i.d)(l,"write"),h=Object(i.d)(l,"read"),y=null==a?void 0:a.id,f=Object(s.b)({site:t,currentUser:l}),b=Boolean(null==t?void 0:t.id)||Boolean(f);return e.createElement(u,{renderButton:({isOpened:t})=>e.createElement(c,{isOpened:t},e.createElement(r.UIIcon,{name:t?"cross":"menu",fill:d&&!t?r.Theme.color.black25:r.Theme.color.black100}))},b&&h&&e.createElement(o.a,{name:"All site settings",description:g?"App store, domains, referral attribution, placements":"Placements",icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.black75,name:"siteSettings",stroke:r.Theme.color.black15}),href:Routes.edit_site_path(f),locationRouter:n,isRouterLink:!0}),b&&g&&e.createElement(e.Fragment,null,e.createElement(o.a,{name:"Fraud settings",icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.black75,name:"fraudSettings"}),href:Routes.fraud_site_path(f),locationRouter:n,isRouterLink:!0}),e.createElement(o.a,{name:"Webhooks",icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.black75,name:"webhook"}),href:Routes.site_web_hooks_path(f),locationRouter:n,isRouterLink:!0}),_.some(t)&&e.createElement(o.a,{name:Object(i.q)(t.platform),icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.black75,name:"integration"}),linksActive:[Routes.integration_site_path(f),Routes.integration_shopify_site_path(f)],href:Object(i.A)({site:f,platform:t.platform}),locationRouter:n,isRouterLink:!0}),e.createElement(p,null,e.createElement(r.UIDivider,null))),m&&e.createElement(o.a,{name:"Account settings",description:"Blacklisting, QA IPs & emails, account security, single sign-on",icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.black75,name:"accountSettings"}),href:Routes.edit_account_path(y),locationRouter:n}),g&&e.createElement(o.a,{name:"Users & privileges",iconName:"users",icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.black75,name:"users"}),href:Routes.account_users_path(y)}),h&&e.createElement(o.a,{name:"Metrics glossary",href:Routes.account_metrics_path(y),icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.black75,name:"metrics"})}),h&&e.createElement(o.a,{name:"Pay bill",icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.black75,name:"pay"}),href:Routes.new_account_charge_path(y)}),e.createElement(o.a,{isExact:!0,name:"Sites",icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.black75,name:"sites"}),href:Routes.account_sites_path(y)}),e.createElement(p,null,e.createElement(r.UIDivider,null)),e.createElement(o.a,{name:"My profile",icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.black75,name:"user"}),href:Routes.edit_user_path(),locationRouter:n}),e.createElement(o.a,{name:"Refer a friend",icon:()=>e.createElement(r.UIIcon,{name:"giftLarge",stroke:r.Theme.color.link}),color:r.Theme.color.link,hoveredColor:"#005db5",href:Routes.invite_user_path(),locationRouter:n}),e.createElement(o.a,{name:"Logout",color:r.Theme.color.red,hoveredColor:"#cb030d",icon:()=>e.createElement(r.UIIcon,{fill:r.Theme.color.red,name:"logout"}),href:Routes.logout_path()}))},d}(e.PureComponent);d.defaultProps={editor:!1}}).call(this,a("q1tI"))},"/ZTi":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("rfrl");const i=r.types.model("Option",{title:r.types.optional(r.types.string,""),value:r.types.optional(r.types.frozen(),null)}),o=r.types.model("Field",{title:"",links:r.types.array(r.types.frozen()),description:"",type:r.types.union(r.types.literal("bool"),r.types.literal("text"),r.types.literal("url_param"),r.types.literal("url"),r.types.literal("number"),r.types.literal("select")),key:"",value:r.types.frozen(),default_value:r.types.frozen(),initialValue:r.types.frozen(),error:r.types.maybeNull(r.types.array(r.types.string)),options:r.types.array(i),sensitive:!1,optional:!1,disabled:!1,disabledEditButton:!1}).views((e=>({get howToFindLink(){return e.links.find((e=>"how_to_find"===e.type))},get selectOptions(){return e.options.map((e=>({label:e.title,value:e.value})))},get isValid(){return!e.error},get isPristine(){return!e.disabledEditButton&&(e.value===e.initialValue||null===e.initialValue&&""===e.value)}}))).actions((e=>({afterCreate:()=>{var t;"select"!==e.type&&"switch"!==e.type||e.value||(e.value=null==(t=e.options[0])?void 0:t.value);e.initialValue=e.value,void 0===e.value&&(e.value=e.default_value)},onChange:({target:{value:t}})=>{e.setError({error:null}),e.value=t},onEditClick:()=>{e.onChange({target:{value:null}}),e.setDisabled({disabled:!1}),e.setDisabledButton({disabledEditButton:!0})},setError:({error:t})=>{e.error=t},reset:()=>{Object(r.applySnapshot)(e,Object(n.a)(e.toJSON(),(e=>{e.error=null,e.value=e.initialValue})))},setDisabled:({disabled:t})=>{e.disabled=t},setDisabledButton:({disabledEditButton:t})=>{e.disabledEditButton=t}})))},"/tsJ":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("B9cq");const i=r.types.model("CampaignsNetworkService",{}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug}}))).actions((e=>({apiGetMany:({siteCachedSlug:t,queryParams:a={no_spinner:!0}}={})=>Object(n.ajax)({url:Routes.internal_site_campaigns_path(t||e.siteCachedSlug,a)}),apiPost:({data:{preset_name:t,appearance:a,placement_id:r,name:i,gdpr_and_ccpa_enabled:o},queryParams:s={no_spinner:!1}})=>Object(n.ajax)({type:"POST",url:Routes.internal_site_campaigns_path(e.siteCachedSlug,s),data:{campaign:{type:t,appearance:a,placement_id:r,name:i,gdpr_and_ccpa_enabled:o}}}),apiPatch:({id:t,data:a,queryParams:r={}})=>Object(n.ajax)({type:"PATCH",url:Routes.internal_site_campaign_path(e.siteCachedSlug,t,r),data:a}),apiDelete:({id:t,queryParams:a={no_spinner:!1}})=>Object(n.ajax)({type:"DELETE",url:Routes.internal_site_campaign_path(e.siteCachedSlug,t,a)}),apiGetManyCampaignsTags:({queryParams:t={no_spinner:!0}}={})=>Object(n.ajax)({url:Routes.all_tags_internal_site_campaigns_path(e.siteCachedSlug,t)})})))},"0+rQ":function(e,t,a){"use strict";(function(e){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}a.d(t,"a",(function(){return n}));let n=function(t){var a,n;function i(e){var a;return(a=t.call(this,e)||this).setPaginationPosition=e.setPaginationPosition.bind(null,e.index),a}return n=t,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,r(a,n),i.prototype.render=function(){const{paginationPosition:t,index:a}=this.props,r=classNames("page",{active:t===a});return e.createElement("li",{className:r},e.createElement("a",{href:"#",onClick:this.setPaginationPosition},a))},i}(e.PureComponent)}).call(this,a("q1tI"))},"0Hrz":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return m}));var r=a("vOnD"),n=a("TyAF"),i=a("55Ip"),o=a("Ty5D"),s=a("GaHK"),l=a("sT1B");function c(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const u=Object(r.default)(i.NavLink).withConfig({displayName:"campaign_navigation_launch__NavLinkStyle"})(["display:flex;text-decoration:none;&:hover,&:active,&:focus,&:visited{text-decoration:none;}"]),d=Object(o.o)(Object(n.b)((({rootStore:e})=>({rootStore:e,campaignShowRoot:e.pages.campaignShowRoot})))(Object(n.c)(function(t){function a(...e){var a;return(a=t.call(this,...e)||this).isCampaignLaunchPage=()=>{const{rootStore:e,match:{params:{site_cached_slug:t}},location:r,campaignShowRoot:{currentCampaign:n}}=a.props;return Routes.launch_form_site_campaign_site_path(t,e.urlSpaceParameter,n.id)===r.pathname},a}return c(a,t),a.prototype.render=function(){const{rootStore:t,isSpa:a,campaignShowRoot:{siteCachedSlug:r,currentCampaign:n,launchButtonText:i}}=this.props;return a?e.createElement(u,{exact:!0,to:Routes.launch_form_site_campaign_site_path(r,t.urlSpaceParameter,n.id),className:"js-ga-click","data-category":l.q,"data-action":"nav click",activeStyle:{cursor:"default"},"data-label":"launch_form_site","data-wizard-area":"launch","data-router":!0},e.createElement(s.UIButton,{trait:"success",size:"smaller",disabled:this.isCampaignLaunchPage()},i)):e.createElement(s.UIButton,{trait:"success",size:"smaller",href:Routes.launch_form_site_campaign_site_path(r,t.urlSpaceParameter,n.id),className:"js-ga-click","data-category":l.q,"data-action":"nav click","data-label":"launch_form_site","data-wizard-area":"launch"},i)},a}(e.PureComponent)))),m=Object(o.o)(Object(n.b)((({rootStore:e})=>({campaignShowRoot:e.pages.campaignShowRoot})))(Object(n.c)(function(t){function a(){return t.apply(this,arguments)||this}return c(a,t),a.prototype.render=function(){const{isSpa:t,campaignShowRoot:{currentCampaign:a,checkDeactivationCampaign:r}}=this.props;return e.createElement("div",{className:"mrm"},a.launchable?e.createElement(d,{isSpa:t}):e.createElement(e.Fragment,null,e.createElement(s.UIButton,{onClick:r,size:"smaller",trait:"danger",className:"js-ga-click ac-deactivate-campaign",disabled:a.deactivation.network.get.isLoading,"data-category":l.q,"data-action":"nav click","data-label":"deactivate campaign"},"Deactivate Campaign")))},a}(e.PureComponent))))}).call(this,a("q1tI"))},"0fUD":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("sT1B"),i=a("9iDo");const o=r.types.compose("MultipleCampaignsEditorModalFilterCampaignsCollection",i.a,r.types.model({data:r.types.array(i.c),maxCampaignsToShow:n.X})),s=r.types.compose("MultipleCampaignsEditorModalFilter",i.b,r.types.model({campaigns:r.types.map(o)}))},"1G/5":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return u}));var r=a("99Ma"),n=a("V0vo"),i=a("x7QQ"),o=a("pm75"),s=a("gpnO"),l=a("mxly"),c=a("vrPu");const p=r.types.compose("LoyaltyTierInList",s.a,r.types.model({})).views((e=>({get loyaltyTiersRootStore(){return Object(r.getParentOfType)(e,l.a)},get campaignRulesStore(){return Object(r.getParentOfType)(e,c.a)},get currentIndex(){return this.loyaltyTiersRootStore.sortedTiers.findIndex((t=>t.id===e.id))},get prevTier(){var e;return null==(e=this.loyaltyTiersRootStore.sortedTiers)?void 0:e[this.currentIndex-1]},get nextTier(){var e;return null==(e=this.loyaltyTiersRootStore.sortedTiers)?void 0:e[this.currentIndex+1]},get thresholdGate(){return this.nextTier?`${e.thresholdInUnit} - ${this.nextTier.getThresholdInUnit(this.nextTier.threshold-1)}`:e.thresholdInUnit},get tierDescription(){return`${this.campaignRulesStore.selectedTiersMetric.name} ${this.campaignRulesStore.currentTiersPeriod} \u2022 ${e.active?this.thresholdGate:e.thresholdInUnit}`},get isBaseTier(){return 0===this.currentIndex}}))),u=r.types.compose("LoyaltyRulesData",i.a.array(p),r.types.model({status:r.types.optional(r.types.model({fetching:r.types.optional(o.a,{}),creating:r.types.optional(o.a,{}),updating:r.types.optional(o.a,{}),deleting:r.types.optional(o.a,{})}),{})})).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get isAvailableForAction(){return Object.values(e.status).every((({status:e})=>"in_progress"!==e))},get campaignRulesStore(){return Object(r.getParentOfType)(e,c.a)},getTierById:t=>e.data.find((e=>e.id===t))}))).actions((t=>{const a=Object(r.flow)((function*({queryParams:a}={}){try{t.status.fetching.update("in_progress");const e=yield t.rootStore.services.loyaltyTiersNetworkService.apiGetMany({campaignId:t.campaignRulesStore.campaign.id},a);t.dataApplySnapshot(e.result.tiers),t.status.fetching.update("success")}catch(xhr){t.status.fetching.update("error"),e({message:"Unable to fetch Loyalty campaign tiers",name:"Ajax failure",xhr:xhr})}})),i=Object(r.flow)((function*({campaignId:r,data:i,iconUrl:o}){try{t.status.creating.update("in_progress");const{tier:e}=i,s=_.cloneDeep(e);if(!s.icon)try{s.icon=yield Object(n.k)(o)}catch{throw"CDN failure"}yield t.rootStore.services.loyaltyTiersNetworkService.apiPost({campaignId:r,tier:s,queryParams:{no_spinner:!1}}),yield a({queryParams:{no_spinner:!1}}),t.status.creating.update("success")}catch(xhr){var s,l;if(422!==xhr.status&&e({message:"Unable to update create lo tier",name:"Ajax failure",xhr:xhr}),t.status.creating.update("error"),"CDN failure"!==xhr)throw null==(s=xhr.responseJSON)||null==(l=s.result)?void 0:l.errors;throw new Error("Unable to create loyalty tier")}})),o=Object(r.flow)((function*({campaignId:r,tierId:i,data:o,iconUrl:s}){try{t.status.updating.update("in_progress");const{tier:e}=o,l=_.cloneDeep(e);if(!l.icon&&s)try{l.icon=yield Object(n.k)(s)}catch{throw"CDN failure"}yield t.rootStore.services.loyaltyTiersNetworkService.apiPut({campaignId:r,tierId:i,tier:l,queryParams:{no_spinner:!1}}),yield a({queryParams:{no_spinner:!1}}),t.status.updating.update("success")}catch(xhr){var l,c;if(console.warn(xhr),422!==xhr.status&&e({message:"Unable to update lo campaign tier",name:"Ajax failure",xhr:xhr}),t.status.updating.update("error"),"CDN failure"!==xhr)throw null==(l=xhr.responseJSON)||null==(c=l.result)?void 0:c.errors;throw new Error("Unable to update loyalty tier")}})),s=Object(r.flow)((function*({campaignId:r,tierId:n}){try{t.status.deleting.update("in_progress"),yield t.rootStore.services.loyaltyTiersNetworkService.apiDelete({campaignId:r,tierId:n,queryParams:{no_spinner:!1}}),yield a({queryParams:{no_spinner:!1}}),t.status.deleting.update("success")}catch(xhr){var i,o;throw t.status.deleting.update("error"),422!==xhr.status&&e({message:`Unable to delete Loyalty campaign tier ${n}`,name:"Ajax failure",xhr:xhr}),null==(i=xhr.responseJSON)||null==(o=i.result)?void 0:o.errors}}));return{fetchAll:a,create:i,update:o,delete:s}}))}).call(this,a("B9cq").notifyDevelopers)},"1OfO":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("vOnD"),n=a("GaHK");const i=Object(r.default)(n.UIIcon).withConfig({displayName:"placements_device_preview_icon__IconStyleOverride"})(["margin-right:0;"]),o=({isEnabled:t,device:a,className:r})=>{switch(a){case"mobile":return e.createElement("div",{"aria-label":t?"Show on: Mobile":void 0,"data-balloon-pos":t?"up":void 0,className:r},e.createElement(i,{name:"mobile",fill:t?n.Theme.color.link:n.Theme.color.black50,stroke:t?n.Theme.color.link:n.Theme.color.black50}));case"tablet":return e.createElement("div",{"aria-label":t?"Show on: Tablet":void 0,"data-balloon-pos":t?"up":void 0,className:r},e.createElement(i,{name:"tablet",fill:t?n.Theme.color.link:n.Theme.color.black50}));case"desktop":return e.createElement("div",{"aria-label":t?"Show on: Desktop":void 0,"data-balloon-pos":t?"up":void 0,className:r},e.createElement(i,{name:"desktop",fill:t?n.Theme.color.link:n.Theme.color.black50,width:30}))}};o.defaultProps={isEnabled:!1}}).call(this,a("q1tI"))},"1Vml":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("99Ma");const n=r.types.model("ParentCampaignData",{id:r.types.maybeNull(r.types.number),name:r.types.maybeNull(r.types.string),site_cached_slug:r.types.maybeNull(r.types.string),placement_category_abbreviation:r.types.maybeNull(r.types.string)})},"1kcE":function(e,t,a){(function(e){function t(e,a){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,a)}Widget.AbTestsModalHeader=function(a){var r,n;function i(){return a.apply(this,arguments)||this}return n=a,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,t(r,n),i.prototype.render=function(){const{template:t,headerExtraData:a}=this.props,{text:r,title:n}=Widget.AbTestsModalConstants[t].headerParams;return e.createElement("div",{className:"Locale-entries-assets-uploader-header"},n,r&&e.createElement("p",null,`${r} ${a||""}`))},i}(e.PureComponent)}).call(this,a("q1tI"))},"1rZ2":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("TyAF"),n=a("amyL");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const o=Object(r.b)((({userSettingsRootStore:e})=>({userSettingsRootStore:e})))(Object(r.c)(function(t){var a,r;function o(){return t.apply(this,arguments)||this}return r=t,(a=o).prototype=Object.create(r.prototype),a.prototype.constructor=a,i(a,r),o.prototype.render=function(){const{userSettingsRootStore:t}=this.props;return e.createElement(n.a,{currentUser:t.currentUser})},o}(e.PureComponent)))}).call(this,a("q1tI"))},"2TKB":function(e,t,a){"use strict";a.d(t,"c",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return v}));var r=a("99Ma"),n=a("V0vo"),i=a("sT1B"),o=a("aetS"),s=a("pm75"),l=a("P1f6");const c=r.types.model("PlacementRuleSchema",{pattern:"",regexp:r.types.maybeNull(r.types.boolean)}).views((()=>({}))).actions((()=>({}))),p=r.types.model("PlacementSchema",{appearance:"",category_abbreviation:"",enable_desktop:!1,enable_mobile:!1,enable_tablet:!1,event_category_id:r.types.maybeNull(r.types.number),exclusions:r.types.array(c),id:r.types.maybeNull(r.types.number),inclusions:r.types.array(c),name:"",previewable:!1}).views((()=>({}))).actions((()=>({})));var u=a("cr+I"),d=a.n(u);const m=r.types.compose("CampaignPlacementRule",c,r.types.model({}).views((e=>({get placement(){return Object(r.getParent)(e,2)},get site(){return e.placement.site},get campaignId(){return e.placement.campaignId},get appearance(){return e.placement.appearance},get previewable(){return e.placement.previewable},get showPreview(){return!e.regexp&&![i.Z.PP,i.Z.RG,i.Z.PE].includes(e.placement.category_abbreviation)},get previewUrl(){return e.showPreview&&`${e.site.url}${e.pattern}`||""},get isPostPurchasePattern(){return e.placement.isPurchasePlacement&&!e.pattern},get isPostEventPattern(){return"PE"===e.placement.category_abbreviation},get composePatternTip(){let t="specific site pages";switch(e.pattern){case"":t=e.placement.isPurchasePlacement?"order confirmation page after checkout":e.isPostEventPattern?"post-event page after registering an Event":"all pages";break;case"/":t="homepage only"}return _.upperFirst(t)},get showComposePatternTip(){return!e.placement.isPurchasePlacement&&!e.isPostEventPattern&&e.pattern},get urlText(){let t="";return e.regexp||!e.pattern||e.placement.isPurchasePlacement||(t=e.site.url),e.isPostPurchasePattern||!e.pattern?t+=e.composePatternTip:t+=e.pattern,t},get url(){return Routes.placements_details_site_path(e.site,e.placement.id)},get notPreviewable(){return e.regexp||!e.previewable},get previewableUrl(){let t=d.a.parseUrl(`${e.site.url}${e.pattern}`);return t.query.tkbl_campaign_id=e.campaignId,`${t.url}?${d.a.stringify(t.query)}`},get previewableExplanation(){return e.previewable?"Regular expression":"Does not have preview"}}))).actions((e=>({})))),g=r.types.compose("CampaignPlacement",p,r.types.model({exclusions:r.types.array(m),inclusions:r.types.array(m)}).views((e=>({get site(){return Object(r.getParent)(e).site},get siteEventCategories(){return e.site.event_categories},get campaignId(){return Object(r.getParent)(e).id},get isPurchasePlacement(){return _.some(e.eventCategory)&&"purchase"===e.eventCategory.identifier},get eventCategory(){return _.find(e.siteEventCategories,{id:e.event_category_id})}}))).actions((e=>({})))),h=r.types.model("CampaignLatestChange",{created_at:r.types.maybeNull(r.types.string),email:r.types.maybeNull(r.types.string)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get site(){return this.rootStore.models.site},get formattedCreatedAt(){return Object(n.l)(this.site.getDateInSiteTimezone(e.created_at))},get formattedCreatedAtWithoutTime(){return Object(n.n)(this.site.getDateInSiteTimezone(e.created_at))}}))),y=r.types.model("ConstantsData",{MIN_SUITABLE_VERSION_FOR_PLACEMENTS:""}),f=r.types.model("CampaignSchema",{id:r.types.identifierNumber,activates_at:r.types.maybeNull(r.types.string),created_at:r.types.maybeNull(r.types.string),expires_at:r.types.maybeNull(r.types.string),appearance:r.types.optional(r.types.string,"inline"),deletable:r.types.boolean,constants:r.types.optional(y,{}),gleam:r.types.boolean,launchable:r.types.maybeNull(r.types.boolean),leaderboard:r.types.boolean,name:r.types.string,normalized_preset_name:r.types.string,placement:r.types.optional(g,{}),placement_category_abbreviation:r.types.maybeNull(r.types.union(r.types.literal("SA"),r.types.literal("PE"),r.types.literal("PP"),r.types.literal("RG"),r.types.literal("FW"),r.types.literal("EC"),r.types.literal("LO"))),placement_category:r.types.maybeNull(r.types.string),preset_name:r.types.string,static_widget:r.types.string,status:r.types.enumeration("Status",_.values(i.w)),tag_names:r.types.array(r.types.string),test_mode:r.types.boolean,ip_address_filtering_mode:r.types.maybeNull(r.types.string),ip_address_filtering_value:r.types.maybeNull(r.types.string),personal_coupon_list_id:r.types.maybeNull(r.types.number),space:r.types.maybeNull(r.types.union(r.types.literal("conversion"),r.types.literal("loyalty")))}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return this.rootStore.siteCachedSlug},get site(){return this.rootStore.models.site},get siteTimeZoneName(){return this.site.time_zone_name},get siteTimeZoneIdentifier(){return this.site.time_zone_identifier},get formattedIpAddressFilteringMode(){return"hide"===e.ip_address_filtering_mode?"hidden":"shown"},get formattedStatus(){return e.status.toLowerCase()},get isDisabled(){return"Disabled"===e.status},get staticWidgetEnabled(){return"1"===e.static_widget},get staticWidgetPolling(){return this.staticWidgetEnabled&&"live"===this.formattedStatus},get humanizedAppearance(){return _.upperFirst(e.appearance)},get humanizedPresetName(){return _.upperFirst(e.preset_name)},get humanizedCreatedAt(){return Object(n.a)({value:e.created_at,timeZoneName:this.siteTimeZoneName,timeZoneIdentifier:this.siteTimeZoneIdentifier})},get referralSpace(){return _.isNull(e.space)},get conversionSpace(){return"conversion"===e.space},get loyaltySpace(){return"loyalty"===e.space}}))),b=r.types.compose("CampaignCommon",f,s.c,r.types.model("CampaignSchemaCommon",{deleteModal:r.types.optional(o.a,{}),deactivation:r.types.optional(l.a,{})})).views((e=>({get isDeletable(){return e.deletable&&!e.rootStore.isLoyaltySpace},get diffAvailable(){return e.rootStore.isStaffMember&&!e.rootStore.isLoyaltySpace},get themeStoreAvailable(){return e.rootStore.isStaffMember&&!e.rootStore.isLoyaltySpace},get isReferralTestOfferAvailable(){return!e.gleam&&e.rootStore.isReferralSpace},get isCopyAvailable(){return!e.rootStore.isLoyaltySpace}}))),v=r.types.compose("Campaign",b,r.types.model("CampaignSchema",{placement_id:r.types.maybeNull(r.types.number),active:r.types.boolean,latest_change:r.types.maybeNull(h),offers_count_with_limit:r.types.number})).views((e=>({get formattedOffersCountWithLimit(){return Object(n.o)({value:e.offers_count_with_limit})}})))},"2ZiZ":function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a("99Ma"),n=a("BpJz"),i=a("BYlJ"),o=a("Ov1f"),s=a("UEOA"),l=a("c7RZ");const c=r.types.model("OriginData",{blocked_by_ip:r.types.maybeNull(r.types.boolean),cookie:r.types.maybeNull(r.types.string),coupons:r.types.maybeNull(r.types.array(l.a)),created_at:r.types.maybeNull(r.types.string),event_category_identifier:r.types.maybeNull(r.types.string),firs_time:r.types.maybeNull(r.types.boolean),ip_address:r.types.maybeNull(r.types.string),order_number:r.types.maybeNull(r.types.string),subtotal:r.types.maybeNull(r.types.string),type:r.types.maybeNull(r.types.string)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get formattedCreatedAt(){return e.rootStore.models.site.formatDate(e.created_at)}}))),p=r.types.model("PeopleStore",{person:r.types.maybeNull(n.a),rewards:r.types.maybeNull(r.types.array(i.a,[])),unredeems:r.types.maybeNull(r.types.array(o.a,[])),incentives:r.types.maybeNull(r.types.array(s.a,[])),claim_unredeem_reason:r.types.maybeNull(r.types.string),origin:r.types.maybeNull(c)}).views((e=>({get showRewardsBlock(){return e.someRewards||e.someUnredeems||e.someIncentives},get showIncentivesBlock(){return e.someIncentives&&!e.someRewards&&!e.someUnredeems},get someRewards(){return _.some(e.rewards)},get someUnredeems(){return _.some(e.unredeems)},get allRewardsCount(){return e.rewards.length+e.unredeems.length},get someIncentives(){return _.some(e.incentives)},get currentRewards(){return e.rewards},unredeemReason:t=>e.claim_unredeem_reason||e.unredeems.length&&e.unredeems[0].human_unredeem_reason||`No ${_.capitalize(t)} Referral Incentive`}))).actions((e=>({})))},"2fvL":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("M+GS"),i=a("KA3C");const o=r.types.model({name:r.types.maybeNull(r.types.string),coupons_mode:"manual",coupons_codes:"",upload_file:r.types.frozen(),upload_file_root:"",expires_at:r.types.maybeNull(r.types.string)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get incentiveFormStore(){return Object(r.getParentOfType)(e,i.a)},get rewardType(){return e.incentiveFormStore.incentiveData.percentage_discount?`${e.incentiveFormStore.incentiveData.amount}%`:`${e.rootStore.models.site.currency_unit}${e.incentiveFormStore.incentiveData.amount}`},get title(){return e.rewardType},get amount(){return e.incentiveFormStore.incentiveData.amount},get percentage_discount(){return e.incentiveFormStore.incentiveData.percentage_discount}}))).actions((e=>({initialData(){e.name=`${e.rewardType} list | ${dayjs().format("MMMM YYYY")}`},clearData(){e.name=null,e.coupons_mode="manual",e.coupons_codes="",e.upload_file=null,e.upload_file_root="",e.expires_at=""},updateKey({target:{name:t,value:a}}){e[t]=a},updateExpiresAt(t){e.expires_at=t},updateUploadFile(t){e.upload_file=null!==t.target.files?t.target.files[0]:"",e.upload_file_root=t.target.value},clearUploadFile(){e.upload_file=null,e.upload_file_root=""}}))),s=r.types.model({id:r.types.identifierNumber,amount:r.types.maybeNull(r.types.number),name:r.types.maybeNull(r.types.string),percentage_discount:r.types.maybeNull(r.types.boolean),site_id:r.types.maybeNull(r.types.number),total_coupons_count:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),expires_at:r.types.maybeNull(r.types.string),updated_at:r.types.maybeNull(r.types.string)}),l=r.types.model("CouponListStore",{coupon_lists:r.types.optional(r.types.map(s),{}),fetchedLists:!1,isShowCouponForm:!1,couponForm:r.types.optional(o,{}),errors:r.types.optional(r.types.map(r.types.array(r.types.string)),{}),submitting:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get incentiveFormStore(){return Object(r.getParentOfType)(e,i.a)},get optionsCouponLists(){const t=[{label:"Please choose",value:""}],a=[];return e.coupon_lists.forEach((t=>{Number(t.amount)===Number(e.incentiveFormStore.incentiveData.amount)&&t.percentage_discount===e.incentiveFormStore.incentiveData.percentage_discount&&a.push(t)})),a.forEach((a=>{const r=a.percentage_discount?`${a.amount}%`:`${e.rootStore.models.site.currency_unit}${a.amount}`;t.push({label:`${a.name} (${r}), ${a.expires_at?`expires at ${dayjs(a.expires_at).format("MM/DD/YYYY")}`:"never expires"} `,value:String(a.id),expires:a.expires_at,created_at:a.created_at,showTotalCouponCount:Object(n.j)(a.created_at),total_coupons_count:a.total_coupons_count})})),t},findCouponListsByValue:({value:t})=>e.optionsCouponLists.find((e=>String(e.value)===String(t)))}))).actions((t=>({fetchData(a=!0){a&&(t.fetchedLists||$.get(Routes.internal_site_coupon_lists_path(t.siteCachedSlug,{no_spinner:!0,space:t.rootStore.space})).then((e=>{t.updateLists(e.result.coupon_lists)})).fail((t=>{e({name:"Unable to get coupon lists",message:"Ajax failure",xhr:t})})))},updateLists(e){t.fetchedLists=!0,e.forEach((e=>t.coupon_lists.set(e.id,s.create(e))))},addItemToLists(e){t.coupon_lists.set(e.id,s.create(e))},toggleCouponForm(){t.isShowCouponForm=!t.isShowCouponForm,t.isShowCouponForm?t.couponForm.initialData():(t.couponForm.clearData(),t.clearData())},updateSubmitting(e){t.submitting=e},create(){let e;e=new FormData,e.append("coupon_list[name]",t.couponForm.name),e.append("coupon_list[amount]",t.couponForm.amount),e.append("coupon_list[expires_at]",t.couponForm.expires_at),e.append("coupon_list[percentage_discount]",t.couponForm.percentage_discount),"manual"===t.couponForm.coupons_mode?e.append("coupon_list[coupons_codes]",t.couponForm.coupons_codes):e.append("coupon_list[upload_file]",t.couponForm.upload_file),e.append("space",t.rootStore.space),t.updateSubmitting(!0),$.ajax({url:Routes.internal_site_coupon_lists_path(t.siteCachedSlug),type:"POST",contentType:!1,processData:!1,data:e}).then((e=>{const{result:{coupon_list:a}}=e;t.addItemToLists(a),t.incentiveFormStore.incentiveData.onChangeByKey({target:{name:"coupon_list_id",value:a.id}}),t.updateSubmitting(!1),t.clearErrors(),t.toggleCouponForm()})).fail((e=>{t.updateSubmitting(!1);const a=_.get(e,"responseJSON.result.errors",{});t.updateErrors(a);const r=_.mapKeys(a,((e,t)=>`couponList.${t}`));Validation.fail(r,!1)}))},clearData(){Validation.clear(),t.isShowCouponForm=!1,t.couponForm={},t.clearErrors()},updateErrors(e){t.errors.replace(e)},clearErrors(){t.errors.clear()}})))}).call(this,a("B9cq").notifyDevelopers)},"2zfS":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("sT1B"),i=a("V0vo");const o=r.types.model("FieldInHoursStore",{delay:0,period:"hours"}).views((e=>({get selectOptions(){return[{label:"Hours",value:"hours"},{label:"Days",value:"days"}]}}))).actions((e=>({init(t){e.delay=t%n.gb.HOURS_IN_DAY===0?t/n.gb.HOURS_IN_DAY:t,e.period=Object(i.C)(t)?"days":"hours"},updatePeriod(t){e.period=t},updateDelay(t){e.delay=t}})))},"38EH":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("I2ID"),i=a("K+ho"),o=a("aFzQ");const s=r.types.compose("PlacementsNewPage",i.a,r.types.model("PlacementsNewPage",{}).views((()=>({}))).actions((t=>({init(e){try{t.updatePlacementData(Object(n.a)({category:e,platform:t.rootStore.models.site.platform,eventCategories:t.rootStore.models.site.event_categories}));const{available:a,ineligible:r}=Object(n.c)({campaigns:Object(o.toJS)(t.placementsRootPage.campaigns.data),category:e});t.updateCampaignsFilter({available:a,ineligible:r}),t.isDataLoaded=!0}catch{t.rootStore.models.router.push(Routes.placements_index_site_path(t.siteCachedSlug))}},attachCampaigns:Object(r.flow)((function*(a){const r=t.campaignsFilter.availableCampaigns.selectedCampaigns.map((r=>{const n=t.placementsRootPage.campaigns.data.find((e=>e.id===r.id));return t.rootStore.services.campaignsNetworkService.apiPatch({id:n.id,data:{campaign:{placement_id:a}}}).catch((t=>(e({name:"Unable to destroy campaign",message:"Ajax failure",xhr:t}),t)))}));yield Promise.all(r)})),goToPlacementPage(e){t.rootStore.models.router.push(Routes.placements_details_site_path(t.siteCachedSlug,e))},handleCancel(){t.init(t.category)},handleCreate:Object(r.flow)((function*(a){if(null==a||a.preventDefault(),t.validate(),t.placementData.isValid){t.placementData.resetErrors();try{t.submit.updateLoading(!0);const{result:e}=yield t.placementsRootPage.placements.apiPost(Object(n.b)(Object(o.toJS)(t.placementData)));yield t.attachCampaigns(e.campaign_placement.id),yield t.placementsRootPage.init(),UINotifications.showSuccessFlash("Placement was created successfully"),t.goToPlacementPage(e.campaign_placement.id)}catch(xhr){var i,s;const r=null==xhr||null==(i=xhr.responseJSON)||null==(s=i.result)?void 0:s.errors;r?(t.placementData.updateErrors(r),Validation.scrollToField(r)):(UINotifications.showErrorFlash(),e({name:"Unable to create placement",message:"Ajax failure",xhr:xhr}))}finally{Object(r.isAlive)(t)&&t.submit.updateLoading(!1)}}}))}))))}).call(this,a("B9cq").notifyDevelopers)},"3CKC":function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("M+GS"),i=a("x7QQ"),o=a("pm75");const s=r.types.model("CouponListSchema",{id:r.types.maybeNull(r.types.number),name:r.types.maybeNull(r.types.string),total_coupons_count:0,expires_at:r.types.maybeNull(r.types.string),created_at:r.types.maybeNull(r.types.string)}).views((e=>({get time_zone_identifier(){return Object(r.getRoot)(e).models.site.time_zone_identifier},get formattedExpiresAt(){return e.expires_at?dayjs(e.expires_at).tz(e.time_zone_identifier).format("MM/DD/YYYY"):"never expired"},get showTotalCouponCount(){return Object(n.j)(e.created_at)}}))).actions((()=>({}))),l=r.types.compose("CouponListData",i.a.model(s),o.c)},"3R0T":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("99Ma");const n=r.types.model("MetricStore",{id:r.types.maybeNull(r.types.number),description:r.types.maybeNull(r.types.string),type:r.types.maybeNull(r.types.string),result_type:r.types.maybeNull(r.types.string),human_type:r.types.maybeNull(r.types.string),identifier:"",name:"",visible:!1}).views((e=>({}))).actions((e=>({})));n.create()},"3u+K":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return p}));var r=a("4b23"),n=a("99Ma"),i=a("V0vo"),o=a("x7QQ"),s=a("pm75"),l=a("l91a");const c=n.types.model("CampaignWarningSchema",{id:n.types.maybeNull(n.types.string),category:n.types.maybeNull(n.types.string),description:n.types.maybeNull(n.types.string),email_digest:n.types.maybeNull(n.types.boolean),errors:n.types.frozen(),link:n.types.maybeNull(n.types.string),severity:n.types.maybeNull(n.types.string),significant:n.types.maybeNull(n.types.boolean),title:n.types.maybeNull(n.types.string),target_id:n.types.maybeNull(n.types.number),validation_context:n.types.frozen()}),p=n.types.compose("CampaignWarningsData",o.a.array(c),s.c,n.types.model({storeIsActive:!1}).volatile((()=>({requestQ:new l.a,ajaxTimeouts:[]}))).views((e=>({get rootStore(){return Object(n.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get notSignificantWarnings(){return e.data.filter((e=>!e.significant))},get significantWarnings(){return e.data.filter((e=>e.significant))},get isSignificantSeverities(){return e.significantWarnings.length>0}}))).actions((t=>({activateStore(){t.storeIsActive=!0},clearStore(){Object(n.applySnapshot)(t,{})},normalizeData:(e=[])=>e.map((e=>({...e,id:Object(r.a)()}))),apiGet:Object(n.flow)((function*({id:a,count:r,instantly:i=!1}){t.network.get.updateLoading(!0),t.network.get.updateLoaded(!1);try{const{result:e}=yield t.requestQ.ajax({url:Routes.warnings_internal_site_campaign_path(t.siteCachedSlug,a),data:{no_spinner:!0,instantly:i}});t.storeIsActive&&(e.lazy_loading?t.continuePolling({id:a,count:r}):(t.dataApplySnapshot(t.normalizeData(null==e?void 0:e.warnings)),t.network.get.updateLoading(!1),t.network.get.updateLoaded(!0)))}catch(xhr){"abort"!==xhr.statusText&&Object(n.isAlive)(t)&&t.network.get.updateLoading(!1),e({name:"Unable to get campaign warnings",message:"Ajax failure",xhr:xhr})}})),startPolling:({id:e,count:a,instantly:r})=>{t.activateStore();const n=Object(i.h)(a),o=setTimeout((()=>{t.apiGet({id:e,count:a,instantly:r}),t.ajaxTimeouts.pop()}),n);t.ajaxTimeouts.push(o)},continuePolling({id:e,count:a}){t.startPolling({id:e,count:a+1})},killAjaxRequests:()=>{t.ajaxTimeouts.forEach((e=>{clearTimeout(e)})),t.ajaxTimeouts=[],t.requestQ.clear()}}))))}).call(this,a("B9cq").notifyDevelopers)},"4Amn":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("BpJz");const i=r.types.model("VisitorOfferStore",{status:r.types.maybeNull(r.types.string),cookie:r.types.maybeNull(r.types.string),fraud_reason:r.types.maybeNull(r.types.string),ip_address:r.types.maybeNull(r.types.string),person:r.types.maybeNull(n.a),type:r.types.maybeNull(r.types.string)}).views((e=>({})));var o=a("Ov1f"),s=a("9ird"),l=a("BYlJ");const c=r.types.model("ShareFriendStore",{journey:r.types.optional(r.types.array(s.a),[]),rewards:r.types.optional(r.types.array(l.a),[]),unredeems:r.types.maybeNull(r.types.array(o.a,[])),visitor_offer:r.types.optional(i,{})}).views((e=>({}))).actions((e=>({})))},"4mPH":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return p})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return d}));var r=a("sT1B"),n=a("HzpY");const i=e=>r.e[e],o=e=>{switch(e){case r.Z.PP:case r.Z.PE:return r.l.POPUP;case r.Z.FW:return r.l.WIDGET;case r.Z.SA:return r.l.INLINE;case r.Z.RG:return r.l.GLEAM}},s=e=>({..._.pick(e,["pattern","regexp"]),pattern:e.regexp?e.pattern:e.pattern.replaceAll(" ","")}),l=["id","event_category_id","appearance","name","enable_desktop","enable_tablet","enable_mobile","inclusions","exclusions"],c=e=>{const t=_.pick(e,l);return t.inclusions=t.inclusions.map(s),t.exclusions=t.exclusions.map(s),t},p=e=>e.map(c),u=({campaign:e,category:t})=>e.appearance===o(t),d=e=>e.some((e=>e.checked&&Object(n.d)(e)))},"4oum":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a("2TKB"),n=a("pm75"),i=a("99Ma"),o=a("x7QQ"),s=a("B9cq");const l=i.types.compose("CampaignsData",o.a.array(r.a),n.c).views((e=>({get rootStore(){return Object(i.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},getCampaignsById:t=>e.data.filter((e=>t.includes(e.id)))}))).actions((e=>({apiGet:Object(i.flow)((function*(t={}){e.network.get.updateLoading(!0);try{var a;const r=yield Object(s.ajax)({url:Routes.internal_site_campaigns_path(e.siteCachedSlug,t)});e.dataApplySnapshot(null==r||null==(a=r.result)?void 0:a.campaigns),e.network.get.updateLoaded(!0)}catch(xhr){console.warn(xhr)}finally{Object(i.isAlive)(e)&&e.network.get.updateLoading(!1)}})),reset:()=>{Object(i.applySnapshot)(e,{})}})))},"52sZ":function(e,t,a){"use strict";(function(e){a.d(t,"b",(function(){return T})),a.d(t,"a",(function(){return A}));var r=a("nKCY"),n=a("UlA6"),i=a("99Ma"),o=a("LhCv"),s=a("V0vo"),l=a("wB/l"),c=a("iZUv"),p=a("gQCd"),u=a("rToH"),d=a("EcW+"),m=a("EAOr"),g=a("af5v"),h=a("broW"),y=a("uZue"),f=a("nKL8"),b=a("YVJR"),v=a("DNDY"),S=a("soYR"),w=a("BYad"),C=a("m0wF"),E=a("7uY6"),N=a("g1Iw"),O=a("varW"),x=a("/tsJ"),I=a("YPDw"),P=a("I4NK");const R=i.types.model({router:i.types.optional(l.a,{}),site:i.types.optional(h.a,{cached_slug:window.CurrentSiteCachedSlug||_.get(window,"Site.cached_slug","")}),currentUser:i.types.optional(g.a,{...window.current_user}),siteSplitTests:i.types.optional(d.a,{}),sitePlacements:i.types.optional(m.b,{}),sitePersonalCouponLists:i.types.optional(S.a,{}),staticWidgets:i.types.optional(N.a,{})}),j=i.types.model({campaignsIndex:i.types.optional(c.a,{}),campaignsNewPage:i.types.optional(p.a,{}),campaignShowRoot:i.types.optional(u.a,{}),customerServiceStore:i.types.optional(O.a,{}),accessRequestPage:i.types.optional(f.a,{}),dashboardTilesStore:i.types.optional(b.a,{}),siteEditPage:i.types.optional(y.a,{}),integrationPage:i.types.optional(v.a,{}),appStorePage:i.types.optional(C.a,{}),personalCouponFormStore:i.types.optional(w.a,{}),multipleCampaignEditorModalPage:i.types.optional(E.a,{}),loyaltyMembersReportPage:i.types.optional(P.a,{})}),D=i.types.model({campaignsNetworkService:i.types.optional(x.a,{}),loyaltyTiersNetworkService:i.types.optional(I.a,{})}),k=i.types.model("RootStore",{models:i.types.optional(R,{}),pages:i.types.optional(j,{}),services:i.types.optional(D,{}),shouldRenderSpa:!1,space:i.types.optional(i.types.union(i.types.literal("referral"),i.types.literal("conversion"),i.types.literal("loyalty")),"referral")}).views((e=>({get isStaffMember(){return e.models.currentUser.staffMember},get isReferralSpace(){return"referral"===e.space},get isConversionSpace(){return"conversion"===e.space},get isLoyaltySpace(){return"loyalty"===e.space},get urlSpaceParameter(){return Object(s.w)(e.space)},get siteCachedSlug(){return e.models.site.siteCachedSlug},get roleRoutes(){const{currentUser:t}=e.models;return{[Routes.site_path(".+")]:{canHaveAccess:Object(s.d)(t,"read"),piiAccessRequired:!1},[Routes.site_customer_service_path(".+")]:{canHaveAccess:Object(s.d)(t,"csp_only"),piiAccessRequired:!0},[Routes.customer_service_portal_site_path(".+","create_referral")]:{canHaveAccess:!t.isReadOnlyRole,piiAccessRequired:!0},[Routes.edit_site_path(".+")]:{canHaveAccess:Object(s.d)(t,"read"),piiAccessRequired:!1},[Routes.site_campaigns_path(".+")]:{canHaveAccess:Object(s.d)(t,"read"),piiAccessRequired:!1},[Routes.integration_site_path(".+")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.site_campaign_path(".+",".+")]:{canHaveAccess:Object(s.d)(t,"read"),piiAccessRequired:!1},[Routes.site_new_campaign_path(".+")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.edit_site_campaign_path(".+",".+")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.fraud_site_path(".+")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.site_web_hooks_path(".+")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.placements_new_site_path(".+",".+")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.placements_edit_site_path(".+",".+")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.custom_domains_site_path(".+")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.edit_site_path(".+","enterprise")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.edit_site_path(".+","referral_attribution")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.app_store_site_path(".+")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.edit_site_path(".+","notifications")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.edit_site_path(".+","integration")]:{canHaveAccess:Object(s.d)(t,"write"),piiAccessRequired:!1},[Routes.edit_site_path(".+","enterprise")]:{canHaveAccess:t.staff_member,piiAccessRequired:!1}}},get getSpaRootRoute(){return _.keys(e.roleRoutes).reduce(((t,a)=>(new RegExp(a).test(e.models.router.location.pathname)&&(t=a),t)),"")},get matchCSPRoute(){return new RegExp(Routes.site_customer_service_path(".+")).test(e.models.router.location.pathname)},get accessibleSite(){return e.models.currentUser.accessible_sites.find((t=>t.id===e.models.site.id))},get havePiiAccess(){return _.get(e.accessibleSite,"pii",!1)},get haveAccess(){return _.get(e.roleRoutes[e.getSpaRootRoute],"canHaveAccess")&&_.some(e.accessibleSite)},get routeNeedPiiAccess(){return _.get(e.roleRoutes[e.getSpaRootRoute],"piiAccessRequired")},get canReceiveData(){return e.haveAccess&&(!e.routeNeedPiiAccess||e.havePiiAccess)},get needRedirectToTFA(){const{currentUser:{staffMember:t,tfa_enabled:a}}=e.models;return t&&!a}}))).actions((t=>({afterCreate(){t.updateSpace(Object(s.t)(location.pathname)),t.fetchInitialData(t.models.site.cached_slug),Object(i.onPatch)(t,(({path:e,value:a})=>{switch(e){case"/models/router/location/pathname":_.endsWith(a,"/")&&t.models.router.replace(_.trimEnd(a,"/")+window.location.search)}})),Object(i.addMiddleware)(t,((e,a,r)=>{switch(e.name){case"_updateLocation":{const a=Object(n.d)(t.models.router.location.pathname),r=Object(n.d)(_.get(e,"args.0.pathname"));_.isEqual(a,r)||t.fetchInitialData(r);break}}a(e)}))},updateSpace(e){t.space=e,Object(s.M)(e)},updateShouldRenderSpa:e=>{t.shouldRenderSpa=e},goToTwoFactorModal:()=>{Object(s.x)()},fetchSiteAndCurrentUser:Object(i.flow)((function*(e){yield Promise.all([t.models.site.fetch(e),t.models.currentUser.fetch()])})),fetchInitialData:Object(i.flow)((function*(a){try{t.updateShouldRenderSpa(!1),yield t.fetchSiteAndCurrentUser(a),t.updateShouldRenderSpa(!0)}catch(xhr){e({name:"Unable to fetch current user data and site data",message:"Ajax failure",xhr:xhr})}})),goToAnotherSite(e){t.models.router.push(Routes.site_path(e))}}))),T=Object(r.a)(k.create()),A=Object(l.b)(Object(o.a)(),T.models.router)}).call(this,a("B9cq").notifyDevelopers)},"5OB8":function(e,t,a){"use strict";(function(e){a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i}));const r=({response:e,configurationErrorsHandler:t,actionsErrorsHandler:a,criteriaErrorsHandler:r,onError:o})=>{n({errors:i({response:e,onError:o}),configurationErrorsHandler:t,actionsErrorsHandler:a,criteriaErrorsHandler:r})},n=({errors:e,configurationErrorsHandler:t=(()=>{}),actionsErrorsHandler:a=(()=>{}),criteriaErrorsHandler:r=(()=>{})})=>{e&&Object.keys(e).forEach((n=>{"configuration"===n&&_.isFunction(t)&&t(e[n]),"actions.configuration"===n&&_.isFunction(a)&&a(e[n]),"criteria"===n&&_.isFunction(a)&&r({[n]:e[n]})}))},i=({response:t,onError:a})=>{var r,n;const i=null==(r=t.responseJSON)||null==(n=r.result)?void 0:n.errors;if(i)return i;"function"===typeof a&&a(),Validation.showErrorFlash(),e({name:"App store failed response",message:"Ajax failure",xhr:t})}}).call(this,a("B9cq").notifyDevelopers)},"5Sw6":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("Md/s"),n=a("ne91");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let o=function(t){var a,o;function s(){return t.apply(this,arguments)||this}return o=t,(a=s).prototype=Object.create(o.prototype),a.prototype.constructor=a,i(a,o),s.prototype.render=function(){const{isSitePersisted:t,isReadRole:a,currentSiteCachedSlug:i,locationRouter:o}=this.props;return t&&a&&e.createElement(r.f,{"data-testid":"ac-subheader-conversion-container"},e.createElement("div",{className:"App-container-inner"},e.createElement(r.g,null,e.createElement("div",{className:"flex align-items-center"},e.createElement(r.h,{isActive:location.pathname===Routes.conversion_site_path(i),href:Routes.conversion_site_path(i),locationRouter:o},"Dashboard"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.campaigns_site_path(i,"conversion")),href:Routes.campaigns_site_path(i,"conversion"),locationRouter:o},"Campaigns"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.site_conversion_metrics_aggregation_path(i)),href:Routes.site_conversion_metrics_aggregation_path(i)},"Metrics"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.site_conversion_offers_path(i)),href:Routes.site_conversion_offers_path(i)},"Offers"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.site_conversion_rewards_path(i)),href:Routes.site_conversion_rewards_path(i)},"Rewards"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.site_conversion_purchases_path(i)),href:Routes.site_conversion_purchases_path(i)},"Purchases"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.site_coupon_lists_path(i,"conversion")),href:Routes.site_coupon_lists_path(i,"conversion")},"Coupon Lists"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.site_customer_emails_path(i,"conversion")),href:Routes.site_customer_emails_path(i,"conversion")},"Emails")))))},s}(e.PureComponent)}).call(this,a("q1tI"))},"5gN9":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("4b23");function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let i=function(t){var a,r;function i(a){var r;return(r=t.call(this,a)||this).getValue=()=>{r.field.current.value},r.setValue=e=>{e&&(r.field.current.value=e)},r.initTextAreaAutoSize=()=>{autosize($(r.field.current))},r.field=e.createRef(),r}r=t,(a=i).prototype=Object.create(r.prototype),a.prototype.constructor=a,n(a,r);var o=i.prototype;return o.componentDidMount=function(){this.props.autoSize&&this.initTextAreaAutoSize()},o.componentDidUpdate=function(){this.props.autoSize&&$(this.field.current).trigger("input")},o.render=function(){const{autoSize:t,placeholder:a,rows:r,id:n,name:i,text:o,disabled:s,onChange:l}=this.props;return e.createElement("textarea",{className:classNames(`form-textarea ${this.props.class}`,{"is-autosize":this.props.autoSize}),style:t?{resize:"none"}:{},placeholder:a,"data-validate-block":this.props["data-validate-block"],rows:r,id:n,name:i,ref:this.field,value:o,onChange:l,disabled:s})},i}(e.Component);i.defaultProps={class:"",rows:"",placeholder:"",onChange:()=>{},id:`textarea-${Object(r.a)()}`,name:"","data-validate-block":"",autoSize:!1}}).call(this,a("q1tI"))},"5uFb":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return u}));var r,n,i=a("vOnD"),o=a("GaHK"),s=a("ZQwf"),l=a("TyAF");function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const p=Object(i.default)(s.b).withConfig({displayName:"campaigns_filter_offers_cell__CellStyleOverride"})(["width:",";",""],(({width:e})=>e),(({align:e})=>e&&Object(i.css)(["text-align:",";"],e))),u=Object(l.c)((n=r=function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,c(a,r),n.prototype.render=function(){const{width:t,align:a,campaign:{formattedOffersCountWithLimit:r}}=this.props;return e.createElement(p,{width:t,align:a},e.createElement(o.BodyS,{color:o.Theme.color.black100},r))},n}(e.PureComponent),r.defaultProps={width:"70px",align:"left"},n))}).call(this,a("q1tI"))},"7GQj":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return d}));var r=a("TyAF"),n=a("kEQf"),i=a("TCJX"),o=a("sT1B"),s=a("nKCY"),l=a("pX3F"),c=a("52sZ"),p=a("Ty5D");function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let d=function(t){var a,d;function m(...e){var a;return(a=t.call(this,...e)||this).closeModal=()=>{Object(l.a)()},a.getInitialSiteCachedSlug=({modalType:e,siteCachedSlug:t})=>"themeStore"!==e?t:t!==o.eb?o.eb:null,a}d=t,(a=m).prototype=Object.create(d.prototype),a.prototype.constructor=a,u(a,d);var g=m.prototype;return g.componentWillUnmount=function(){document.body.removeChild(document.getElementById(o.y))},g.render=function(){const{campaign:t,site:a,currentUser:o,isSpa:l,modalType:u}=this.props;return e.createElement(r.a,{campaignCopyStore:Object(s.a)(i.a.create({values:{id:t.id,name:`Copy of ${t.name}`,cached_slug:this.getInitialSiteCachedSlug({modalType:u,siteCachedSlug:a.cached_slug})},isSpa:l,site:a,currentUser:o,modalType:u}))},e.createElement(p.e,{history:c.a},e.createElement(n.a,{actionClose:this.closeModal,actionOverlay:this.closeModal})))},m}(e.PureComponent)}).call(this,a("q1tI"))},"7uY6":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("0fUD"),i=a("V0vo"),o=a("B9cq");const s=r.types.model("MultipleCampaignEditorLocalizations",{id:r.types.maybeNull(r.types.string),localization:r.types.maybeNull(r.types.string),value:r.types.maybeNull(r.types.string),currentView:r.types.maybeNull(r.types.string),checked:!0,copyingStatus:r.types.optional(r.types.union(r.types.literal("pending"),r.types.literal("success"),r.types.literal("error")),"pending"),errors:r.types.optional(r.types.frozen(),{})}).actions((e=>({updateCheckbox:t=>{e.checked=t},updateCopyingStatus:t=>{e.copyingStatus=t},changeCheckbox:()=>{e.checked=!e.checked}}))),l=r.types.model("multipleCampaignEditorModalPage",{localizations:r.types.array(s),campaignsFilter:r.types.optional(n.a,{}),campaignsFetched:!1,campaignId:r.types.maybeNull(r.types.number),step:1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get viewSetupsWithLocalizations(){return _.transform(_.groupBy(e.localizations,"currentView"),((e,t,a)=>{e.push({currentView:a,children:t})}),[])},get selectedLocalizations(){return this.localizations.filter((e=>e.checked))},get localizationsForGettingCampaigns(){return e.selectedLocalizations.map((e=>e.localization))},get noLocalizationsSelected(){return _.isEmpty(e.selectedLocalizations)},get selectedCampaigns(){var t;return null==(t=e.campaignsFilter.availableCampaigns)?void 0:t.selectedCampaigns},get selectedCampaignsIds(){return e.selectedCampaigns.map((e=>e.id))},get noSelectedCampaigns(){return _.isEmpty(e.selectedCampaigns)},currentViewLocalizations:e=>t=>t.currentView===e,currentViewCheckbox:t=>e.localizations.filter(e.currentViewLocalizations(t)).every((e=>e.checked)),humanizeCurrentView:e=>Object(i.z)(e)}))).actions((t=>({reset:()=>{Object(r.applySnapshot)(t,{})},increaseStep:()=>{t.step=t.step+1},decreaseStep:()=>{t.step=t.step-1},updateSessionStorage:e=>{const t=JSON.parse(sessionStorage.getItem("localizations_batches")),a=null==t?void 0:t.filter((t=>t.id!==e));sessionStorage.setItem("localizations_batches",JSON.stringify(a))},deleteLocalization:e=>{const a=t.localizations.filter((t=>t.id!==e));t.updateSessionStorage(e),t.updateLocalizations(a)},updateLocalizations:e=>{Object(r.applySnapshot)(t.localizations,e)},updateViewCheckbox:e=>{const a=e.target.name,r=!t.currentViewCheckbox(a);t.localizations.filter(t.currentViewLocalizations(a)).forEach((e=>{e.updateCheckbox(r)}))},updateCampaignId:e=>{t.campaignId=e},normalizedLocalizations:({localizations:e,sessionStorage:a})=>{const r=_.flatten(_.values(e)),n=JSON.parse(a.getItem("localizations_batches")).reduce(((e,a)=>{if(t.campaignId===a.campaignId){let t=r.find((e=>Number(e.id)===Number(a.id)));e.push({id:a.id,localization:t.key,value:a.value,currentView:a.currentView})}return e}),[]);t.updateLocalizations(n)},fetchCampaigns:Object(r.flow)((function*(){const a={locale_keys:t.localizationsForGettingCampaigns};try{t.updateCampaignsFetched(!1);const e=yield $.ajax({url:Routes.suitable_campaigns_by_locale_keys_internal_site_localization_split_tests_path(t.siteCachedSlug,Object(i.v)(location.pathname),a)});t.updateCampaignsFilter(e.result)}catch(xhr){e({name:"Unable to fetchCampaignsForCommonLocales",message:"Ajax failure",xhr:xhr})}finally{t.updateCampaignsFetched(!0)}})),deleteLocalizationFromSessionStorage:e=>{const t=JSON.parse(sessionStorage.getItem("localizations_batches")).filter((t=>t.id!==e.id));sessionStorage.setItem("localizations_batches",JSON.stringify(t))},copyCampaignsLocalization:Object(r.flow)((function*(a){const r={key:a.localization,value:a.value,selected_campaigns_ids:t.selectedCampaignsIds};try{yield Object(o.ajax)({type:"PUT",url:Routes.multi_campaign_update_internal_site_campaign_locale_entries_path(t.siteCachedSlug,t.campaignId),data:r}),a.updateCopyingStatus("success"),t.deleteLocalizationFromSessionStorage(a),UINotifications.add({text:`${a.localization} has been copied`,type:"success"})}catch(xhr){a.updateCopyingStatus("error");const n=_.get(xhr,"responseJSON.result.errors",{});let i="";_.isEmpty(n)?i=_.get(xhr,"responseJSON.result.error_message")||"Something went wrong":(t.updateErrors({localization:a,errors:n}),i=_.get(xhr,"responseJSON.result.errors.value[0]",{})),UINotifications.add({text:`${a.localization} has not been copied. ${_.upperFirst(i)}`,type:"error",delay:8e3}),e({name:"Unable to copyCampaignsLocalizations",message:"Ajax failure",xhr:xhr})}})),updateErrors({localization:e,errors:t}){e.errors.replace(t)},copyLocalizationsToCampaigns:Object(r.flow)((function*(){t.increaseStep(),yield Promise.all(t.selectedLocalizations.map(t.copyCampaignsLocalization))})),updateCampaignsFilter:e=>{t.campaignsFilter.addAvailableCampaigns(e.available_campaigns),t.campaignsFilter.addIneligibleCampaigns(e.ineligible_campaigns)},updateCampaignsFetched:e=>{t.campaignsFetched=e}})))}).call(this,a("B9cq").notifyDevelopers)},"85NH":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("sT1B"),i=a("ojmY");const o=r.types.model("LoyaltyRuleSchema",{id:r.types.maybeNull(r.types.number),name:r.types.maybeNull(r.types.string),description:r.types.maybeNull(r.types.string),icon_url:r.types.maybeNull(r.types.string),enabled:!0,once_per_member:!0,points:1,based_on_subtotal:!1,criteria:r.types.string,type:r.types.union(r.types.literal(n.V.event),r.types.literal(n.V.referral),r.types.literal(n.V.other),r.types.literal(n.V.optin),r.types.undefined),category_id:r.types.maybeNull(r.types.number),criteria_sample_interpolations:r.types.frozen()}).preProcessSnapshot((e=>({...e,based_on_subtotal:void 0!==e.based_on_subtotal?Boolean(Number(e.based_on_subtotal)):void 0,once_per_member:void 0!==e.once_per_member?Boolean(Number(e.once_per_member)):void 0,criteria:e.criteria||""}))).views((e=>({get isEventRule(){return Object(i.b)({type:e.type})},get isCustomRule(){return Object(i.a)({type:e.type})},get isReferralRule(){return Object(i.c)({type:e.type})}})))},"8C8s":function(e,t,a){"use strict";var r=a("q1tI"),n=a.n(r),i=a("i8i4"),o=a.n(i),s=a("TyAF"),l=a("aFzQ"),c=a("lFKM"),p=a.n(c),u=a("4b23"),d=a("EVdn"),m=a.n(d);const g=new function(){this.items=Object(l.observable)(new Map),this.checkTypeNotification=e=>["success","warning","error","notice","alert"].includes(e),this.add=Object(l.action)((e=>{if(!this.checkTypeNotification(e.get("type")))throw new Error("Invalid data type");if(e.get("text")&&Object(l.values)(this.items).some((t=>t.text===e.get("text"))))return;const t=Object(u.a)();e.get("text")&&this.items.set(t,{type:e.get("type"),text:e.get("text")}),e.get("delay")!==1/0&&setTimeout((()=>{this.removeFromScreen(t)}),p()(e.get("delay"))?e.get("delay"):6e3)})),this.removeFromScreen=e=>{const t=m()(`[data-notification-id=${e}]`),a=this;t.addClass("Notification-remove"),t.on("transitionend webkitTransitionEnd oTransitionEnd",(function(){m()(this).css({height:0,margin:0,padding:0}),"0px"===m()(this).css("height")&&a.remove(e)}))},this.remove=Object(l.action)((e=>{this.items.delete(e)})),this.clearStore=Object(l.action)((()=>{this.items.clear()}))};const h=a("vOnD").default.div.withConfig({displayName:"styled__NotificationsList"})([".Notification{position:fixed;bottom:10px;right:10px;display:flex;flex-direction:column;z-index:2147483647;transition:all 2s ease-in-out;margin-left:0;&-item{display:flex;justify-content:flex-start;align-items:center;position:relative;width:360px;margin-top:10px;color:#fff;padding:15px 8px 15px 15px;border-radius:6px;opacity:1;animation:fade-right 0.4s ease-in-out;animation-fill-mode:backwards;box-sizing:border-box;&-wrap{width:100%;display:flex;justify-content:flex-start;align-items:center;border-right:1px solid rgba(255,255,255,0.2);padding-right:15px;}&-icon{margin-right:15px;}&-text{display:block;font-family:'gotham-htf-medium','aktiv-grotesk',Arial,sans-serif !important;margin:0;padding-right:15px;font-size:14px;line-height:1.3;word-break:break-word;p{margin:0;padding:0;}a{text-decoration:underline;color:#fff;cursor:pointer;}}&-close{margin-left:15px;cursor:pointer;.sign-svg{vertical-align:baseline;}}}&-remove{transform:translateX(200%);opacity:0;transition:all 0.4s ease-in-out;}&-is-success{background-color:rgba(13,167,82,0.9);box-shadow:0 4px 10px rgba(13,167,82,0.3);}&-is-error,&-is-warning,&-is-alert{background-color:rgba(223,20,10,0.9);box-shadow:0 4px 10px rgba(163,16,27,0.3);}&-is-notice{background-color:rgba(37,131,219,0.9);box-shadow:0 4px 10px rgba(8,75,138,0.3);}@keyframes fade-right{0%{height:0;margin:0;padding:0;transform:translateX(200%);}50%{transform:translateX(200%);}100%{transform:translateX(0%);}}}"]);var y=a("GaHK");function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const _=Object(s.c)(function(e){var t,a;function r(...t){var a;return(a=e.call(this,...t)||this).handleClick=e=>()=>{m()(`[data-notification-id=${e}]`).each((function(){m()(this).css({height:m()(this).outerHeight()})})),g.removeFromScreen(e)},a.normalize=e=>e.map((([e,t])=>new Map([["type",e],["text",t]]))),a.getIconName=e=>{switch(e){case"success":return"successNotification";default:return"errorNotification"}},a}a=e,(t=r).prototype=Object.create(a.prototype),t.prototype.constructor=t,f(t,a);var i=r.prototype;return i.componentDidMount=function(){const{FlashNotifications:e}=window;if(e&&e.length>0){this.normalize(e).map((e=>{g.add(e)}))}},i.componentWillUnmount=function(){const{clearStore:e}=g;e()},i.render=function(){const{items:e}=g;return 0===e.size?null:n.a.createElement(h,null,n.a.createElement("ul",{className:"Notification"},Array.from(e.entries()).map((([e,t])=>n.a.createElement("li",{"data-testid":"ac-notification","data-notification-id":e,className:`Notification-item Notification-is-${t.type}`,key:e},n.a.createElement("div",{className:"Notification-item-wrap"},"notice"!==t.type&&n.a.createElement("div",{className:"Notification-item-icon ac-notification-item-icon"},n.a.createElement(y.UIIcon,{name:this.getIconName(t.type)})),n.a.createElement("div",{className:"Notification-item-text"},n.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.text}}))),n.a.createElement("div",{"data-testid":"ac-notification-item-close",onClick:this.handleClick(e),className:"Notification-item-close"},n.a.createElement(y.UIIcon,{name:"closeNotification"})))))))},r}(n.a.PureComponent));t.a={mount:()=>{document.addEventListener("DOMContentLoaded",(()=>{const e=document.createElement("div");e.setAttribute("id","notifications"),document.body.appendChild(e),o.a.render(n.a.createElement(_,null),document.getElementById("notifications"))}))},add:({type:e,text:t,delay:a})=>{g.add(new Map([["type",e],["text",t],["delay",a]]))},showSuccessFlash:(e="Changes have been saved",t=6e3)=>{g.add(new Map([["type","success"],["text",e],["delay",t]]))},showErrorFlash:(e="Error saving changes",t=6e3)=>{g.add(new Map([["type","error"],["text",e],["delay",t]]))}}},"8Jte":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return u}));var r=a("99Ma"),n=a("aFzQ"),i=a("B9cq"),o=a("2ZiZ"),s=a("4Amn"),l=a("SvJU"),c=a("vxPL");const p=r.types.model("ShareSent",{id:r.types.identifierNumber,page:r.types.maybeNull(r.types.number),share:r.types.optional(l.a,{}),advocate:r.types.optional(o.a,{}),offer:r.types.optional(c.a,{}),friends:r.types.optional(r.types.array(s.a),[]),visitor_offers_shown:!1,friends_count:r.types.maybeNull(r.types.number),friend_clicks_count:r.types.maybeNull(r.types.number)}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get sharePath(){const t=e.rootStore.models.site.getDateInSiteTimezone(e.share.created_at).format("MM/DD/YYYY");return Routes.site_visitor_offers_path(e.rootStore.models.site.cached_slug,{visitor_offers_grid:{share_id:e.id,created_at:[t,t],created_at_period_type:"custom"}})}}))).actions((e=>({toggleVisitorOffersExpander:()=>{e.visitor_offers_shown=!e.visitor_offers_shown},update:t=>{_.forEach(t,((a,r)=>{e[r]=t[r]}))}}))),u=r.types.model("SharesSentStore",{sharesSent:r.types.optional(r.types.map(p),{}),searchQuery:"",sharesSentFetched:!1,paginationPosition:1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get currentSharesSent(){return Object(n.values)(e.sharesSent).filter((t=>t.page===e.paginationPosition))}}))).actions((t=>({resetFetchState:()=>{t.sharesSentFetched=!1},fetchSharesSent:Object(r.flow)((function*(a){t.resetFetchState();try{const e=yield Object(i.ajax)({url:Routes.internal_site_customer_service_for_scope_path(t.rootStore.models.site.cached_slug,"shares_by",{q:a,page:t.paginationPosition,no_spinner:!0})});t.updateSharesSent(e.result.records,a)}catch(xhr){e({name:"Unable to fetch CSP Shares Sent",message:"Ajax failure",xhr:xhr})}})),clearSharesSent:()=>{t.sharesSent.clear()},updateSharesSent:(e=[],a)=>{e.forEach(((e,a)=>{const r=t.modifyShareSent(e);t.sharesSent.put(r)})),t.sharesSentFetched=!0,t.searchQuery=a},modifyShareSent:e=>{if(_.set(e,"id",e.share.id),_.set(e,"page",t.paginationPosition),_.set(e,"advocate.person.type","advocate"),_.some(e.friends)){const t=_.forOwn(e.friends,((e,t)=>{_.set(e,"visitor_offer.type","friend")}));_.set(e,"friends.visitor_offer",t)}return e},setPaginationPosition:(e,a)=>{a&&a.preventDefault(),e!==t.paginationPosition&&(t.paginationPosition=e,t.fetchSharesSent(t.searchQuery))}})))}).call(this,a("B9cq").notifyDevelopers)},"90E5":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("sT1B"),i=a("9iDo");const o=r.types.compose("CampaignMigrateDetails",i.c,r.types.model({migratedStatus:"",migratedError:""}).actions((e=>({updateMigratedStatus:({type:t,error:a})=>{e.migratedStatus=t,"error"===t&&e.updateMigratedError(a)},updateMigratedError:t=>{e.migratedError=t}})))),s=r.types.compose("CampaignMigrateCampaignsFilterCampaignsCollection",i.a,r.types.model({data:r.types.array(o),maxCampaignsToShow:n.X})),l=r.types.compose("CampaignMigrateCampaignsFilter",i.b,r.types.model({campaigns:r.types.map(s)}))},"9Fy+":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("99Ma");const n=r.types.model("MetricSchema",{identifier:"",description:r.types.maybeNull(r.types.string),formatted:"",humanized:"",name:"",plain:r.types.maybeNull(r.types.number),ratio:""}).views((e=>({}))).actions((e=>({}))),i=r.types.model("MetricsStore",{advocacy_percentage:r.types.optional(n,{}),advocate_referral_rewards:r.types.optional(n,{}),click_rate:r.types.optional(n,{}),conversion_percentage:r.types.optional(n,{}),ideal_friend_sales:r.types.optional(n,{}),impressions:r.types.optional(n,{}),offer_clicks:r.types.optional(n,{}),sharers:r.types.optional(n,{}),shares:r.types.optional(n,{}),site_visits:r.types.optional(n,{}),visit_percentage:r.types.optional(n,{}),email_capture_offers:r.types.optional(n,{}),email_capture_offers_signed_up:r.types.optional(n,{}),email_capture_first_time_sales_count:r.types.optional(n,{}),email_capture_first_time_sales_sum:r.types.optional(n,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get topMetrics(){return e.isGleamCampaign?e.gleamTopMetrics:e.otherTopMetrics},get gleamTopMetrics(){return[e.impressions]},get emailCaptureMetrics(){return[e.email_capture_offers,e.email_capture_offers_signed_up,{...e.email_capture_first_time_sales_count,subMetric:{...e.email_capture_first_time_sales_sum}}]},get otherTopMetrics(){return[e.impressions,{...e.shares,subMetric:{...e.sharers}},e.offer_clicks,e.site_visits,e.ideal_friend_sales,e.advocate_referral_rewards]},get ratioMetrics(){return[e.advocacy_percentage,e.click_rate,e.visit_percentage,e.conversion_percentage]},get isGleamCampaign(){return e.rootStore.pages.campaignShowRoot.currentCampaign.gleam},get chartYAxisType(){return e.chartData.includes(0)?"linear":"logarithmic"},get chartCategories(){return e.topMetrics.reduce(((e,t)=>(e.push(t.name),e)),[])},get chartData(){return e.topMetrics.reduce(((e,t)=>(e.push(t.plain),e)),[])},get chardDataIsEmpty(){return 0===_.sum(e.chartData)}}))).actions((e=>({}))),o=r.types.model("ReportDataSchema",{metrics:r.types.optional(i,{})}).views((e=>({}))).actions((e=>({}))),s=r.types.model("FunnelStore",{report_data:r.types.optional(o,{}),report_path:r.types.maybeNull(r.types.string)}).views((e=>({}))).actions((e=>({})))},"9LaU":function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var r=a("99Ma"),n=a("dhqo"),i=a.n(n),o=a("BL7L"),s=a("rfrl"),l=a("aFzQ"),c=a("YWrU");const p=r.types.compose("LoyaltyRedemptionRulesFormStore",c.a,r.types.model({errors:r.types.frozen({})})).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get redemptionRulesRootStore(){return Object(r.getParentOfType)(e,f)},get redemptionRulesData(){return e.redemptionRulesRootStore.redemptionRulesData},get couponListsData(){return e.redemptionRulesRootStore.couponListsData},get couponListsOptions(){const t=[{label:"Please choose",value:""}];return e.couponListsData.couponLists.forEach((a=>{e.isCouponUsedInAnotherRule(a.id)||t.push({label:a.selectLabel,value:String(a.id)})})),t},get selectedCouponListOptionValue(){return String(e.coupon_list_id||"")},get selectedCouponList(){return e.couponListsData.getCouponListById(e.coupon_list_id)},get preparedDataForServer(){return _.pick(Object(l.toJS)(e),["points_cost","coupon_list_id","description"])},isCouponUsedInAnotherRule:t=>e.redemptionRulesData.data.some((a=>a.id!==e.id&&a.coupon_list_id===t))}))).actions((e=>({updateErrors(t){e.errors=t},clearErrorByName(t){e.errors=Object(s.b)(e.errors,(e=>{null==e||delete e[t]}))},handleChange({target:{name:t,value:a}}){e.clearErrorByName(t),e[t]=a},handleSelectCouponList({selectedOption:t}){e.clearErrorByName("coupon_list"),e.coupon_list_id=Number(t.value)||null}})));var u=a("vrPu");const d=r.types.model("LoyaltyRedemptionRulesNewStore",{data:r.types.optional(p,{}),initialData:r.types.optional(p,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignRulesStore(){return Object(r.getParentOfType)(e,u.a)},get loyaltyRedemptionRulesRootStore(){return Object(r.getParent)(e)},get couponListsData(){return e.loyaltyRedemptionRulesRootStore.couponListsData},get redemptionRulesData(){return e.loyaltyRedemptionRulesRootStore.redemptionRulesData},get showFormInner(){return"success"===e.couponListsData.network.getAll.status},get redemptionRulePostStatus(){return e.redemptionRulesData.network.post.status},get isAvailableForAction(){return"in_progress"!==e.redemptionRulePostStatus&&"success"===e.redemptionRulesData.network.get.status},get isPristine(){return _.isEqual(e.initialData.toJSON(),e.data.toJSON())}}))).actions((e=>({init(){e.couponListsData.apiGetAll("loyalty")},updateData(t){Object(r.applySnapshot)(e.data,t),Object(r.applySnapshot)(e.initialData,t)},handleCreate:Object(r.flow)((function*(){try{yield e.redemptionRulesData.apiPost({campaignId:e.campaignRulesStore.campaign.id,data:{redemption_rule:e.data.preparedDataForServer}}),yield e.loyaltyRedemptionRulesRootStore.init(),e.reset()}catch(t){throw e.data.updateErrors(t),new Error("Unable to create points redemption batch")}})),handleDiscardChanges(){e.updateData(e.initialData.toJSON())},reset(){Object(r.applySnapshot)(e,{})}})));var m=a("fcLJ"),g=a("aetS");const h=r.types.model("LoyaltyRedemptionRulesEditStore",{data:r.types.optional(p,{}),initialData:r.types.optional(p,{}),deleteModal:r.types.optional(g.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignRulesStore(){return Object(r.getParentOfType)(e,u.a)},get loyaltyRedemptionRulesRootStore(){return Object(r.getParent)(e)},get couponListsData(){return e.loyaltyRedemptionRulesRootStore.couponListsData},get redemptionRulesData(){return e.loyaltyRedemptionRulesRootStore.redemptionRulesData},get showFormInner(){return e.couponListsData.network.getAll.isLoaded},get redemptionRulePutStatus(){return e.redemptionRulesData.network.put.status},get redemptionRuleDeleteStatus(){return e.redemptionRulesData.network.delete.status},get isAvailableForUpdateAction(){return"in_progress"!==e.redemptionRulePutStatus&&"success"===e.redemptionRulesData.network.get.status},get isAvailableForDeleteAction(){return"in_progress"!==e.redemptionRuleDeleteStatus&&"success"===e.redemptionRulesData.network.get.status},get isAvailableForAction(){return e.isAvailableForUpdateAction&&e.isAvailableForDeleteAction},get isPristine(){return _.isEqual(e.initialData.toJSON(),e.data.toJSON())}}))).actions((e=>({init(t){e.couponListsData.apiGetAll("loyalty");const a=e.redemptionRulesData.getRuleById(t);if(!a)throw new Error("No such redemption rule");e.updateData(Object(l.toJS)(a))},updateData(t){Object(r.applySnapshot)(e.data,t),Object(r.applySnapshot)(e.initialData,t)},handleUpdate:Object(r.flow)((function*(){try{yield e.redemptionRulesData.apiPut({ruleId:e.data.id,campaignId:e.campaignRulesStore.campaign.id,data:{redemption_rule:e.data.preparedDataForServer}}),yield e.loyaltyRedemptionRulesRootStore.init(),e.reset()}catch(t){throw e.data.updateErrors(t),new Error("Unable to create points redemption batch")}})),handleDelete:Object(r.flow)((function*(t){null==t||t.preventDefault(),e.handleDiscardChanges();try{yield e.redemptionRulesData.apiDelete({campaignId:e.loyaltyRedemptionRulesRootStore.campaign.id,ruleId:e.data.id}),yield e.loyaltyRedemptionRulesRootStore.init()}catch(t){e.data.updateErrors(t)}})),handleDiscardChanges(){e.updateData(e.initialData.toJSON())},reset(){Object(r.applySnapshot)(e,{})}}))),y=c.a.views((e=>({get rootStore(){return Object(r.getRoot)(e)},get loyaltyRedemptionRulesRootStore(){return Object(r.getParentOfType)(e,f)},get couponList(){return Object(r.isAlive)(e)?e.loyaltyRedemptionRulesRootStore.couponListsData.getCouponListById(e.coupon_list_id):null},get site(){return e.rootStore.models.site},get availableCouponsCountDescription(){return`${i()("coupon",e.available_coupons_count,!0)} left`},get pointsToCurrencyDescription(){if(!e.couponList)return"";const t=`${i()("point",e.points_cost,!0)} =`;return e.description?`${t} ${e.description}`:`${t} ${e.couponList.localized_amount} off`},get shouldShowCouponUsedWarning(){return!e.available_coupons_count},get couponListHumanName(){return e.couponList?`${e.couponList.localized_amount} ${e.couponList.name}`:""}}))),f=r.types.model({redemptionRulesData:r.types.optional(r.types.compose(o.a,r.types.model({data:r.types.array(y)})),{}),couponListsData:r.types.optional(m.a,{}),redemptionRulesNew:r.types.optional(d,{}),redemptionRulesEditStore:r.types.optional(h,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignRulesStore(){return Object(r.getParent)(e)},get campaign(){return e.campaignRulesStore.campaign},get isLoaded(){return e.redemptionRulesData.network.get.isLoaded},get isLoading(){return"in_progress"===e.redemptionRulesData.network.get.status},get rules(){return e.redemptionRulesData.data.slice().sort(((e,t)=>e.points_cost-t.points_cost))}}))).actions((e=>({init:Object(r.flow)((function*(){yield e.redemptionRulesData.apiGet(e.campaign.id)})),fetchCouponListById(t){e.couponListsData.apiGetOneById({id:t,space:"loyalty"})},reset(){Object(r.applySnapshot)(e,{})}})))},"9g9V":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("CO79");function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let i=function(t){var a,i;function o(...a){var r;return(r=t.call(this,...a)||this).getStatusDescription=({status:t,kind:a})=>"ready"===t?"long"===a?"Ready to run":e.createElement("span",null,"Ready ",e.createElement("br",null)," to run"):`${t.charAt(0).toUpperCase()+t.slice(1)}`,r}return i=t,(a=o).prototype=Object.create(i.prototype),a.prototype.constructor=a,n(a,i),o.prototype.render=function(){const{status:t,kind:a,className:n}=this.props,i=classNames(n,{"is-warning is-text-left":"ready"===t,"is-error":"active"===t,"is-success":"finished"===t});return e.createElement(r.a,{className:i,kind:a},this.getStatusDescription({status:t,kind:a}))},o}(e.PureComponent);i.defaultProps={type:"ready",kind:"long"},Widget.BaseTextLabelStatus=i}).call(this,a("q1tI"))},"9iDo":function(e,t,a){"use strict";a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var r=a("99Ma"),n=a("4b23"),i=a("dhqo"),o=a.n(i),s=a("2TKB"),l=a("sT1B"),c=a("HzpY");const p=[{value:"any",label:"Any"},...l.g],u=r.types.compose("SelectableCampaign",s.a,r.types.model({checked:!1})).volatile((()=>({initial_checked:!1,key:""}))).views((e=>({get isPristine(){return e.initial_checked===e.checked},get campaignsSet(){return Object(r.getParent)(e,2)}}))).actions((e=>({afterCreate(){e.initial_checked=e.checked,e.key=Object(n.a)()},handleChange({target:{value:t}}){e.updateChecked({value:t}),e.campaignsSet.checkAndUpdateCheckedAll()},updateChecked({value:t}){e.checked=t},handleSelectOne({target:{value:t}}){e.campaignsSet.updateAll(!1),e.checked=t}}))),d=r.types.model("CampaignsCollection",{data:r.types.array(u),isShownAll:!1,maxCampaignsToShow:5,checkedAll:r.types.union(r.types.null,r.types.boolean)}).preProcessSnapshot((e=>({data:e.data,checkedAll:_.some(e.data)&&e.data.every((e=>e.checked))}))).volatile((e=>({initialSelectedCampaignsId:[]}))).views((e=>({get selectedCampaignsTitle(){return`${e.selectedCampaignsCount||"No"} ${o()("campaign",e.selectedCampaignsCount)} attached`},get hiddenFilteredCampaignsCount(){return e.data.length-e.filteredCampaigns.length},get showHiddenFilteredCampaignsCountNote(){return Boolean(e.hiddenFilteredCampaignsCount)},get hiddenCampaignsNote(){return`${e.hiddenFilteredCampaignsCount} ${o()("campaign",e.hiddenFilteredCampaignsCount)} hidden due to search criteria`},get selectedCampaigns(){return e.data.filter((e=>e.checked))},get selectedCampaignsCount(){return e.selectedCampaigns.length},get selectedCampaignsId(){return e.selectedCampaigns.map((e=>e.id))},get hiddenCampaignsCount(){return e.sortedCampaigns.length-e.campaigns.length},get campaignsFilter(){return Object(r.getParent)(e,2)},get filteredCampaigns(){return(({campaigns:e,search:t,status:a})=>{let r=e;return t&&(r=(({campaigns:e,value:t})=>t?e.filter((e=>`${e.id}${e.name}${e.status}`.toLocaleLowerCase().includes(t.toLowerCase()))):e)({campaigns:r,value:t})),"any"!==a&&(r=(({campaigns:e,value:t})=>t?e.filter((e=>e.status.toLowerCase()===t.toLowerCase())):e)({campaigns:r,value:a})),r})({campaigns:e.data,status:e.campaignsFilter.status,search:e.campaignsFilter.search})},get sortedCampaigns(){return e.filteredCampaigns.slice().sort(((e,t)=>t.checked-e.checked||Object(c.c)(t)-Object(c.c)(e)))},get campaigns(){return e.isShownAll?e.sortedCampaigns:e.sortedCampaigns.slice(0,e.maxCampaignsToShow)},get isPristine(){return _.isEqual(e.selectedCampaignsId,e.initialSelectedCampaignsId)},get isExists(){return _.some(e.campaigns)},get isEmpty(){return!e.isExists}}))).actions((e=>({afterCreate(){e.initialSelectedCampaignsId=e.selectedCampaignsId},toggleShowAll(){e.isShownAll=!e.isShownAll},updateShowAll(t=!1){e.isShownAll=t},updateCampaigns(t){e.data=t},handleChangeAll({target:{value:t}}){e.updateCheckedAll(t),e.updateAll(t)},updateAll(t){e.filteredCampaigns.forEach((e=>{e.updateChecked({value:t})}))},updateCheckedAll(t){e.checkedAll=t},removeCampaignById(t){const a=e.data.find((e=>e.id===t));return e.updateCampaigns(e.data.filter((e=>e.id!==t))),a},addCampaign(t){e.data.push(t)},checkAndUpdateCheckedAll(){_.some(e.filteredCampaigns)?e.filteredCampaigns.every((e=>e.checked))?e.updateCheckedAll(!0):e.filteredCampaigns.every((e=>!e.checked))?e.updateCheckedAll(!1):e.updateCheckedAll(null):e.updateCheckedAll(!1)}}))),m=r.types.model("CampaignsFilter",{campaigns:r.types.map(d),statuses:r.types.optional(r.types.array(r.types.frozen()),p),search:"",status:"any"}).views((e=>({get availableCampaigns(){return e.campaigns.get("available")},get ineligibleCampaigns(){return e.campaigns.get("ineligible")},get isPristineCampaigns(){return Array.from(e.campaigns.values()).every((e=>e.isPristine))},get isPristine(){return""===e.search&&"any"===e.status&&e.isPristineCampaigns}}))).actions((e=>({handleSearch({target:{value:t}}){e.updateSearch(t),e.campaigns.forEach((e=>{e.updateShowAll(!1),e.checkAndUpdateCheckedAll()}))},updateSearch(t){e.search=t},handleSelectStatus({selectedOption:{value:t}}){e.status=t},updateSelectStatus(t){e.status=t},addCampaignsCollection({identifier:t,campaignCollection:a}){e.campaigns.set(t,a),e.campaigns.get(t).checkAndUpdateCheckedAll()},addAvailableCampaigns(t){e.addCampaignsCollection({identifier:"available",campaignCollection:{data:t}})},addIneligibleCampaigns(t){e.addCampaignsCollection({identifier:"ineligible",campaignCollection:{data:t}})},reset(){Object(r.applySnapshot)(e,{})}})))},"9ird":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("c7RZ"),i=a("AHpt");const o=r.types.model("RecordData",{campaign:r.types.maybeNull(i.a),short_url_code:r.types.maybeNull(r.types.string),id:r.types.maybeNull(r.types.number),sharing_channel:r.types.maybeNull(r.types.string),channel_human_name:r.types.maybeNull(r.types.string),email:r.types.maybeNull(r.types.string),amount:r.types.maybeNull(r.types.number),short_description:r.types.maybeNull(r.types.string),coupon:r.types.maybeNull(n.a),coupons:r.types.optional(r.types.array(n.a),[]),first_time:r.types.maybeNull(r.types.boolean),formatted_subtotal:r.types.maybeNull(r.types.string),event_category:r.types.maybeNull(r.types.number),subtotal:r.types.maybeNull(r.types.number),status:r.types.maybeNull(r.types.string),track_method:r.types.maybeNull(r.types.string),fraud_details:r.types.maybeNull(r.types.string),reason:r.types.maybeNull(r.types.string),event_category_id:r.types.maybeNull(r.types.number),event_category_identifier:r.types.maybeNull(r.types.string),refunded_by:r.types.maybeNull(r.types.string),origin_id:r.types.maybeNull(r.types.number),origin_type:r.types.maybeNull(r.types.string)}).views((e=>({get textForSharedChannel(){if("personal_coupon"===e.sharing_channel)return"Advocate shared personal coupon";{const t="Advocate shared the link",a=e.channel_human_name?` via ${e.channel_human_name} sharing channel`:"";return t.concat(a)}}}))),s=r.types.model("Journey",{datetime:r.types.maybeNull(r.types.string),journey_point:r.types.maybeNull(r.types.string),record:r.types.maybeNull(o)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get formattedDatetime(){return e.rootStore.models.site.formatDate(e.datetime)},get isAdvocate(){return _.includes(["share","referral","offer"],e.journey_point)},get isFriend(){return!e.isAdvocate},get originPath(){return Routes.site_origin_path(e.rootStore.siteCachedSlug,e.record.id)}}))).actions((e=>({update:t=>{_.forEach(t,((a,r)=>{e[r]=t[r]}))}})))},"9qCm":function(e,t){!function(e,t){const a=e,{ga:r}=window;a.init=function(){a.collectData(),t(window).resize((()=>a.collectData())),t(window).scroll((()=>a.collectData()))},a.collectData=function(){a.browserHeight=t(window).height(),a.pageHeight=t(document).height(),a.currentScroll=t(window).scrollTop()},a.hub=t("<div></div>"),a.publish=function(e,t){window.console&&console.log("Publish event: "+e),a.hub.trigger(e,t)},a.subscribe=function(e,t){a.hub.bind(e,(function(e,a){return t(a),!0}))},a.isMobile={Android:()=>navigator.userAgent.match(/Android/i),BlackBerry:()=>navigator.userAgent.match(/BlackBerry/i),iOS:()=>navigator.userAgent.match(/iPhone|iPad|iPod/i),Opera:()=>navigator.userAgent.match(/Opera Mini/i),Windows:()=>navigator.userAgent.match(/IEMobile/i),any(){return this.Android()||this.BlackBerry()||this.iOS()||this.Opera()||this.Windows()}},a.setCurrentSite=e=>talkableLocalStorage.setItem("currentSiteCachedSlug",e),a.getCurrentSite=()=>talkableLocalStorage.getItem("currentSiteCachedSlug"),a.trackGAEvent=function(e,t,a){if(!e&&!t)throw new Error("Please supply: Category and Action in order to register Google Analytics Event");r&&r("send","event",e,t,a)},a.trackGAClicks=()=>t(document).on("click",".js-ga-click",(e=>{const n=t(e.currentTarget).data("category"),i=t(e.currentTarget).data("label")||t(e.currentTarget).attr("class"),o=t(e.currentTarget).data("action")||"Click",s=t(e.currentTarget).data("name"),l=t(e.currentTarget).attr("href"),c=t(e.currentTarget).attr("target"),p=t(e.currentTarget).data("router");t(e.currentTarget).attr("href")&&!p&&e.preventDefault(),n?a.trackGAEvent(n,o,i):r&&r("send","event",s,"clicked"),p||l&&(e.ctrlKey||e.metaKey||"_blank"===c?window.open(l):window.location=l)})),window.reloadAndClearHash=()=>{window.location=`${window.location.origin}${window.location.pathname}${window.location.search}`}}(window.Utils=window.Utils||{},jQuery)},A95y:function(e,t,a){(function(e){function t(e,a){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,a)}Widget.AbTestsModalDeleteVariantConfirmation=function(a){var r,n;function i(){return a.apply(this,arguments)||this}return n=a,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,t(r,n),i.prototype.render=function(){return e.createElement("div",{className:"Locale-entries-assets-uploader-static"},e.createElement("p",null,"Are you sure you want to delete this A/B Test variant? All its Impressions will be deleted and as a result the A/B test stats will be recalculated."))},i}(e.PureComponent)}).call(this,a("q1tI"))},AEM3:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return u}));var r=a("99Ma"),n=a("4oum"),i=a("+K82"),o=a("v6cQ"),s=a("bPB2"),l=a("38EH"),c=a("V8d1"),p=a("DvqJ");const u=r.types.model("PlacementsRootPage",{placementsIndexPage:r.types.optional(o.a,{}),placementsDetailsPage:r.types.optional(s.a,{}),placementsNewPage:r.types.optional(l.a,{}),placementsEditPage:r.types.optional(c.a,{}),placements:r.types.optional(i.a,{}),campaigns:r.types.optional(n.a,{}),campaignsDetacher:r.types.optional(p.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get siteEventCategories(){return e.rootStore.models.site.event_categories},getEventCategoryById:t=>e.siteEventCategories.find((e=>e.id===t)),get isLoading(){return(e.placements.isFetching||e.campaigns.network.get.isLoading)&&!e.isLoaded},get isLoaded(){return e.placements.isFetched&&e.campaigns.network.get.isLoaded}}))).actions((t=>({init:Object(r.flow)((function*(){yield Promise.all([t.placements.fetch(),t.campaigns.apiGet({no_spinner:!0})])})),updateCampaignPlacementRequest({campaignId:a,placementId:r}){const n=t.campaigns.data.find((e=>Number(e.id)===Number(a)));return t.rootStore.services.campaignsNetworkService.apiPatch({id:n.id,data:{campaign:{placement_id:r}}}).catch((t=>(e({name:"Unable to destroy campaign",message:"Ajax failure",xhr:t}),t)))},reset:()=>{Object(r.isAlive)(t)&&Object(r.applySnapshot)(t,{})}})))}).call(this,a("B9cq").notifyDevelopers)},AHpt:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("sT1B"),i=a("UEOA"),o=a("V0vo");const s=r.types.model("CSPCampaignSchema",{id:r.types.identifierNumber,name:r.types.string,tiered:!1,appearance:r.types.maybeNull(r.types.optional(r.types.string,"inline")),normalized_preset_name:r.types.maybeNull(r.types.string),placement_category_abbreviation:r.types.maybeNull(r.types.union(r.types.literal("SA"),r.types.literal("PE"),r.types.literal("PP"),r.types.literal("RG"),r.types.literal("FW"),r.types.literal("EC"),r.types.literal("LO"))),status:r.types.maybeNull(r.types.enumeration("Status",_.values(n.w))),advocate_incentives:r.types.array(i.a),friend_incentives:r.types.array(i.a),offers_count_with_limit:0}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({get formattedOffersCountWithLimit(){return Object(o.o)({value:e.offers_count_with_limit})}})))},AJcQ:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return g}));var r,n,i=a("TyAF"),o=a("Ty5D"),s=a("O6AO"),l=a("UM2y"),c=a("L2VW"),p=a("iwB2"),u=a("oYvJ"),d=a("IvMf");function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const g=Object(o.o)(Object(i.b)((({rootStore:e})=>({campaignShowRoot:e.pages.campaignShowRoot,currentUser:e.models.currentUser})))(Object(i.c)((n=r=function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,m(a,r),n.prototype.render=function(){const{campaignShowRoot:{currentCampaign:t,campaignInitialDataFetched:a},active_tab:r,isSpa:n,currentUser:i}=this.props;return e.createElement("div",{className:"App-container-inner"},a&&e.createElement("div",{className:"mbm"},e.createElement(l.a,null),e.createElement("div",{className:"flex justify-space-between align-items-center"},e.createElement("div",{className:"flex align-items-center"},t.staticWidgetEnabled&&e.createElement(c.a,null),e.createElement(d.a,null),e.createElement(s.a,null)),i.isWriteRole&&e.createElement(p.a,{isSpa:n}))),i.isWriteRole&&e.createElement(u.a,{isSpa:n,active_tab:r}))},n}(e.PureComponent),r.defaultProps={isSpa:!1,active_tab:""},n))))}).call(this,a("q1tI"))},B9cq:function(e,t,a){"use strict";a.r(t),a.d(t,"getHeaders",(function(){return c})),a.d(t,"getUrl",(function(){return p})),a.d(t,"jsonToFormData",(function(){return u})),a.d(t,"ajax",(function(){return d})),a.d(t,"isAccessDeniedStatus",(function(){return m})),a.d(t,"notifyDevelopers",(function(){return g}));var r=a("EVdn"),n=a.n(r),i=a("mwIZ"),o=a.n(i),s=a("lSCD"),l=a.n(s);const c=(e={})=>({...e,"X-CSRF-Token":n()("meta[name=csrf-token]").attr("content")}),p=(e="")=>`${window.Constants.DEFAULT_URL_OPTIONS.host}${e}`,u=e=>{const t=(e,a,r)=>{if(!a||"object"!==typeof a||a instanceof Date||a instanceof File){const t=null===a?"":a;e.append(r,t)}else Object.keys(a).forEach((n=>{t(e,a[n],r?`${r}[${n}]`:n)}))},a=new FormData;return t(a,e),a},d=({url:e="",headers:t={},withFileUpload:a=!1,...r})=>{let i={...r,headers:c(t),url:p(e),xhrFields:{withCredentials:!0},crossDomain:!0};return a&&(i={...i,processData:!1,contentType:!1,data:u(i.data)}),n.a.ajax(i)},m=e=>401===e.status&&"Unauthorized"===o()(e,"responseJSON.errors.0")||401===e.status&&"Unauthorized"===o()(e,"responseJSON.result.errors.0")||401===e.status&&"Unauthorized"===o()(e,"responseJSON.result.error_message")||403===e.status,g=e=>{const{name:t,message:a,xhr:r,custom:n}=e;if(t&&r||console.error("name and xhr attributes must be specified"),"abort"===(null==r?void 0:r.statusText))return"xhr was aborted";window.Bugsnag?Bugsnag.notify({name:t,message:a},(e=>{e.addMetadata("custom",{xhr:r,requestId:r&&l()(r.getResponseHeader)&&r.getResponseHeader("x-request-id"),custom:n})})):console.error(e)}},BCyL:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("99Ma");const n=r.types.model("ChildrenViews",{id:r.types.maybeNull(r.types.number),value:r.types.maybeNull(r.types.string),isChecked:!1,label:r.types.maybeNull(r.types.string),name:r.types.maybeNull(r.types.string),type:r.types.maybeNull(r.types.string)}).actions((e=>({onChangeChecked:t=>{e.changeChecked(t.target.value)},changeChecked:t=>{e.isChecked=t}}))),i=r.types.model("CheckboxModel",{children:r.types.optional(r.types.array(n),[]),id:r.types.maybeNull(r.types.number),value:r.types.maybeNull(r.types.string),isDisabled:!1,isSelfChecked:!1,label:r.types.maybeNull(r.types.string),name:r.types.maybeNull(r.types.string)}).views((e=>({get childrenCheck(){return!_.some(e.children)||e.children.some((e=>e.isChecked))},get isChecked(){return e.isSelfChecked&&e.childrenCheck}}))).actions((e=>({onChangeChecked:()=>{!e.isChecked&&_.some(e.children)?(e.children.forEach((e=>{e.changeChecked(!0)})),e.isSelfChecked=!0):e.isSelfChecked=!e.isSelfChecked},changeDisabled:t=>{e.isDisabled=t}}))),o=r.types.model("CampaignMigrateValues",{rules:r.types.optional(r.types.array(i),[{name:"general_settings",label:"Campaign description",isSelfChecked:!1,isDisabled:!1,children:[]},{name:"offer_settings",label:"Friend offer duration",isSelfChecked:!1,isDisabled:!1,children:[]},{name:"incentives",label:"Incentives",isSelfChecked:!1,isDisabled:!1,children:[]},{name:"tags_attributes",label:"Tags",isSelfChecked:!1,isDisabled:!1,children:[]},{name:"advanced_settings",label:"Advanced settings",isSelfChecked:!1,isDisabled:!1,children:[]}]),stylesheets:r.types.optional(r.types.array(i),[{name:"email",label:"CSS for emails",isSelfChecked:!1,isDisabled:!1,children:[]},{name:"friend",label:"Friend claim page CSS",isSelfChecked:!1,isDisabled:!1,children:[]},{name:"advocate",label:"Advocate views CSS",isSelfChecked:!1,isDisabled:!1,children:[]}]),integration_css:r.types.optional(r.types.array(i),[{name:"offer_integration_css",label:"Signup and share page CSS",isSelfChecked:!1,isDisabled:!1},{name:"trigger_integration_css",label:"Trigger widget CSS",isSelfChecked:!1,isDisabled:!1},{name:"gleam_integration_css",label:"Gleam CSS",isSelfChecked:!1,isDisabled:!1}]),views:r.types.optional(r.types.array(i),[])}).views((e=>({}))).actions((e=>({updateViews:t=>{e.views=t}})))},BL7L:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("x7QQ"),i=a("pm75"),o=a("B9cq"),s=a("YWrU");const l=r.types.compose("LoyaltyRedemptionRulesDataStore",n.a.array(s.a),i.c).views((e=>({get rootStore(){return Object(r.getRoot)(e)},getRuleById:t=>e.data.find((e=>e.id===t))}))).actions((t=>({apiGet:Object(r.flow)((function*(a){try{t.network.get.update("in_progress");const{result:e}=yield Object(o.ajax)({url:Routes.internal_site_campaign_loyalty_redemption_rules_path(t.rootStore.siteCachedSlug,a)});t.dataApplySnapshot(null==e?void 0:e.redemption_rules),t.network.get.update("success")}catch(xhr){t.network.get.update("error"),e({message:"Unable to fetch loyalty campaign redemption rules",name:"Ajax failure",xhr:xhr})}})),apiPost:Object(r.flow)((function*({campaignId:a,data:r}){try{t.network.post.update("in_progress"),yield Object(o.ajax)({type:"POST",url:Routes.internal_site_campaign_loyalty_redemption_rules_path(t.rootStore.siteCachedSlug,a),data:r}),t.network.post.update("success")}catch(xhr){var n,i;throw t.network.post.update("error"),422!==xhr.status&&e({message:"Unable to create loyalty redemption rule",name:"Ajax failure",xhr:xhr}),null==(n=xhr.responseJSON)||null==(i=n.result)?void 0:i.errors}})),apiPut:Object(r.flow)((function*({campaignId:a,ruleId:r,data:n}){try{t.network.put.update("in_progress"),yield Object(o.ajax)({type:"PUT",url:Routes.internal_site_campaign_loyalty_redemption_rule_path(t.rootStore.siteCachedSlug,a,r),data:n}),t.network.put.update("success")}catch(xhr){var i,s;throw t.network.put.update("error"),422!==xhr.status&&e({message:`Unable to update loyalty redemption rule ${r}`,name:"Ajax failure",xhr:xhr}),null==(i=xhr.responseJSON)||null==(s=i.result)?void 0:s.errors}})),apiDelete:Object(r.flow)((function*({campaignId:a,ruleId:r}){try{t.network.delete.update("in_progress"),yield Object(o.ajax)({type:"DELETE",url:Routes.internal_site_campaign_loyalty_redemption_rule_path(t.rootStore.siteCachedSlug,a,r)}),t.network.delete.update("success")}catch(xhr){var n,i;throw t.network.delete.update("error"),422!==xhr.status&&e({message:`Unable to delete Loyalty rule ${r}`,name:"Ajax failure",xhr:xhr}),null==(n=xhr.responseJSON)||null==(i=n.result)?void 0:i.errors}}))})))}).call(this,a("B9cq").notifyDevelopers)},BYad:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("sT1B");const i=r.types.model("PersonalCouponFormStore",{personalCouponFormVisibility:!1,mode:"",selectedPersonalCouponListId:r.types.maybeNull(r.types.number),removeModalVisibility:!1,isHighlightChanges:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get router(){return e.rootStore.models.router},get sitePersonalCouponLists(){return e.rootStore.models.sitePersonalCouponLists},get currentPersonalCouponList(){return e.sitePersonalCouponLists.currentPersonalCouponList},get personalCouponListsForSelect(){return e.sitePersonalCouponLists.personalCouponListsForSelect},get formTitle(){return`${"create"===e.mode?"Create ":""}Advocate Personal Coupon Incentive`},get actionButtonText(){return`${"create"===e.mode?"Create":"Save"} Incentive`},get selectedPersonalCouponListIdSelectValue(){return _.find(e.personalCouponListsForSelect,{value:e.selectedPersonalCouponListId})||{}}}))).actions((e=>({updateHighlightChanges:t=>{e.isHighlightChanges=t},showHighlightChanges:()=>{e.updateHighlightChanges(!0),setTimeout((()=>{e.updateHighlightChanges(!1)}),3500)},showPersonalCouponForm:()=>{e.personalCouponFormVisibility=!0},hidePersonalCouponForm:()=>{e.personalCouponFormVisibility=!1,e.changeSelectedPersonalCouponListId(null),e.resetMode()},activateCreateMode:()=>{e.mode="create",e.showPersonalCouponForm(),Utils.trackGAEvent(n.u,"activate create mode")},activateEditMode:()=>{e.mode="edit",e.selectedPersonalCouponListId=e.currentPersonalCouponList.id,e.showPersonalCouponForm(),Utils.trackGAEvent(n.u,"activate edit mode")},activateDeleteMode:()=>{e.mode="delete",Utils.trackGAEvent(n.u,"activate remove mode")},resetMode:()=>{e.mode=""},showPersonalCouponRemoveModal:()=>{e.removeModalVisibility=!0,e.activateDeleteMode()},hidePersonalCouponRemoveModal:()=>{e.removeModalVisibility=!1,e.resetMode()},changeIntegrationLibraryPresent:t=>{e.integrationLibraryPresent=t},changeSelectedPersonalCouponListId:t=>{e.selectedPersonalCouponListId=t},detachPersonalCouponList:()=>{e.selectedPersonalCouponListId=null},handlePersonalCouponLists:t=>{const{selectedOption:{value:a}}=t;e.changeSelectedPersonalCouponListId(a)}})));i.create()},BYlJ:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("c7RZ"),i=a("UEOA"),o=a("M+GS"),s=a("V0vo");const l=r.types.model("RewardStore",{id:r.types.identifierNumber,amount:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),explanation:r.types.maybeNull(r.types.string),percentage_discount:r.types.maybeNull(r.types.boolean),coupon_used:r.types.maybeNull(r.types.boolean),short_description:r.types.maybeNull(r.types.string),status_text:r.types.maybeNull(r.types.string),status:r.types.maybeNull(r.types.string),coupon:r.types.maybeNull(n.a),incentive:r.types.maybeNull(i.a),human_type:r.types.maybeNull(r.types.string),page:r.types.maybeNull(r.types.number)}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get formattedStatusText(){return _.toLower(e.status_text)},get formattedStatus(){return _.toLower(e.status)},get formattedCreatedAt(){return e.rootStore.models.site.formatDate(e.created_at)},get relativeCreatedAt(){return e.relativeDate(e.created_at)},get humanType(){return`${e.human_type} reward`},get humanizedExplanation(){return e.explanation?`${e.incentive.human_name}: ${e.explanation}`:e.incentive.humanizedExplanation},get rewardPath(){return Routes.site_incentive_outcome_path(e.rootStore.siteCachedSlug,e.id)},get couponStatus(){return"discount_coupon"===e.incentive.incentive_type?e.incentive.single_use?`Single-use coupon ${e.coupon?e.coupon.code:""} reward: ${_.upperFirst(e.short_description)}`:`Multi-use coupon ${e.coupon?e.coupon.code:""} reward: ${_.upperFirst(e.short_description)}`:"rebate"===e.incentive.incentive_type?`Rebate reward: ${_.upperFirst(e.short_description)}`:"other"===e.incentive.incentive_type?`Non-monetary reward: ${_.upperFirst(e.short_description)}`:null},get originPath(){return Routes.edit_site_campaign_path(e.rootStore.siteCachedSlug,Object(s.v)(window.location.pathname),e.incentive.campaign_id,{anchor:Object(o.d)(e.incentive.id)})},relativeDate:e=>dayjs(e).fromNow(),couponUsageDescription:t=>"friend"===t?e.coupon_used?"\nCoupon usage: Used":"\nCoupon usage: Not used":"",tooltipForReward:t=>`${e.couponStatus}\nReward status: ${e.status_text}${e.couponUsageDescription(t)}`})))},Bb2w:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("/ZTi"),n=a("99Ma");const i=n.types.compose("CriteriaField",r.a,n.types.model({type:n.types.frozen("textarea_liquid"),key:n.types.frozen("criteria"),variables:n.types.frozen(),show:!1}).views((e=>({}))).actions((e=>({toggle(t){e.show=t},onToggleClick(){e.toggle(!e.show)}}))))},BeA6:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return p}));var r,n,i=a("vOnD"),o=a("GaHK"),s=a("TyAF");function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const c=i.default.div.withConfig({displayName:"campaigns_filter_select__SelectWrapper"})(["z-index:1;width:auto;min-width:150px;"]),p=Object(s.c)((n=r=function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,l(a,r),n.prototype.render=function(){const{value:t,options:a,onChange:r,name:n,size:i}=this.props;return e.createElement(c,{className:"mls"},e.createElement(o.UIInputSelect,{value:t,name:n,options:a,size:i,onChange:r}))},n}(e.PureComponent),r.defaultProps={size:"big"},n))}).call(this,a("q1tI"))},BpJz:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("99Ma");const n=r.types.model("PersonStore",{blocked:!1,email:r.types.maybeNull(r.types.string),first_name:r.types.maybeNull(r.types.string),id:r.types.maybeNull(r.types.number),last_name:r.types.maybeNull(r.types.string),manage_blocked_email_path:r.types.maybeNull(r.types.string),type:r.types.maybeNull(r.types.string)}).views((e=>({get fullName(){return[e.first_name,e.last_name].join(" ").trim()}})))},CFgq:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("GaHK"),n=a("ZQwf");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let o=function(t){var a,o;function s(){return t.apply(this,arguments)||this}return o=t,(a=s).prototype=Object.create(o.prototype),a.prototype.constructor=a,i(a,o),s.prototype.render=function(){const{width:t,stretch:a,children:i}=this.props;return e.createElement(n.b,{width:t,stretch:a},e.createElement(r.H5,null,i))},s}(e.PureComponent);o.defaultProps={width:null,stretch:!1}}).call(this,a("q1tI"))},CO79:function(e,t,a){"use strict";(function(e){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}a.d(t,"a",(function(){return n}));let n=function(t){var a,n;function i(){return t.apply(this,arguments)||this}return n=t,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,r(a,n),i.prototype.render=function(){const{className:t,kind:a,children:r}=this.props,n=classNames("base-text-label",t,{[`is-${a}`]:a});return e.createElement("div",{className:n},e.createElement("mark",null,r))},i}(e.PureComponent);Widget.BaseTextLabel=n}).call(this,a("q1tI"))},CVk5:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return m}));var r,n,i=a("TyAF"),o=a("vOnD"),s=a("GaHK"),l=a("ZQwf");function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const p=o.default.span.withConfig({displayName:"campaigns_filter_main_info_cell__CampaignStatus"})(["display:inline-block;width:12px;height:12px;border-radius:50%;box-sizing:border-box;",""],(e=>"Live"===e.status?Object(o.css)(["background:#3c913c;"]):"Disabled"===e.status?Object(o.css)(["width:10px;height:10px;border-radius:0;background:#df4343;"]):"Scheduled"===e.status?Object(o.css)(["display:inline-block;width:4px;border-radius:0;background:#eaa717;margin-right:8px;&::after{content:'';display:block;margin-left:2px;width:4px;height:12px;background-color:#eaa717;right:-5px;position:relative;}"]):Object(o.css)(["border:2px solid #eaa717;"]))),u=o.default.a.withConfig({displayName:"campaigns_filter_main_info_cell__Name"})(["display:inline-block;line-height:21px;max-width:500px;overflow:hidden;word-break:break-all;"]),d=o.default.div.withConfig({displayName:"campaigns_filter_main_info_cell__InfoCampaign"})(["height:19px;"]),m=Object(i.c)((n=r=function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,c(a,r),n.prototype.render=function(){const{siteCachedSlug:t,campaign:{status:a,placement_category_abbreviation:r,name:n,id:i,latest_change:o},children:c,stretch:m,notice:g,shrink:h,className:y,withDate:f,hideCampaignLink:_}=this.props;return e.createElement(l.b,{stretch:m,shrink:h,className:`flex ${y}`},e.createElement("div",{className:"flex align-items-flex-start"},e.createElement(d,{className:"flex align-items-center"},e.createElement(p,{status:a}),e.createElement(s.UICampaignBadge,{type:"all",category:r,size:"mini",className:"mls"})),e.createElement("div",{className:"mls"},e.createElement("div",{className:"flex align-items-center"},_?e.createElement(s.H5,null,n):e.createElement(u,{href:Routes.site_campaign_path(t,i),rel:"noopener noreferrer",target:"_blank",className:"link campaigns-filter-campaign-link"},n),c),e.createElement(s.BodyD,null,f&&`${null==o?void 0:o.formattedCreatedAtWithoutTime} \u2022 `,"ID: ",i,g&&` \u2022 ${g}`))))},n}(e.PureComponent),r.defaultProps={direction:"",stretch:!0,shrink:!0,notice:"",withDate:!1,hideCampaignLink:!1},n))}).call(this,a("q1tI"))},CfEP:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("4b23"),n=a("GaHK"),i=a("ZQwf");function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let s=function(t){var a,s;function l(e){var a;return(a=t.call(this,e)||this).id=Object(r.a)(),a}return s=t,(a=l).prototype=Object.create(s.prototype),a.prototype.constructor=a,o(a,s),l.prototype.render=function(){const{checked:t,disabled:a,onChange:r}=this.props;return e.createElement(i.b,null,e.createElement("div",{className:"flex mls"},e.createElement(n.UIInputCheckbox,{indeterminate:null===t||void 0,id:this.id,checked:t||!1,disabled:a,name:this.id,onChange:r})))},l}(e.PureComponent);s.defaultProps={disabled:!1,onChange:()=>{}}}).call(this,a("q1tI"))},CmFo:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("vrPu"),i=a("aetS"),o=a("M+GS");const s=e=>e.replace(/\d+$/,(e=>Number(e)+1)),l=r.types.model("IncentiveActions",{createModal:r.types.optional(i.a,{}),createAbTestModal:r.types.optional(i.a,{}),createTieredModal:r.types.optional(i.a,{}),deleteModal:r.types.optional(i.a,{}),turnOnClaimPageModal:r.types.optional(i.a,{}),incentiveData:r.types.frozen()}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get personalCouponFormStore(){return e.rootStore.pages.personalCouponFormStore},get campaignRulesStore(){return Object(r.getParentOfType)(e,n.a)},get campaign(){return e.campaignRulesStore.campaign},get incentives(){return e.campaignRulesStore.incentives},get view_setups(){return e.campaignRulesStore.view_setups},newIncentiveIdentifier(t){let a,r;if(a=_.max(_.map(e.incentives.data,"id")),r=s(t),r===t)return t+"_"+ ++a;const n=_.map(e.incentives.data,"identifier");for(;_.includes(n,r);)r=s(r);return r},needTurnClaimPageWhenAddIncentive:t=>!("ClickIncentive"!==t.type&&"ReferredIncentive"!==t.type||!e.view_setups.offersClaimViewSetup||!e.view_setups.isDisabledOffersClaimViewSetup||1!==e.incentives.friendIncentives.length),get canDeleteLastFriendIncentive(){var t;return(null==(t=e.incentiveData)?void 0:t.for_friend)&&1===e.incentives.friendIncentives.length&&e.view_setups.offersClaimViewSetup&&e.view_setups.isActiveOffersClaimViewSetup}}))).actions((t=>({updateIncentiveData:e=>{t.incentiveData=e},resetIncentiveData:()=>{t.incentiveData=null},openCreateModal:e=>{if("PersonalCouponIncentive"===e.type)return void t.personalCouponFormStore.activateCreateMode();const a={type:e.type,sub_type:e.sub_type};t.updateIncentiveData(a),t.createModal.open()},closeCreateModal:()=>{t.createModal.close(),t.needTurnClaimPageWhenAddIncentive(t.incentiveData)?t.turnOnClaimPageModal.open():t.resetIncentiveData()},openDeleteModal:e=>{const a={id:e.id,for_friend:e.for_friend};t.updateIncentiveData(a),t.deleteModal.open()},closeDeleteModal:()=>{t.deleteModal.close(),t.resetIncentiveData()},openCreateAbTestModal:e=>{const a={test_variant:!0,id:e.id,type:e.type,sub_type:Object(o.h)(e)};t.updateIncentiveData(a),t.createAbTestModal.open()},closeCreateAbTestModal:()=>{t.createAbTestModal.close(),t.resetIncentiveData()},openCreateTieredModal:e=>{const a={id:e.id,type:e.type,sub_type:Object(o.h)(e),identifier:t.newIncentiveIdentifier(e.identifier)};t.updateIncentiveData(a),t.createTieredModal.open()},closeCreateTieredModal:()=>{t.createTieredModal.close(),t.resetIncentiveData()},closeTurnOnClaimPageModal:()=>{t.turnOnClaimPageModal.close(),t.resetIncentiveData()},turnOnClaimPage:Object(r.flow)((function*(){try{yield t.view_setups.apiPatch({campaignId:t.campaign.id,viewSetupId:t.view_setups.offersClaimViewSetup.id,data:{is_disabled:0}}),yield t.view_setups.apiGet(t.campaign.id),t.closeTurnOnClaimPageModal(),Validation.succeed()}catch(xhr){e({name:"Unable to turn on claim page",message:"Ajax failure",xhr:xhr})}})),turnOffClaimPage:Object(r.flow)((function*(){try{yield t.view_setups.apiPatch({campaignId:t.campaign.id,viewSetupId:t.view_setups.offersClaimViewSetup.id,data:{is_disabled:1}}),yield t.view_setups.apiGet(t.campaign.id)}catch(xhr){e({name:"Unable to turn off claim page",message:"Ajax failure",xhr:xhr})}}))})))}).call(this,a("B9cq").notifyDevelopers)},Cpj0:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("x7QQ"),i=a("pm75"),o=a("2TKB");const s=r.types.compose("LiveScheduledCampaigns",n.a.array(o.c),i.c,r.types.model({}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get showLiveScheduledCampaigns(){return _.some(e.data)},get siteCachedSlug(){return e.rootStore.siteCachedSlug}}))).actions((t=>({apiGet:Object(r.flow)((function*(a){t.network.get.updateLoading(!0),t.network.get.updateLoaded(!1);try{const e=yield $.ajax({url:Routes.launch_form_internal_site_campaign_path(t.siteCachedSlug,a,{no_spinner:!0})}),r=_.get(e,"result.campaigns",[]);t.dataApplySnapshot(r),t.network.get.updateLoading(!1),t.network.get.updateLoaded(!0)}catch(xhr){UINotifications.add({text:"Unable to fetch campaigns",type:"error"}),e({name:"Unable to fetch campaigns",message:"Ajax failure",xhr:xhr})}}))}))))}).call(this,a("B9cq").notifyDevelopers)},CreG:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("TyAF"),n=a("1OfO");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const o=Object(r.c)(function(t){var a,r;function o(){return t.apply(this,arguments)||this}return r=t,(a=o).prototype=Object.create(r.prototype),a.prototype.constructor=a,i(a,r),o.prototype.render=function(){const{mobile:t,tablet:a,desktop:r}=this.props;return e.createElement("div",{className:"flex justify-flex-end"},e.createElement("div",{className:"flex align-items-flex-start"},e.createElement(n.a,{isEnabled:t,device:"mobile",className:"mrs"}),e.createElement(n.a,{isEnabled:a,device:"tablet",className:"mrs"}),e.createElement(n.a,{isEnabled:r,device:"desktop"})))},o}(e.PureComponent))}).call(this,a("q1tI"))},D0An:function(e,t,a){"use strict";(function(e,r){a.d(t,"a",(function(){return f}));var n=a("GaHK"),i=a("vOnD"),o=a("8C8s"),s=a("KfdZ"),l=a("kigN"),c=a("TyAF");function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const u=i.default.div.withConfig({displayName:"tfa_setup_section__WrapQrCode"})(["display:flex;flex-shrink:0;flex-basis:180px;height:180px;"]),d=i.default.div.withConfig({displayName:"tfa_setup_section__Preloader"})(["border-radius:8px;background:#fff;margin:auto;"]),m=i.default.div.withConfig({displayName:"tfa_setup_section__PreloaderContent"})(["display:flex;align-items:center;justify-content:center;width:100%;height:100%;flex-direction:column;"]),g=Object(i.default)(n.BodyS).withConfig({displayName:"tfa_setup_section__SpinnerText"})(["margin-top:10px;font-size:16px;line-height:1.56;color:#999;text-align:center;"]),h=i.default.div.withConfig({displayName:"tfa_setup_section__InputContainer"})(["width:200px;"]),y=e.lazy((()=>a.e(66).then(a.bind(null,"MzUQ")))),f=Object(c.b)((({userSettingsRootStore:e})=>({userSettingsRootStore:e})))(Object(c.c)(function(t){var a,i;function c(e){var a;return(a=t.call(this,e)||this).updateLoadingSetup=e=>{a.setState({isLoadingSetup:e})},a.updateSubmitting=e=>{a.setState({submitting:e})},a.updateErrors=e=>{a.setState({errors:e})},a.getSetup=async()=>{try{a.updateLoadingSetup(!0);const{result:e}=await $.ajax({url:Routes.new_internal_user_two_factor_authentication_setup_path({no_spinner:!0})});a.setState({setup:e.setup})}catch(xhr){r({name:"Unable to get internal_user_two_factor_authentication",message:"Ajax failure",xhr:xhr})}finally{a.updateLoadingSetup(!1)}},a.onChangeTfaToken=e=>{a.setState({tfa_token:e.target.value})},a.setupUserTFA=e=>$.ajax({type:"POST",url:Routes.internal_user_two_factor_authentication_setup_path({no_spinner:!0}),data:{two_factor_authentication:{tfa_token:e}}}),a.createTFA=async e=>{e&&e.preventDefault();const{userSettingsRootStore:t}=a.props;try{a.updateSubmitting(!0),await a.setupUserTFA(a.state.tfa_token),await t.currentUser.fetch(),a.updateSubmitting(!1),a.props.updateTfaEnabled(!0)}catch(xhr){const t=_.get(xhr,"responseJSON.result.errors");a.updateErrors(t),a.updateSubmitting(!1),o.a.showErrorFlash()}},a.state={setup:{},isLoadingSetup:!1,tfa_token:"",submitting:!1,errors:{}},a}i=t,(a=c).prototype=Object.create(i.prototype),a.prototype.constructor=a,p(a,i);var f=c.prototype;return f.componentDidMount=function(){this.getSetup()},f.render=function(){const{setup:t,isLoadingSetup:a,submitting:r,tfa_token:i,errors:o}=this.state;return e.createElement(l.a,{onSubmit:this.createTFA},a?e.createElement(d,null,e.createElement(m,null,e.createElement(n.UIIcon,{name:"spinner"}),e.createElement(g,null,"Creating code..."))):e.createElement(e.Fragment,null,e.createElement("div",null,e.createElement(s.a,{className:"mbl"},"You can set up 2FA following steps below:"),e.createElement("div",{className:"flex"},e.createElement("ol",null,e.createElement(s.a,{className:"mbs",as:"li"},"Download a two-factor authenticator app on your mobile device.",e.createElement("br",null),"(Example:"," ",e.createElement(n.UILink,{target:"_blank",href:"https://support.google.com/accounts/answer/1066447?hl=en"},"Google Authenticator"),")."),e.createElement(s.a,{className:"mbs",as:"li"},"Open the app, then scan QR code to the right or manually enter this code:",e.createElement(n.UIInlineCode,{className:"mts",text:t.tfa_secret||""})),e.createElement(s.a,{as:"li"},"Enter the six-digit numerical pass-code from the two-factor authenticator app to complete the setup process:",e.createElement(h,null,e.createElement("div",{className:"mtm"},e.createElement(n.UIInputText,{id:"tfa_token",name:"tfa_token",value:i,onChange:this.onChangeTfaToken,error:_.get(o,"two_factor_authentication.tfa_token"),autoFocus:!0}))),e.createElement(n.UIError,{error:[_.get(o,"two_factor_authentication.tfa_token")]}))),e.createElement(u,{"data-private":!0},e.createElement(e.Suspense,{fallback:e.createElement("div",null,"Loading...")},e.createElement(y,{code:t.tfa_setup_url}))))),e.createElement("div",{className:"mtxl justify-space-between"},e.createElement(n.UIButton,{className:"mtxxl align-self-flex-start",trait:"success",size:"xl",type:"submit",onClick:this.createTFA,disabled:a||r},"Complete"))))},c}(e.PureComponent)))}).call(this,a("q1tI"),a("B9cq").notifyDevelopers)},DDol:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return p}));var r=a("GaHK"),n=a("U6ye"),i=a("micW"),o=a("vOnD"),s=a("V0vo");function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const c=o.default.div.withConfig({displayName:"campaign_filter_campaign__StaticWidgetWrapper"})(["display:inline-block;position:relative;margin-left:5px;top:1px;"]);let p=function(t){var a,o;function p(e){var a;return(a=t.call(this,e)||this).onStatusChange=e.onStatusChange.bind(null,e.campaign),a.staticWidgetStore="1"===e.campaign.static_widget&&i.a.create({id:`${e.site.cached_slug}_${e.campaign.id}`,campaign_id:e.campaign.id,site_cached_slug:e.site.cached_slug,disabled_state:e.is_edit&&!0,tooltipDescription:e.is_edit?"This campaign uses \u201cStatic trigger widget\u201d setting":""}),a}return o=t,(a=p).prototype=Object.create(o.prototype),a.prototype.constructor=a,l(a,o),p.prototype.render=function(){const{campaign:t,notice:a,abbreviation:i,viewSetupLabel:o,is_edit:l,disabled:p,noOffers:u,checked:d,site:m,singleSelect:g,hideCampaignLink:h,withCreatedAt:y}=this.props,f=_.get(m,"cached_slug"),b=`campaignfilter-check-${t.id}`,v=`campaignfilter-campaign-status is-${t.status.toLowerCase()}`,S=classNames({"campaignfilter-campaign-data":!0,"is-disabled":p}),w=classNames({"is-edit":l,"is-have-extra-column":o}),C=classNames({dashboard:"PP"===t.placement_category_abbreviation,tiered:"SA"===t.placement_category_abbreviation,invite_full_bleed:"FW"===t.placement_category_abbreviation||"PE"===t.placement_category_abbreviation,gleam:"RG"===t.placement_category_abbreviation}),E=g?"base-radio":"base-checkbox",N=g?"radio":"checkbox";return e.createElement("li",{className:w},e.createElement("div",{className:"campaignfilter-campaign-check"},e.createElement("div",{className:E},e.createElement("input",{"data-testid":`ac-multiple-editor-campaign-filter-campaign-${t.id}`,type:N,id:b,onChange:this.onStatusChange,disabled:p||!l,checked:d}),e.createElement("label",{htmlFor:b},"\xa0"))),e.createElement("div",{className:v},e.createElement("i",{title:`Campaign status: ${t.status}`,"data-toggle":"tooltip"})),i&&C&&e.createElement("div",{className:"campaignfilter-campaign-label"},e.createElement(r.UICampaignBadge,{type:C,category:t.placement_category_abbreviation,size:"mini"})),e.createElement("div",{className:S},h?e.createElement("strong",null,t.name):_.some(f)&&e.createElement(e.Fragment,null,e.createElement("a",{href:Routes.site_campaign_path(f,t.id),target:"_blank"},t.name),"1"===t.static_widget&&e.createElement(c,null,e.createElement(n.a,{size:"small",background:"#fff",polling:!l&&"Live"===t.status,staticWidgetStore:this.staticWidgetStore}))),e.createElement("div",{className:"campaignfilter-campaign-id"},y&&Object(s.l)(Object(s.m)({date:t.latest_change.created_at,timeZone:m.time_zone_identifier}))+" ","ID: ",t.id,"\xa0",a)),o&&e.createElement("div",{className:"campaignfilter-campaign-views"},o),!u&&e.createElement("div",{className:"campaignfilter-campaign-offers"},Object(s.o)({value:t.offers_count_with_limit})))},p}(e.PureComponent);p.defaultProps={onStatusChange:()=>{},campaign:{id:null,appearance:null,status:""},checked:!1,disabled:!1,hideCampaignLink:!1,site:window.Site}}).call(this,a("q1tI"))},DNDY:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("sT1B"),i=a("RawV");const o=r.types.model("OriginData",{order_number:"",subtotal:0,coupon_code:""});let s={};const l=r.types.model("IntegrationPage",{platform:"",offsetTop:r.types.optional(r.types.number,0),errorMessages:r.types.optional(r.types.map(r.types.union(r.types.string)),{}),successMessages:r.types.optional(r.types.map(r.types.union(r.types.string)),{}),customIntegrationCurrentStage:"general_integration",customIntegrationGeneralStepPassed:!1,customIntegrationPPStepPassed:!1,shopifyInitialDataFetched:!1,lastOrigin:r.types.optional(o,{}),shopifyData:r.types.optional(i.a,{}),verifyingIntegration:!1,shopifyManualStep:!1,shopifyScriptFetched:!1,shopifyScript:r.types.maybeNull(r.types.string),installingShopifyApp:!1,removingShopifyApp:!1,resettingShopifyApp:!1,removeShopifyAppModal:!1,resetShopifyAppModal:!1,savingShopifyScript:!1,integrationLibraryPresent:!1,integrationLibraryPresentFetched:!1,integrationPageVisited:!1,savingShopifyAutoSync:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get site(){return e.rootStore.models.site},get currentUser(){return e.rootStore.models.currentUser},get siteCachedSlug(){return e.site.siteCachedSlug},get sitePlatform(){return e.site.platform},get siteCouponAutoSyncEnabled(){return e.site.shopify_coupon_auto_sync_enabled},get integrationScriptUrl(){return e.site.integration_script_url},get hasPerClientIntegrationScript(){return e.site.has_perclient_integration_script},get shopifyNeedsAdditionalPermissions(){return e.shopifyData.shopify_needs_additional_permissions},get couponAutoSyncEnabledExternal(){const{shopifyData:{shopify_authorized:t,shopify_connected:a}}=e;return t&&a},get couponAutoSyncEnabled(){return e.couponAutoSyncEnabledExternal&&e.siteCouponAutoSyncEnabled||e.createCouponWebHookExist},get shopifyCouponAutoSyncHumanName(){return e.couponAutoSyncEnabled?"ON":"OFF"},get shopifyIntegrationCompleted(){return e.couponAutoSyncEnabledExternal&&!e.shopifyNeedsAdditionalPermissions},get shopifyIntegrationWay(){const{shopifyData:{shopify_script_persisted:t},integrationLibraryPresent:a}=e;let r="";return r=t?"Automatic":a?"Manual":"Not found",r},get shopifyIntegrationWayIsManual(){return"Manual"===e.shopifyIntegrationWay},get shopifyIntegrationWayIsAutomatic(){return"Automatic"===e.shopifyIntegrationWay},get customIntegrationError(){return e.errorMessages.get(e.customIntegrationCurrentStage)},get customIntegrationSuccess(){return e.successMessages.get(e.customIntegrationCurrentStage)},get magentoError(){return e.errorMessages.get("magento")},get shopifyError(){return e.errorMessages.get("shopify")},get demandwareError(){return e.errorMessages.get("demandware")},get processingShopifyScript(){return e.savingShopifyScript||e.resettingShopifyApp||e.removingShopifyApp},get createCouponWebHookExist(){return e.site.create_coupon_web_hook_exists},get showShopifyToken(){return e.currentUser.staff_member&&e.shopifyData.shopify_token}}))).actions((t=>({afterCreate:()=>{s=Object(r.getSnapshot)(t)},reset:()=>{t.integrationPageVisited&&Object(r.applySnapshot)(t,s)},changeIntegrationPageVisitedState:e=>{t.integrationPageVisited=e},updateLastOrigin:e=>{t.lastOrigin=e},setCustomIntegrationCurrentStage:e=>{t.customIntegrationCurrentStage=e},clearAllMessages:()=>{t.successMessages.clear(),t.errorMessages.clear()},clearMessages:e=>{t.successMessages.delete(e),t.errorMessages.delete(e)},setTabError:({platform:e,msg:a})=>{t.errorMessages.set(e,a)},setTabSuccess:({platform:e,msg:a})=>{t.successMessages.set(e,a)},generalIntegrationSuccess:()=>{t.customIntegrationGeneralStepPassed=!0},postPurchaseIntegrationSuccess:()=>{t.customIntegrationPPStepPassed=!0},enableVerifyingIntegration:()=>{t.verifyingIntegration=!0},disableVerifyingIntegration:()=>{t.verifyingIntegration=!1},changeShopifyInitialDataFetched:e=>{t.shopifyInitialDataFetched=e},changeShopifyManualStep:e=>{t.shopifyManualStep=e},changeInstallingShopifyAppState:e=>{t.installingShopifyApp=e},changeIntegrationLibraryPresent:e=>{t.integrationLibraryPresent=e,t.integrationLibraryPresentFetched=!0},changeShopifyScriptFetchedState:e=>{t.shopifyScriptFetched=e},changeResettingShopifyAppState:e=>{t.resettingShopifyApp=e},changeRemovingShopifyAppState:e=>{t.removingShopifyApp=e},changeSavingShopifyScriptState:e=>{t.savingShopifyScript=e},changeSavingShopifyCouponAutoSyncState:e=>{t.savingShopifyAutoSync=e},showRemoveShopifyModal:()=>{t.removeShopifyAppModal=!0},hideRemoveShopifyModal:()=>{t.removeShopifyAppModal=!1},showResetShopifyModal:()=>{t.resetShopifyAppModal=!0},hideResetShopifyModal:()=>{t.resetShopifyAppModal=!1},updateShopifyScript:e=>{t.shopifyScript=e.integration_script_content,t.changeShopifyScriptFetchedState(!0)},handleChangeShopifyScript:e=>{t.shopifyScript=e.target.value},checkIntegrationLibraryPresence:Object(r.flow)((function*({platform:a,disableErrors:r}){t.clearAllMessages(),t.enableVerifyingIntegration();try{const e=yield $.ajax({url:Routes.check_integration_status_site_path(t.siteCachedSlug),data:{disableErrors:r}});t.changeIntegrationLibraryPresent(e.integration_library_present),"shopify"===a&&e.integration_library_present&&t.changeShopifyManualStep(!1),e.integration_library_present||r||t.setTabError({platform:a,msg:"NO_TALKABLE_LIBRARY"}),t.disableVerifyingIntegration()}catch(xhr){t.setTabError({platform:a,msg:"UNKNOWN_ERROR"}),e({name:`Unable to do ${a} verify`,message:"Ajax failure",xhr:xhr}),t.disableVerifyingIntegration()}})),checkPPIntegrationStatus:Object(r.flow)((function*(){t.clearMessages(t.customIntegrationCurrentStage),t.enableVerifyingIntegration();try{const e=yield $.ajax({url:Routes.check_integration_status_site_path(t.siteCachedSlug)});e.last_origin?(t.updateLastOrigin(e.last_origin),t.setTabSuccess({platform:t.customIntegrationCurrentStage,msg:"SUCCESS_PP_INTEGRATION"}),t.postPurchaseIntegrationSuccess()):t.setTabError({platform:t.customIntegrationCurrentStage,msg:"NO_PURCHASES"}),t.disableVerifyingIntegration()}catch(xhr){t.setTabError({platform:t.customIntegrationCurrentStage,msg:"UNKNOWN_ERROR"}),t.disableVerifyingIntegration(),e({name:"Unable to do customIntegrationAction",message:"Ajax failure",xhr:xhr})}})),checkGeneralIntegrationStatus:Object(r.flow)((function*(){t.clearMessages(t.customIntegrationCurrentStage),t.enableVerifyingIntegration();try{(yield $.ajax({url:Routes.check_integration_status_site_path(t.siteCachedSlug)})).integration_library_present?(t.setTabSuccess({platform:t.customIntegrationCurrentStage,msg:"Well done, we were able to find Talkable JS library on your homepage!"}),t.generalIntegrationSuccess()):t.setTabError({platform:t.customIntegrationCurrentStage,msg:"NO_TALKABLE_LIBRARY"}),t.disableVerifyingIntegration()}catch(xhr){t.setTabError({platform:t.customIntegrationCurrentStage,msg:"UNKNOWN_ERROR"}),t.disableVerifyingIntegration(),e({name:"Unable to do customIntegrationAction",message:"Ajax failure",xhr:xhr})}})),fetchShopifyData:Object(r.flow)((function*(){try{yield t.shopifyData.fetch()}catch(xhr){t.setTabError({platform:"shopify",msg:"UNKNOWN_ERROR"}),e({name:"Unable to get shopify data",message:"Ajax failure",xhr:xhr})}})),shopifyFetchInitialData:Object(r.flow)((function*(){try{yield Promise.all([t.checkIntegrationLibraryPresence({platform:"shopify",disableErrors:!0}),t.fetchShopifyData()]),t.changeShopifyInitialDataFetched(!0)}catch(xhr){e({name:"Unable to get initial shopify data",message:"Ajax failure",xhr:xhr})}})),fetchShopifyScript:Object(r.flow)((function*(){try{const e=yield $.ajax({url:Routes.internal_site_shopify_integration_path(t.siteCachedSlug),data:{no_spinner:!0}});t.updateShopifyScript(e.result)}catch(xhr){e({name:"Unable to get shopify script",message:"Ajax failure",xhr:xhr})}})),installShopifyApp:Object(r.flow)((function*(){t.changeInstallingShopifyAppState(!0);try{yield $.ajax({url:Routes.internal_site_shopify_integration_path(t.siteCachedSlug),type:"POST"}),yield t.fetchShopifyData(),t.changeInstallingShopifyAppState(!1),UINotifications.add({text:"Successfully integrated",type:"success"})}catch(xhr){401===xhr.status?(UINotifications.add({text:"Error authorizing access to your Shopify store",type:"error"}),yield t.fetchShopifyData(),Utils.trackGAEvent(n.S,"install shopify app failed because auth")):(UINotifications.add({text:"There was an error while integrating with Shopify",type:"error"}),e({name:"Unable to install shopify app",message:"Ajax failure",xhr:xhr})),t.changeInstallingShopifyAppState(!1)}Utils.trackGAEvent(n.S,"install shopify app click")})),removeShopify:Object(r.flow)((function*({history:a}){t.changeRemovingShopifyAppState(!0),t.hideRemoveShopifyModal();try{yield $.ajax({url:Routes.internal_site_shopify_integration_path(t.siteCachedSlug),type:"DELETE",data:{no_spinner:!0}}),yield t.fetchShopifyData(),t.changeRemovingShopifyAppState(!1),UINotifications.add({text:"Integration successfully removed",type:"success"}),a&&a.push(Routes.integration_shopify_site_path(t.siteCachedSlug))}catch(xhr){t.changeRemovingShopifyAppState(!1),UINotifications.add({text:"There was an error while removing Shopify app",type:"error"}),e({name:"Unable to remove shopify script",message:"Ajax failure",xhr:xhr})}})),resetShopify:Object(r.flow)((function*(){t.changeResettingShopifyAppState(!0),t.hideResetShopifyModal();try{yield $.ajax({type:"PUT",url:Routes.reset_internal_site_shopify_integration_path(t.siteCachedSlug),data:{no_spinner:!0}}),yield t.fetchShopifyScript(),t.changeResettingShopifyAppState(!1),UINotifications.add({text:"Integration was reset to defaults",type:"success"})}catch(xhr){t.changeResettingShopifyAppState(!1),UINotifications.add({text:"There was an error while resetting Shopify app",type:"error"}),e({name:"Unable to remove shopify script",message:"Ajax failure",xhr:xhr})}Utils.trackGAEvent(n.S,"reset shopify app")})),saveShopifyScript:Object(r.flow)((function*(){t.changeSavingShopifyScriptState(!0);try{yield $.ajax({type:"PUT",url:Routes.internal_site_shopify_integration_path(t.siteCachedSlug),data:{no_spinner:!0,site:{integration_script_content:t.shopifyScript}}}),t.changeSavingShopifyScriptState(!1),UINotifications.add({text:"Saved",type:"success"})}catch(xhr){t.changeSavingShopifyScriptState(!1),UINotifications.add({text:"There was an error updating integration",type:"error"}),e({name:"Unable to update shopify script",message:"Ajax failure",xhr:xhr})}Utils.trackGAEvent(n.S,"update shopify script")})),changeCouponAutoSync:Object(r.flow)((function*(a){t.changeSavingShopifyCouponAutoSyncState(!0);try{yield $.ajax({type:"PATCH",url:Routes.internal_site_path(t.siteCachedSlug),data:{site:{shopify_coupon_auto_sync_enabled:a}}}),yield t.site.fetch(t.siteCachedSlug),t.changeSavingShopifyCouponAutoSyncState(!1),UINotifications.add({text:"Coupon auto sync successfully changed",type:"success"})}catch(xhr){t.changeSavingShopifyCouponAutoSyncState(!1),UINotifications.add({text:"There was an error updating site setting",type:"error"}),e({name:"Unable to update shopify auto sync",message:"Ajax failure",xhr:xhr})}}))})))}).call(this,a("B9cq").notifyDevelopers)},Dg7y:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma");const n=r.types.model("LatestChangeSchema",{email:r.types.maybeNull(r.types.string),created_at:r.types.maybeNull(r.types.string)}),i=r.types.model("TileConfigStore",{id:r.types.identifierNumber,type:r.types.maybeNull(r.types.string),title:r.types.maybeNull(r.types.string),column_position:r.types.maybeNull(r.types.number),order_position:r.types.maybeNull(r.types.number),visible:r.types.maybeNull(r.types.boolean),human_type:r.types.maybeNull(r.types.string),async_data_identifiers:r.types.maybeNull(r.types.array(r.types.string)),report_url:r.types.maybeNull(r.types.string),latest_change:r.types.optional(n,{})}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({get parentStore(){return Object(r.getParent)(e,2)},get isDashboardTilesStore(){return"DashboardTilesStore"===Object(r.getParent)(e,2).name},get descriptionText(){return e.dynamicDescription.replace(/ {2,}/g," ")},get isCustomizable(){return _.some(e.configuration)},get showTileEditLink(){return e.isCustomizable&&e.parentStore.showTileEditLink},get tileDataStore(){return e.parentStore.getTileData(e.id)},get showTooltipDescription(){return e.descriptionText&&!e.parentStore.priorityMode},metricData:t=>e.tileDataStore[t]||{}}))).actions((e=>({updatePosition(t){const{columnPosition:a,orderPosition:r}=t;e.column_position=a,e.order_position=r}})));i.create()},DgEd:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("85NH");const i=r.types.model("LoyaltyCustomRuleCategorySchema",{id:r.types.number,identifier:r.types.string,rule:r.types.union(r.types.null,n.a)})},DrZn:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a("99Ma"),n=a("aFzQ"),i=a("aetS"),o=a("vrPu"),s=a("mxly"),l=a("Jpk0");const c=r.types.compose(l.a,r.types.model({})).views((e=>({get loyaltyTiersRootStore(){return Object(r.getParentOfType)(e,s.a)},get isBaseTier(){var e;return null==(e=this.currentTierInList)?void 0:e.isBaseTier},get minThreshold(){var e,t;const a=null==(e=this.currentTierInList)||null==(t=e.prevTier)?void 0:t.threshold;return a||0===a?a+1:0},get maxThreshold(){var e,t;if(this.isBaseTier)return 0;return(null==(e=this.currentTierInList)||null==(t=e.nextTier)?void 0:t.threshold)-1||1/0},get minMultiplier(){var e,t;return(null==(e=this.currentTierInList)||null==(t=e.prevTier)?void 0:t.multiplier)||1},get maxMultiplier(){var e,t;return(null==(e=this.currentTierInList)||null==(t=e.nextTier)?void 0:t.multiplier)||1/0},get currentTierInList(){return this.loyaltyTiersRootStore.tiersData.getTierById(e.id)}}))),p=r.types.model("LoyaltyTiersUpdateStore",{data:r.types.optional(c,{}),initialData:r.types.optional(l.a,{}),deleteModal:r.types.optional(i.a,{}),deleteTierConfirmation:""}).views((e=>({get deleteTierConfirmationKey(){return`Delete ${e.initialData.name} tier`},get rootStore(){return Object(r.getRoot)(e)},get campaignRulesStore(){return Object(r.getParentOfType)(e,o.a)},get loyaltyTiersRootStore(){return Object(r.getParentOfType)(e,s.a)},get isPristine(){return _.isEqual(Object(n.toJS)(e.initialData),Object(n.toJS)(e.data))},get isConfirmedDelete(){return e.deleteTierConfirmationKey===e.deleteTierConfirmation},get showDeleteTierButton(){var t;return this.rootStore.isStaffMember&&0!==(null==(t=e.data.currentTierInList)?void 0:t.currentIndex)&&this.loyaltyTiersRootStore.tiers.length>2}}))).actions((e=>{const t=t=>{Object(r.applySnapshot)(e.data,t),Object(r.applySnapshot)(e.initialData,t)},a=Object(r.flow)((function*(){try{yield e.loyaltyTiersRootStore.tiersData.update({tierId:e.data.id,campaignId:e.campaignRulesStore.campaign.id,data:{tier:e.data.preparedDataForServer},iconUrl:e.data.defaultIconUrlToUpload}),s()}catch(t){throw e.data.updateErrors(t),new Error("Unable to update tier")}})),i=Object(r.flow)((function*(t){try{o(),yield e.loyaltyTiersRootStore.tiersData.delete({tierId:e.data.id,campaignId:e.campaignRulesStore.campaign.id}),s()}catch(t){throw e.data.updateErrors(t),new Error("Enable to delete loyalty tier")}})),o=()=>{t(Object(n.toJS)(e.initialData))},s=()=>{Object(r.applySnapshot)(e,{})};return{init:a=>{const r=e.loyaltyTiersRootStore.tiersData.getTierById(a);if(!r)throw new Error("No such redemption rule");{const e=Object(n.toJS)(r);t(e)}},updateData:t,handleChangeDeleteConfirmation:({target:{value:t}})=>{e.deleteTierConfirmation=t},handleUpdate:a,closeDeleteModal:()=>{e.deleteTierConfirmation="",e.deleteModal.close()},handleDelete:i,handleDiscardChanges:o,reset:s}}))},DvqJ:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return d}));var r=a("99Ma"),n=a("dhqo"),i=a.n(n),o=a("B9cq"),s=a("HzpY"),l=a("2TKB"),c=a("aetS"),p=a("AEM3"),u=a("pm75");const d=r.types.model("CampaignsDetacher",{currentPlacementId:r.types.maybeNull(r.types.number),campaigns:r.types.array(l.a),modal:r.types.optional(c.a,{}),network:r.types.optional(r.types.model({deactivate:r.types.optional(u.a,{}),move:r.types.optional(u.a,{})}).views((e=>({get isLoading(){return e.deactivate.isLoading||e.move.isLoading}}))),{}),selectedPlacementId:r.types.maybeNull(r.types.number)}).volatile((()=>({movedCampaignsToAnotherPlacement:[],detachedCampaignsQueue:[],resolve:()=>null,reject:()=>null}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get placementsRootPage(){return Object(r.getParentOfType)(e,p.a)},get placements(){return e.placementsRootPage.placements},get isStaticWidgetCampaign(){return e.campaigns.some((e=>Object(s.d)(e)))},get campaignsAppearance(){return e.campaigns[0].appearance},get availablePlacements(){return e.placements.campaign_placements.filter((t=>t.appearance===e.campaignsAppearance&&t.id!==e.currentPlacementId))},get selectedPlacement(){return e.availablePlacements.find((t=>t.id===e.selectedPlacementId))}}))).actions((t=>({updateCampaigns(e){t.campaigns.replace(e)},initPromise:()=>new Promise(((e,a)=>{t.resolve=e,t.reject=a,t.nextStep()})),rejectDetachedCampaigns(e){t.reject(e),t.reset()},resolveDetachedCampaigns(){t.resolve(t.movedCampaignsToAnotherPlacement),t.reset()},nextStep(){t.modal.close(),_.some(t.detachedCampaignsQueue)?(t.updateCampaigns(t.detachedCampaignsQueue.pop()),t.modal.open()):t.resolveDetachedCampaigns(t.movedCampaignsToAnotherPlacement)},updateCurrentPlacementId(e){t.currentPlacementId=e},init:({placementId:e,detachedCampaigns:a})=>(t.updateCurrentPlacementId(e),t.initQueue(a)),resetQueue(){t.detachedCampaignsQueue=[]},initQueue(e){t.resetQueue();const a=e.filter(s.d),r=e.filter((e=>"Live"===e.status&&"0"===e.static_widget));return _.some(r)&&t.detachedCampaignsQueue.push(r),_.some(a)&&t.detachedCampaignsQueue.push(a),t.initPromise()},handleMoveCampaigns:Object(r.flow)((function*(){try{t.network.move.updateLoading(!0),yield Promise.all(t.campaigns.map((e=>t.placementsRootPage.updateCampaignPlacementRequest({campaignId:e.id,placementId:t.selectedPlacementId})))),t.campaigns.forEach((e=>{t.movedCampaignsToAnotherPlacement.push(e.id)})),UINotifications.showSuccessFlash(`${i()("Campaign",t.campaigns.length)} ${i()("was",t.campaigns.length)} successfully moved to another placement`),t.nextStep()}catch(xhr){UINotifications.showErrorFlash(),e({name:"Unable to move campaign to another placement",message:"Ajax failure",xhr:xhr}),t.rejectDetachedCampaigns()}finally{Object(r.isAlive)(t)&&t.network.move.updateLoading(!1)}})),handleDeactivateCampaigns:Object(r.flow)((function*(){try{t.network.deactivate.updateLoading(!0),yield Promise.all(t.campaigns.map((e=>Object(o.ajax)({url:Routes.toggle_deal_status_site_campaign_path(t.siteCachedSlug,e.id)})))),UINotifications.showSuccessFlash(`${i()("Campaign",t.campaigns.length)} ${i()("was",t.campaigns.length)} successfully deactivated`),t.nextStep()}catch(xhr){UINotifications.showErrorFlash(),e({name:"Unable to deactivate campaigns",message:"Ajax failure",xhr:xhr}),t.rejectDetachedCampaigns()}finally{Object(r.isAlive)(t)&&t.network.deactivate.updateLoading(!1)}})),handleClose(){t.modal.close(),t.rejectDetachedCampaigns()},updateSelectedPlacement(e){t.selectedPlacementId=e},reset(){Object(r.applySnapshot)(t,{}),t.movedCampaignsToAnotherPlacement=[],t.detachedCampaignsQueue=[],t.resolve=()=>null,t.reject=()=>null}})))}).call(this,a("B9cq").notifyDevelopers)},EAOr:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return s}));var r=a("99Ma"),n=a("B9cq");const i=r.types.model("Pattern",{regexp:!1,pattern:""}),o=r.types.model("SitePlacementSchema",{id:r.types.maybeNull(r.types.number),appearance:"",category:"",category_abbreviation:r.types.maybeNull(r.types.string),name:"",previewable:!1,restricted:!1,site_id:r.types.maybeNull(r.types.number),priority:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),updated_at:r.types.maybeNull(r.types.string),event_category_id:r.types.maybeNull(r.types.number),enable_desktop:!1,enable_tablet:!1,enable_mobile:!1,inclusions:r.types.array(i),exclusions:r.types.array(i)}),s=r.types.model("SitePlacements",{campaign_placements:r.types.array(o),constants:r.types.frozen(),isFetching:!1,isFetched:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},getById:t=>e.campaign_placements.find((e=>e.id===Number(t)))}))).actions((t=>({updateFetching:e=>{t.isFetching=e},updateFetched:e=>{t.isFetched=e},update:e=>{Object(r.applySnapshot)(t,e)},fetch:Object(r.flow)((function*(){t.updateFetching(!0);try{const{result:e}=yield Object(n.ajax)({url:Routes.internal_site_campaign_placements_path(t.rootStore.models.site.cached_slug,{no_spinner:!0})});Object(r.applySnapshot)(t,e),t.updateFetched(!0)}catch(xhr){e({name:"Unable to fetch Campaign Placements",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.updateFetching(!1)}})),reset(){Object(r.applySnapshot)(t,{})}})))}).call(this,a("B9cq").notifyDevelopers)},EIXB:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("B9cq");const i=r.types.model("UnblockedIncentives",{advocate:r.types.maybeNull(r.types.string),friend:r.types.maybeNull(r.types.string)}).actions((e=>({updateIncentive:({type:t,data:a})=>{const{selectedOption:{value:r}}=a;e[t]=r}}))),o=r.types.model("UnblockedReferralStore",{showModal:!1,incentives:r.types.optional(i,{}),referralIsFetching:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get referral(){return Object(r.getParent)(e)},get campaign(){return e.referral.referral.campaign},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get advocateIncentives(){let t=[];return t=e.campaign.tiered?e.referral.advocate.incentives.filter((e=>"ReferrerIncentive"===e.type)):e.referral.advocate.unredeems.map((e=>"ReferrerIncentive"===e.incentive.type&&e.incentive)),t},get unredeemFriendIncentives(){return e.referral.friend.unredeems.map((e=>"ReferredIncentive"===e.incentive.type&&e.incentive))},get isAvailableIncentives(){return _.some(e.advocateIncentives)||_.some(e.unredeemFriendIncentives)},get cannotContinueUnblockReferral(){return _.some(e.advocateIncentives)&&!e.incentives.advocate||_.some(e.unredeemFriendIncentives)&&!e.incentives.friend},get disabledUnblockButton(){return e.cannotContinueUnblockReferral||e.referralIsFetching},optionsForSelect(e){const t=e.map((e=>({label:`${e.short_description} ${e.human_name}`,value:String(e.id)})));return t.push({label:"None",value:"none"}),t},selectedIncentive:t=>e.referral[t].incentives.find((a=>String(a.id)===e.incentives[t])),get showAdvocateIncentive(){return _.some(e.advocateIncentives)},get showFriendIncentive(){return _.some(e.unredeemFriendIncentives)},incentivePath:t=>`${Routes.edit_site_campaign_path(e.siteCachedSlug,e.campaign.id)}#/incentives/edit/${t}`,get campaignPath(){return Routes.site_campaign_path(e.siteCachedSlug,e.campaign.id)},couponListPath:t=>Routes.site_coupon_list_path(e.siteCachedSlug,t),get canBeUnblocked(){const{referral:t}=e.referral;return!t.child_id&&"blocked"===t.status},get prepareDataForServer(){let t={no_spinner:!0};return e.incentives.advocate&&"none"!==e.incentives.advocate&&(t.referrer_incentive_id=e.incentives.advocate),e.incentives.friend&&"none"!==e.incentives.friend&&(t.referred_incentive_id=e.incentives.friend),t}}))).actions((t=>({resetStore:()=>{Object(r.applySnapshot)(t,{})},init:()=>{1===t.advocateIncentives.length&&t.incentives.updateIncentive({type:"advocate",data:{selectedOption:{value:String(t.advocateIncentives[0].id)}}}),1===t.unredeemFriendIncentives.length&&t.incentives.updateIncentive({type:"friend",data:{selectedOption:{value:String(t.unredeemFriendIncentives[0].id)}}})},toggleModal:()=>{t.showModal=!t.showModal},updateReferralFetch:e=>{t.referralIsFetching=e},goToReferralDetails:({id:e,history:a})=>{a.push(Routes.customer_service_portal_referral_details_site_path(t.siteCachedSlug,e))},unblockReferral:Object(r.flow)((function*(a){t.updateReferralFetch(!0);try{const e=yield Object(n.ajax)({url:Routes.recreate_internal_site_customer_service_referral_path(t.siteCachedSlug,t.referral.id),type:"POST",data:t.prepareDataForServer});t.goToReferralDetails({id:e.result.id,history:a})}catch(xhr){UINotifications.add({text:_.get(xhr,"responseJSON.result.error_message"),type:"error"}),e({name:"Unable to re-create referral",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.updateReferralFetch(!1)}}))})))}).call(this,a("B9cq").notifyDevelopers)},"EcW+":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("99Ma");const n=r.types.model("SiteSplitTest",{id:r.types.number,first_impression_created_at:r.types.maybeNull(r.types.string),last_impression_created_at:r.types.maybeNull(r.types.string),key:r.types.string,locale_key:r.types.maybeNull(r.types.string),name:r.types.string,previewable:r.types.boolean,progress:r.types.number,status:r.types.string,type:r.types.string,winner_selected_at:r.types.maybeNull(r.types.string),winner_variant:r.types.frozen(),variants:r.types.optional(r.types.array(r.types.frozen()),[]),view_setup_ids:r.types.optional(r.types.array(r.types.frozen()),[]),campaigns:r.types.optional(r.types.array(r.types.frozen()),[])}),i=r.types.model("SiteSplitTests",{data:r.types.optional(r.types.array(n),[]),isFetching:!1,isFetched:!1}).views((e=>({get siteCachedSlug(){return Object(r.getRoot)(e).siteCachedSlug}}))).actions((t=>({setFetching(e){t.isFetching=e},setFetched(e){t.isFetched=e},fetch(){t.setFetching(!0),$.ajax({url:Routes.internal_site_split_tests_path(t.siteCachedSlug,{no_spinner:!0})}).then((e=>{t.setFetching(!1),t.setFetched(!0),t.updateSiteSplitTests(e.result.split_tests)})).fail((t=>{e({name:"Unable to fetch Site Split Tests",message:"Ajax failure",xhr:t})}))},updateSiteSplitTests(e){t.data.replace(e)},reset(){Object(r.applySnapshot)(t,{})}})))}).call(this,a("B9cq").notifyDevelopers)},El5V:function(e,t,a){"use strict";(function(e){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}a.d(t,"a",(function(){return n}));let n=function(t){var a,n;function i(e){var a;return a=t.call(this,e)||this,e.toggle&&(a.toggle=e.toggle.bind(null)),a}return n=t,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,r(a,n),i.prototype.render=function(){const{all_campaigns_selected:t,views:a,toggle:r}=this.props;return e.createElement("div",{className:"campaignfilter-head is-th"},r&&e.createElement("div",{className:"campaignfilter-campaign-check"},e.createElement("div",{className:"base-checkbox"},e.createElement("input",{type:"checkbox",id:"select-all-campaigns",onChange:this.toggle,checked:t}),e.createElement("label",{htmlFor:"select-all-campaigns"},"\xa0"))),e.createElement("div",{className:"campaignfilter-campaign-data"},"Campaign name & ID"),a&&e.createElement("div",{className:"campaignfilter-campaign-views"},"Views in Test"),e.createElement("div",{className:"campaignfilter-campaign-offers"},"Offers total:"))},i}(e.PureComponent)}).call(this,a("q1tI"))},Fc2S:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("TyAF"),n=a("Ty5D"),i=a("rwDS"),o=a("o+QP"),s=a("Tehy");function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const c=Object(r.c)(function(t){var a,c;function p(){return t.apply(this,arguments)||this}return c=t,(a=p).prototype=Object.create(c.prototype),a.prototype.constructor=a,l(a,c),p.prototype.render=function(){return e.createElement(r.a,{userSettingsRootStore:i.b},e.createElement(n.e,{history:i.a},!i.b.shouldRenderSpa&&e.createElement(s.a,null),i.b.shouldRenderSpa&&e.createElement(o.a,null)))},p}(e.PureComponent))}).call(this,a("q1tI"))},Foy5:function(e,t,a){"use strict";function r(e,t,a){_.isObject(t)&&_.keys(t).forEach((n=>{let i=a?`${a}.${n}`:n;i=i.replace(/(\.)([0-9]+)/g,"[$2]");const o=_.has(t,`${n}.value`)?`${n}.value`:n,s=_.get(t,o);_.isObject(s)?r(e,s,i):e[i]=i}))}function n(e){let t={};return r(t,function(e){return _.transform(e,((e,t,a)=>{t.description&&(e[a]=t.value)}),{})}(e)),_.keys(t)}function i(e,t){const a={};return _.map(t,(t=>{const r=o(e,t);_.isUndefined(r)||(a[t]=r)})),a}function o(e,t){var a;const r=(e,t)=>`.value.${t}`;if("string"!==typeof t||"undefined"===typeof e)return null;if(t.includes("[")&&!t.includes("value.")&&(t=t.replace(/\[(\d+)\]/,r)),"object"===typeof e.value&&!Array.isArray(e.value)&&null!==e.value)return o(e.value,t);if(t.includes(".")){const a=t.indexOf("."),r=e[t.substring(0,a)];if(r)return o(r,t.substr(a+1))}return _.isUndefined(null==(a=e[t])?void 0:a.value)?e.prop:e[t].value}a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}))},"G/JG":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return p}));var r=a("99Ma"),n=a("x7QQ"),i=a("pm75"),o=a("85NH"),s=a("B9cq"),l=a("sT1B");const c=r.types.compose("LoyaltyRulesData",n.a.array(o.a),i.c).views((e=>({get rootStore(){return Object(r.getRoot)(e)},getFirstRuleByType:t=>e.data.find((e=>e.type===t)),getRuleById:t=>e.data.find((e=>e.id===t))}))).actions((t=>({apiGet:Object(r.flow)((function*(a){try{t.network.get.update("in_progress");const{result:e}=yield Object(s.ajax)({url:Routes.internal_site_campaign_loyalty_rules_path(t.rootStore.siteCachedSlug,a)});t.dataApplySnapshot(null==e?void 0:e.rules),t.network.get.update("success")}catch(xhr){t.network.get.update("error"),e({message:"Unable to fetch Loyalty campaign rules",name:"Ajax failure",xhr:xhr})}})),apiPost:Object(r.flow)((function*({campaignId:a,data:r}){if(!r.rule.icon)throw{icon:"Icon is required"};try{t.network.post.update("in_progress"),yield Object(s.ajax)({type:"POST",withFileUpload:!0,url:Routes.internal_site_campaign_loyalty_rules_path(t.rootStore.siteCachedSlug,a),data:r}),t.network.post.update("success")}catch(xhr){var n,i;throw t.network.post.update("error"),422!==xhr.status&&e({message:"Unable to create Loyalty rule",name:"Ajax failure",xhr:xhr}),null==(n=xhr.responseJSON)||null==(i=n.result)?void 0:i.errors}})),apiPut:Object(r.flow)((function*({campaignId:e,ruleId:a,data:r}){try{t.network.put.update("in_progress"),yield Object(s.ajax)({withFileUpload:!0,type:"PUT",url:Routes.internal_site_campaign_loyalty_rule_path(t.rootStore.siteCachedSlug,e,a),data:r}),t.network.put.update("success")}catch(xhr){throw t.network.put.update("error"),xhr}})),apiDelete:Object(r.flow)((function*({campaignId:a,ruleId:r}){try{t.network.delete.update("in_progress"),yield Object(s.ajax)({type:"DELETE",url:Routes.internal_site_campaign_loyalty_rule_path(t.rootStore.siteCachedSlug,a,r)}),t.network.delete.update("success")}catch(xhr){var n,i;throw t.network.delete.update("error"),422!==xhr.status&&e({message:`Unable to delete Loyalty rule ${r}`,name:"Ajax failure",xhr:xhr}),null==(n=xhr.responseJSON)||null==(i=n.result)?void 0:i.errors}}))}))),p=r.types.compose("LoyaltyRulesVariablesData",n.a.map(r.types.frozen()),i.c).views((e=>({get rootStore(){return Object(r.getRoot)(e)},getVariablesByType:t=>e.data.get(t)}))).actions((t=>({apiGetForAllTypes:Object(r.flow)((function*(e){yield Promise.all(Object.values(l.V).map((a=>t.apiGet({campaignId:e,type:a}))))})),apiGet:Object(r.flow)((function*({campaignId:a,type:r}){try{const e=yield Object(s.ajax)({url:Routes.criteria_sample_interpolations_internal_site_campaign_loyalty_rules_path(t.rootStore.siteCachedSlug,a,{type:r})});t.data.set(r,e.result.criteria_sample_interpolations),t.network.get.update("success")}catch(xhr){t.network.get.update("error"),e({message:`Unable to fetch Loyalty campaign rule ${r} variables`,name:"Ajax failure",xhr:xhr})}}))})))}).call(this,a("B9cq").notifyDevelopers)},GKah:function(e,t,a){"use strict";a("dQ6V"),a("huDt"),a("zHjf"),a("A95y"),a("koaK"),a("wY3E"),a("Y1Wb"),a("1kcE"),a("Ypvm"),a("HvC/")},GdP4:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r=e=>_.reduce(e,((e,t,a)=>""===t?_.omit(e,[a]):("all"!==t&&(e[a]=t),e)),{})},H42K:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("TyAF"),n=a("vOnD"),i=a("GaHK");function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const s=n.default.div.withConfig({displayName:"user_settings_invite_page__OfferContainer"})(["display:flex;height:100%;align-items:center;justify-content:center;"]),l=Object(r.b)((({userSettingsRootStore:e})=>({userSettingsRootStore:e})))(Object(r.c)(function(t){var a,r;function n(e){var a;return(a=t.call(this,e)||this).createScriptElem=()=>{a.script=document.createElement("script"),a.script.type="text/javascript",a.script.async=!0,a.script.src="https://d2jjzw81hqbuqv.cloudfront.net/integration/clients/talkable-raf.min.js"},a.createScriptElem(),a}r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,o(a,r);var l=n.prototype;return l.componentDidMount=function(){window._talkableq=[["init",{site_id:"talkable-raf"}],["authenticate_customer",{email:this.props.userSettingsRootStore.currentUser.email}],["register_affiliate",{}]],document.body.appendChild(this.script)},l.componentWillUnmount=function(){document.body.removeChild(this.script)},l.render=function(){return e.createElement(s,{id:"talkable-offer"},e.createElement(i.UILoader,null))},n}(e.PureComponent)))}).call(this,a("q1tI"))},HDDd:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("pm75"),i=a("x7QQ");const o=r.types.model("ReferralSaleMetric",{metric:"",plain:r.types.maybeNull(r.types.number),formatted:"",humanized:""}).views((e=>({}))).actions((e=>({}))),s=r.types.model("ReferralSalesEventCategory",{event_category_identifier:"",metrics:r.types.array(o),report_path:""}).views((e=>({get idealFriendCount(){return e.getMetricByName("ideal_friend_sales_count")},get idealFriendSum(){return e.getMetricByName("ideal_friend_sales_sum")},get idealAdvocateSalesCount(){return e.getMetricByName("ideal_advocate_sales_count")},get idealAdvocateSalesSum(){return e.getMetricByName("ideal_advocate_sales_sum")},getMetricByName:t=>e.metrics.find((e=>e.metric===t))}))).actions((e=>({}))),l=r.types.model("ReferralSalesSchema",{report_data:r.types.array(s),report_path:r.types.maybeNull(r.types.string)}).views((e=>({get filteredEventCategories(){return e.report_data.filter((e=>0!==_.sumBy(e.metrics,"plain")))},get anyFilteredEventCategories(){return _.some(e.filteredEventCategories)}}))).actions((e=>({}))),c=r.types.compose("ReferralSalesData",i.a.model(l),n.c).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignShowRoot(){return e.rootStore.pages.campaignShowRoot},get currentCampaign(){return e.campaignShowRoot.currentCampaign},get site(){return e.rootStore.models.site},get siteCachedSlug(){return e.site.siteCachedSlug},get isLoaded(){return e.network.get.isLoaded}}))).actions((t=>({apiGet:Object(r.flow)((function*(){try{t.network.get.updateLoading(!0);const e=yield $.ajax({url:Routes.widget_internal_site_campaign_path(t.siteCachedSlug,t.currentCampaign.id,{report:"referral_sales",no_spinner:!0})});t.dataApplySnapshot(e.result),t.network.get.updateLoaded(!0)}catch(xhr){e({name:"Unable to fetch referral sales",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.network.get.updateLoading(!1)}}))})))}).call(this,a("B9cq").notifyDevelopers)},"HvC/":function(e,t,a){"use strict";(function(e){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}a.d(t,"a",(function(){return n}));let n=function(t){var a,n;function i(e){var a;return(a=t.call(this,e)||this).state={template:e.template&&Widget.AbTestsModalConstants[e.template]?e.template:"existingTemplate"},a}n=t,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,r(a,n);var o=i.prototype;return o.componentDidMount=function(){const{closeAbPopup:e}=this.props;window.document.body.addEventListener("keyup",(t=>{"Escape"===t.key&&e()}))},o.render=function(){const{closeAbPopup:t,footerButtonFunc:a,headerExtraData:r}=this.props,{template:n}=this.state;return e.createElement("div",{className:"Locale-entries-popup-holder"},e.createElement("div",{className:"Locale-entries-popup-overlay js-locale-assets-uploader-overlay"},e.createElement("div",{className:"Locale-entries-popup js-locale-assets-uploader Locale-entries-assets-uploader is-small"},e.createElement("div",{className:"Locale-entries-button-close",onClick:t},"\xd7"),e.createElement("div",{className:"Locale-entries-popup-title is-no-border js-locale-assets-upload"},e.createElement(Widget.AbTestsModalHeader,{headerExtraData:r,template:n})),e.createElement("div",{className:"Locale-entries-popup-overlay-body"},"existingTemplate"===this.state.template&&e.createElement(Widget.AbTestsModalExisting,this.props),"confirmDeletePopup"===this.state.template&&e.createElement(Widget.AbTestsModalDeleteConfirmation,this.props),"confirmDeleteVariantPopup"===this.state.template&&e.createElement(Widget.AbTestsModalDeleteVariantConfirmation,this.props),"confirmChooseWinnerPopup"===this.state.template&&e.createElement(Widget.AbTestsModalChooseWinnerConfirmation,this.props)),Widget.AbTestsModalConstants[n].footerParams&&e.createElement(Widget.AbTestsModalFooter,{template:n,closeAbPopup:t,footerButtonFunc:a})),e.createElement("div",{className:"Locale-entries-popup-helper"})))},i}(e.PureComponent)}).call(this,a("q1tI"))},HzpY:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return l}));var r=a("sT1B");const n=e=>e.preset_name===r.s.GLEAM&&e.appearance===r.l.GLEAM,i=e=>e.preset_name===r.s.EMAIL_CAPTURE&&e.appearance===r.l.POPUP,o=e=>e.preset_name===r.s.LOYALTY&&e.appearance===r.l.WIDGET,s=e=>"Live"===e.status,l=e=>(e=>"1"===e.static_widget)(e)&&s(e)},I2ID:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return s}));var r=a("sT1B"),n=a("4mPH");const i=({category:e,platform:t,eventCategories:a})=>{var i,o,s,l;const c={inclusions:[{regexp:!1,pattern:""}],enable_desktop:!0,enable_tablet:!0,enable_mobile:!0,category_abbreviation:e};switch(e){case r.Z.PP:return{...c,appearance:Object(n.a)(e),event_category_id:null==(i=_.find(a,{identifier:"purchase"}))?void 0:i.id};case r.Z.FW:return{...c,appearance:Object(n.a)(e),event_category_id:null==(o=_.find(a,{identifier:"affiliate_member"}))?void 0:o.id};case r.Z.SA:return{...c,inclusions:[{regexp:!1,pattern:"shopify"===t?"/pages/share":"/share"}],appearance:Object(n.a)(e),event_category_id:null==(s=_.find(a,{identifier:"affiliate_member"}))?void 0:s.id};case r.Z.RG:return{...c,appearance:Object(n.a)(e),event_category_id:null==(l=_.find(a,{identifier:"affiliate_member"}))?void 0:l.id};case r.Z.PE:return{...c,event_category_id:0,appearance:Object(n.a)(e)};default:throw new Error("No such placement")}},o=({category:e,campaigns:t})=>{const a=[],r=[];return t.forEach((t=>{null===t.placement_id&&t.appearance===Object(n.a)(e)?a.push(t):r.push(t)})),{available:a,ineligible:r}},s=e=>Object(n.e)(_.omit(e,"id"))},I4NK:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("VX74");const i=r.types.model("IntField",{value:r.types.number,name:r.types.string}).actions((e=>({handleChange({target:{value:t}}){e.value=t}}))),o=r.types.model({min:i,max:i}).views((e=>({get values(){return{min:e.min.value,max:e.max.value||1/0}}}))),s=r.types.model({search:"",pointsBalance:r.types.optional(o,{min:{value:0,name:"points_balance_min"},max:{value:1/0,name:"points_balance_max"}}),pointsEarned:r.types.optional(o,{min:{value:0,name:"points_earned_min"},max:{value:1/0,name:"points_earned_max"}}),pointsRedeemed:r.types.optional(o,{min:{value:0,name:"points_redeemed_min"},max:{value:1/0,name:"points_redeemed_max"}})}).actions((e=>({handleChange({target:{name:t,value:a}}){e[t]=a}}))),l=r.types.model("GqlResponseDataStore",{edges:r.types.array(r.types.frozen()),nodes:r.types.array(r.types.frozen())}),c=r.types.model({filters:r.types.optional(s,{}),data:r.types.optional(l,{})}).volatile((e=>({apolloClient:null}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get members(){return e.data.nodes},get loyaltyMembersQuery(){return{id:e.filters.search||void 0,pointsBalance:e.filters.pointsBalance.values,pointsEarned:e.filters.pointsEarned.values,pointsRedeemed:e.filters.pointsRedeemed.values}}}))).actions((e=>{const t=Object(r.flow)((function*(e){null==e||e.preventDefault(),yield i()})),a=()=>{var t;e.apolloClient=(t=e.rootStore.siteCachedSlug,new n.ApolloClient({uri:`/${t}/graphql`,headers:{"X-CSRF-Token":$("meta[name=csrf-token]").attr("content")},cache:new n.InMemoryCache}))},i=Object(r.flow)((function*(){try{const t=n.gql`
          query LoyaltyMembers(
            $id: ID
            $membershipStartedAt: DateRange
            $pointsBalance: Range
            $pointsEarned: Range
            $pointsRedeemed: Range
            $active: Boolean
          ) {
            loyaltyMembers(
              identifier: $id
              membershipStartedAt: $membershipStartedAt
              pointsBalance: $pointsBalance
              pointsEarned: $pointsEarned
              pointsRedeemed: $pointsRedeemed
              active: $active
            ) {
              edges {
                node {
                  id
                }
              }
              nodes {
                createdAt
                email
                id
                membershipEndedAt
                membershipStartedAt
                pointsBalance
                pointsEarned
                pointsRedeemed
                unsubscribedAt
                uuid
              }
            }
          }
        `,a=yield e.apolloClient.query({query:t,variables:e.loyaltyMembersQuery});Object(r.applySnapshot)(e.data,a.data.loyaltyMembers)}catch(t){console.warn(t)}}));return{init:()=>{a(),i()},initGqlClient:a,fetchLOMembers:i,searchSubmit:t}}))},"Ifx+":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return n}));const r=e=>{const t={};return Object.keys(e).forEach((a=>{void 0!==e[a]&&(t[a]=e[a])})),t},n=()=>{Validation.showErrorFlash(`Something went wrong, please try again in a minute or contact ${Constants.SUPPORT_EMAIL}`,15e3)}},Ipfk:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("sT1B"),i=a("EAOr"),o=a("4b23");const s=r.types.model("PlacementPattern",{regexp:!1,pattern:""}).volatile((e=>({key:""}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get site(){return e.rootStore.models.site},get placement(){return Object(r.getParent)(e,2)},get showPreview(){return!e.regexp&&![n.Z.PP,n.Z.RG,n.Z.PE].includes(e.placement.category_abbreviation)},get previewUrl(){return e.showPreview&&`${e.site.url}${e.pattern}`||""},get isPostEventPlacement(){return"PE"===e.placement.category_abbreviation},get isPostPurchasePlacement(){return"PP"===e.placement.category_abbreviation},get patternTip(){switch(e.pattern){case"":return e.isPostEventPlacement?"post-event page after registering an Event":e.isPostPurchasePlacement?"the order confirmation page after checkout":"all pages";case"/":return"the homepage only";default:return"specific site pages"}},get prefix(){return e.regexp?"":e.site.url},get noticeText(){return e.regexp&&e.pattern?"pages matching Regex pattern":e.patternTip}}))).actions((e=>({afterCreate(){e.key=Object(o.a)()},handleChangePattern({target:{value:t}}){e.updatePattern(t)},updatePattern(t){e.pattern=t},handleChangeRegexp({target:{value:t}}){e.updateRegexp(t)},updateRegexp(t){e.regexp=t}}))),l=r.types.compose(i.a,r.types.model({inclusions:r.types.array(s),exclusions:r.types.array(s)}).views((e=>({}))).actions((e=>({handleAddInclusion(){e.inclusions.push({})},handleAddExclusion(){e.exclusions.push({})},handleDeleteInclusion(t){e.inclusions.splice(t,1)},handleDeleteExclusion(t){e.exclusions.splice(t,1)}}))))},IvMf:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("vOnD"),n=a("TyAF"),i=a("Ty5D"),o=a("GaHK");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const l=Object(r.default)(o.H3).withConfig({displayName:"campaign_navigation_name__Head"})(["max-width:600px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;"]),c=Object(i.o)(Object(n.b)((({rootStore:e})=>({campaignShowRoot:e.pages.campaignShowRoot})))(Object(n.c)(function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r),n.prototype.render=function(){const{campaignShowRoot:{currentCampaign:{name:t}}}=this.props;return e.createElement(l,{"data-testid":"ac-campaign-name",className:"ac-campaign-name",title:t},t)},n}(e.PureComponent))))}).call(this,a("q1tI"))},J63I:function(e,t,a){"use strict";(function(e){a.d(t,"c",(function(){return g})),a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return y}));var r=a("V0vo"),n=a("ECCn"),i=a.n(n),o=a("TdF3"),s=a.n(o),l=a("ebWy"),c=a.n(l),p=a("jctj"),u=a.n(p);function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function g({subject:t,children:a=window.Constants.SUPPORT_EMAIL,...r}){let n=`mailto:${window.Constants.SUPPORT_EMAIL}`;return t&&(n+=`?subject=${t}`),e.createElement("a",m({},r,{className:"Welcome-link",href:n}),a)}function h({type:t,size:a,resetChildGaps:n=!0,children:i,...o}){return e.createElement("div",Object(r.b)(o,`h-${t}gap-${a}`),_.map(i,((a,r)=>e.createElement("div",{className:classNames({[`h-${t}gap-child-wrap`]:n}),key:r},a))))}i.a.registerLanguage("javascript",s.a),i.a.registerLanguage("htmlbars",c.a),i.a.registerLanguage("xml",u.a);let y=function(t){var a,r;function n(...e){var a;return(a=t.call(this,...e)||this).handleMount=e=>{e&&i.a.highlightElement(e)},a}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,d(a,r),n.prototype.render=function(){const{children:t,...a}=this.props;return e.createElement("pre",null,e.createElement("code",m({},a,{ref:this.handleMount}),t))},n}(e.Component)}).call(this,a("q1tI"))},JAXR:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return p}));var r=a("TyAF"),n=a("vOnD"),i=a("GaHK"),o=a("qnoz");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const c=n.default.div.withConfig({displayName:"variables__NoMatches"})(["margin-left:30px;color:#333;font-size:14px;",""],i.Theme.fontWeights.regular),p=Object(r.c)(function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,l(a,r),n.prototype.render=function(){const{infoSidebarStore:{data:t,toggleOpenByPath:a,showVariables:r,pathActiveMatchNode:n,gaTrackCopyVariable:i}}=this.props;return r?_.map(t,((t,r)=>e.createElement(o.a,s({key:r,name:r},t,{toggleOpenByPath:a,pathActiveMatchNode:n,gaTrackCopyVariable:i})))):e.createElement(c,null,"No matching variables")},n}(e.Component))}).call(this,a("q1tI"))},JHMc:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return d}));var r=a("99Ma"),n=a("2ZiZ"),i=a("9ird"),o=a("EIXB"),s=a("eVYL"),l=a("B9cq"),c=a("+CAZ");const p={blocked:3,flagged:2,skipped:1,passed:0},u=r.types.model("OriginalReferral",{advocate:r.types.maybeNull(n.a),friend:r.types.maybeNull(n.a),journey:r.types.maybeNull(r.types.array(i.a)),referral:r.types.maybeNull(s.a)}),d=r.types.model("ReferralStore",{id:r.types.identifierNumber,page:r.types.maybeNull(r.types.number),filter_statuses:r.types.maybeNull(r.types.array(r.types.string)),advocate:r.types.maybeNull(n.a),friend:r.types.maybeNull(n.a),journey:r.types.maybeNull(r.types.array(i.a)),referral:r.types.maybeNull(s.a),originalReferral:r.types.optional(u,{}),unblockedReferral:r.types.optional(o.a,{})}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get records(){return[e.advocate,e.friend]},get isFirstTimePurchase(){return e.journey.some((e=>"referred_origin"===e.journey_point&&e.record.first_time))},get referredOriginJourneyExists(){return _.some(e.referredOriginJourney)},get referredOriginJourney(){return e.journey.find((e=>"referred_origin"===e.journey_point))},get referralsStore(){return Object(r.getParent)(e,2)},get isReferralsStore(){return"ReferralsStore"===Object(r.getParent)(e,2).name},get isCspReferralsStore(){return"CSpReferralsStore"===Object(r.getParent)(e,2).name},get isSameEmail(){return e.advocate.person.email===e.friend.person.email},get isSameCookie(){return e.advocate.origin.cookie===e.friend.origin.cookie},get advocateRewards(){return e.advocate.rewards},get friendRewards(){return e.friend.rewards},get advocateAndFriendRewards(){return[...e.advocateRewards,...e.friendRewards]},get waitingForCouponRewardExists(){return e.advocateAndFriendRewards.some((e=>"Waiting for coupon"===e.status_text))},get findMatchingEmailStatus(){return _.findKey(e.referral.fraud_policies_status,(e=>_.includes(e,"Matching Email or Cookie on Friend Purchase")))},get findFriendAdvocateReferEachOther(){return _.findKey(e.referral.fraud_policies_status,(e=>_.includes(e,"Friend and Advocate Refer Each Other")))},getStatusByReason:t=>_.reduce(e.referral.fraud_policies_status,((e,a,r)=>a.includes(t)?r:e),"passed"),getImportanceStatusByReasons:t=>t.map((t=>e.getStatusByReason(t))).reduce(((e,t)=>p[t]>=p[e]?t:e),"passed"),get crossReferralStatus(){return e.getStatusByReason("Friend and Advocate Refer Each Other")},hideCrossReferralReason:t=>"skipped"!==e.crossReferralStatus&&"passed"!==e.crossReferralStatus&&p[e.crossReferralStatus]>=p[t],get getFraudReasonStatusForCookie(){const t=e.isSameCookie?e.getImportanceStatusByReasons(["Matching Email or Cookie on Friend Purchase","Friend and Advocate Refer Each Other"]):"passed";return{status:t,reason:e.isSameCookie&&e.hideCrossReferralReason(t)?e.fraudReasonReferral:null}},get getFraudReasonStatusForEmail(){const t=e.isSameEmail?e.getImportanceStatusByReasons(["Friend and Advocate Refer Each Other","Similar Email Match","Matching Email or Cookie on Friend Purchase"]):e.getImportanceStatusByReasons(["Friend and Advocate Refer Each Other","Similar Email Match"]);return{status:t,reason:e.hideCrossReferralReason(t)&&_.isNull(e.getFraudReasonStatusForCookie.reason)?e.fraudReasonReferral:null}},get fraudReasonReferral(){const t=_.get(e.originalReferral.referral,"id");return{status:e.crossReferralStatus,link:`${Routes.customer_service_portal_person_lookup_site_path(e.rootStore.siteCachedSlug)}?q=${e.friend.person.email}&referral=${t}`,id:t}},get fraudReasonToPoliciesRaw(){return{ip:{type:"ip",value:"IP check",status:e.getImportanceStatusByReasons(["Matching by IP Address only","Matching by Combination of IP Address &amp; User Agent"]),advocate:e.advocate.origin.ip_address,friend:e.friend.origin.ip_address,tooltip:!1},cookie:{type:"cookie",value:"Cookie check",status:e.getFraudReasonStatusForCookie.status,reason:e.getFraudReasonStatusForCookie.reason,advocate:e.advocate.origin.cookie,friend:e.friend.origin.cookie,tooltip:!0},email:{type:"email",value:"Email check",status:e.getFraudReasonStatusForEmail.status,reason:e.getFraudReasonStatusForEmail.reason,advocate:e.advocate.person.email,friend:e.friend.person.email,tooltip:!0},address:{type:"address",value:"Address check",status:e.getImportanceStatusByReasons(["Matching Shipping Address"]),advocate:e.matchedShippingAddresses||e.advocateShippingAddresses,friend:_.get(e.referral,"shipping_address_fraud_report.base_address"),tooltip:!0}}},get fraudReasonToPolicies(){return _.values(e.fraudReasonToPoliciesRaw)},get incentives(){return _.union(e.advocate.incentives,e.friend.incentives)},isEqual:t=>!(!_.get(e.advocate,t)&&!_.get(e.friend,t))&&_.get(e.advocate,t)===_.get(e.friend,t),get advocateShippingAddresses(){if(!e.referral.shipping_address_fraud_report)return null;const t=e.referral.shipping_address_fraud_report.addresses;if(_.isEmpty(t))return null;let a=t[0].address;return t.length>1&&(a+=` and ${t.length-1} more`),a},get matchedShippingAddresses(){return e.referral.shipping_address_fraud_report?_.isEmpty(e.referral.shipping_address_fraud_report.addresses)?null:e.referral.shipping_address_fraud_report.addresses.reduce(((e,t)=>(t.match&&e.push(t.address),e)),[]).join(", "):null},blockedBy:({target:t,reason:a})=>"email"===a?e[t].person.blocked:e[t].origin.blocked_by_ip,blacklistLink:({target:t,reason:a})=>e[t].person.manage_blocked_email_path&&"email"===a?e[t].person.manage_blocked_email_path:Routes.customer_service_portal_site_path(e.rootStore.siteCachedSlug,"blacklist")}))).actions((t=>({refreshReferral:()=>{Object(r.getParent)(t).fetchReferral(t.id)},modifyReferral:e=>Object(c.a)(e,t.page),update:e=>{_.forEach(e,((a,r)=>{t[r]=e[r]}))},refetch(){Object(r.getParent)(t).refetch(t.id)},getOriginalReferral:Object(r.flow)((function*(){try{const e=yield Object(l.ajax)({url:Routes.original_referral_internal_site_customer_service_referral_path(t.rootStore.siteCachedSlug,t.id)});Object(r.applySnapshot)(t.originalReferral,_.get(e,"result.record",{}))}catch(xhr){422===xhr.status?Object(r.applySnapshot)(t.originalReferral,{referral:{id:0}}):e({name:"Unable to fetch original referral",message:"Ajax failure",xhr:xhr})}}))})))}).call(this,a("B9cq").notifyDevelopers)},JIUx:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("GaHK"),n=a("KfdZ");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let o=function(t){var a,o;function s(){return t.apply(this,arguments)||this}return o=t,(a=s).prototype=Object.create(o.prototype),a.prototype.constructor=a,i(a,o),s.prototype.render=function(){const{onSubmit:t,onClose:a}=this.props;return e.createElement(r.UIModal,{actionClose:a,title:"Deactivate 2FA",position:"center",ribbon:"danger"},e.createElement(n.a,{className:"mbxl"},"Your user account will become less secured if you deactivate 2FA.",e.createElement("br",null),"Are you sure?"),e.createElement("div",{className:"justify-space-between"},e.createElement(r.UIButton,{size:"small",trait:"danger",className:"mrm",onClick:t},"Yes, deactivate"),e.createElement(r.UIButton,{trait:"action",onClick:a},"Nevermind")))},s}(e.PureComponent)}).call(this,a("q1tI"))},Jpk0:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a("99Ma"),n=a("rfrl"),i=a("dhqo"),o=a.n(i),s=a("V0vo"),l=a("vrPu"),c=a("gpnO");const p=r.types.compose("LoyaltyRedemptionRulesFormStore",c.a,r.types.model({icon:r.types.frozen(null),errors:r.types.frozen({}),updatedSecretStatus:!1})).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignRulesStore(){return Object(r.getParentOfType)(e,l.a)},get isDefaultIcon(){var t;return["basic.svg","secret.svg"].includes(_.last(null==(t=e.icon_url)?void 0:t.split("/")))},get iconUrl(){return e.icon_url&&this.isDefaultIcon&&e.updatedSecretStatus||!e.icon_url?e.secret?"/assets/v1/packs/secret-5134f6fddc7952e0fb89a5c2d7b35381.svg":"/assets/v1/packs/basic-a939036c4410937010b07a763dff9e75.svg":e.icon_url},get defaultIconUrlToUpload(){return this.isDefaultIcon&&e.updatedSecretStatus?this.iconUrl:void 0},get isValidIconFileType(){var t,a;return null==(t=e.icon)||!t.type||Object(s.D)(null==(a=e.icon)?void 0:a.type)},get thresholdInUnit(){return"points"===e.campaignRulesStore.values.tiers_metric_identifier?o()("point",e.threshold,!0):this.rootStore.models.site.valueInSiteCurrency(e.threshold)},get thresholdMask(){return e.thresholdInUnit},get preparedDataForServer(){return _.pick(e,["name","threshold","multiplier","secret","icon"])},get metricDescriptionForThresholdTooltip(){return"points"===this.campaignRulesStore.values.tiers_metric_identifier?"points earned":"spend"},get thresholdDisabledMinusButtonTooltip(){if(!this.isBaseTier)return 0===this.minThreshold?"Can't be less then 0":`Minimum ${this.metricDescriptionForThresholdTooltip} per time period should be more than in the previous tier`},get thresholdDisabledPlusButtonTooltip(){return this.isBaseTier?void 0:`Maximum ${this.metricDescriptionForThresholdTooltip} per time period should be less than in the next tier`},get multiplierDisabledMinusButtonTooltip(){return 1===this.minMultiplier?"Minimum multiplier should equal or be more then 1":"Minimum multiplier should be more than in the previous tier"},get multiplierDisabledPlusButtonTooltip(){return"Minimum multiplier can\u2019t be more than in the next tier"},get thresholdDescription(){return`eg. Loyalty customer has to ${"points"===e.campaignRulesStore.values.tiers_metric_identifier?"earn":"spent"} at least ${e.thresholdInUnit} to reach that tier.`},get disabledThresholdTooltip(){if(this.isBaseTier)return`Base tier doesn't require any ${"points"===this.campaignRulesStore.values.tiers_metric_identifier?"points":"spent"} to join.`},get multiplierDescription(){return"points"===e.campaignRulesStore.values.tiers_metric_identifier?`eg. Loyalty customer gets ${_.round(100*e.multiplier,2)} points per 100 points earned.`:`eg. Loyalty customer gets ${_.round(e.rootStore.models.site.loyalty_points_to_currency_conversion_rate*e.multiplier*100,2)} points per ${this.rootStore.models.site.valueInSiteCurrency(100)} spent.`},get showLoyaltyPointsConversionLink(){return"purchases"===e.campaignRulesStore.values.tiers_metric_identifier},get minThreshold(){return 0},get minMultiplier(){return 0},get isBaseTier(){return!1}}))).actions((e=>{const t=t=>{e.errors=Object(n.b)(e.errors,(e=>{null==e||delete e[t]}))};return{updateErrors:t=>{e.errors=t},clearErrorByName:t,handleChangeImage:t=>{e.icon=t.target.files[0]},handleChange:({target:{name:a,value:r}})=>{t(a),"secret"===a&&(e.updatedSecretStatus=!e.updatedSecretStatus),e[a]=r}}}))},"K+ho":function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var r=a("99Ma"),n=a("Ipfk"),i=a("rfrl");const o=r.types.compose("PlacementWithPatternEditable",n.a,r.types.model({errors:r.types.optional(r.types.frozen(),{}),shouldShowVisibilityWarning:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get site(){return e.rootStore.models.site},get isValid(){return _.isEmpty(e.errors)},get eventCategoriesOptions(){return e.site.event_categories.reduce(((e,t)=>"purchase"!==t.identifier&&"affiliate_member"!==t.identifier?[...e,{value:t.id,label:t.identifier}]:e),[{value:0,label:"Select Event"}])},get selectedEventCategoryOption(){return e.eventCategoriesOptions.find((t=>t.value===e.event_category_id))},get shouldShowSelectEventSection(){return"PE"===e.category_abbreviation}}))).actions((e=>({updateVisibilityWarning(t){e.shouldShowVisibilityWarning=t},handleCloseVisibilityWarning(){e.updateVisibilityWarning(!1)},updateErrors(t){e.errors=t},resetErrors(){e.errors={}},resetErrorByName(t){e.errors=Object(i.b)(e.errors,(e=>{_.unset(e,t)}))},handleChangeName({target:{value:t}}){e.resetErrorByName("name"),e.name=t},handleToggleDevice({target:{value:t,name:a}}){e.updateDeviceVisibility({name:a,value:t}),e.resetErrorByName("enable_desktop"),e.resetErrorByName("enable_tablet"),e.resetErrorByName("enable_mobile"),e.updateVisibilityWarning(!e.enable_desktop&&!e.enable_tablet&&!e.enable_mobile)},updateDeviceVisibility({name:t,value:a}){e[t]=a},handleChangeEventCategory({selectedOption:{value:t}}){e.event_category_id=t,e.resetErrorByName("event_category_id")}}))));var s=a("AEM3"),l=a("HzpY"),c=a("9iDo"),p=a("4mPH");const u=r.types.compose("PlacementsSelectableCampaign",c.c,r.types.model({}).views((e=>({get placementsRootPage(){return Object(r.getParentOfType)(e,s.a)},get sitePlacements(){return e.placementsRootPage.placements.campaign_placements},get campaignsFilter(){return e.campaignsSet.campaignsFilter},get isCampaignLiveWithStaticWidget(){return Object(l.d)(e)},get isWithoutPlacement(){return!e.placement_id},get attachedPlacement(){return e.sitePlacements.find((t=>t.id===e.placement_id))},get isAttachedToAnotherPlacement(){return e.attachedPlacement&&e.placement_id!==e.campaignsFilter.placementData.id},get placementAppearance(){return e.campaignsFilter.placementData.appearance},get notice(){return e.isAttachedToAnotherPlacement?` used in ${e.attachedPlacement.name}`:e.appearance!==e.placementAppearance?`attaches only to ${Object(p.b)(e.appearance)} placement`:e.isCampaignLiveWithStaticWidget&&!e.checked?" only one live campaign with \u201cStatic trigger widget\u201d setting is allowed":""}}))).actions((e=>({updateChecked({value:t}){Object(r.isAlive)(e)&&(e.checked=t,e.reGroupCampaigns(t))},reGroupCampaigns(){e.isCampaignLiveWithStaticWidget&&(Object(p.d)(e.campaignsFilter.availableCampaigns.data)&&e.campaignsFilter.availableCampaigns.data.filter((e=>!e.checked&&Object(l.d)(e))).map((t=>{var a;return null==(a=e.campaignsFilter.availableCampaigns.removeCampaignById(t.id))?void 0:a.toJSON()})).forEach((t=>{e.campaignsFilter.ineligibleCampaigns.addCampaign(t)})),e.campaignsFilter.ineligibleCampaigns.data.filter((t=>t.appearance===e.placementAppearance&&!t.isAttachedToAnotherPlacement&&t.isCampaignLiveWithStaticWidget&&!e.campaignsFilter.availableCampaigns.isSelectedLiveCampaignWithStaticWidget)).map((t=>{var a;return null==(a=e.campaignsFilter.ineligibleCampaigns.removeCampaignById(t.id))?void 0:a.toJSON()})).forEach((t=>{e.campaignsFilter.availableCampaigns.addCampaign(t)})))}})))),d=r.types.compose("PlacementsCampaignsCollection",c.a,r.types.model({data:r.types.array(u)}).volatile((()=>({nextCampaignIndex:0}))).views((e=>({get campaignsIdShouldBeAttached(){return e.selectedCampaignsId.filter((t=>!e.initialSelectedCampaignsId.includes(t)))},get campaignsIdShouldBeDetached(){return e.initialSelectedCampaignsId.filter((t=>!e.selectedCampaignsId.includes(t)))},get isSelectedLiveCampaignWithStaticWidget(){return e.data.filter((e=>e.checked)).some(l.d)}}))).actions((e=>({updateAll(t){e.filteredCampaigns.forEach((e=>{Object(r.isAlive)(e)&&e.updateChecked({value:t})}))}})))),m=r.types.compose("PlacementsCampaignsFilter",c.b,r.types.model({campaigns:r.types.map(d)}).views((e=>({get placementEditablePage(){return Object(r.getParent)(e)},get placementData(){return e.placementEditablePage.placementData}}))));var g=a("pm75"),h=a("aFzQ");const y=r.types.model("PlacementsEditablePage",{placementData:r.types.optional(o,{}),campaignsFilter:r.types.optional(m,{}),initialPlacementData:r.types.frozen(),isPlacementDataInitialized:!1,submit:r.types.optional(g.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get placementsRootPage(){return Object(r.getParentOfType)(e,s.a)},get isPristine(){return _.isEqual(e.initialPlacementData,Object(h.toJS)(e.placementData))&&e.campaignsFilter.isPristineCampaigns},get categoryAbbreviation(){return e.placementData.category_abbreviation},get shouldShowCancelButton(){return!e.isPristine}}))).actions((e=>({updatePlacementData(t){e.placementData=o.create(t),e.initialPlacementData=Object(h.toJS)(e.placementData),e.isPlacementDataInitialized=!0},updateCampaignsFilter({available:t,ineligible:a}){e.campaignsFilter.reset(),e.campaignsFilter.addAvailableCampaigns(t),e.campaignsFilter.addIneligibleCampaigns(a)},validate(){const t={};e.placementData.name.length<3&&(t.name=["can't be blank, is too short (minimum is 3 characters)"]),"PE"===e.categoryAbbreviation&&0===e.placementData.event_category_id&&(t.event_category_id=["Select some event category"]),e.placementData.updateErrors(t),Validation.scrollToField(t)},reset(){Object(r.applySnapshot)(e,{})}})))},KA3C:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return g}));var r=a("99Ma"),n=a("sT1B"),i=a("V0vo"),o=a("m3Dn"),s=a("M+GS"),l=a("2fvL"),c=a("vrPu");const p=r.types.union(r.types.number,r.types.string,r.types.null,r.types.undefined),u=e=>{switch(e){case n.c:return"Any event category";case n.Y:return"Other event category";default:return e}},d=r.types.model({id:r.types.maybeNull(r.types.number),type:r.types.maybeNull(r.types.string),incentive_type:r.types.maybeNull(r.types.string),amount:p,latest_coupon_expiration_date:r.types.maybeNull(r.types.string),percentage_discount:r.types.maybeNull(r.types.boolean),multi_use_coupon_code:r.types.maybeNull(r.types.string),coupon_list_id:p,custom_description:r.types.maybeNull(r.types.string),identifier:r.types.maybeNull(r.types.string),criteria:r.types.maybeNull(r.types.string),sharing_channels:r.types.maybeNull(r.types.string),email_shares:p,new_customer:p,subtotal_min:p,subtotal_max:p,referrals_min:p,referrals_max:p,reward_uniqueness:r.types.maybeNull(r.types.string),friend_event_category:r.types.maybeNull(r.types.string),new_optin:r.types.union(r.types.string,r.types.null,r.types.undefined),allow_on_expired_offer:p,allow_on_self_referral:p,once_per_person:p}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get incentiveFormStore(){return Object(r.getParentOfType)(e,g)},get normalizeData(){const t=_.cloneDeep(e.toJSON());return _.update(t,"friend_event_category",(e=>e!==n.c?e:null)),t},get prepareDataForServer(){return _.pick(e.normalizeData,_.keys(_.pickBy(o.b,(t=>t.includes(e.type)))))},get coupon_codes(){return _.isNull(e.multi_use_coupon_code)?"single":"multi"},get disabledCouponCodeType(){return e.amount<0||""===e.amount},get sharingChannelsValueForSelect(){return e.sharing_channels?e.sharing_channels.split(", "):[]},get sharingChannelsOptions(){return e.rootStore.models.site.sharing_channels.map((e=>({label:e,value:e})))},get referrableSiteEventCategories(){return e.rootStore.models.site.event_categories.filter((e=>e.referrable))},get friendEventCategoryIdentifiers(){return[...e.referrableSiteEventCategories.map((e=>e.identifier)),n.c,n.Y]},get friendEventCategoryOptions(){return e.friendEventCategoryIdentifiers.map((e=>({label:u(e),value:e})))},get friendEventCategoryValueForSelect(){return _.isNull(e.friend_event_category)?n.c:e.friendEventCategoryIdentifiers.includes(e.friend_event_category)?e.friend_event_category:n.Y}}))).actions((e=>({onChangeByKey({target:{name:t,value:a}}){_.has(e,t)&&(e[t]=a,"incentive_type"===t&&("rebate"===a&&(e.percentage_discount=!1),Utils.trackGAEvent(n.u,"change incentive type",a)))},updateData(t){_.keys(t).forEach((a=>{if("multi_use_coupon"===a){const a=_.get(t,"multi_use_coupon.code");e.updateKey("multi_use_coupon_code",a||null)}else e.updateKey(a,t[a])}))},updateKey(t,a){_.has(e,t)&&(e[t]=a)},onChangeCouponCodes({target:{value:t}}){"multi"===t?(e.coupon_list_id=null,e.multi_use_coupon_code=""):e.multi_use_coupon_code=null,e.incentiveFormStore.deleteErrorByKey("coupon_list"),e.incentiveFormStore.deleteErrorByKey("multi_use_coupon")}}))),m=r.types.model({data:r.types.optional(r.types.frozen(),{}),isFetched:!1,isShow:!1}).actions((e=>({updateData(t){e.data=t},updateFetched(t){e.isFetched=t},hide(){e.isShow=!1}}))),g=r.types.model("IncentiveFormStore",{action:"",type:"",sub_type:r.types.maybeNull(r.types.string),incentiveData:r.types.optional(d,{}),initialData:r.types.optional(d,{}),errors:r.types.map(r.types.array(r.types.string)),submitting:!1,interpolations:r.types.optional(m,{}),confirmation:!1,showConfirmationFlushCampaignData:!1,couponListsStore:r.types.optional(l.a,{}),destroyingIncentive:!1,showAdvancedSection:r.types.maybeNull(r.types.boolean)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get campaignRulesStore(){return Object(r.getParentOfType)(e,c.a)},get campaignEditable(){return e.campaignRulesStore.campaign},get incentives(){return e.campaignRulesStore.incentives},get allowEdit(){let t=!1;return"new"===e.action&&(t=!0),"edit"===e.action&&(t=e.campaignEditable.test_mode||!e.campaignEditable.has_activities),t},get allowEditFriendEventCategory(){return"ReferredIncentive"!==e.incentiveData.type&&e.allowEdit},get changes(){return Object(i.g)(e.incentiveData.toJSON(),e.initialData.toJSON())},get changesProduceFlushCampaign(){return _.keys(e.changes).filter((e=>!s.a.includes(e)))},get needConfirmationFlushCampaignData(){return e.campaignEditable.test_mode&&e.campaignEditable.has_activities&&"edit"===e.action&&_.some(e.changesProduceFlushCampaign)},get title(){const t="new"===e.action?"Create ":"",a=`${e.type}.${e.sub_type}.title`;return`${t}${_.get(o.c,a,"")}`},get buttonTextOnSave(){switch(e.action){case"new":return"Create Incentive";case"edit":return"Save Incentive";default:return""}},get uiFields(){return o.c[e.type][e.sub_type][e.incentiveData.incentive_type]},get advancedUIFields(){return _.get(e.uiFields,"advanced",[])},get advancedUIFieldKeys(){return _.get(e.uiFields,"advanced_keys",[])},get pristine(){return _.isEqual(e.incentiveData,e.initialData)},get supportsNonMonetary(){return["ReferrerIncentive","ReferredIncentive"].includes(e.sub_type)},get isDisabledSubmitButton(){return"tremendous"===e.incentiveData.incentive_type||"rybbon"===e.incentiveData.incentive_type},get selectedPersonalCouponListOption(){return e.couponListsStore.findCouponListsByValue({value:e.incentiveData.coupon_list_id})},get showCouponListInfo(){var t;return Boolean(null==(t=e.selectedPersonalCouponListOption)?void 0:t.value)},get showCouponListExpirationWarning(){var t,a;return Object(s.l)({coupon_list_expires_at:null==(t=e.selectedPersonalCouponListOption)?void 0:t.expires,latest_coupon_expiration_date:null==(a=e.incentiveData)?void 0:a.latest_coupon_expiration_date})}}))).actions((t=>({setSubmitting(e){t.submitting=e},setAction(e){t.action=e},setDestroyingIncentiveStatus(e){t.destroyingIncentive=e},setType(e){t.type=e.type,"edit"===t.action?t.sub_type=Object(s.h)(t.incentives.data.find((({id:t})=>t===e.id))):t.sub_type=e.sub_type},getInitialData({action:e,data:a}){switch(e){case"edit":t.incentiveData.updateData(t.incentives.data.find((e=>e.id===a.id))),t.initialData.updateData(t.incentives.data.find((e=>e.id===a.id)));break;case"new":{t.incentiveData.updateData(t.incentives.data.find((e=>e.id===a.id)));const e=e=>{let a=o.a[e.type][e.sub_type];switch(e.type){case"ClickIncentive":Number(t.campaignEditable.require_email_to_claim)&&(a.once_per_person="1");break;case"SharingIncentive":Number(t.campaignEditable.require_email_to_share)&&(a.once_per_person="1")}return _.has(e,"identifier")&&(a.identifier=e.identifier),a};if(a.test_variant){const e={...t.incentives.data.find((e=>e.id===a.id)),id:null,amount:0,percentage_discount:!1,multi_use_coupon_code:null,coupon_list_id:null};t.incentiveData.updateData(e),t.initialData.updateData(e)}else{const r=e(a);t.incentiveData.updateData(r),t.initialData.updateData(r)}}}t.setAction(e),t.setType(a)},updateErrors(e){t.errors.replace(e)},deleteErrorByKey(e){t.errors.delete(e)},cancelChanges(){t.incentiveData.updateData(t.initialData),t.clearErrors()},clearErrors(){t.errors.clear()},clearData(){t.action="",t.incentiveData={},t.initialData={},t.interpolations={},t.clearErrors(),t.confirmation=!1,t.showConfirmationFlushCampaignData=!1},changeAdvancedSectionState(e){t.showAdvancedSection=e},toggleAdvancedSection(){t.changeAdvancedSectionState(null)},processErrors(e){_.keys(e).some((e=>t.advancedUIFieldKeys.includes(e)))&&t.changeAdvancedSectionState(!0)},create:Object(r.flow)((function*(){t.setSubmitting(!0);try{const{result:e}=yield $.ajax({type:"POST",url:Routes.internal_site_campaign_incentives_path(t.siteCachedSlug,t.campaignEditable.id),data:{incentive:t.incentiveData.prepareDataForServer}});t.campaignRulesStore.updateIncentiveHighlightNewId(null==e?void 0:e.id),yield t.campaignRulesStore.incentives.apiGet(t.campaignEditable.id),Validation.showSuccessFlash(),t.setSubmitting(!1)}catch(xhr){t.setSubmitting(!1);const r=_.get(xhr,"responseJSON.result.errors",{});return t.processErrors(r),Validation.showErrorFlash(),t.updateErrors(r),_.isEmpty(r)&&e({name:"Unable to create incentive",message:"Ajax failure",xhr:xhr}),xhr}})),edit:Object(r.flow)((function*(a){t.setSubmitting(!0);try{yield $.ajax({type:"PATCH",url:Routes.internal_site_campaign_incentive_path(t.siteCachedSlug,t.campaignEditable.id,{id:a}),data:{incentive:t.incentiveData.prepareDataForServer}}),t.campaignRulesStore.updateIncentiveHighlightEditId(t.incentiveData.id),yield t.campaignRulesStore.incentives.apiGet(t.campaignEditable.id),Validation.showSuccessFlash(),t.setSubmitting(!1)}catch(xhr){t.setSubmitting(!1);const r=_.get(xhr,"responseJSON.result.errors",{});if("Single-use or multi-use code must be specified"===_.get(r,"coupon_list.0"))switch(t.incentiveData.coupon_codes){case"single":r.coupon_list=["Please choose coupon list"];break;case"multi":r.coupon_list=["Is too short (minimum is 3 characters)"]}return Validation.showErrorFlash(),t.updateErrors(r),_.isEmpty(r)&&e({name:"Unable to edit incentive",message:"Ajax failure",xhr:xhr}),xhr}})),delete:Object(r.flow)((function*(a){t.setDestroyingIncentiveStatus(!0);try{yield $.ajax({type:"DELETE",url:Routes.internal_site_campaign_incentive_path(t.siteCachedSlug,t.campaignEditable.id,{id:a})}),t.campaignRulesStore.init(),t.setDestroyingIncentiveStatus(!1)}catch(xhr){Validation.showErrorFlash(),e({name:"Unable delete incentive",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.setDestroyingIncentiveStatus(!1)}})),toggleInterpolations(){const e=!t.interpolations.isShow;e&&!t.interpolations.isFetched&&t.fetchInterpolations(),t.interpolations.isShow=e},fetchInterpolations(){$.get(Routes.criteria_sample_interpolations_internal_site_campaign_incentives_path(t.siteCachedSlug,t.campaignEditable.id,{type:t.incentiveData.type,no_spinner:!0})).then((({result:{criteria_sample_interpolations:e}})=>{t.interpolations.updateFetched(!0),t.interpolations.updateData(e)})).fail((t=>{e({name:"Unable to get interpolations of incentive",message:"Ajax failure",xhr:t})}))},toggleConfirmation(){t.confirmation=!t.confirmation},toggleShowConfirmationFlushCampaignData(){t.showConfirmationFlushCampaignData=!t.showConfirmationFlushCampaignData}})))}).call(this,a("B9cq").notifyDevelopers)},KfdZ:function(e,t,a){"use strict";(function(e,r){a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return g}));var n=a("vOnD"),i=a("TyAF"),o=a("B9cq"),s=a("GaHK"),l=a("8C8s"),c=a("D0An"),p=a("JIUx");function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const d=Object(n.default)(s.BodyS).withConfig({displayName:"user_settings_2fa_page__Text"})(["color:",";",";"],s.Theme.color.black100,s.Theme.fontWeights.regular),m=Object(n.default)(s.UIFormBody).withConfig({displayName:"user_settings_2fa_page__UIFormBodyStyleOverride"})(["min-height:100%;display:flex;flex-direction:column;box-sizing:border-box;"]),g=Object(i.b)((({userSettingsRootStore:e})=>({userSettingsRootStore:e})))(Object(i.c)(function(t){var a,n;function i(e){var a;return(a=t.call(this,e)||this).handleDisableTfa=async()=>{const{userSettingsRootStore:e}=a.props;a.setState({isSubmitting:!0});try{await Object(o.ajax)({url:Routes.internal_user_two_factor_authentication_setup_path(),type:"DELETE"}),a.updateTfaEnabled(!1),await e.currentUser.fetch(),l.a.showSuccessFlash("Two-factor authentication off")}catch(xhr){l.a.showErrorFlash(),r({name:"Unable to disable tfa",message:"Ajax failure",xhr:xhr})}finally{a.setState({showModal:!1,isSubmitting:!1})}},a.updateTfaEnabled=e=>a.setState({tfa_enabled:e},(()=>{if(a.state.tfa_enabled)return l.a.showSuccessFlash("Two-factor authentication enabled")})),a.toggleModal=()=>{a.setState((e=>({showModal:!e.showModal})))},a.state={tfa_enabled:e.userSettingsRootStore.currentUser.tfa_enabled,showModal:!1},a}return n=t,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,u(a,n),i.prototype.render=function(){const{tfa_enabled:t,showModal:a,isSubmitting:r}=this.state;return e.createElement(m,null,e.createElement(s.H3,{className:"mbl"},"Two-factor authentication"),t||r?e.createElement(e.Fragment,null,e.createElement(d,{className:"mbm"},"2FA is enabled for your user account. You will be asked to enter the 2FA code next time you log in into Talkable."),e.createElement("div",null,e.createElement(s.UIButton,{width:"auto",trait:"danger",onClick:this.toggleModal},"Deactivate 2FA"),a&&e.createElement(p.a,{onSubmit:this.handleDisableTfa,onClose:this.toggleModal}))):e.createElement(c.a,{updateTfaEnabled:this.updateTfaEnabled}))},i}(e.PureComponent)))}).call(this,a("q1tI"),a("B9cq").notifyDevelopers)},L2VW:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("TyAF"),n=a("Ty5D"),i=a("U6ye"),o=a("sT1B");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const l=Object(n.o)(Object(r.b)((({rootStore:e})=>({site:e.models.site,campaignShowRoot:e.pages.campaignShowRoot,staticWidgets:e.models.staticWidgets})))(Object(r.c)(function(t){var a,r;function n(e){var a;(a=t.call(this,e)||this).handleCloseDeactivationModal=()=>{a.props.campaignShowRoot.currentCampaign.deactivation.staticWidgetDeactivationModal.close(),Utils.trackGAEvent(o.q,"hide static widget deactivation modal")};const{staticWidgets:r,site:{siteCachedSlug:n},campaignShowRoot:{currentCampaign:i}}=e;return a.staticWidget=r.createStaticWidgetStore({siteCachedSlug:n,campaign_id:i.id}),a}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r),n.prototype.render=function(){const{campaignShowRoot:{deactivateCampaign:t,currentCampaign:{static_widget:a,status:r,deactivation:{staticWidgetDeactivationModal:{shouldShow:n}}}}}=this.props;return e.createElement("div",{className:"Campaign-management-header-indicator ac-cd-static-widget"},e.createElement(i.a,{staticWidgetStore:this.staticWidget,polling:Object(i.b)({static_widget:a,status:r}),showDeactivationModal:n,onCloseModal:this.handleCloseDeactivationModal,onPrimaryAction:t,onSecondaryAction:this.handleCloseDeactivationModal}))},n}(e.PureComponent))))}).call(this,a("q1tI"))},Leho:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var r=a("99Ma"),n=a("cr+I"),i=a.n(n),o=a("dhqo"),s=a.n(o),l=a("9iDo");const c=r.types.model("CreateReferralIncentives",{advocate:r.types.maybeNull(r.types.string),friend:r.types.maybeNull(r.types.string)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get createReferralStore(){return Object(r.getParent)(e)},get campaignId(){return e.createReferralStore.changes.campaign_id},get campaigns(){return e.createReferralStore.campaigns},get currentCampaign(){return e.campaigns.find((t=>t.id===e.campaignId))},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get advocateIncentives(){var t;return null==(t=e.currentCampaign)?void 0:t.advocate_incentives.filter((e=>"ReferrerIncentive"===e.type))},get friendIncentives(){var t;return null==(t=e.currentCampaign)?void 0:t.friend_incentives.filter((e=>"ReferredIncentive"===e.type))},get isAvailableIncentives(){return _.some(e.advocateIncentives)||_.some(e.friendIncentives)},optionsForSelect(e){const t=e.map((e=>({label:`${e.short_description} ${e.human_name}`,value:String(e.id)})));return t.push({label:"None",value:"none"}),t},selectedIncentive:t=>e[`${t}Incentives`].find((a=>String(a.id)===e[t])),get showAdvocateIncentive(){return _.some(e.advocateIncentives)},get showFriendIncentive(){return _.some(e.friendIncentives)},incentivePath:t=>`${Routes.edit_site_campaign_path(e.siteCachedSlug,e.currentCampaign.id)}#/incentives/edit/${t}`,couponListPath:t=>Routes.site_coupon_list_path(e.siteCachedSlug,t)}))).actions((e=>({resetStore:()=>{Object(r.applySnapshot)(e,{})},init:()=>{1===e.advocateIncentives.length&&e.updateIncentive({type:"advocate",data:{selectedOption:{value:String(e.advocateIncentives[0].id)}}}),1===e.friendIncentives.length&&e.updateIncentive({type:"friend",data:{selectedOption:{value:String(e.friendIncentives[0].id)}}})},updateIncentive:({type:t,data:a})=>{const{selectedOption:{value:r}}=a;e[t]=r}})));var p=a("B9cq"),u=a("4b23"),d=a("AHpt");const m=(e=window.location)=>i.a.parse(e.search);function g(e){window.Validation.showErrorFlash(e||"Unable to create a referral",1e4)}const h=r.types.model("ChangesSchema",{advocate_email:r.types.maybeNull(r.types.string),campaign_id:r.types.maybeNull(r.types.number),friend_email:r.types.maybeNull(r.types.string),friend_origin_coupon_code:r.types.maybeNull(r.types.string),friend_origin_event_category:r.types.maybeNull(r.types.string),friend_origin_ip_address:r.types.maybeNull(r.types.string),friend_origin_order_number:r.types.maybeNull(r.types.string),friend_origin_subtotal:r.types.maybeNull(r.types.number),friend_origin_visitor_uuid:r.types.maybeNull(r.types.string),new_friend_order:r.types.optional(r.types.boolean,!0),friend_custom_properties:r.types.maybeNull(r.types.string),advocate_custom_properties:r.types.maybeNull(r.types.string),follow_fraud_settings:!1,referrer_incentive_id:r.types.maybeNull(r.types.string),referred_incentive_id:r.types.maybeNull(r.types.string)}),y=r.types.compose("CSPSelectableCampaign",d.a,r.types.model({checked:!1})).views((e=>({get isPristine(){return e.initial_checked===e.checked},get campaignsSet(){return Object(r.getParent)(e,2)}}))).actions((e=>({afterCreate(){e.initial_checked=e.checked,e.key=Object(u.a)()},updateChecked({value:t}){e.checked=t},handleSelectOne({target:{value:t}}){e.campaignsSet.updateAll(!1),e.updateChecked({value:t})}}))),f=r.types.compose("CreateReferralCampaignsCollection",l.a,r.types.model({data:r.types.array(y)})),b=r.types.compose("CreateReferralCampaignsFilter",l.b,r.types.model({campaigns:r.types.map(f,{})})),v=r.types.model("InitialDataSchema",{build_referral:r.types.optional(h,{}),ok:r.types.maybeNull(r.types.boolean)}),S=r.types.model("CreateReferralStore",{changes:r.types.optional(h,{}),errors:r.types.optional(r.types.frozen(),{}),fetching:r.types.optional(r.types.boolean,!0),initialData:r.types.optional(v,{}),campaignsFilter:r.types.optional(b,{}),query:r.types.optional(r.types.string,""),initialDataFetched:r.types.optional(r.types.boolean,!1),incentives:r.types.optional(c,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaigns(){return e.campaignsFilter.availableCampaigns.campaigns.filter((e=>"gleam"!==e.appearance))},get friendOriginSubtotal(){return e.changes.friend_origin_subtotal||0},get siteCachedSlug(){return e.rootStore.siteCachedSlug},friendOriginOrderNumber(t){let a=null;const r=m()["build_referral[friend_origin_order_number]"];return a=r||(t?e.initialData.build_referral.friend_origin_order_number:null),a},getNotice(e){const t=e.map((e=>e.short_description));return`Advocate ${s()("reward",t.length)}: ${_.some(t)?t.join(", "):"none"}`},checkedCampaign:t=>e.changes.campaign_id===t,showIncentives:t=>e.checkedCampaign(t)&&!e.changes.follow_fraud_settings}))).actions((e=>({validateForm:()=>{let t={};e.changes.campaign_id||(t.campaign="can't be blank"),!e.changes.follow_fraud_settings&&e.changes.campaign_id&&(e.incentives.showAdvocateIncentive&&!e.incentives.advocate||e.incentives.showFriendIncentive&&!e.incentives.friend)&&(t.incentives="can't be blank"),e.updateErrors(t)},checkCreateReferral:t=>{e.validateForm(),_.some(e.errors)?g():e.createReferral(t)},prepareDataForServer:()=>("none"===e.incentives.advocate?e.updateReferrerIncentive():e.updateReferrerIncentive(e.incentives.advocate),"none"===e.incentives.friend?e.updateReferredIncentive():e.updateReferredIncentive(e.incentives.friend),{build_referral:_.omit(e.changes,"campaign_id"),campaign_id:e.changes.campaign_id}),updateReferrerIncentive:t=>{e.changes.referrer_incentive_id=t},updateReferredIncentive:t=>{e.changes.referred_incentive_id=t},createReferral:Object(r.flow)((function*(t){try{e.updateFetching(!0);const a=yield Object(p.ajax)({type:"POST",url:Routes.internal_site_customer_service_referrals_path(e.siteCachedSlug),data:e.prepareDataForServer()});t.push(Routes.customer_service_portal_referral_details_site_path(e.siteCachedSlug,a.result.id)),e.updateInitialDataFetched(!1)}catch(xhr){e.updateErrors(_.get(xhr,"responseJSON.result.errors",{})),g(_.get(xhr,"responseJSON.result.error_message")),e.updateFetching(!1)}})),fetchData:Object(r.flow)((function*(){try{e.updateFetching(!0),e.errors={};const t=yield Object(p.ajax)({url:Routes.new_internal_site_customer_service_referral_path(e.siteCachedSlug,{no_spinner:!0})});e.updateInitialData(t.result),e.updateChanges(t.result.build_referral);const a=m(),{campaign_id:r}=a,n=a["build_referral[friend_origin_order_number]"];r&&(e.campaignsFilter.updateSearch(r),e.updateCampaignId(r)),n&&e.updateFriendOriginOrderNumber(n),e.updateInitialDataFetched(!0),e.updateFetching(!1)}catch(xhr){g(_.get(xhr,"responseJSON.result.errors")||xhr.responseJSON)}})),onStatusChange:t=>{e.changes.campaign_id=t},setChange:({target:{name:t,value:a}})=>{e.changes[t]=a,"new_friend_order"===t&&(e.changes.friend_origin_order_number=e.friendOriginOrderNumber(a))},updateFetching:t=>e.fetching=t,updateInitialData:t=>{const a=_.omit(t,"campaigns");e.initialData=a,e.campaignsFilter.addAvailableCampaigns(t.campaigns)},updateChanges:t=>{e.changes=t},updateCampaignId:t=>{e.changes.campaign_id=_.toInteger(t)},updateFriendOriginOrderNumber:t=>{e.changes.friend_origin_order_number=t},updateErrors:t=>{e.errors=t},updateInitialDataFetched:t=>{e.initialDataFetched=t}})))},"M+GS":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"e",(function(){return i})),a.d(t,"l",(function(){return o})),a.d(t,"j",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"b",(function(){return p})),a.d(t,"d",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"i",(function(){return m})),a.d(t,"m",(function(){return g})),a.d(t,"k",(function(){return h})),a.d(t,"h",(function(){return b}));const r={advocate_signup_incentive:{title:"Advocate signup incentive",description:"Given to an Advocate after signing up to Standalone campaign with his email"},advocate_sharing_incentive:{title:"Advocate sharing incentive",description:"Given to an Advocate after sharing via social network or email"},advocate_personal_coupon_incentive:{title:"Advocate personal coupon incentive"},advocate_referral_incentive:{title:"Advocate referral incentive",description:"Given to an Advocate who has successfully referred a Friend"},advocate_referral_incentive_new_subscriber:{title:"Advocate referral incentive (new subscriber)",description:"Given to an Advocate who has successfully referred a Friend"},friend_incentive:{title:"Friend incentive",description:"Given to a Friend upon visiting a referral link"},friend_incentive_new_customer:{title:"Friend incentive (new customer)",description:"Given to a Friend upon visiting a referral link"},friend_incentive_existing_customer:{title:"Friend incentive (existing customer)",description:"Given to a Friend upon visiting a referral link"},friend_incentive_expired_offer:{title:"Friend incentive (expired offer)",description:"Given to a Friend upon visiting a referral link"},friend_incentive_self_referral:{title:"Friend incentive (self-referral)",description:"Given to a Friend upon visiting a referral link"},friend_incentive_new_subsriber:{title:"Friend incentive (new subscriber)",description:"Given to a Friend upon visiting a referral link"},friend_referred_incentive:{title:"Friend referred incentive",description:"Given to a Friend after they make referral purchase"},email_capture_giveaway_incentive:{title:"Email capture giveaway incentive",description:"Given instantly"},email_capture_signup_incentive:{title:"Email capture signup incentive",description:"Given after signup"}},n=["multi_use_coupon_code","coupon_list_id"],i=e=>{switch(e.type){case"SignupIncentive":return r.advocate_signup_incentive;case"SharingIncentive":return r.advocate_sharing_incentive;case"PersonalCouponIncentive":return r.advocate_personal_coupon_incentive;case"ReferrerIncentive":return"1"===e.new_optin?r.advocate_referral_incentive_new_subscriber:r.advocate_referral_incentive;case"ClickIncentive":return"1"===e.allow_on_self_referral?r.friend_incentive_self_referral:"1"===e.allow_on_expired_offer?r.friend_incentive_expired_offer:"1"===e.new_optin?r.friend_incentive_new_subsriber:_.isNil(e.new_customer)?r.friend_incentive:"1"===e.new_customer?r.friend_incentive_new_customer:r.friend_incentive_existing_customer;case"ReferredIncentive":return r.friend_referred_incentive;case"EmailCapture::GiveawayIncentive":return r.email_capture_giveaway_incentive;case"EmailCapture::SignupIncentive":return r.email_capture_signup_incentive}},o=({coupon_list_expires_at:e,latest_coupon_expiration_date:t})=>e&&t&&dayjs(t)>=dayjs(e),s=e=>dayjs().diff(dayjs(e),"minute")>=1,l=e=>{const t=((e={})=>{const{incentive_type:t,multi_use_coupon:a}=e;switch(t){case"discount_coupon":return _.some(a)?"multi-use coupon code":"single-use coupon code";case"rebate":return"rebate";default:return""}})(e);return`${null==e?void 0:e.short_description}${(null==t?void 0:t.length)>0?` ${t}`:""}`},c=e=>e<0?"":String.fromCharCode(97+e).toUpperCase(),p=e=>`incentive_${e}`,u=e=>`/incentives/edit/${e}`,d=e=>`/personal_coupon/edit/${e}`,m=e=>e.some((e=>{var t;return null==(t=e.split_test_variant)?void 0:t.winner})),g=e=>m(e)?_.sortBy(e,(e=>{var t;return null==(t=e.split_test_variant)?void 0:t.winner})):e,h=e=>e.every((e=>{var t,a;return!(null!=(t=e.split_test_variant)&&t.winner)&&(null==(a=e.split_test_variant)?void 0:a.winner_selected_at)})),y={ReferrerIncentive:{new_optin:"0"},ReferrerSubscription:{new_optin:"1"}},f={ClickIncentive:{new_customer:"",new_optin:"0",allow_on_expired_offer:"0",allow_on_self_referral:"0"},NewCustomer:{new_customer:"1",new_optin:"0",allow_on_expired_offer:"0",allow_on_self_referral:"0"},ExistingCustomer:{new_customer:"0",new_optin:"0",allow_on_expired_offer:"0",allow_on_self_referral:"0"},ExpiredOffer:{new_customer:"",new_optin:"0",allow_on_expired_offer:"1",allow_on_self_referral:"0"},SelfReferral:{new_customer:"",new_optin:"0",allow_on_expired_offer:"0",allow_on_self_referral:"1"},NewSubscriber:{new_customer:"",new_optin:"1",allow_on_expired_offer:"0",allow_on_self_referral:"0"}},b=e=>{switch(e.type){case"ClickIncentive":return(e=>{const t={new_customer:e.new_customer||"",new_optin:e.new_optin,allow_on_expired_offer:e.allow_on_expired_offer,allow_on_self_referral:e.allow_on_self_referral};let a;return _.each(f,((e,r)=>{_.isEqual(e,t)&&(a=r)})),a})(e);case"ReferrerIncentive":return(e=>{const t={new_optin:e.new_optin};let a;return _.map(y,((e,r)=>{_.isEqual(e,t)&&(a=r)})),a})(e);default:return e.type}}},"Md/s":function(e,t,a){"use strict";(function(e){a.d(t,"i",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"h",(function(){return m})),a.d(t,"d",(function(){return g})),a.d(t,"e",(function(){return h})),a.d(t,"f",(function(){return y})),a.d(t,"g",(function(){return f})),a.d(t,"b",(function(){return _}));var r=a("vOnD"),n=a("GaHK"),i=a("55Ip");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const l=r.default.div.withConfig({displayName:"components__VerticalDivider"})(["height:32px;width:1px;background-color:",";"],n.Theme.color.black25),c=r.default.small.withConfig({displayName:"components__BetaLabel"})([""," text-transform:uppercase;font-size:10px;transform:translate(2px,-5px);letter-spacing:0.03em;display:inline-block;"],n.Theme.fontWeights.medium),p=e=>Object(r.css)([".sign-svg-fill-outer{fill:",";}"],e),u=Object(r.default)(n.UILink).withConfig({displayName:"components__HeaderLinkStyleOverride"})(["&&{"," color:#555555;text-decoration:none;font-size:14px;letter-spacing:-0.44px;transition:color 0.3s;height:",";line-height:",";display:inline-block;white-space:nowrap;&:visited{color:#555555;}span{display:inline-block;transform:translateY(2px);}.sign-svg-fill-outer{transition:0.3s;}&.is-active,&:active,&:hover,&:focus{",";color:",";.sign-svg-fill{fill:",";}}}"],n.Theme.fontWeights.medium,(({height:e})=>e),(({height:e})=>e),(({type:e})=>(e=>{switch(e){case"referral":return p("#ff684a");case"emailCapture":return p(n.Theme.color.coral);case"customerServicePortal":return p(n.Theme.color.yellow);case"loyaltyBadge":return p(n.Theme.color.rose);default:return Object(r.css)(["position:relative;&::after{content:'';display:block;position:absolute;bottom:0;left:0;right:0;height:3px;background-color:",";}"],n.Theme.color.orange)}})(e)),n.Theme.color.black100,n.Theme.color.black100);let d=function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r),n.prototype.render=function(){const{children:t,isActive:a,height:r,type:n,href:o,className:s,locationRouter:l,target:c}=this.props;return e.createElement(u,{className:classNames(s,{"is-active":a}),type:n,to:l?o:void 0,href:l?void 0:o,height:r,as:l?i.Link:void 0,target:c},t)},n}(e.PureComponent);d.defaultProps={height:"auto"};const m=({height:t,children:a,...r})=>e.createElement(d,o({height:"48px"},r),a),g=r.default.div.withConfig({displayName:"components__HeaderTopContainer"})(["position:relative;box-shadow:0 1px rgba(0,0,0,0.1);"]),h=r.default.div.withConfig({displayName:"components__HeaderTopInner"})(["position:relative;&.is-wide-report{@media (min-width:1600px){padding-right:50px;}}@media (max-width:1350px){padding-right:50px;}"]),y=r.default.div.withConfig({displayName:"components__SubHeaderContainer"})(["background:#fafafa;box-shadow:0 1px 1px 0 rgba(0,0,0,0.1),0 1px 4px 0 rgba(0,0,0,0.05);"]),f=r.default.div.withConfig({displayName:"components__SubHeaderInner"})(["display:flex;justify-content:space-between;align-items:center;"]),_=r.default.div.withConfig({displayName:"components__HeaderContainer"})(["background-color:#fff;margin-bottom:24px;position:relative;&.is-wide-report{@media (min-width:1600px){border-bottom:none;min-width:1260px;&::after{content:'';display:block;position:absolute;left:-20px;right:-20px;bottom:-1px;height:1px;background-color:#eee;}",",","{margin-right:-20px;padding-right:20px;padding-left:20px;margin-left:-20px;}}}"],g,y)}).call(this,a("q1tI"))},MrdO:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma");const n=r.types.model("TileConfigurationMetricStore",{id:r.types.maybeNull(r.types.number),identifier:r.types.maybeNull(r.types.string),name:r.types.maybeNull(r.types.string),result_type:r.types.maybeNull(r.types.string),custom_name:r.types.maybeNull(r.types.string),customMetricFieldState:!1}).views((e=>({get humanName(){return e.custom_name||e.name}}))).actions((e=>({}))),i=(n.create(),r.types.model("TileConfigurationStore",{ui:r.types.maybeNull(r.types.model({revenue_metrics:r.types.maybeNull(r.types.array(r.types.string)),transactions:r.types.maybeNull(r.types.boolean),overtime_chart:r.types.maybeNull(r.types.boolean),revenue_percentage:r.types.maybeNull(r.types.boolean),first_metric:r.types.optional(n,{}),second_metric:r.types.optional(n,{}),third_metric:r.types.optional(n,{}),metric:r.types.optional(n,{}),revenue_segmentation:r.types.maybeNull(r.types.model({enabled:r.types.boolean,options:r.types.model({segments:r.types.string})}))})),friend_sales:r.types.maybeNull(r.types.model({enabled:r.types.boolean,options:r.types.model({new_customers:r.types.maybeNull(r.types.string),referral_statuses:r.types.array(r.types.string),ideal_timing:!0,coupon_usage:r.types.maybeNull(r.types.string)})})),advocate_sales:r.types.maybeNull(r.types.model({enabled:r.types.boolean,options:r.types.model({new_customers:r.types.maybeNull(r.types.string)})})),campaign_tags:r.types.maybeNull(r.types.array(r.types.string)),event_categories:r.types.maybeNull(r.types.array(r.types.string))}).views((e=>({}))).actions((e=>({}))));i.create()},"Mx/S":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("TyAF"),n=a("Ty5D"),i=a("55Ip"),o=a("sT1B"),s=a("GaHK");function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const c=Object(n.o)(Object(r.b)((({rootStore:e})=>({rootStore:e,campaignShowRoot:e.pages.campaignShowRoot})))(Object(r.c)(function(t){var a,r;function n(...e){var a;return(a=t.call(this,...e)||this).handleOpenCopyModal=e=>{null==e||e.preventDefault();const{campaignShowRoot:t,isSpa:r}=a.props;t.openCopyModal(r),Utils.trackGAEvent(o.q,"open copy campaign modal")},a.handleOpenThemeStoreModal=e=>{null==e||e.preventDefault();const{campaignShowRoot:t,isSpa:r}=a.props;t.openThemeStoreModal(r),Utils.trackGAEvent(o.q,"open theme store modal")},a.destroyCampaign=e=>{null==e||e.preventDefault();const{campaignShowRoot:{destroyCampaign:t},isSpa:r}=a.props;t(r),Utils.trackGAEvent(o.q,"destroy campaign")},a.showDestroyCampaignModal=()=>{const{campaignShowRoot:{currentCampaign:e}}=a.props;e.network.delete.isLoading||(e.deleteModal.open(),Utils.trackGAEvent(o.q,"nav click","show destroy campaign modal"))},a.showCampaignFlushDataModal=()=>{const{campaignShowRoot:{campaignFlushData:e}}=a.props;e.network.delete.isLoading||(e.modal.open(),Utils.trackGAEvent(o.q,"nav click","show flush campaign modal"))},a.flushCampaign=()=>{const{campaignShowRoot:{flushCampaignData:e},isSpa:t}=a.props;e(t)},a.getColorFlushCampaign=()=>{const{campaignShowRoot:{campaignFlushData:e}}=a.props;return e.network.delete.isLoading?s.Theme.color.black25:s.Theme.color.red},a.getColorDestroyCampaign=()=>{const{campaignShowRoot:{currentCampaign:e}}=a.props;return e.network.delete.isLoading?s.Theme.color.black25:s.Theme.color.red},a}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,l(a,r),n.prototype.render=function(){const{rootStore:t,campaignShowRoot:{currentCampaign:a,currentCampaign:{test_mode:r,origin_class:n},campaignFlushData:l,campaignShowPage:{siteCachedSlug:c,currentUser:{staffMember:p}}},isSpa:u,history:{location:{pathname:d}}}=this.props;return e.createElement(e.Fragment,null,e.createElement(s.UIMenuDropdown,{renderButton:()=>e.createElement(s.UIButton,{"data-testid":"ac-campaign-navigation-actions",size:"smaller"},e.createElement(s.UIIcon,{name:"more"}),"Actions")},a.isCopyAvailable&&e.createElement(s.UIMenuDropdown.Item,{onClick:this.handleOpenCopyModal,"data-testid":"ac-campaign-navigation-actions-copy-campaign"},e.createElement("div",{className:"flex align-items-center","data-testid":"ac-campaign-navigation-actions-copy"},e.createElement(s.UIIcon,{width:"16",name:"copy"}),e.createElement(s.H5,null,"Copy"))),a.isReferralTestOfferAvailable&&e.createElement(s.UIMenuDropdown.Item,{isLink:!0,"data-testid":"ac-campaign-navigation-actions-create-test-referral-offer"},e.createElement("a",{className:classNames("flex align-items-center js-ga-click",{"is-active":Routes.new_site_origin_path(c)===d}),"data-category":o.q,"data-action":"nav click","data-label":"create test offer",target:"_blank",href:Routes.new_site_origin_path(c,{origin:{type:n},campaign_id:a.id})},e.createElement(s.UIIcon,{width:"16",name:"offer"}),e.createElement(s.H5,null,"Create test offer"))),t.isConversionSpace&&e.createElement(s.UIMenuDropdown.Item,{isLink:!0,"data-testid":"ac-campaign-navigation-actions-create-test-conversion-offer"},e.createElement("a",{className:classNames("flex align-items-center js-ga-click",{"is-active":Routes.site_new_conversion_offer_path(c,{campaign_id:a.id})===d}),"data-category":o.q,"data-action":"nav click","data-label":"create test offer",target:"_blank",href:Routes.site_new_conversion_offer_path(c,{campaign_id:a.id})},e.createElement(s.UIIcon,{width:"16",name:"offer"}),e.createElement(s.H5,null,"Create test offer"))),a.loyaltySpace&&e.createElement(s.UIMenuDropdown.Item,{isLink:!0,"data-testid":"ac-campaign-navigation-actions-create-test-loyalty-member"},e.createElement("a",{className:classNames("flex align-items-center js-ga-click",{"is-active":Routes.new_site_loyalty_member_path(c,{campaign_id:a.id})===d}),"data-category":o.q,"data-action":"nav click","data-label":"create test member",target:"_blank",href:Routes.new_site_loyalty_member_path(c,{campaign_id:a.id})},e.createElement(s.UIIcon,{width:"16",name:"offer"}),e.createElement(s.H5,null,"Create test member"))),t.isReferralSpace&&e.createElement(s.UIMenuDropdown.Item,{isLink:!0,"data-testid":"ac-campaign-navigation-actions-settings-changes"},e.createElement("a",{className:"flex align-items-center js-ga-click","data-category":o.q,"data-action":"nav click","data-label":"settings changes",href:Routes.site_settings_changes_path(c,{settings_changes_grid:{campaigns_filter:{campaign_id:a.id}}})},e.createElement(s.UIIcon,{width:"16",name:"changes"}),e.createElement(s.H5,null,"Settings changes"))),t.isReferralSpace&&e.createElement(s.UIMenuDropdown.Item,{isLink:!0,"data-testid":"ac-campaign-navigation-actions-migrate"},u?e.createElement(i.NavLink,{activeClassName:"is-active",className:"flex align-items-center js-ga-click","data-category":o.q,"data-action":"nav click","data-label":"migrate",to:Routes.campaign_copy_data_site_path(c,a.id),"data-router":!0},e.createElement(s.UIIcon,{width:"16",name:"migrate"}),e.createElement(s.H5,null,"Migrate")):e.createElement("a",{href:Routes.campaign_copy_data_site_path(c,a.id),className:"flex align-items-center js-ga-click","data-category":o.q,"data-action":"nav click","data-label":"migrate"},e.createElement(s.UIIcon,{width:"16",name:"migrate"}),e.createElement(s.H5,null,"Migrate"))),a.isOfferBlastAvailable&&e.createElement(s.UIMenuDropdown.Item,{isLink:!0,"data-testid":"ac-campaign-navigation-actions-offer-blast"},e.createElement("a",{className:classNames("flex align-items-center js-ga-click",{"is-active":Routes.site_offer_blasts_path(c,a.id)===d}),"data-category":o.q,"data-action":"nav click","data-label":"offer blast",href:Routes.site_offer_blasts_path(c,a.id)},e.createElement(s.UIStaffBadge,{className:"mrs",size:"micro",text:!1}),e.createElement(s.H5,null,"Offer Blast"))),a.diffAvailable&&e.createElement(s.UIMenuDropdown.Item,{isLink:!0,"data-testid":"ac-campaign-navigation-actions-diff"},e.createElement("a",{className:"flex align-items-center js-ga-click","data-category":o.q,"data-action":"nav click","data-label":"diff",href:Routes.diff_site_campaign_path(c,t.urlSpaceParameter,a.id)},e.createElement(s.UIStaffBadge,{className:"mrs",size:"micro",text:!1}),e.createElement(s.H5,null,"Diff"))),a.themeStoreAvailable&&e.createElement(s.UIMenuDropdown.Item,{onClick:this.handleOpenThemeStoreModal,"data-testid":"ac-campaign-navigation-actions-copy-theme-store"},e.createElement("div",{className:"flex align-items-center"},e.createElement(s.UIStaffBadge,{className:"mrs",size:"micro",text:!1}),e.createElement(s.H5,null,c===o.eb?"Copy from Theme store":"Copy to Theme store"))),p&&e.createElement(s.UIMenuDropdown.Item,{isLink:!0,"data-testid":"ac-campaign-navigation-actions-localizations-csv"},e.createElement("a",{className:"flex align-items-center js-ga-click","data-category":o.q,"data-action":"nav click","data-label":"localizations csv",href:Routes.localizations_export_site_campaign_path(c,a.id)},e.createElement(s.UIStaffBadge,{className:"mrs",size:"micro",text:!1}),e.createElement(s.H5,null,"Localizations CSV"))),r&&e.createElement(s.UIMenuDropdown.Item,{"data-testid":"ac-campaign-navigation-flush-data",onClick:this.showCampaignFlushDataModal},e.createElement("div",{className:"flex align-items-center"},e.createElement(s.UIIcon,{width:"16",fill:this.getColorFlushCampaign(),name:"cross"}),e.createElement(s.H5,{color:this.getColorFlushCampaign()},"Flush all data"))),a.isDeletable&&e.createElement(s.UIMenuDropdown.Item,{onClick:this.showDestroyCampaignModal,"data-testid":"ac-campaign-navigation-actions-delete"},e.createElement("div",{className:"flex align-items"},e.createElement(s.UIIcon,{width:"16",fill:this.getColorDestroyCampaign(),name:"delete"}),e.createElement(s.H5,{color:this.getColorDestroyCampaign()},"Delete campaign")))),l.modal.shouldShow&&e.createElement("div",{className:"ac-flush-campaign-modal","data-testid":"ac-flush-campaign-modal"},e.createElement(s.UIModalConfirmation,{title:"Confirmation",type:"confirmation",onCloseModal:l.modal.close,onPrimaryAction:this.flushCampaign},e.createElement("p",null,"Are you sure you want to delete data (offers, purchases, referrals, rewards, ...)?"))),a.deleteModal.shouldShow&&e.createElement("div",{className:"ac-destroy-campaign-modal"},e.createElement(s.UIModalConfirmation,{title:"Confirmation",type:"confirmation",onCloseModal:a.deleteModal.close,onPrimaryAction:this.destroyCampaign},e.createElement("p",null,"Are you sure you want to delete this campaign?"))))},n}(e.PureComponent))))}).call(this,a("q1tI"))},"N/Cz":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma");const n=r.types.model("previewData",{desktop:"",mobile:"",tablet:""}).views((e=>({}))).actions((e=>({}))),i=r.types.model("StaticWidgetInfoStore",{published:r.types.maybeNull(r.types.boolean),eligible:r.types.maybeNull(r.types.boolean),fresh:r.types.maybeNull(r.types.boolean),ineligible_reasons:r.types.optional(r.types.array(r.types.string),[]),preview:r.types.optional(n,{})}).views((e=>({get isActive(){return e.published&&e.fresh},get tooltipText(){let t="";return t=_.some(e.ineligible_reasons)||!e.eligible?"Could not publish campaign changes. <br /> Click here for more details":e.fresh?"Static trigger widget is working":"Publishing campaign changes\u2026",t},get errorText(){return e.ineligible_reasons.join("\n")},get ineligibleReasonsExists(){return _.some(e.ineligible_reasons)}}))).actions((e=>({})))},NdUt:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("GaHK");function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let i=function(t){var a,i;function o(){return t.apply(this,arguments)||this}return i=t,(a=o).prototype=Object.create(i.prototype),a.prototype.constructor=a,n(a,i),o.prototype.render=function(){const{value:t,onChange:a}=this.props;return e.createElement("div",{className:"ac-campaign-filter-search-block flex-grow-1"},e.createElement(r.UIInputText,{name:"query",value:t,onChange:_.debounce(a,300),placeholder:"Search by campaign ID, name or status",icon:{name:"searchLite",width:22}}))},o}(e.PureComponent);i.propsTypes={value:PT.string.isRequired,onChange:PT.func.isRequired}}).call(this,a("q1tI"))},NdV1:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return u}));var r=a("99Ma"),n=a("B9cq"),i=a("sT1B"),o=a("pm75"),s=a("cYwS");const l=r.types.compose("EventCategoryReferralData",s.a,r.types.model().views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get monthlyEventsLink(){const t={commit:"Generate",origin:{type:"Event"},origins_grid:{coupon_code:"",created_at_period_type:"custom",email:"",event_categories:[e.identifier],order_number:""},utf8:!0};return Routes.site_origins_path(e.siteCachedSlug,t)},get monthlyReferralsLink(){const t={commit:"Generate",referrals_grid:{campaigns_filter:{live_campaigns:0},created_at_period_type:"custom",email:"",friend_event_category:[e.identifier]},utf8:!0};return Routes.site_referrals_path(e.siteCachedSlug,t)},get isDisabled(){return!e.rootStore.models.currentUser.staff_member||"purchase"===e.identifier},get tooltip(){switch(!0){case"purchase"===e.identifier:return"Purchases cannot be configured as non-referral.";case e.isDisabled:return"Only staff member can change it."}return""},get showWarningForMonthlyReferrals(){return Boolean(e.monthly_events)&&!e.monthly_referrals&&!e.referrable}})))),c=r.types.model("EventCategoryReferral",{data:l,initialData:r.types.maybeNull(r.types.frozen()),network:r.types.optional(o.b,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get isUpdating(){return e.network.put.isLoading}}))).actions((t=>({afterCreate(){t.initialData=t.data.toJSON()},updateReferrable(e){t.data.referrable=e},setInitialData(){t.data=t.initialData},handleChange:Object(r.flow)((function*({target:{value:e}}){try{t.updateReferrable(e),yield t.apiPut({eventCategoryId:t.data.id,value:e})}catch(xhr){var a,r;t.setInitialData(),Validation.showErrorFlash(null==(a=xhr.responseJSON)||null==(r=a.result)?void 0:r.error_message)}})),apiPut:Object(r.flow)((function*({eventCategoryId:a,value:i}){try{t.network.put.updateLoading(!0),yield Object(n.ajax)({url:Routes.internal_site_event_category_path(t.siteCachedSlug,a),type:"PUT",data:{event_category:{referrable:i}}})}catch(xhr){var o;throw null!=(o=xhr.responseJSON)&&o.result.error_message||e({name:`Unable to PUT event_category with id: ${t.id}`,message:"Ajax failure",xhr:xhr}),xhr}finally{Object(r.isAlive)(t)&&t.network.put.updateLoading(!1)}}))}))).preProcessSnapshot((e=>({data:e}))),p=r.types.model({name:"monthly_referrals",value:i.K}).views((()=>({}))).actions((e=>({handleSortingChange:({name:t,value:a})=>{e.name=t,e.value=a}}))),u=r.types.model("EventCategoriesPage",{event_categories:r.types.array(c),network:r.types.optional(o.b,{}),sorting:r.types.optional(p,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get isLoading(){return e.network.get.isLoading},get isEditable(){return e.event_categories.every((e=>!e.isUpdating))},get sortedEventCategories(){const t=e.event_categories.slice().sort(((t,a)=>t.data[e.sorting.name]-a.data[e.sorting.name]));return"ASC"===e.sorting.value?t:t.reverse()}}))).actions((t=>({apiGet:Object(r.flow)((function*(){try{var a;t.network.get.updateLoading(!0);const e=yield Object(n.ajax)({url:Routes.internal_site_event_categories_path(t.siteCachedSlug,{no_spinner:!0})});return t.updateData(null==(a=e.result)?void 0:a.event_categories),t.network.get.updateLoaded(!0),e}catch(xhr){e({name:"Unable to fetch event_categories",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.network.get.updateLoading(!1)}})),updateData:e=>{Object(r.applySnapshot)(t.event_categories,e)},reset(){Object(r.applySnapshot)(t,{})}})))}).call(this,a("B9cq").notifyDevelopers)},O6AO:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("TyAF"),n=a("Ty5D"),i=a("GaHK");function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const s=Object(n.o)(Object(r.b)((({rootStore:e})=>({campaignShowRoot:e.pages.campaignShowRoot})))(Object(r.c)(function(t){var a,r;function n(...e){var a;return(a=t.call(this,...e)||this).normalizeStatus=()=>{const{campaignShowRoot:{currentCampaign:{status:e}}}=a.props;switch(e){case"Live":return"green";case"Test":return"yellow";case"Disabled":return"red";case"Scheduled":return"yellow";default:return"gray"}},a}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,o(a,r),n.prototype.render=function(){const{campaignShowRoot:{currentCampaign:{status:t}}}=this.props;return e.createElement(i.UIBadge,{color:this.normalizeStatus()},e.createElement(i.UIIcon,{width:"12",height:"12",name:_.lowerCase(t)}),e.createElement("span",{className:"ac-campaign-status"},t))},n}(e.PureComponent))))}).call(this,a("q1tI"))},OOsX:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return r}));const r=({times:t=10})=>e.createElement("div",{className:"component-loader"},e.createElement("ul",{className:"campaignfilter-list"},_.times(t,(t=>e.createElement("li",{className:"is-edit",key:t},e.createElement("div",{className:"campaignfilter-campaign-label"},e.createElement("div",{className:"campaign-type is-mini is-widget component-loader-box"})),e.createElement("div",{className:"campaignfilter-campaign-data"},e.createElement("a",{className:"component-loader-box"},"XXXXXX XXXXXXXXXXXX"),e.createElement("div",{className:"campaignfilter-campaign-id"},e.createElement("span",{className:"component-loader-box"},"XX: XXX"))),e.createElement("div",{className:"campaignfilter-campaign-offers"},e.createElement("span",{className:"component-loader-box"},"XXX")))))))}).call(this,a("q1tI"))},OdtE:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("99Ma");const n=r.types.union(r.types.number,r.types.string,r.types.null,r.types.undefined),i=r.types.model({code:"",coupon_list_id:r.types.maybeNull(r.types.string),created_at:r.types.maybeNull(r.types.string),expires_at:r.types.maybeNull(r.types.string),id:r.types.identifierNumber,ownerships_count:r.types.maybeNull(r.types.number),site_id:r.types.maybeNull(r.types.number)}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))),o=r.types.model("SplitTestVariantSchema",{id:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),distribution_rate:r.types.maybeNull(r.types.number),site_id:r.types.maybeNull(r.types.number),split_test_id:r.types.maybeNull(r.types.number),updated_at:r.types.maybeNull(r.types.string),value:r.types.maybeNull(r.types.string),value_hash:r.types.maybeNull(r.types.string),winner:r.types.frozen()}),s=r.types.model("IncentiveSchema",{absolute_distribution:r.types.maybeNull(r.types.number),allow_on_expired_offer:n,allow_on_self_referral:n,amount:n,available_coupons_count:r.types.maybeNull(r.types.number),coupon_list_id:n,criteria:r.types.maybeNull(r.types.string),custom_description:r.types.maybeNull(r.types.string),description:r.types.maybeNull(r.types.string),distribution_rate:r.types.maybeNull(r.types.number),email_shares:n,for_advocate:r.types.boolean,for_friend:r.types.boolean,friend_event_category:r.types.maybeNull(r.types.string),human_criterias:r.types.maybeNull(r.types.array(r.types.string)),human_name:r.types.maybeNull(r.types.string),id:r.types.identifierNumber,identifier:r.types.maybeNull(r.types.string),incentive_type:r.types.maybeNull(r.types.string),multi_use_coupon:r.types.optional(r.types.maybeNull(i),{}),new_customer:n,new_optin:r.types.union(r.types.string,r.types.null,r.types.undefined),once_per_person:n,percentage_discount:r.types.maybeNull(r.types.boolean),percentage_probability:r.types.maybeNull(r.types.string),referrals_max:n,referrals_min:n,reward_uniqueness:r.types.maybeNull(r.types.string),sharing_channels:r.types.maybeNull(r.types.string),short_description:r.types.maybeNull(r.types.string),split_tested:r.types.maybeNull(r.types.boolean),split_test_variant:r.types.maybeNull(o),subtotal_max:n,subtotal_min:n,type:r.types.maybeNull(r.types.string),latest_coupon_expiration_date:r.types.maybeNull(r.types.string)}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({get distributionInfo(){return`${e.distribution_rate}:${e.absolute_distribution}, ${e.percentage_probability} distribution`},get formattedDescription(){return _.upperFirst(e.description)},get humanCriteriasExists(){return _.some(e.human_criterias)},get isMultiUseCouponCode(){return 0!==e.multi_use_coupon.id},get distributionInfoDescription(){let t="";return t=e.split_tested?`#${e.id} \u2022 ${e.distributionInfo}`:`#${e.id}`,t}})))},Om6g:function(e,t,a){"use strict";a.r(t),function(e){var r=a("EVdn"),n=a.n(r),i=a("mwIZ"),o=a.n(i),s=a("QDUJ"),l=a("B9cq");t.default=()=>{n()(document).ajaxError(((t,a,r)=>{Object(l.isAccessDeniedStatus)(a)&&(document.getElementById("access-modal")||s.a.mount()),500===a.status&&e({message:`Unable to ajax ${o()(r,"url")} ${o()(r,"type")}`,name:"Ajax failure 500",xhr:a})}))}}.call(this,a("B9cq").notifyDevelopers)},On4Y:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("99Ma");const n=r.types.model("PersonalCouponList",{id:r.types.maybeNull(r.types.identifierNumber),amount:r.types.maybeNull(r.types.number),name:r.types.maybeNull(r.types.string),percentage_discount:r.types.maybeNull(r.types.boolean),site_id:r.types.maybeNull(r.types.number),campaigns_count:r.types.maybeNull(r.types.number)}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get site(){return e.rootStore.models.site},get siteCachedSlug(){return e.site.siteCachedSlug},get humanName(){let t="";return t=e.percentage_discount?`${e.amount}%`:e.site.valueInSiteCurrency(e.amount),t},get description(){return`${e.humanName} coupon code`},get humanSelectName(){return`${e.humanName} | ${e.name}`}}))).actions((e=>({})))},OuKs:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("Md/s"),n=a("GaHK"),i=a("V0vo");function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let s=function(t){var a,s;function l(){return t.apply(this,arguments)||this}return s=t,(a=l).prototype=Object.create(s.prototype),a.prototype.constructor=a,o(a,s),l.prototype.render=function(){const{currentSiteCachedSlug:t,urlHome:a,locationRouter:o}=this.props;return e.createElement("div",{className:"flex align-items-center mlm","data-testid":"ac-header-product-switcher"},e.createElement(r.i,null),e.createElement(r.c,{className:"mlm",isActive:"referral"===Object(i.t)(location.pathname),href:a,type:"referral",locationRouter:o},e.createElement(n.UIIcon,{name:"horn",className:"mrd"}),e.createElement("span",null,"Referrals")),e.createElement(r.c,{className:"mll",isActive:"conversion"===Object(i.t)(location.pathname),href:Routes.conversion_site_path(t),type:"emailCapture",locationRouter:o},e.createElement(n.UIIcon,{name:"emailCapture",className:"mrd"}),e.createElement("span",null,"Conversion"),e.createElement(r.a,null,"beta")),e.createElement(r.c,{className:"mll",isActive:"loyalty"===Object(i.t)(location.pathname),href:Routes.loyalty_site_path(t),type:"loyaltyBadge",locationRouter:o},e.createElement(n.UIIcon,{name:"loyaltyBadge",className:"mrd"}),e.createElement("span",null,"Loyalty"),e.createElement(r.a,null,"beta")))},l}(e.PureComponent)}).call(this,a("q1tI"))},Ov1f:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("UEOA");const i=r.types.model("UnredeemStore",{id:r.types.maybeNull(r.types.number),amount:r.types.maybeNull(r.types.number),incentive:r.types.maybeNull(n.a),percentage_discount:r.types.maybeNull(r.types.boolean),human_unredeem_reason:r.types.maybeNull(r.types.string)}).views((e=>({})))},P0Hl:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("55Ip"),n=a("GaHK");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let o=function(t){var a,o;function s(){return t.apply(this,arguments)||this}return o=t,(a=s).prototype=Object.create(o.prototype),a.prototype.constructor=a,i(a,o),s.prototype.render=function(){const{locationRouter:t,urlHome:a}=this.props;return e.createElement("div",{className:"logo"},t?e.createElement(r.Link,{to:a},e.createElement(n.UIIcon,{name:"logo"})):e.createElement("a",{href:a},e.createElement(n.UIIcon,{name:"logo"})))},s}(e.PureComponent)}).call(this,a("q1tI"))},P1f6:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("aetS"),i=a("pm75"),o=a("sT1B");const s=r.types.model("CampaignDeactivation",{staticWidgetDeactivationModal:r.types.optional(n.a,{}),network:r.types.optional(i.b,{})}).views((e=>({get campaign(){return Object(r.getParent)(e)},get siteCachedSlug(){return Object(r.getRoot)(e).siteCachedSlug}}))).actions((t=>({deactivate:Object(r.flow)((function*(a){try{t.staticWidgetDeactivationModal.close(),t.network.get.updateLoading(!0);return yield $.ajax({url:Routes.toggle_deal_status_site_campaign_path(t.siteCachedSlug,a||t.campaign.id)})}catch(xhr){return e({name:"Unable to deactivate campaign",message:"Ajax failure",xhr:xhr}),xhr}finally{Object(r.isAlive)(t)&&t.network.get.updateLoading(!1)}})),checkDeactivationRules:()=>t.campaign.expired?(UINotifications.add({text:"Campaign is expired",type:"error"}),!1):!t.campaign.staticWidgetPolling||(Utils.trackGAEvent(o.db,"show deactivation modal"),t.staticWidgetDeactivationModal.open(),!1)})))}).call(this,a("B9cq").notifyDevelopers)},Pe0B:function(e,t,a){"use strict";function r(e,t,a){let r=new Image;r.crossOrigin="Anonymous",r.onload=function(){let e,n=document.createElement("CANVAS"),i=n.getContext("2d");n.height=r.height,n.width=r.width,i.drawImage(r,0,0),e=n.toDataURL(a),t({base64:e,height:r.height,width:r.width}),n=null},r.src=e}async function n(e){return new Promise(((t,a)=>{try{r(e,t)}catch(n){a(n)}}))}a.r(t),a.d(t,"convertImgToBase64URL",(function(){return r})),a.d(t,"default",(function(){return n}))},QDUJ:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("i8i4"),n=a.n(r),i=a("GaHK");function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let s=function(t){var a,r;function n(...e){var a;return(a=t.call(this,...e)||this).reloadPage=()=>{window.location.reload()},a.onCloseModal=()=>{document.body.removeChild(document.getElementById("access-modal"))},a}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,o(a,r),n.prototype.render=function(){return e.createElement(i.UIModalConfirmation,{type:"warning",title:"No access",onPrimaryAction:this.reloadPage,onSecondaryAction:this.onCloseModal,onCloseModal:this.onCloseModal,primaryButtonText:"Request access",width:"600"},"Your access to this account has expired.")},n}(e.Component);s.mount=()=>{let t=document.createElement("div");t.setAttribute("id","access-modal"),document.body.appendChild(t),n.a.render(e.createElement(s,null),t)}}).call(this,a("q1tI"))},R7RE:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("4KG8"),n=a.n(r);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let s=function(t){var a,r;function s(a){var r;return(r=t.call(this,a)||this).variables={},r.interpolationsChanging=e=>{r.convertToPreview();const t=r.field.current,a=_.keys(r.props.liquidInterpolationPreviews).map((e=>({key:e,value:r.props.liquidInterpolationPreviews[e]})));new n.a({collection:[{values:a,trigger:"{{ ",selectTemplate:e=>`{{ ${e.original.key} }}`,menuItemTemplate:e=>`${e.original.key}`,menuItemLimit:10,noMatchTemplate:"",requireLeadingSpace:!0},{values:a,trigger:"{{",selectTemplate:e=>`{{${e.original.key}}}`,menuItemTemplate:e=>`${e.original.key}`,menuItemLimit:10,noMatchTemplate:"",requireLeadingSpace:!0}]}).attach(t),$(t).on("tribute-replaced",(e=>{r.handleInput(e)}))},r.convertToPreview=()=>{const{liquidInterpolationPreviews:e,dataId:t}=r.props,a=$(r.preview.current);let n=r.state.text?r.state.text.replace(/\n$/g,"\n\n"):r.state.text;const i=$("<div></div>");i.text(n),a.html(r.sanitizeHtml(i.html())),$(`#localization_${t} mark`).each(((t,a)=>{const r=$(a).text().replace("{{","").replace("}}","").trim();n=$(a).text(),(_.isString(e[r])||_.isNumber(e[r]))&&(n=e[r]),$(a).text(n),$(a).attr("data-variable",r)}))},r.sanitizeHtml=e=>e.replace(/{{.*?}}/g,"<mark title='$&'>$&</mark>").replaceAll("&amp;","&").replaceAll("&nbsp;"," "),r.handleInput=e=>{e?r.setInputValue(e.target.value):r.state.text!==r.field.current.value&&r.setInputValue(r.field.current.value)},r.setInputValue=e=>{let t;t=_.isNumber(r.props.variantIndex)?{index:r.props.variantIndex,value:e}:{[r.props.dataId]:{id:r.props.dataId,values:[e]}},r.setState({text:e},(()=>{"function"===typeof r.props.onLocalizationItemChange&&r.props.onLocalizationItemChange(t),"function"===typeof r.props.onLocalizationItemABChange&&r.props.onLocalizationItemABChange(t),r.convertToPreview()}))},r.startWatchingGrammarly=()=>{r.timer=window.setInterval((()=>{r.handleInput()}),1e3)},r.stopWatchingGrammarly=()=>{window.clearInterval(r.timer)},r.resetGrammarlyStyles=()=>{$(r.field.current).css("background-color","")},r.field=e.createRef(),r.preview=e.createRef(),a.liquidInterpolations&&_.map(a.liquidInterpolations,((e,t)=>r.variables[`${t}`]=e)),r.state={text:a.text},r}r=t,(a=s).prototype=Object.create(r.prototype),a.prototype.constructor=a,o(a,r);var l=s.prototype;return l.componentDidUpdate=function(e){this.state.text!==e.text&&this.convertToPreview(),_.isEqual(this.props.liquidInterpolationKeys,e.liquidInterpolationKeys)||(_.map(this.props.liquidInterpolations,((e,t)=>this.variables[`${t}`]=e)),this.interpolationsChanging(nextProps))},l.componentDidMount=function(){this.interpolationsChanging(this.props);const e=this.field.current;autosize(e),$(e).on("focus",(()=>{setTimeout(this.resetGrammarlyStyles,0),$(e).parent().addClass("is-hover")})),$(e).on("hover",(()=>{this.resetGrammarlyStyles(),autosize.update(e)})),$(e).on("blur",(()=>{this.resetGrammarlyStyles(),$(e).parent().removeClass("is-hover")})),$("[data-gr-c-s-loaded]").length&&this.startWatchingGrammarly()},l.shouldComponentUpdate=function(e,t){return this.props.text!==e.text||this.state.text!==t.text||this.props.class!==e.class},l.componentWillUnmount=function(){this.stopWatchingGrammarly()},l.render=function(){const t=this.props.disabled?{disabled:"disabled"}:void 0,a=_.isNull(this.state.text)?"":this.state.text,r=classNames("form-textarea base-textarea",{[this.props.class]:this.props.class});return e.createElement("div",{id:`localization_${this.props.dataId}`,"data-testid":`ac-autocomplete-field-${this.props.dataId}`},e.createElement("div",{className:"code-area"},e.createElement("textarea",i({className:r,"data-placeholder":this.props.placeholder,"data-testid":`ac-autocomplete-field-textarea-${this.props.dataId}`,ref:this.field,rows:"1",value:a,onChange:this.handleInput},t)),e.createElement("div",i({className:r,"data-placeholder":this.props.placeholder,"data-validate":_.isNumber(this.props.variantIndex)?void 0:this.props.dataId,ref:this.preview},t))))},s}(e.Component);s.defaultProps={class:"",placeholder:"",text:"",liquidInterpolations:{}}}).call(this,a("q1tI"))},RFye:function(e,t,a){"use strict";a.r(t),t.default="/assets/v1/packs/gotham-htf-bold-38960182facd32d647e4dcb638ebaadb.ttf"},"RQ/8":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("pm75"),i=a("DgEd"),o=a("B9cq"),s=a("x7QQ");const l=r.types.compose("LoyaltyCustomRuleCategoriesData",s.a.array(i.a),n.c).views((e=>({get rootStore(){return Object(r.getRoot)(e)},getCategoryById:t=>e.data.find((e=>e.id===t))}))).actions((t=>({apiGet:Object(r.flow)((function*(){try{t.network.get.update("in_progress");const{result:e}=yield Object(o.ajax)({url:Routes.internal_site_loyalty_custom_rule_categories_path(t.rootStore.siteCachedSlug)});t.dataApplySnapshot(null==e?void 0:e.categories),t.network.get.update("success")}catch(xhr){t.network.get.update("error"),e({message:"Unable to fetch loyalty custom rule categories",name:"Ajax failure",xhr:xhr})}})),apiPost:Object(r.flow)((function*(a){try{t.network.post.update("in_progress");const e=yield Object(o.ajax)({type:"POST",url:Routes.internal_site_loyalty_custom_rule_categories_path(t.rootStore.siteCachedSlug),data:a});return t.network.post.update("success"),e.result.category}catch(xhr){var r,n;throw t.network.post.update("error"),422!==xhr.status&&e({message:"Unable to create loyalty custom rule categories",name:"Ajax failure",xhr:xhr}),null==(r=xhr.responseJSON)||null==(n=r.result)?void 0:n.error_message}}))})))}).call(this,a("B9cq").notifyDevelopers)},RawV:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("B9cq");const i=r.types.model("SiteShopifyData",{shopify_auth_url:"",shopify_authorized:!1,shopify_connected:!1,shopify_script_persisted:!1,shopify_needs_additional_permissions:!1,shopify_token:r.types.maybeNull(r.types.string)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)}}))).actions((t=>({update:e=>{Object(r.applySnapshot)(t,e)},fetch:Object(r.flow)((function*(){try{const e=yield Object(n.ajax)({url:Routes.status_internal_site_shopify_integration_path(t.rootStore.siteCachedSlug),data:{no_spinner:!0}});t.update(e.result)}catch(xhr){return e({name:"Unable to get shopify data",message:"Ajax failure",xhr:xhr}),xhr}}))})))}).call(this,a("B9cq").notifyDevelopers)},RoWf:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("55Ip"),n=a("V0vo");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let o=function(t){var a,o;function s(){return t.apply(this,arguments)||this}return o=t,(a=s).prototype=Object.create(o.prototype),a.prototype.constructor=a,i(a,o),s.prototype.render=function(){const{site:t,currentUser:a,isSpa:i}=this.props;return e.createElement("div",{className:"footer"},e.createElement("div",{className:"App-container-inner"},e.createElement("div",{className:"footer-copy"},"\xa9 ",dayjs().format("YYYY")," Talkable Inc"),e.createElement("div",{className:"footer-links"},i?e.createElement(r.Link,{to:Routes.site_path(_.get(t,"cached_slug"))},"Dashboard"):e.createElement("a",{href:_.get(t,"id")?Routes.site_path(_.get(t,"cached_slug")):window.location.origin},"Dashboard"),a&&Object(n.d)(a,"write")&&(_.get(t,"id")?e.createElement(e.Fragment,null,e.createElement("a",{href:Object(n.A)({site:t.cached_slug,platform:t.platform})},"Integration Guide"),e.createElement("a",{href:documentationURL(),className:"api_nav",target:"_blank"},"Documentation")):e.createElement("a",{href:documentationURL(),className:"integration_nav",target:"_blank"},"Integration Guide")),e.createElement("a",{href:Routes.privacy_path(),className:"privacy_nav"},"Privacy"),e.createElement("a",{href:Routes.jobs_path(),className:"careers_nav"},"Careers"))))},s}(e.PureComponent)}).call(this,a("q1tI"))},Rokn:function(e,t,a){"use strict";(function(e,r){a.d(t,"a",(function(){return c}));var n=a("GaHK"),i=a("SN4Y"),o=a("V0vo");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let c=function(t){var a,c;function p(e){var a;return(a=t.call(this,e)||this).takeAttached=e=>e?_.reduce(e,((t,r,n)=>((r.attached||r.split_test_id===a.props.abTestId)&&(t[n]=e[n]),t)),{}):{},a.fetchCampaignsByLocaleKey=()=>{const e={locale_key:a.props.localizationKey,no_spinner:!0};$.ajax({url:Routes.campaigns_by_locale_key_internal_site_localization_split_tests_path(Site,Object(o.v)(window.location.pathname),e)}).then((e=>{a.setState({isSocialSharing:a.isSocialSharing(e.result.campaigns),campaignsByLocaleKey:e.result.campaigns},a.fetchViewSetups)})).fail((e=>{r({name:"Unable to fetchCampaignsByLocaleKey",message:"Ajax failure",xhr:e})}))},a.isSocialSharing=e=>{const t=_.get(_.values(e),"[0].view_setups[0].identifier");return a.props.isSocialSharing||"social_sharing"===t},a.fetchAllCampaigns=()=>{$.ajax({url:Routes.internal_site_campaigns_path(Site,{no_spinner:!0})}).then((e=>{a.setState({allCampaigns:_.get(e,"result.campaigns",[])})})).fail((e=>{r({name:"Unable to fetchAllCampaigns",message:"Ajax failure",xhr:e})}))},a.fetchViewSetups=()=>{const{isSocialSharing:e,campaignsByLocaleKey:t}=a.state,{abTestId:n,viewSetupIds:i}=a.props,o=a.takeAttached(t),s=a.props.attachedCampaignIds||_.keys(o).map((e=>Number(e))),l=e=>a.setDefaults(e.result.presets);if(e)$.ajax({url:Routes.social_view_presets_internal_site_localization_split_tests_path(Site),data:{campaigns:s,no_spinner:!0}}).then((e=>{l(e)})).fail((e=>{r({name:"Unable to fetchViewSetups for social sharing view in ab_test_preview_container",message:"Ajax failure",xhr:e})}));else{const e={view_setups:i,split_test_id:n,no_spinner:!0};$.ajax({url:Routes.view_presets_internal_site_localization_split_tests_path(Site,e)}).then((e=>{l(e)})).fail((e=>{r({name:"Unable to fetchViewSetups for !social sharing view in ab_test_preview_container",message:"Ajax failure",xhr:e})}))}},a.setDefaults=e=>{e.length?a.setState({viewSetups:e}):a.props.onClose(!0)},a.state={campaignsByLocaleKey:e.campaignsByLocaleKey||null,isSocialSharing:a.isSocialSharing(e.campaignsByLocaleKey),viewSetups:null,allCampaigns:e.allCampaigns||null},a}c=t,(a=p).prototype=Object.create(c.prototype),a.prototype.constructor=a,l(a,c);var u=p.prototype;return u.componentDidMount=function(){document.body.classList.value+=" is-cut",!this.state.allCampaigns&&this.fetchAllCampaigns(),this.state.campaignsByLocaleKey?this.fetchViewSetups():this.fetchCampaignsByLocaleKey()},u.componentWillUnmount=function(){document.body.classList.value=document.body.classList.value.replace(" is-cut","")},u.render=function(){const{onClose:t}=this.props,{viewSetups:a,allCampaigns:r,isSocialSharing:o}=this.state,l=_.isNull(a)||_.isNull(r),c=classNames("modal-overlay abtest-preview-modal",{"is-loading":l});return e.createElement("div",{className:c},e.createElement("div",{className:"modal-holder"},e.createElement("div",{className:"modal is-preview"},e.createElement("span",{className:"modal-close",onClick:t,"data-close":!0}),_.some(a)&&_.some(r)&&e.createElement(i.a,s({isSocialSharing:o},this.props,this.state)),l&&e.createElement(n.UILoader,null))),e.createElement("div",{className:"modal-overlay is-transparent",onClick:t,"data-close":!0}))},p}(e.PureComponent);c.defaultProps={abTestVariantChosen:0}}).call(this,a("q1tI"),a("B9cq").notifyDevelopers)},RqyE:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("5gN9");function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let i=function(t){var a,i;function o(a){var r;return(r=t.call(this,a)||this).blink=e=>{const t=$(r[e].current);return t.addClass("App-blinking is-highlight"),setTimeout((()=>t.removeClass("App-blinking is-highlight")),2500)},r.fetchData=t=>{const a={content_type:"image"};$.ajax({url:Routes.internal_site_static_assets_path(Site),type:"GET",dataType:"json",data:a,success:a=>{a.result.static_assets.forEach((t=>{r[t.id]=e.createRef()})),r.setState({images:a.result.static_assets,fetched:!0},(()=>{t&&r.blink(t)}))}})},r.dropzoneInit=()=>{const e=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r),t=$("meta[name=csrf-token]").attr("content"),a=Routes.internal_site_static_assets_path(Site),n=Routes.check_existing_internal_site_static_assets_path(Site);$(".js-locale-assets-upload").dropzone({url:a,clickable:".js-locale-assets-upload-trigger",previewsContainer:!1,acceptedFiles:"image/*, video/*",maxFilesize:Constants.VIDEO_SIZE_LIMIT,headers:{"X-CSRF-Token":encodeURI(t)},accept(t,a){if(t.size>1024*Constants.ATTACHMENT_SIZE_LIMIT*1024&&!t.type.match(/(video|audio)/))return a(`File is too big (${t.size}). Max filesize: ${Constants.ATTACHMENT_SIZE_LIMIT}MB.`),!1;$.ajax({type:"POST",url:n,data:{filename:t.name},success(r){if(r)if(r.result.exists){confirm(`A file with the name ${t.name} already exists on the server.\nWould you like to replace the existing file?`)?(e.setState({overwrite:!0}),a()):e.setState({assetIsLoading:!1})}else a()}})},init(){const t=this;t.on("addedfile",(a=>{t.processQueue(),e.setState({assetIsLoading:!0})})),t.on("error",((t,a)=>{_.isObject(a)&&(a=a.result.errors.base[0]),Validation.showErrorFlash(a,8e3),e.setState({assetIsLoading:!1})})),t.on("complete",(t=>{if("error"===t.status){if(t.xhr){const e=JSON.parse(t.xhr.responseText),a=e.result.errors.base[0]||e.result.error_message,r=`The file ${t.name} could not be uploaded. ${a}`;Validation.failCustomBlock("open_graph_image"),Validation.showErrorFlash(r,8e3)}e.setState({assetIsLoading:!1})}else{const a=$.parseJSON(t.xhr.response).result.static_asset.id;e.state.overwrite&&"function"===typeof e.props.fetchLocalizationsAfterOverwrite&&e.props.fetchLocalizationsAfterOverwrite();const r="New image has been successfully uploaded";Validation.showSuccessFlash(r,8e3),e.fetchData(a),e.setState({assetIsLoading:!1,overwrite:!1})}}))}})},r.handleImageSelect=e=>{r.setState({selected:_.set(e,"name",e.name||e.value)},(()=>{r.props.onSelect(r.props.localization,r.state.selected,r.props.extraData),r.closeModal()}))},r.handleImagePreview=e=>{r.setState({currentImagePreview:e})},r.openImageEditor=e=>{const t={imageUrl:e.preview||e.url,localizationData:r.props.localizationData,iframePreviewPath:r.props.iframePreviewPath};r.props.onOpenImageEditor(t)},r.handleLocalizationValueChange=e=>{(r.state.selected||[]).value=e.target.value},r.handleLocalizationValueSave=e=>{r.props.onLocalizationValueChange(r.props.localization,r.state.selected),r.toggleAssetValue()},r.closeModal=()=>{r.props.onClose()},r.toggleAssetValue=()=>{r.setState({toggleAssetValue:!r.state.toggleAssetValue})},r.isPreview=()=>UI.isImageUrl(r.props.selected.preview),r.isClickedOnScrollBar=(e,t)=>e.innerWidth()>e.get(0).scrollWidth&&t>e.get(0).scrollWidth,r.isUnsupportedExtension=e=>{var t;return _.includes(["gif","svg"],null==(t=e.split("."))?void 0:t.pop())},r.getMode=e=>"asset"!==r.trait||r.isUnsupportedExtension(e)?"is-1of2":"is-1of3",r.trait=_.get(a,"localizationData.trait",null),r.state={fetched:!1,toggleAssetValue:!1,assetIsLoading:!1,selected:a.selected,currentImagePreview:null,images:[],overwrite:!1},r}i=t,(a=o).prototype=Object.create(i.prototype),a.prototype.constructor=a,n(a,i);var s=o.prototype;return s.componentDidMount=function(){this.fetchData(),UI.subscribe("LocaleEntries_asset_uploader_reload",(()=>this.fetchData())),UI.subscribe("LocaleEntries_asset_uploader_close",(()=>this.closeModal())),Dropzone.autoDiscover=!1,this.dropzoneInit(),$(document).on({keyup:e=>{if(e.which&&27===e.which)return this.closeModal()}}),$(".js-locale-assets-uploader-overlay").on("mousedown",(e=>{const t=$(e.target);t.is(".js-locale-assets-uploader")||t.parents().is(".js-locale-assets-uploader")||this.isClickedOnScrollBar($(e.currentTarget),e.pageX)||this.closeModal()}))},s.render=function(){var t;let a;return e.createElement("div",{className:"Locale-entries-popup-holder"},e.createElement("div",{className:"Locale-entries-popup-overlay js-locale-assets-uploader-overlay"},e.createElement("div",{className:"Locale-entries-popup js-locale-assets-uploader Locale-entries-assets-uploader"},e.createElement("div",{className:"Locale-entries-button-close",onClick:this.closeModal},"\xd7"),e.createElement("div",{className:"Locale-entries-popup-title js-locale-assets-upload"},e.createElement("div",{className:""+(this.state.currentImagePreview?"hidden":"")},"Select image",e.createElement("div",{className:"Locale-entries-assets-uploader-button"},e.createElement("div",{className:"base-btn is-success js-locale-assets-upload-trigger"},e.createElement("i",{className:"icon icon-upload"}),"Upload new")),e.createElement("div",{className:"preloader "+(this.state.assetIsLoading?"":"hidden")})),Boolean(this.state.currentImagePreview)&&e.createElement("div",null,e.createElement("div",{className:"base-btn is-small",onClick:this.handleImagePreview.bind(this,null)},"\u2190 Back"),e.createElement("div",{className:"base-btn is-small is-success mls",onClick:this.handleImageSelect.bind(this,this.state.currentImagePreview)},"Select this image"),e.createElement("span",{className:"Locale-entries-assets-uploader-edit-value-preview-asset-name mlm"},this.state.currentImagePreview.value||this.state.currentImagePreview.name))),e.createElement("div",{className:"Locale-entries-assets-uploader-wrapper"},Boolean(this.state.currentImagePreview)&&e.createElement("div",{className:"Locale-entries-assets-uploader-edit-value"},e.createElement("div",{className:"Locale-entries-assets-uploader-edit-value-preview is-wide"},e.createElement("img",{src:this.state.currentImagePreview.url||this.state.currentImagePreview.preview}))),this.state.toggleAssetValue&&e.createElement("div",{className:"Locale-entries-assets-uploader-edit-value"},e.createElement("div",{className:"Locale-entries-assets-uploader-edit-value-preview"},UI.isImageUrl(null==(t=this.props.selected)?void 0:t.preview)&&e.createElement("img",{src:this.props.selected.preview})),e.createElement("div",{className:"Locale-entries-assets-uploader-edit-value-field"},e.createElement("label",{htmlFor:`localization_${this.props.localization.localization_id}`},"Value:"),e.createElement(r.a,{class:"base-textarea",placeholder:"Enter text here",id:`localization_${this.props.localization.localization_id}`,name:`localization_${this.props.localization.localization_id}`,text:this.props.selected.value,onChange:this.handleLocalizationValueChange,autoSize:!0}),e.createElement("div",{className:"base-btn is-warning mts is-block",onClick:this.handleLocalizationValueSave},"Save"))),e.createElement("div",{className:"Locale-entries-assets-uploader-content"},this.state.fetched&&e.createElement("div",{className:"Locale-entries-assets-uploader-list"},(()=>{if(this.props.selected&&this.isPreview())return a=this.getMode(this.props.selected.preview),e.createElement("div",{className:"Locale-entries-assets-uploader-list-item col1of4 is-selected"},e.createElement("div",{className:"Locale-entries-assets-uploader-list-item-image"},e.createElement("img",{src:this.props.selected.preview}),e.createElement("div",{className:`Locale-entries-assets-uploader-list-item-image-tip is-preview ${a}`,onClick:this.handleImagePreview.bind(this,this.props.selected)},e.createElement("i",{className:"icon icon-preview"}),"Preview"),"asset"===this.trait&&!this.isUnsupportedExtension(this.props.selected.preview)&&e.createElement("div",{className:`Locale-entries-assets-uploader-list-item-image-tip is-edit ${a}`,onClick:this.openImageEditor.bind(this,this.props.selected)},e.createElement(UIkit.UIIcon,{name:"pencil",fill:"#fff",height:"20",width:"20"}),"Edit"),e.createElement("div",{className:`Locale-entries-assets-uploader-list-item-image-tip is-select ${a}`,onClick:this.closeModal},e.createElement("i",{className:"icon icon-select"}),"Select")),e.createElement("div",{className:"Locale-entries-assets-uploader-list-item-info",title:this.props.selected.value},this.props.selected.value),Boolean(this.props.selectedLocalizationAssetData)&&e.createElement("div",{className:"Locale-entries-assets-uploader-list-item-info"},this.props.selectedLocalizationAssetData.width&&this.props.selectedLocalizationAssetData.height&&e.createElement("span",{className:"Locale-entries-assets-uploader-list-item-info-icon-row"},e.createElement(UIkit.UIIcon,{name:"arrowsToOut"}),this.props.selectedLocalizationAssetData.width," x"," ",this.props.selectedLocalizationAssetData.height,"px"),this.props.selectedLocalizationAssetData.size&&e.createElement("span",{className:"Locale-entries-assets-uploader-list-item-info-icon-row mlm"},e.createElement(UIkit.UIIcon,{name:"clip"}),this.props.selectedLocalizationAssetData.size.filesize())))})(),this.state.images.map((t=>{var r;if(a=this.getMode(t.url),(null==(r=this.state.selected)?void 0:r.value)!==t.name)return e.createElement("div",{className:"Locale-entries-assets-uploader-list-item col1of4",key:t.id},e.createElement("div",{className:"Locale-entries-assets-uploader-list-item-image",ref:this[t.id]},e.createElement("img",{src:t.url}),e.createElement("div",{className:`Locale-entries-assets-uploader-list-item-image-tip is-preview ${a}`,onClick:this.handleImagePreview.bind(this,t)},e.createElement("i",{className:"icon icon-preview"}),"Preview"),"asset"===this.trait&&!this.isUnsupportedExtension(t.url)&&e.createElement("div",{className:`Locale-entries-assets-uploader-list-item-image-tip is-edit ${a}`,onClick:this.openImageEditor.bind(this,t)},e.createElement(UIkit.UIIcon,{name:"pencil",fill:"#fff",height:"20",width:"20"}),"Edit"),e.createElement("div",{className:`Locale-entries-assets-uploader-list-item-image-tip is-select ${a}`,onClick:this.handleImageSelect.bind(this,t)},e.createElement("i",{className:"icon icon-select"}),"Select")),e.createElement("div",{className:"Locale-entries-assets-uploader-list-item-info",title:t.name},t.name),e.createElement("div",{className:"Locale-entries-assets-uploader-list-item-info"},t.width&&t.height&&e.createElement("span",{className:"Locale-entries-assets-uploader-list-item-info-icon-row"},e.createElement(UIkit.UIIcon,{name:"arrowsToOut"}),t.width," x ",t.height,"px"),t.size&&e.createElement("span",{className:"Locale-entries-assets-uploader-list-item-info-icon-row mlm"},e.createElement(UIkit.UIIcon,{name:"clip"}),t.size.filesize())))})))))),e.createElement("div",{className:"Locale-entries-popup-helper"})))},o}(e.Component)}).call(this,a("q1tI"))},S2he:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("aFzQ"),i=a("JHMc"),o=a("+CAZ"),s=a("B9cq");const l=r.types.model("ReferralsStore",{name:"ReferralsStore",referrals:r.types.map(i.a),searchQuery:"",referralsFetched:!1,paginationPosition:1,offsetTop:0}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get currentReferrals(){return Object(n.values)(e.referrals).filter((t=>t.page===e.paginationPosition))}}))).actions((t=>({resetFetchState:()=>{t.referralsFetched=!1},fetchReferrals:Object(r.flow)((function*(a){t.referralsFetched=!1;try{const e=yield Object(s.ajax)({debug:!0,url:Routes.internal_site_customer_service_for_scope_path(t.rootStore.siteCachedSlug,"referrals",{q:a,page:t.paginationPosition,no_spinner:!0})});t.updateReferrals(e.result.records,a)}catch(xhr){e({name:"Unable to fetch CSP Referrals",message:"Ajax failure",xhr:xhr})}})),fetchReferral:Object(r.flow)((function*(a){try{const e=yield Object(s.ajax)({url:Routes.internal_site_customer_service_referral_path(t.rootStore.siteCachedSlug,a)});t.updateReferrals([e.result.record],t.searchQuery)}catch(xhr){e({name:"Unable to fetch CSP Referral",message:"Ajax failure",xhr:xhr})}})),clearReferrals:()=>{t.referrals.clear()},updateReferrals:(e=[],a)=>{e.forEach((e=>{const a=Object(o.a)(e,t.paginationPosition,t.convertStatuses);t.referrals.put(a)})),t.referralsFetched=!0,t.searchQuery=a},setPaginationPosition:(e,a)=>{a&&a.preventDefault(),e!==t.paginationPosition&&(t.paginationPosition=e,_.isEmpty(t.currentReferrals)&&t.fetchReferrals(t.searchQuery))},setOffsetTop:e=>{t.offsetTop=e}})))}).call(this,a("B9cq").notifyDevelopers)},SN4Y:function(e,t,a){"use strict";(function(e,r){a.d(t,"a",(function(){return p}));var n=a("GaHK"),i=a("tkrC"),o=a("iY+z"),s=a("V0vo");function l(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let p=function(t){var a,p;function u(a){var n;return(n=t.call(this,a)||this).filterViewSetups=()=>{const{viewSetups:e}=n.props;let t={};return e.map((e=>{const a=n.convertViewSetupIntoSelectOption(e);t[e.campaign_id]?t[e.campaign_id].push(a):t[e.campaign_id]=[a]})),t},n.convertViewSetupIntoSelectOption=e=>{const{allCampaigns:t,isSocialSharing:a}=n.props,r=_.find(t,{id:e.campaign_id}),i=r&&`${r.name} | ID: ${r.id}`;return{label:e.human_name,value:String(a?e.campaign_id:e.id),campaign_name:i}},n.convertViewsToSelectOptions=()=>_.reduce(n.filterViewSetups(),((e,t,a)=>(1===t.length?e.push({label:t[0].campaign_name,value:String(t[0].value)}):t.length&&e.push({label:t[0].campaign_name,options:t}),e)),[]),n.convertViewPresetsToOptions=()=>_.find(n.props.viewSetups,{id:n.state.currentViewSetupId}).view_presets.map((e=>({label:e.name,value:e.cached_slug}))),n.changeViewSetup=e=>{const t=Number(e.target.value),a=n.props.isSocialSharing?"campaign_id":"id",r=_.find(n.props.viewSetups,{[a]:t});n.setState({isPreloading:!0,currentViewSetupId:r.id,currentViewSetupCampaignId:r.campaign_id,currentViewPresetSlug:r.initial_preset_slug},n.fetchViewPreview)},n.changeViewPreset=e=>{const t=e.target.value;n.setState({isPreloading:!0,currentViewPresetSlug:t},n.fetchViewPreview)},n.fetchViewPreview=(e=n.props)=>{const{localizationKey:t,viewSetups:a,abTestVariants:r,isSocialSharing:i,abTestVariantChosen:o,localeEntryValue:s}=e,{currentViewSetupId:l,currentViewPresetSlug:c}=n.state,p=_.some(r)&&r[o],u=p?p.value:s,d=_.find(a,{id:l}),m=_.find(d.view_presets,{cached_slug:c});n.setState({localizationOverride:null,viewPreviewUrl:null,isPreloading:!0}),$.ajax({url:Routes.internal_localization_override_index_path({no_spinner:!0}),type:"POST",dataType:"json",data:{localization_override:{[t]:u}},success:e=>{const t=i?"?":"&",a=`${m.preview_url}${t}localization_override=${e.result.fingerprint}`;n.setState({viewPreviewUrl:a,localizationOverride:e.result.fingerprint},(()=>{n.fetchCaptionFields()}))}})},n.fetchCaptionFields=()=>{const{currentViewSetupId:e,currentViewPresetSlug:t,localizationOverride:a,currentViewSetupCampaignId:i}=n.state,o={preset_slug:t,localization_override:a};n.props.isSocialSharing||n.currentViewSetup["disabled_by_configuration?"]||$.ajax({url:Routes.caption_fields_internal_site_campaign_preview_path(window.Site,i,e,o)}).then((e=>{n.setState({captionFields:e.result})})).fail((e=>{r({name:"Unable to get caption_fields_internal",message:"Ajax failure",xhr:e})}))},n.takeViewSetupsSelectValue=e=>{const{currentViewSetupCampaignId:t,currentViewSetupId:a}=n.state,r=n.props.isSocialSharing?t:a;if(e.some((e=>e.options))){return e.reduce(((e,t)=>(t.options?e.push(...t.options):e.push(t),e)),[]).find((e=>String(e.value)===String(r)))}return String(r)},n.renderAbTestVariants=()=>n.props.abTestVariants.map(((t,a)=>e.createElement(o.a,{index:a,abTestVariantChosen:n.props.abTestVariantChosen,changeAbTestVariant:n.props.handleShowAbTestPreviewVariant,key:a}))),n.renderAbTestVariantBody=()=>{if(_.isEmpty(n.props.abTestVariants))return n.props.localeEntryValue;const t=n.props.abTestVariants[n.props.abTestVariantChosen];return t.value.length?t.value:e.createElement("i",{className:"muted"},"No value provided")},n.renderEditViewSetupLink=()=>{const e=_.find(n.props.viewSetups,{id:n.state.currentViewSetupId});return Routes.editor_site_campaign_path(Site,e.campaign_id)+"#/view_setups/"+e.id+"/preset_slug/"+n.state.currentViewPresetSlug},n.setPreviewDeviceMode=e=>{n.state.platformType!==e&&n.setState({platformType:e})},n.state={currentViewSetupId:_.get(a.viewSetups,"[0].id",null),currentViewSetupCampaignId:_.get(a.viewSetups,"[0].campaign_id",null),currentViewPresetSlug:_.get(a.viewSetups,"[0].initial_preset_slug"),isPreloading:!0,viewPreviewUrl:null,localizationOverride:null,captionFields:{caption:"",email_sender:""},platformType:"desktop"},n}p=t,(a=u).prototype=Object.create(p.prototype),a.prototype.constructor=a,c(a,p);var d,m,g,h=u.prototype;return h.componentDidUpdate=function(e){_.isUndefined(this.props.abTestVariantChosen)||this.props.abTestVariantChosen===e.abTestVariantChosen||this.fetchViewPreview(this.props)},h.componentDidMount=function(){this.fetchViewPreview(),UI.previewSubscribe("offer_loaded",(e=>{UI.previewPublish("preview_styles","previewIframe",{remove_preview_styles:!0})})),UI.previewSubscribe("responsive_iframe_size",(e=>{this.setState({isPreloading:!1})}))},h.componentWillUnmount=function(){UI.removePreviewEvent()},h.render=function(){const{abTestName:t,abTestVariants:a,hideEdit:r,abTestVariantChosen:o,isSocialSharing:l}=this.props,{isPreloading:c,captionFields:p,viewPreviewUrl:u,currentViewPresetSlug:d,localizationOverride:m,platformType:g}=this.state,h=this.convertViewsToSelectOptions(),y=this.takeViewSetupsSelectValue(h),f=this.convertViewPresetsToOptions(),b=this.renderAbTestVariants(),v=this.renderAbTestVariantBody(),S=this.renderEditViewSetupLink(),w=UI.ALPHABET.charAt(o).toUpperCase(),C=classNames("abtest-preview-iframe",{"is-loading":c}),E=this.currentViewSetup["disabled_by_configuration?"]?e.createElement("div",{className:"abtest-preview-zerocase"},"Preview is not available."):e.createElement(n.UILoader,null);return e.createElement("div",{"data-testid":"ac-ab-test-preview"},e.createElement("div",{className:"modal-header"},e.createElement("div",{className:"phm"},e.createElement("h3",{className:"pvs"},"Preview Content ",_.some(a)&&"A/B Test"),e.createElement("div",{className:"clearfix"},e.createElement("div",{className:"col1of3"},e.createElement("label",{className:"base-form-label is-small"},"Campaign:"),e.createElement("div",{className:"ac-ab-test-preview-campaign-select"},e.createElement(n.UIInputSelect,{size:"big",onChange:({selectedOption:e})=>this.changeViewSetup({target:{value:e.value}}),options:h,placeholder:"Select View...",value:y}))),f.length>1&&e.createElement("div",{className:"col1of3 pll"},e.createElement("label",{className:"base-form-label is-small"},"View preset:"),e.createElement(n.UIInputSelect,{size:"big",onChange:({selectedOption:e})=>this.changeViewPreset({target:{value:e.value}}),options:f,placeholder:"Select Preset...",value:d})),_.some(a)&&e.createElement("div",{className:"abtest-preview-variants"},e.createElement("label",{className:"base-form-label is-small"},"Variants:"),e.createElement("div",{className:"base-btn-group is-styled is-nostyle is-full-width"},b)),!l&&e.createElement("div",{className:"abtest-preview-platform"},e.createElement("label",{className:"base-form-label is-small"},"Preview:"),e.createElement("div",null,e.createElement(Widget.DeviceSwitcher,{platformType:g,setPreviewDeviceMode:this.setPreviewDeviceMode})))))),e.createElement("div",{className:"modal-body"},e.createElement("div",{className:"abtest-preview-body"},e.createElement("div",{className:"abtest-preview-variant-value"},_.some(t)&&e.createElement("div",null,"\u201c",e.createElement("strong",null,t),"\u201d value:"),_.some(a)&&e.createElement("div",{className:"abtest-preview-variant"},e.createElement("span",{className:"abtest-preview-variant-char"},w)),e.createElement("div",null,v)),e.createElement("div",{className:"abtest-preview-bar"},!l&&e.createElement("div",null,this.currentViewSetup["email_view?"]?e.createElement("strong",null,"Subject: "):e.createElement("strong",null,"Title: "),p.caption,this.currentViewSetup["email_view?"]&&e.createElement("div",null,e.createElement("strong",null,"Email sender: "),p.email_sender)),e.createElement("div",{className:"abtest-preview-subnav"},!r&&Object(s.d)(window.current_user,"write")&&e.createElement("a",{href:S,target:"_blank",className:"is-edit"},e.createElement(n.UIIcon,{name:"edit"}),"Edit View"),e.createElement("a",{href:u,className:"is-open",target:"_blank"},e.createElement(n.UIIcon,{name:"open"}),"Open in new tab"))),e.createElement("div",{className:C},_.some(u)&&!this.currentViewSetup["disabled_by_configuration?"]?e.createElement(i.a,{ViewSetup:this.currentViewSetup,ViewPreset:this.currentViewPreset,localizationOverride:m,className:"is-outside-cover-iframe",platformType:g}):E))))},d=u,(m=[{key:"currentViewSetup",get:function(){const{viewSetups:e}=this.props,{currentViewSetupId:t}=this.state;return e.find((e=>e.id===t))||{}}},{key:"currentViewPreset",get:function(){const{currentViewPresetSlug:e}=this.state;return this.currentViewSetup&&e&&this.currentViewSetup.view_presets.find((t=>t.cached_slug===e))||{}}}])&&l(d.prototype,m),g&&l(d,g),u}(e.PureComponent);p.defaultProps={viewSetups:[],hideEdit:!1,abTestVariants:[]}}).call(this,a("q1tI"),a("B9cq").notifyDevelopers)},StnM:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("2TKB"),i=a("90E5"),o=a("BCyL");const s=r.types.model("CampaignMigratePage",{campaigns:r.types.array(n.a),campaignsFilter:r.types.optional(i.a,{}),campaignsFetched:!1,isContinueMigration:!1,isFinishedMigration:!1,isStartedMigration:!1,target_site_id:r.types.maybeNull(r.types.string),values:r.types.optional(o.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignShowRoot(){return e.rootStore.pages.campaignShowRoot},get currentCampaign(){return e.campaignShowRoot.currentCampaign},get site(){return e.rootStore.models.site},get currentUser(){return e.rootStore.models.currentUser},get router(){return e.rootStore.models.router},get siteCachedSlug(){return e.site.siteCachedSlug},get campaignRulesPath(){return Routes.edit_site_campaign_path(e.siteCachedSlug,e.rootStore.urlSpaceParameter,e.currentCampaign.id)},get editorHtmlPath(){return _.some(e.campaignShowRoot.view_setups.data)?Routes.site_campaign_view_setup_path(e.siteCachedSlug,e.currentCampaign.id,e.campaignShowRoot.view_setups.data[0].id):""},get showMigrationStatus(){return e.isStartedMigration||e.isFinishedMigration},isCurrentCampaignGleam:t=>t.gleam===e.campaignShowRoot.currentCampaign.gleam,isNotSameCampaigns:t=>t.id!==e.campaignShowRoot.currentCampaign.id,get availableCampaigns(){return e.campaigns.filter((t=>e.isCurrentCampaignGleam(t)&&e.isNotSameCampaigns(t)))},get ineligibleCampaigns(){return e.campaigns.filter((t=>!e.isCurrentCampaignGleam(t)&&e.isNotSameCampaigns(t)))},get selectedCampaigns(){var t;return null==(t=e.campaignsFilter.availableCampaigns)?void 0:t.selectedCampaigns},get sitesForSelect(){return e.rootStore.models.currentUser.accessible_sites.filter((t=>t.account_id===e.site.account_id)).map((e=>({label:e.name,value:e.cached_slug})))},get disabledSitesForSelect(){return 1===e.sitesForSelect.length},get targetSiteId(){return e.target_site_id||e.siteCachedSlug},get advancedSettingsPath(){return Routes.edit_site_campaign_path(e.siteCachedSlug,e.rootStore.urlSpaceParameter,e.campaignShowRoot.currentCampaign.id,{anchor:"/#settings"})}}))).actions((t=>({resetStore:()=>{Object(r.applySnapshot)(t,{})},fetchCampaigns:Object(r.flow)((function*(a){try{t.updateCampaignsFetched(!1);const e=yield t.rootStore.services.campaignsNetworkService.apiGetMany({siteCachedSlug:a});t.updateCampaigns(_.get(e,"result.campaigns",[])),t.updateCampaignsFilter(),t.updateCampaignsFetched(!0)}catch(xhr){e({name:"Unable to fetch Campaigns",message:"Ajax failure",xhr:xhr})}})),updateCampaignsFetched:e=>{t.campaignsFetched=e},updateCampaigns:(e=[])=>{Object(r.applySnapshot)(t.campaigns,e)},updateCampaignsFilter:()=>{t.campaignsFilter.addAvailableCampaigns(t.availableCampaigns.map((e=>e.toJSON()))),t.campaignsFilter.addIneligibleCampaigns(t.ineligibleCampaigns.map((e=>e.toJSON())))},validationMigration:()=>{let e={selectedValue:{error:!0,value:"No values selected!"},selectedCampaign:{error:!0,value:"No campaigns selected!"}};for(let a in t.values)if(!t.values[a].every((e=>!e.isSelfChecked))){e.selectedValue.error=!1;break}return _.some(t.selectedCampaigns)&&(e.selectedCampaign.error=!1),Object.values(e).forEach((e=>{e.error&&UINotifications.add({text:e.value,type:"error",delay:3e3})})),Object.values(e).some((e=>e.error))},confirmationMigration:()=>{t.validationMigration()||t.updateContinueMigration(!0)},migrateCampaign:Object(r.flow)((function*(e,a){try{e.updateMigratedStatus({type:""}),a.migration.campaigns_filter.campaign_id=e.id,yield $.ajax({url:Routes.internal_site_campaign_campaign_migrations_path(t.siteCachedSlug,t.currentCampaign.id,{no_spinner:!0}),type:"POST",contentType:"application/json",data:JSON.stringify(a)}),e.updateMigratedStatus({type:"success"}),UINotifications.add({text:`${e.name}(${e.id}) was migrated`,type:"success"})}catch(xhr){e.updateMigratedStatus({type:"error",error:_.get(xhr,"responseJSON.result.error_message")}),UINotifications.add({text:`${e.name}(${e.id}) wasn't migrated. ${_.get(xhr,"responseJSON.result.error_message")}`,type:"error"})}})),startMigration:Object(r.flow)((function*(){t.updateStartMigration(!0),t.updateFinishMigration(!1);const e=t.normalizeDataForMigration();yield Promise.all(t.selectedCampaigns.map((a=>t.migrateCampaign(a,e)))),t.updateStartMigration(!1),t.updateFinishMigration(!0)})),updateContinueMigration:e=>{e||(t.updateStartMigration(!1),t.updateFinishMigration(!1),t.selectedCampaigns.forEach((e=>{e.updateMigratedStatus({type:""})}))),t.isContinueMigration=e},updateStartMigration:e=>{t.isStartedMigration=e},updateFinishMigration:e=>{t.isFinishedMigration=e},normalizeDataWithoutChildren:e=>t.values[e].reduce(((e,t)=>t.isSelfChecked?[...e,t.name]:e),[]),normalizeDataViews:e=>t.values.views.reduce(((t,a)=>a.isSelfChecked?[t,a.children.reduce(((t,a)=>a.isChecked&&a.type===e?[t,a.value]:t),[])]:t),[]).flat(1/0),normalizeDataForMigration:()=>{const e={migration:{target_site_id:t.target_site_id,campaigns_filter:{campaign_id:null},values:{stylesheets:t.normalizeDataWithoutChildren("stylesheets"),integration_css:t.normalizeDataWithoutChildren("integration_css"),view_setups:t.normalizeDataViews("view_setups"),view_setup_extras:t.normalizeDataViews("view_setup_extras"),locale_entries:t.normalizeDataViews("locale_entries")}}};return t.values.rules.forEach((t=>{e.migration.values[t.name]=t.isSelfChecked})),e},onChangeSite:Object(r.flow)((function*(e){t.targetSiteId!==e.selectedOption.value&&(t.target_site_id=e.selectedOption.value,yield t.fetchCampaigns(e.selectedOption.value))})),fetchCampaignViewSetupsForMigrate:Object(r.flow)((function*(e){yield t.campaignShowRoot.view_setups.apiGet(e),t.updateMigrateViews()})),updateMigrateViews:()=>{const e=[];t.campaignShowRoot.view_setups.data.forEach((t=>{const a=String(t.id);e.push({name:t.identifier,label:t.human_name,id:t.id,value:a,isSelfChecked:!1,isDisabled:!1,children:[{id:t.id,value:a,name:`liquid_html_${t.id}`,label:"Liquid HTML",type:"view_setups",isChecked:!1},{id:t.id,value:a,name:`extras_${t.id}`,label:"Extras",type:"view_setup_extras",isChecked:!1},{id:t.id,value:a,name:`localizations_${t.id}`,label:"Localizations",type:"locale_entries",isChecked:!1}]}),"offers_show"===t.view_category&&e.push({name:"advocate social sharing",label:"Advocate social sharing",isSelfChecked:!1,isDisabled:!1,children:[{value:"social_sharing",name:"localizations_social_sharing",label:"Localizations",type:"locale_entries",isChecked:!1}]})})),t.values.updateViews(e)},checkIntegrationCss:()=>{t.values.integration_css.forEach((e=>{"offer_integration_css"===e.name&&t.currentCampaign.gleam||"trigger_integration_css"===e.name&&"widget"!==t.currentCampaign.appearance||"gleam_integration_css"===e.name&&!t.currentCampaign.gleam?e.changeDisabled(!0):e.changeDisabled(!1)}))}})))}).call(this,a("B9cq").notifyDevelopers)},SvJU:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("V0vo"),i=a("AHpt");const o=r.types.model("ShareStore",{campaign:r.types.maybeNull(i.a),sharing_channel:r.types.maybeNull(r.types.string),recipient:r.types.maybeNull(r.types.string),created_at:r.types.maybeNull(r.types.string)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get normalizeSharingChannel(){return Object(n.z)(e.sharing_channel)},get formattedCreatedAt(){return e.rootStore.models.site.formatDate(e.created_at)},get relativeCreatedAt(){return e.relativeDate(e.created_at)},relativeDate:e=>dayjs(e).fromNow()}))).actions((e=>({})))},TCJX:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return m}));var r=a("99Ma"),n=a("af5v"),i=a("sT1B"),o=a("pX3F"),s=a("V0vo");const l=r.types.model("CampaignCopyValues",{id:r.types.maybeNull(r.types.number),name:"",cached_slug:r.types.optional(r.types.maybeNull(r.types.string),null)}),c=r.types.model("CampaignCopyErrors",{name:r.types.optional(r.types.array(r.types.string),[]),cached_slug:r.types.optional(r.types.array(r.types.string),[]),base:r.types.optional(r.types.array(r.types.string),[])}),p=r.types.model({conflict_names:r.types.optional(r.types.array(r.types.string),[]),new_names:r.types.optional(r.types.array(r.types.string),[])}),u=r.types.model({assets:r.types.optional(p,{})}),d=r.types.model({id:r.types.maybeNull(r.types.number),cached_slug:r.types.maybeNull(r.types.string),name:r.types.maybeNull(r.types.string),account_id:r.types.maybeNull(r.types.number)}),m=r.types.model("CampaignCopyModal",{step:r.types.optional(r.types.union(r.types.literal("check"),r.types.literal("copy")),"check"),modalType:r.types.optional(r.types.union(r.types.literal("basic"),r.types.literal("themeStore")),"basic"),values:r.types.optional(l,{}),errors:r.types.optional(c,{}),conflicts:r.types.optional(u,{}),submitting:!1,site:r.types.optional(d,{}),currentUser:r.types.optional(n.a,{}),isSpa:!1}).views((e=>({get isThemeStoreSite(){return e.site.cached_slug===i.eb},get prefixNotification(){return e.isThemeStoreSite?"from":"to"},get isThemeStoreModal(){return"themeStore"===e.modalType},get title(){switch(e.step){case"check":return e.isThemeStoreModal?`Copy campaign ${e.prefixNotification} Theme store`:"Copy Campaign";case"copy":return"Campaign Copy Check";default:return"Copy Campaign"}},get isCopyToThemeStore(){return e.isThemeStoreModal&&!e.isThemeStoreSite},get isCopyToThisSite(){return e.site.cached_slug===e.values.cached_slug},get sitesOptions(){return e.isCopyToThemeStore?[{label:"Talkable Theme Store Site",value:i.eb}]:e.isThemeStoreSite?_.reduce(_.orderBy(e.currentUser.accessible_sites,["name"],["asc"]),((t,a)=>(e.isThemeStoreModal&&a.cached_slug===i.eb||t[e.currentUser.account_id===a.account_id?0:1].options.push({label:a.name,value:a.cached_slug}),t)),[{label:"My Sites",options:[]},{label:"Granted Sites",options:[]}]):_.reduce(_.orderBy(e.currentUser.accessible_sites,["name"],["asc"]),((t,a)=>(a.cached_slug!==i.eb&&e.site.account_id===a.account_id&&t.push({label:a.name,value:a.cached_slug}),t)),[])},get valueSiteCachedSlugSelect(){return e.isThemeStoreSite?e.values.cached_slug?{label:e.values.cached_slug,value:e.values.cached_slug}:null:e.values.cached_slug},get disabledSiteCachedSlugSelect(){return e.isThemeStoreSite?e.sitesOptions[0].options.length+e.sitesOptions[1].options.length===1:1===e.sitesOptions.length},get conflictsAssets(){return[...e.conflicts.assets.conflict_names.toJSON(),...e.conflicts.assets.new_names.toJSON()]},get haveConflictsByType(){const t={incentives:!e.isCopyToThisSite,placements:!e.isCopyToThisSite};return e.isThemeStoreModal?{assets:!e.isThemeStoreSite||_.some(e.conflictsAssets),...t}:t},get checkingTypesAssets(){return{type:"assets",title:"Assets",values:e.conflictsAssets,description:e.isThemeStoreSite?"All assets were checked. No conflicts found.":"No assets will be copied. You are not allowed to copy customer assets into Theme Store."}},get prefixActionForPlacements(){return e.isCopyToThisSite?"will":"will not"},get checkingTypesPlacements(){return{type:"placements",title:"Placements",description:`The newly created campaign ${e.prefixActionForPlacements} be attached to any placement.`}},get checkingTypesIncentives(){return{type:"incentives",title:"Incentives",description:e.isCopyToThisSite?"All settings of incentives will be copied.":"Coupon lists will not be copied. All incentives with single-use coupon lists will be replaced with a multi-use coupon code placeholder"}},get checkingTypes(){const t=[e.checkingTypesIncentives,e.checkingTypesPlacements];return e.isThemeStoreModal?[e.checkingTypesAssets,...t]:t}}))).actions((t=>({onChange({target:{name:e,value:a}}){t.values[e]=a},onChangeSite({name:e,selectedOption:a}){t.values[e]=String(a.value)},updateStep(e){t.step=e},onDiscard(){t.isThemeStoreSite&&(t.values.cached_slug=null),t.clearErrors(),t.updateStep("check")},updateErrors(e={}){Object(r.applySnapshot)(t.errors,e)},clearErrors(){Object(r.applySnapshot)(t.errors,{})},updateConflictsAssets(e){Object(r.applySnapshot)(t.conflicts.assets,e)},validateValues(){const e={};return _.map(t.values.toJSON(),((t,a)=>{t||(e[a]=["Can't be blank"])})),e},setSubmitting(e){t.submitting=e},checkCopyingCampaign:Object(r.flow)((function*(a){try{null==a||a.preventDefault();const e=t.validateValues();if(_.some(e))t.updateErrors(e);else{t.setSubmitting(!0);const e=yield $.ajax({url:Routes.check_for_conflicts_internal_site_campaign_path(t.site.id,t.values.id,{campaign:{name:t.values.name,target_site_id:t.values.cached_slug},no_spinner:!0}),type:"GET"});t.updateConflictsAssets(e.result),t.setSubmitting(!1),t.clearErrors(),t.updateStep("copy")}}catch(xhr){t.setSubmitting(!1),UINotifications.add({text:`You can not copy this campaign from ${t.site.name}`,type:"error"}),e({name:"Unable to check conflicts",message:"Ajax failure",xhr:xhr})}})),createCopyCampaign:Object(r.flow)((function*(a){try{t.setSubmitting(!0);const e=yield $.ajax({type:"POST",url:Routes.make_copy_internal_site_campaign_path(t.site.id,t.values.id,{no_spinner:!0}),data:{campaign:{name:t.values.name,target_site_id:t.values.cached_slug}}});t.clearErrors(),UINotifications.add({text:`Copy of campaign created from the ${t.site.name}`,type:"success"});const r=Routes.site_campaign_path(t.values.cached_slug,Object(s.v)(window.location.pathname),_.get(e,"result.id"));t.isSpa&&a?(Object(o.a)(),a.push(r)):window.location=r}catch(r){t.setSubmitting(!1),t.updateErrors({base:[_.get(r,"responseJSON.result.error_message")]}),UINotifications.add({text:`Copy of campaign wasn\u2019t created from ${t.site.name}`,type:"error"}),e({name:"Unable to create copy of campaign",message:"Ajax failure",xhr:r})}}))})))}).call(this,a("B9cq").notifyDevelopers)},TGZC:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("TyAF"),n=a("Ty5D"),i=a("55Ip"),o=a("GaHK");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const l=Object(n.o)(Object(r.c)(function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r),n.prototype.render=function(){return e.createElement(o.UIHolderSidebar,null,e.createElement(o.UISidebar,null,e.createElement(o.UISidebarItem,null,e.createElement(o.UISidebarLink,{as:i.NavLink,exact:!0,to:Routes.edit_user_path()},"My profile")),e.createElement(o.UISidebarItem,null,e.createElement(o.UISidebarLink,{as:i.NavLink,to:Routes.tfa_settings_user_path()},"2FA")),e.createElement(o.UISidebarItem,null,e.createElement(o.UISidebarLink,{as:i.NavLink,to:Routes.invite_user_path()},"Refer a friend"))))},n}(e.PureComponent)))}).call(this,a("q1tI"))},TKiR:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var r=a("99Ma"),n=a("HDDd"),i=a("q42M"),o=a("3CKC"),s=a("bPeU"),l=a("o8+a"),c=a("YMV4"),p=a("xEex");const u=r.types.model("CampaignShowPage",{advocateOffersChart:r.types.optional(c.a,{}),cachedOffersCount:r.types.optional(s.a,{}),referralSales:r.types.optional(n.a,{}),rewards:r.types.optional(i.a,{}),couponLists:r.types.map(o.b),incentives:r.types.optional(p.a,{}),performance:r.types.optional(l.a,{}),wizardShown:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get sitePersonalCouponLists(){return e.rootStore.models.sitePersonalCouponLists},get currentUser(){return e.rootStore.models.currentUser},get campaignShowRoot(){return e.rootStore.pages.campaignShowRoot},get currentCampaign(){return e.campaignShowRoot.currentCampaign},get site(){return e.rootStore.models.site},get siteCachedSlug(){return e.site.siteCachedSlug},get router(){return e.rootStore.models.router},get isIncentivesFetched(){return e.incentives.network.get.isLoaded},get isIncentivesOrPersonalCouponsFetched(){let t=!1;return t=e.currentCampaign.personal_coupon_list_id?e.isIncentivesFetched&&e.sitePersonalCouponLists.currentPersonalCouponListDataFetched:e.isIncentivesFetched,t},get offersShowViewSetup(){const{view_setups:t}=e.campaignShowRoot;return t.data.find((e=>"offers_show"===e.view_category))},get emailCaptureViewSetup(){const{view_setups:t}=e.campaignShowRoot;return t.data.find((e=>"email_capture"===e.view_category))},get gleamViewSetup(){const{view_setups:t}=e.campaignShowRoot;return t.data.find((e=>"gleam_reward_widget"===e.view_category))},get viewSetupForPreview(){return e.currentCampaign.gleam?e.gleamViewSetup:e.currentCampaign.conversionSpace?e.emailCaptureViewSetup:e.offersShowViewSetup},get presetForPreview(){var t;return null==(t=e.viewSetupForPreview)?void 0:t.presets_with_default.find((e=>"default-preset"===e.cached_slug))},get showNotes(){return e.currentCampaign.gleam||e.currentCampaign.ip_address_filtering_mode},get campaignReferralPerformanceReportPath(){const{start_date:t,end_date:a}=e.currentCampaign.metrics_date_range;return Routes.by_channel_site_reports_path(e.siteCachedSlug,{channels_filter:{campaigns_filter:{campaign_id:e.currentCampaign.id},created_at:[t,a]}})},get campaignConversionPerformanceReportPath(){return e.performance.data.report_path},get campaignPerformanceReportPath(){return e.currentCampaign.conversionSpace?e.campaignConversionPerformanceReportPath:e.campaignReferralPerformanceReportPath}}))).actions((e=>({clearStore:()=>{Object(r.applySnapshot)(e,{})},getInitialCampaignData:t=>{const{pages:{integrationPage:{shopifyInitialDataFetched:a,shopifyFetchInitialData:r}},models:{site:{platform:n}}}=e.rootStore;e.init(t),"shopify"!==n||a||r()},init:Object(r.flow)((function*(t){e.currentCampaign.gleam||e.cachedOffersCount.apiGet(t),e.incentives.apiGet(t),e.currentCampaign.personal_coupon_list_id&&(yield e.sitePersonalCouponLists.fetchCurrentPersonalCouponList(e.currentCampaign.personal_coupon_list_id)),e.campaignShowRoot.campaignInitialDataFetched&&e.showWizard()})),showWizard:()=>{e.currentUser.isWriteRole&&e.currentUser.showWizard&&!e.wizardShown&&(Wizard.init(),e.changeWizardShowState(!0))},changeWizardShowState:t=>{e.wizardShown=t}})))},"TN/B":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return s}));var r=a("aFzQ"),n=a("99Ma"),i=a("pm75");const o=n.types.model("CampaignTemplate",{preset_name:"",appearance:"",default_name:"",campaign_type:""}).views((e=>({get notGleamCampaign(){return"gleam"!==e.appearance}}))),s=n.types.model("CampaignsTypes",{templates:n.types.array(o),network:n.types.optional(i.b,{})}).views((e=>({get rootStore(){return Object(n.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},getCampaignTemplate:({type:t,preset_name:a,appearance:n})=>Object(r.toJS)(e.templates.find((e=>e.preset_name===a&&e.appearance===n)))}))).actions((t=>({updateTemplates:e=>{Object(n.applySnapshot)(t.templates,e)},fetchCampaignTemplates:Object(n.flow)((function*(){t.network.get.updateLoading(!0),t.network.get.updateLoaded(!1);try{var a;const e=yield $.ajax({url:Routes.campaign_templates_internal_site_campaigns_path(t.siteCachedSlug,{no_spinner:!0,space:t.rootStore.urlSpaceParameter})});t.updateTemplates((null==e||null==(a=e.result)?void 0:a.campaign_templates)||[])}catch(xhr){e({name:"Unable to fetch campaign templates",message:"Ajax failure",xhr:xhr})}finally{Object(n.isAlive)(t)&&(t.network.get.updateLoading(!1),t.network.get.updateLoaded(!0))}}))})))}).call(this,a("B9cq").notifyDevelopers)},Tehy:function(e,t,a){"use strict";(function(e){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}a.d(t,"a",(function(){return n}));let n=function(t){var a,n;function i(){return t.apply(this,arguments)||this}n=t,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,r(a,n);var o=i.prototype;return o.componentDidMount=function(){window.showSpinner()},o.componentWillUnmount=function(){window.hideSpinner()},o.render=function(){return e.createElement("div",null)},i}(e.PureComponent)}).call(this,a("q1tI"))},Ttsf:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return h}));var r=a("99Ma"),n=a("aFzQ"),i=a("2TKB"),o=a("On4Y"),s=a("M+GS"),l=a("sT1B"),c=a("l91a");const p=r.types.union(r.types.number,r.types.string,r.types.null,r.types.undefined),u=r.types.model({id:r.types.identifierNumber,coupon_list_id:r.types.maybeNull(r.types.string),code:"",created_at:r.types.maybeNull(r.types.string),expires_at:r.types.maybeNull(r.types.string),ownerships_count:r.types.maybeNull(r.types.number),site_id:r.types.maybeNull(r.types.number)}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))),d=r.types.model({allow_on_expired_offer:p,allow_on_self_referral:p,amount:p,coupon_list_id:p,criteria:r.types.maybeNull(r.types.string),custom_description:r.types.maybeNull(r.types.string),email_shares:p,for_advocate:r.types.boolean,for_friend:r.types.boolean,friend_event_category:r.types.maybeNull(r.types.string),human_name:r.types.maybeNull(r.types.string),id:r.types.identifierNumber,identifier:r.types.maybeNull(r.types.string),incentive_type:r.types.maybeNull(r.types.string),multi_use_coupon:r.types.optional(r.types.maybeNull(u),{}),new_customer:p,new_optin:r.types.union(r.types.string,r.types.null,r.types.undefined),once_per_person:p,percentage_discount:r.types.maybeNull(r.types.boolean),referrals_max:p,referrals_min:p,reward_uniqueness:r.types.maybeNull(r.types.string),sharing_channels:r.types.maybeNull(r.types.string),short_description:r.types.maybeNull(r.types.string),subtotal_max:p,subtotal_min:p,type:r.types.maybeNull(r.types.string)}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({}))),m=r.types.model("CampaignIncentives",{incentives:r.types.optional(r.types.array(d),[]),personalCouponList:r.types.optional(o.a,{}),showModalIncentives:!1,isFetchingIncentivesState:!1,isIncentivesFetched:!1,personalCouponListFetched:!1,personalCouponListFetching:!1,personalCouponListId:r.types.maybeNull(r.types.number)}).volatile((()=>({requestQ:new c.a}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get allowLoad(){return!e.isFetchingIncentives&&!e.isIncentivesFetched&&!e.personalCouponListFetching&&!e.personalCouponListFetched},get isFetchingIncentives(){let t=!1;return t=e.personalCouponListId?e.isFetchingIncentivesState||e.personalCouponListFetching:e.isFetchingIncentivesState,t},get incentivesByType(){return e.incentives.reduce(((e,t)=>(e[t.for_advocate?"for_advocate":"for_friend"].push({id:t.id,title:t.human_name,description:Object(s.c)(t)}),e)),{for_advocate:[],for_friend:[]})}}))).actions((t=>({updateFetchingIncentivesState:e=>{t.isFetchingIncentivesState=e},updateIncentivesFetched:e=>{t.isIncentivesFetched=e},setPersonalCouponListId:e=>{t.personalCouponListId=e},onShowModalIncentives:e=>{const{personalCouponListId:a}=e;a&&t.setPersonalCouponListId(a),t.showModalIncentives=!0,t.allowLoad&&t.fetch(e)},onHideModalIncentives:()=>{t.requestQ.clear(),t.showModalIncentives=!1},fetch:e=>{const{campaignId:a,personalCouponListId:r}=e;t.fetchIncentives(a),r&&t.fetchPersonalCouponList(r)},updatePersonalCouponListData:e=>{t.personalCouponList=e,t.personalCouponListFetching=!1,t.personalCouponListFetched=!0},fetchPersonalCouponList:Object(r.flow)((function*(a){try{t.personalCouponListFetching=!1;const{result:{personal_coupon_list:e}}=yield t.requestQ.ajax({type:"GET",url:Routes.internal_site_personal_coupon_list_path(t.rootStore.models.site.cached_slug,a,{no_spinner:!0})});t.updatePersonalCouponListData(e)}catch(xhr){e({name:"Unable get campaign group personal coupon list",message:"Ajax failure",xhr:xhr})}})),fetchIncentives:Object(r.flow)((function*(a){try{t.updateFetchingIncentivesState(!0);const{result:{incentives:e}}=yield t.requestQ.ajax({type:"GET",url:Routes.internal_site_campaign_incentives_path(t.rootStore.models.site.cached_slug,a,{no_spinner:!0})});t.incentives.replace(e),t.updateFetchingIncentivesState(!1),t.updateIncentivesFetched(!0)}catch(xhr){e({name:"Unable get campaign group incentives",message:"Ajax failure",xhr:xhr})}}))}))),g=r.types.compose(i.a,m),h=r.types.model("CampaignsGroup",{status:r.types.maybeNull(r.types.identifier),isFetching:!1,isFetched:!1,campaigns:r.types.optional(r.types.map(g),{}),current_page:1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignsFilter(){return Object(r.getParent)(e,2).campaigns_filter},get getCampaigns(){return Object(n.values)(e.campaigns)},get getCampaignsByFilters(){return e.getCampaigns.filter((t=>(t.preset_name===e.campaignsFilter.preset_name||"all"===e.campaignsFilter.preset_name)&&(t.tag_names.includes(e.campaignsFilter.tag_name)||"all"===e.campaignsFilter.tag_name)&&(String(t.appearance)===e.campaignsFilter.appearance||"all"===e.campaignsFilter.appearance)&&(`${t.id}${t.name}`.toLocaleLowerCase().includes(e.campaignsFilter.query.toLocaleLowerCase())||""===e.campaignsFilter.query)))},get getCampaignsByPage(){return e.getCampaignsByFilters.slice(l.f*(e.current_page-1),l.f*e.current_page)}}))).actions((t=>({fetchCampaignsGroup:Object(r.flow)((function*(){t.setFetching(!0),t.setFetched(!1);try{const e=yield t.rootStore.services.campaignsNetworkService.apiGetMany({queryParams:{no_spinner:!0,campaigns_filter:{campaign_status:t.status},space:t.rootStore.space}});t.setFetched(!0),t.updateCampaignsGroup(_.get(e,"result.campaigns",[]))}catch(xhr){e({name:"Unable to fetch campaigns",message:"Ajax failure",xhr:xhr})}finally{t.setFetching(!1)}})),setFetching:e=>{t.isFetching=e},setFetched:e=>{t.isFetched=e},updateCampaignsGroup:(e=[])=>{t.campaigns.clear(),e.forEach((e=>t.campaigns.put(e)))},setPaginationPosition(e){t.current_page=e},deleteCampaignFromGroup(e){t.campaigns.delete(String(e))}})))}).call(this,a("B9cq").notifyDevelopers)},Tvf1:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("aFzQ"),i=a("BpJz"),o=a("B9cq"),s=a("pm75");const l=r.types.model("Event",{id:r.types.identifierNumber,page:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),order_number:r.types.maybeNull(r.types.string),event_category_id:r.types.maybeNull(r.types.number),event_category_identifier:r.types.maybeNull(r.types.string),person:r.types.maybeNull(i.a),subtotal:r.types.maybeNull(r.types.string),refunded:r.types.maybeNull(r.types.boolean),refundNetworkStatus:r.types.optional(s.a,{})}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).volatile((e=>({type:"Event"}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get formattedCreatedAt(){return e.rootStore.models.site.formatDate(e.created_at)},get relativeCreatedAt(){return e.relativeDate(e.created_at)},get originPath(){return Routes.site_origin_path(e.rootStore.models.site.cached_slug,e.id)},get isRefunded(){return e.refunded||e.refundNetworkStatus.isLoading},relativeDate:e=>dayjs(e).fromNow()}))).actions((e=>({update:t=>{_.forEach(t,((a,r)=>{e[r]=t[r]}))},setRefundedStatus(t){e.refunded=t}}))),c=r.types.model("EventsStore",{events:r.types.optional(r.types.map(l),{}),searchQuery:"",eventsFetched:!1,paginationPosition:1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get currentEvents(){return Object(n.values)(e.events).filter((t=>t.page===e.paginationPosition))}}))).actions((t=>({resetFetchState:()=>{t.eventsFetched=!1},fetchEvents:Object(r.flow)((function*(a){t.resetFetchState();try{const e=yield Object(o.ajax)({url:Routes.internal_site_customer_service_for_scope_path(t.rootStore.models.site.cached_slug,"events",{q:a,page:t.paginationPosition,no_spinner:!0})});t.updateEvents(e.result.records,a)}catch(xhr){e({name:"Unable to fetch CSP Events",message:"Ajax failure",xhr:xhr})}})),modifyEvent:e=>(_.set(e,"event.page",t.paginationPosition),e),clearEvents:()=>{t.events.clear()},updateEvents:(e=[],a)=>{e.forEach(((e,a)=>{const r=t.modifyEvent(e);t.events.put(r.event)})),t.eventsFetched=!0,t.searchQuery=a},setPaginationPosition:(e,a)=>{a&&a.preventDefault(),e!==t.paginationPosition&&(t.paginationPosition=e,t.fetchEvents(t.searchQuery))}})))}).call(this,a("B9cq").notifyDevelopers)},U6ye:function(e,t,a){"use strict";(function(e){a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var r=a("TyAF"),n=a("aFzQ"),i=a("GaHK"),o=a("sT1B");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const l=({static_widget:e,status:t})=>"1"===e&&"Live"===t,c=Object(r.c)(function(t){var a,r;function l(a){var r;return(r=t.call(this,a)||this).startPolling=()=>{const{polling:e,staticWidgetStore:{fetchData:t}}=r.props;r.poll=e&&setInterval((()=>{t()}),5e3)},r.stopPolling=()=>{const{polling:e}=r.props;e&&clearInterval(r.poll)},r.handleClick=e=>{null==e||e.preventDefault();const{staticWidgetStore:{showModal:t,staticWidgetInfo:{ineligibleReasonsExists:a}}}=r.props;a&&(t(),r.stopPolling())},r.hideModal=e=>{null==e||e.preventDefault();const{staticWidgetStore:{hideModal:t}}=r.props;t(),r.startPolling()},r.onCloseModal=()=>{r.props.onCloseModal(),Utils.trackGAEvent(o.db,"hide deactivation modal")},r.onPrimaryAction=()=>{r.props.onPrimaryAction(),Utils.trackGAEvent(o.db,"proceed to deactivate")},r.onSecondaryAction=()=>{r.props.onSecondaryAction(),Utils.trackGAEvent(o.db,"hide deactivation modal")},r.poll=null,r.tooltipRef=e.createRef(),r.disposer=Object(n.reaction)((()=>a.staticWidgetStore.staticWidgetInfo.tooltipText),(e=>{const{staticWidgetStore:{tooltipCanBeShown:t}}=a;t&&$(r.tooltipRef.current).tooltip("hide").attr("title",e).tooltip("fixTitle")})),r}r=t,(a=l).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r);var c=l.prototype;return c.componentDidMount=function(){const{staticWidgetStore:{fetchData:e}}=this.props;e(),this.startPolling()},c.componentWillUnmount=function(){this.stopPolling(),this.disposer()},c.render=function(){const{size:t,background:a,placement:r,withBorder:n,showDeactivationModal:o,staticWidgetStore:{isLoading:s,tooltipCanBeShown:l,showStaticWidgetModal:c,tooltipText:p,staticWidgetInfo:{isActive:u,errorText:d}}}=this.props,m=classNames("ac-static-widget",{"Campaign-management-header-indicator":"header"===r});return e.createElement("div",{className:m},e.createElement("div",{ref:this.tooltipRef,"data-toggle":"tooltip","data-container":"body","data-placement":"bottom","data-html":!0,title:l?p:"",className:"ac-sw-badge",onClick:this.handleClick},e.createElement(i.UIStaticBadge,{withBorder:n,size:t,active:u,loading:s,background:a})),c&&e.createElement("div",{className:"ac-static-widget-modal"},e.createElement(i.UIModalConfirmation,{title:"Could not publish campaign changes",type:"confirmation",onCloseModal:this.hideModal,onPrimaryAction:this.hideModal,style:"one-section"},e.createElement("p",null,'The following campaign changes were saved but Talkable could not publish them because they are incompatible with the "Static trigger widget" setting:'),e.createElement("p",null,d))),o&&e.createElement("div",{className:"ac-static-widget-deactivation-modal"},e.createElement(i.UIModalConfirmation,{type:"confirmation",onCloseModal:this.onCloseModal,onPrimaryAction:this.onPrimaryAction,onSecondaryAction:this.onSecondaryAction,style:"two-sections",primaryButtonText:"Yes"},e.createElement("p",null,'This will deactivate "Static trigger widget" setting, are you sure?'))))},l}(e.PureComponent))}).call(this,a("q1tI"))},UBih:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("AEM3"),i=a("4b23"),o=a("WxVm");const s=r.types.compose(o.a,r.types.model({indexNumber:0}).volatile((()=>({initialIndexNumber:0,key:""}))).views((e=>({get attachedCampaignsPreview(){return e.attachedCampaigns.slice(0,2)},get placementDetailsPath(){return Routes.placement_details_site_path(e.siteCachedSlug,e.id)},get isPristineIndex(){return e.initialIndexNumber===e.indexNumber}}))).actions((e=>({afterCreate(){e.initialIndexNumber=e.indexNumber,e.key=Object(i.a)()},updateIndex(t){e.indexNumber=t}})))),l=r.types.model("PlacementsStream",{eventCategoryId:r.types.number,placements:r.types.array(s)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get placementsRootPage(){return Object(r.getParentOfType)(e,n.a)},get siteEventCategories(){return e.placementsRootPage.siteEventCategories},get eventCategory(){return e.placementsRootPage.getEventCategoryById(e.eventCategoryId)},get eventCategoryNameHumanized(){return _.upperFirst(_.lowerCase(e.eventCategory.identifier))},get isPristineOrder(){return e.placements.every((e=>e.isPristineIndex))}}))).actions((e=>({reorder(t=[]){t.forEach((t=>{e.updatePlacementIndexById({orderNumber:t.orderNumber,placementId:t.placementId})}))},updatePlacementIndexById({orderNumber:t,placementId:a}){e.placements.find((e=>e.id===a)).updateIndex(t)}})))},UEOA:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("99Ma");const n=r.types.model("CouponListCode",{code:""}),i=r.types.model("CouponList",{id:r.types.maybeNull(r.types.number),amount:r.types.maybeNull(r.types.number),created_at:"",expired_at:"",updated_at:"",name:"",percentage_discount:!1,site_id:r.types.maybeNull(r.types.number),status:r.types.optional(n,{})}),o=r.types.model("IncentiveStore",{id:r.types.maybeNull(r.types.number),campaign_id:r.types.maybeNull(r.types.number),short_description:r.types.maybeNull(r.types.string),default_description:r.types.maybeNull(r.types.string),human_identifier:r.types.maybeNull(r.types.string),human_name:r.types.maybeNull(r.types.string),incentive_type:r.types.maybeNull(r.types.string),single_use:!1,coupon_list:r.types.maybeNull(i),type:r.types.maybeNull(r.types.string)}).views((e=>({get formattedHumanIdentifier(){return _.upperFirst(e.human_identifier)},get incentiveTypeDescription(){switch(e.incentive_type){case"discount_coupon":return e.single_use?"off single-use coupon":"off multi-use coupon";case"rebate":return"rebate";default:return null}},get humanizedExplanation(){return _.trim(`${e.human_name}: ${e.short_description} ${e.incentiveTypeDescription||""}`)},get wordCouponAvailable(){return"discount_coupon"===e.incentive_type?"coupon":null},get couponStatusForTiered(){return"discount_coupon"===e.incentive_type?`${e.single_use?"Single-use coupon":"Multi-use coupon"} reward: ${_.upperFirst(e.short_description)}`:"rebate"===e.incentive_type?`Rebate reward: ${_.upperFirst(e.short_description)}`:"other"===e.incentive_type?`Non-monetary reward: ${_.upperFirst(e.short_description)}`:null},tooltipForTiered:t=>`${e.couponStatusForTiered}\nReward status: ${_.upperFirst(t)}`})))},UHDK:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("TyAF"),n=a("Cs6D"),i=a("XbWu"),o=a("zfg3");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const l=Object(r.c)(function(t){var a,r;function l(a){var r;return(r=t.call(this,a)||this).handleChangeChosen=({value:e})=>{r.dropDown.current.toggleDropdownList(),r.setState({selectedOption:e},(()=>{setTimeout((()=>{const{selectedOption:e}=r.state,{goToAnotherSite:t}=r.props;t?t(e):window.location=Routes.site_path(e)}),300)}))},r.getOptions=()=>{const{currentUser:e,isSitePersisted:t,account:a}=r.props,n=Object(i.c)(e);return[{label:t?"My Sites":_.get(a,"name"),options:n.own.map((e=>({label:e.name,value:e.cached_slug})))},{label:t?"Granted Sites":"Other Sites",options:n.granted.map((e=>({label:e.name,value:e.cached_slug})))}]},r.handleClickCreateSite=()=>{r.dropDown.current.toggleDropdownList()},r.state={selectedOption:a.currentSiteCachedSlug},r.dropDown=e.createRef(),r}r=t,(a=l).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r);var c=l.prototype;return c.componentDidUpdate=function(e){e.currentSiteCachedSlug!==this.props.currentSiteCachedSlug&&this.setState({selectedOption:this.props.currentSiteCachedSlug})},c.render=function(){const{isAdmin:t}=this.props,{selectedOption:a}=this.state,r=this.getOptions();return e.createElement(o.e,{"data-testid":"ac-header-site-selector",ref:this.dropDown,closeOnDropdownClick:!1,renderButton:({isOpened:t})=>e.createElement(o.d,{isOpened:t},Object(i.b)({selectedOption:a,options:r}))},e.createElement(o.g,null,e.createElement(n.default,{autoFocus:!0,backspaceRemovesValue:!1,components:{DropdownIndicator:o.c,Option:o.f,Control:o.a,IndicatorSeparator:null},isSearchable:Object(i.a)(r).length>=5,controlShouldRenderValue:!1,hideSelectedOptions:!1,isClearable:!1,menuIsOpen:!0,onChange:this.handleChangeChosen,options:r,placeholder:"Search...",styles:o.i,tabSelectsValue:!1,value:a,formatGroupLabel:o.h,noOptionsMessage:()=>"No sites found"})),t&&e.createElement(o.b,{onClick:this.handleClickCreateSite}))},l}(e.PureComponent))}).call(this,a("q1tI"))},UM2y:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("TyAF"),n=a("Ty5D"),i=a("GaHK"),o=a("V0vo");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const l=Object(n.o)(Object(r.b)((({rootStore:e})=>({campaignShowRoot:e.pages.campaignShowRoot})))(Object(r.c)(function(t){var a,r;function n(...e){var a;return(a=t.call(this,...e)||this).checkColorType=()=>{const{campaignShowRoot:{currentCampaign:{placement_category_abbreviation:e}}}=a.props;switch(e){case"PP":return i.Theme.color.purple;case"FW":return"#ff684a";case"SA":return i.Theme.color.yellow;case"PE":return"#70c880";case"EC":return i.Theme.color.coral;case"RG":return i.Theme.color.link;case"LO":return i.Theme.color.rose;default:return"#bbb"}},a}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r),n.prototype.render=function(){const{campaignShowRoot:{currentCampaign:{normalized_preset_name:t,placement_category_abbreviation:a}}}=this.props;return e.createElement("div",{className:"flex align-items-center mbs"},e.createElement(i.UICampaignBadge,{type:"all",size:"mini",className:"mrs",category:a}),e.createElement(i.BodyS,{className:"ac-campaign-type",color:this.checkColorType(),bold:!0},Object(o.z)(t)))},n}(e.PureComponent))))}).call(this,a("q1tI"))},UVaA:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return b}));var r=a("99Ma"),n=a("S2he"),i=a("8Jte"),o=a("a0d0"),s=a("Tvf1"),l=a("iuKr"),c=a("vxPL"),p=a("rgIu"),u=a("cYkR"),d=a("B9cq"),m=a("8C8s"),g=a("aFzQ");const h=[{key:"offer_shares_count",label:"Shares",icon:"shareCircle",fill:"#999"},{key:"purchases_count",label:"Purchases",icon:"cart"},{key:"refunds_count",label:"Refunds",icon:"refund"},{key:"referrals_count",label:"Friends referred",icon:"people",stroke:"#999"},{key:"events_count",label:"Events",icon:"events"},{key:"rewards_earned",label:"Referral rewards",icon:"giftLarge",stroke:"#999"}],y=[{key:"email",label:"Email",title:!0},{key:"id",label:"ID"},{key:"customer_id",label:"External id",tooltip:"Customer ID from your site that you pass through JS Integration (optional)"},{key:"referred_by",label:"Referred by",target:"referred_by.email",tooltip:"Person who invited (Advocate)",title:!0},{key:"opted_in_at",label:"Opted in",tooltip:"Subscription checkbox value that may be presented either on an Advocate Signup Page or Friend Claim Page (optional)"},{key:"email_origin",label:"Email origin",tooltip:"Origin of the email which can be a Checkout Page, Event, Signup Page, Claim Page, Share Email, depending on where the Person came from initially"},{key:"created_at",label:"Created at"},{key:"unsubscribed_at",label:"Unsubscribed"}],f=r.types.model("CountersData",{purchases:r.types.maybeNull(r.types.number),events:r.types.maybeNull(r.types.number),offers:r.types.maybeNull(r.types.number),received_emails:r.types.maybeNull(r.types.number),referrals:r.types.maybeNull(r.types.number),shares_by:r.types.maybeNull(r.types.number),shares_with:r.types.maybeNull(r.types.number),rewards:r.types.maybeNull(r.types.number)}),b=r.types.model({id:0,email:r.types.maybeNull(r.types.string),first_name:r.types.maybeNull(r.types.string),last_name:r.types.maybeNull(r.types.string),customer_id:r.types.maybeNull(r.types.string),opted_in_at:r.types.maybeNull(r.types.string),unsubscribed_at:r.types.maybeNull(r.types.string),email_origin:r.types.maybeNull(r.types.string),created_at:r.types.maybeNull(r.types.string),blocked:!1,referrals_count:r.types.maybeNull(r.types.number),events_count:r.types.maybeNull(r.types.number),offer_shares_count:r.types.maybeNull(r.types.number),purchases_count:r.types.maybeNull(r.types.number),rewards_earned:r.types.maybeNull(r.types.string),refunds_count:r.types.maybeNull(r.types.number),referred_by:r.types.frozen(),active_tab:r.types.maybeNull(r.types.string),pre_integration:r.types.maybeNull(r.types.boolean),counters:r.types.maybeNull(f),countersFetched:r.types.optional(r.types.boolean,!1),referralsStore:r.types.optional(n.a,{referrals:{}}),eventsStore:r.types.optional(s.a,{events:{}}),purchasesStore:r.types.optional(l.a,{purchases:{}}),offersStore:r.types.optional(c.b,{offers:{}}),sharesSentStore:r.types.optional(i.a,{sharesSent:{}}),emailsReceivedStore:r.types.optional(o.a,{emailsReceived:{}}),rewardsStore:r.types.optional(p.a,{rewards:{}}),referralDetails:r.types.optional(u.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get fullName(){return[e.first_name,e.last_name].join(" ").trim()},get stores(){return{referrals:e.referralsStore,events:e.eventsStore,purchases:e.purchasesStore,offers:e.offersStore,shares_by:e.sharesSentStore,received_emails:e.emailsReceivedStore,rewards:e.rewardsStore}},get actionsData(){return _.transform(h,((t,a)=>{a.value=_.get(e,a.key,0),t.push(a)}),[])},get isBlacklistedEmail(){return e.blocked},get personInfoData(){return _.transform(y,((t,a)=>{const r=a.target||a.key,n=_.get(e,r,"");a.value=n,a.title&&(a.title=n),t.push(a)}),[])},get purchasesAndEvents(){return[...Object(g.values)(e.eventsStore.events),...Object(g.values)(e.purchasesStore.purchases)]},purchaseOrEvent:t=>e.purchasesAndEvents.find((e=>e.id===t)),formattedDate:t=>e.rootStore.models.site.formatDate(t),relativeDate:e=>dayjs(e).fromNow()}))).actions((t=>({update(e){Object(r.applySnapshot)(t,e)},reset(){Object(r.applySnapshot)(t,{})},loadReferrals:()=>{t.referralsStore.referralsFetched=!1},resetCounters:()=>{t.countersFetched=!1},fetchCounters:Object(r.flow)((function*(a){try{const e=yield Object(d.ajax)({url:Routes.internal_site_customer_service_counters_path(t.rootStore.models.site.cached_slug,{q:a,no_spinner:!0})});t.updateCounters(e.result.counters)}catch(xhr){e({name:"Unable to fetch CSP counters",message:"Ajax failure",xhr:xhr})}})),setActiveTab:e=>{t.active_tab=e},addToBlacklistEmail:Object(r.flow)((function*(e){e&&e.preventDefault(),yield t.rootStore.models.site.siteAccount.addToBlacklist({type:"emails",value:t.email}),t.rootStore.pages.customerServiceStore.fetchPerson()})),checkForReset:e=>{t.countersFetched&&_.forOwn(e,((e,a)=>{t.counters[a]!==e&&a!==t.active_tab&&t.stores[a].resetFetchState()}))},updateCounters:e=>{t.checkForReset(e),t.counters=f.create(e),t.countersFetched=!0},fetchData:e=>Object(d.ajax)({url:Routes.internal_site_customer_service_path(t.rootStore.models.site.cached_slug,{q:e,no_spinner:!1})}),updateUnsubscribedValue:e=>{t.unsubscribed_at=e},refund:Object(r.flow)((function*(a){const r=t.purchaseOrEvent(a);r.refundNetworkStatus.update("in_progress");try{yield $.ajax({url:Routes.internal_site_customer_service_refunds_path(t.rootStore.siteCachedSlug,{event_id:r.id}),type:"POST"}),r.setRefundedStatus(!0),r.refundNetworkStatus.update("success"),m.a.add({text:`${r.type}  was successfully refunded`,type:"success"}),Utils.trackGAEvent(t.rootStore.pages.customerServiceStore.gaCategory,"successful refund")}catch(xhr){var n;const a=null==xhr||null==(n=xhr.responseJSON)?void 0:n.result.error_message;r.refundNetworkStatus.update("error"),m.a.add({text:a,type:"error"}),e({name:`Unable to refund ${r.type}`,message:"Ajax failure",xhr:xhr})}}))})))}).call(this,a("B9cq").notifyDevelopers)},UlA6:function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return p})),a.d(t,"e",(function(){return u}));var r=a("BkRI"),n=a.n(r),i=a("Zsd2"),o=a.n(i);const s=e=>e.split("/")[2],l=["name","url","reward_contact_email","platform","cached_slug","technical_contact_email","customer_service_email","currency_code","custom_web_domain","bcc_owner_on_reward","send_unpaid_reward_notifications","ignore_failed_transactions","limit_offer_email_period","customer_service_name","force_custom_web_domain_and_ssl","self_serve_domain_creation","marketer_contact_email","weekly_performance_report_enabled","loyalty_auto_signup","loyalty_points_to_currency_conversion_rate","loyalty_current_balance_limit","loyalty_referral_reward_to_points_rate","loyalty_referral_percentage_reward_to_points_rate","physical_address"],c=["monthly_licensing_cost","ideal_friend_timing","ideal_email_capture_timing","sticky_advocates","custom_email_domain","referrer_reward_limit_reached_notify","suspicious_offer_clicks_notify","lite_mode"],p=["id","created_at","updated_at","api_key","public_api_key","share_images","time_zone_identifier"],u=e=>{const t=n()(e);return Object.keys(t).map((e=>{"string"===typeof t[e]&&(t[e]=o()(t[e]))})),t}},V0vo:function(e,t,a){"use strict";(function(e){a.d(t,"s",(function(){return F})),a.d(t,"P",(function(){return M})),a.d(t,"K",(function(){return U})),a.d(t,"I",(function(){return L})),a.d(t,"S",(function(){return B})),a.d(t,"z",(function(){return V})),a.d(t,"N",(function(){return z})),a.d(t,"g",(function(){return q})),a.d(t,"b",(function(){return W})),a.d(t,"H",(function(){return G})),a.d(t,"J",(function(){return H})),a.d(t,"G",(function(){return Q})),a.d(t,"u",(function(){return J})),a.d(t,"O",(function(){return K})),a.d(t,"B",(function(){return Y})),a.d(t,"j",(function(){return Z})),a.d(t,"T",(function(){return X})),a.d(t,"Q",(function(){return te})),a.d(t,"A",(function(){return ae})),a.d(t,"d",(function(){return re})),a.d(t,"F",(function(){return ne})),a.d(t,"i",(function(){return ie})),a.d(t,"a",(function(){return oe})),a.d(t,"e",(function(){return se})),a.d(t,"R",(function(){return le})),a.d(t,"q",(function(){return ce})),a.d(t,"h",(function(){return pe})),a.d(t,"x",(function(){return ue})),a.d(t,"l",(function(){return de})),a.d(t,"n",(function(){return me})),a.d(t,"m",(function(){return ge})),a.d(t,"o",(function(){return he})),a.d(t,"f",(function(){return _e})),a.d(t,"E",(function(){return be})),a.d(t,"C",(function(){return ve})),a.d(t,"y",(function(){return Se})),a.d(t,"t",(function(){return we})),a.d(t,"w",(function(){return Ce})),a.d(t,"v",(function(){return Ee})),a.d(t,"p",(function(){return Ne})),a.d(t,"c",(function(){return Oe})),a.d(t,"L",(function(){return xe})),a.d(t,"M",(function(){return Ie})),a.d(t,"r",(function(){return Pe})),a.d(t,"D",(function(){return Re})),a.d(t,"k",(function(){return je}));var r=a("sT1B"),n=a("6acW"),i=a.n(n),o=a("Zsd2"),s=a.n(o),l=a("79/T"),c=a.n(l),p=a("UMpK"),u=a.n(p),d=a("Y+p1"),m=a.n(d),g=a("GoyQ"),h=a.n(g),y=a("4qC0"),f=a.n(y),b=a("6qam"),v=a.n(b),S=a("Puqe"),w=a.n(S),C=a("3WF5"),E=a.n(C),N=a("RBan"),O=a.n(N),x=a("p46w"),I=a.n(x),P=a("6cT+"),R=a.n(P),j=a("oqc9"),D=a("cr+I"),k=a.n(D),T=a("dhqo"),A=a.n(T);const F=e=>{const t=k.a.parse(e);let a;return Object.keys(t).forEach((e=>{e.includes("prev_url")&&(a=t[e])})),a},M=e=>{const{string:t,date:a}=e;return a?R()(t,a):R()(t)},U=({position:e=0,duration:t=500,smooth:a=!0}={})=>{j.animateScroll.scrollTo(e,{duration:t,smooth:a})},L=e=>u()(e,((e,t,a)=>(""!==t&&(e[a]=t),e))),B=(e="",t={})=>({[e]:t}),V=e=>i()(s()(c()(e).replace(/_id$/,"").replaceAll("_"," "))),z=(e,t)=>{if(e)return`Users with ${r.R[t]} role are not allowed to perform this action.`},q=(e,t)=>function e(t,a){return u()(t,(function(t,r,n){m()(r,a[n])||(t[n]=h()(r)&&h()(a[n])?e(r,a[n]):r)}))}(e,t),W=(e={},t="")=>({...e,className:`${e.className||""} ${t}`}),G=(e=window.location.search)=>e.substr(1).split("&").reduce(((e,t)=>{const[a,r]=t.split("="),n=isNaN(r)?window.decodeURIComponent(r):Number(r);return e[a]=n,e}),{}),H=e=>(f()(e)||(e=`${e}`),(e.match(/^-?\d+(?:\.\d{0,2})?/)||[])[0]),Q=(e={})=>{if(e.metaKey||e.ctrlKey)return window.open(e.target.href),!0},J=e=>window.location.href.includes(e),K=(e=[])=>e.sort(((e,t)=>r.x.indexOf(e.status.toUpperCase())-r.x.indexOf(t.status.toUpperCase())||t.id-e.id)),Y=({forceIntegration:e,currentUrl:t})=>"referral"===we(t)&&e&&!I.a.get("skip_integration"),Z=({startDate:e,endDate:t,liveFrom:a,liveTo:r})=>{const n=dayjs(e).startOf("day"),i=dayjs(t).endOf("day"),o=dayjs(a).startOf("day"),s=dayjs(r).endOf("day");let l=!1;return a&&r?l=o.isBetween(n,i,null,"[]")||s.isBetween(n,i,null,"[]")||o.isBefore(n,i)&&!s.isBefore(n,i):a&&(l=o.isBetween(n,i)),l},X=({date:e})=>(({date:e})=>{const t=[];let a=dayjs(e).startOf("year");const r=dayjs().endOf("year");for(;r.diff(a,"years")>=1;)t.unshift(a.format("YYYY")),a=a.add(1,"year");return t})({date:e}).map(((e,t)=>{const a=t+1;return{label:0===t?"Previous year":`${a} ${A()("year",a)} ago`,value:{startDate:`${e}-01-01`,endDate:`${e}-12-31`}}})),ee=({date:e,range:t=12,format:a="YYYY-MM-DD"})=>dayjs(e).subtract(t,"month").format(a),te=({endDate:e})=>({startDate:ee({date:e}),endDate:e}),ae=({site:e,platform:t})=>{let a="";switch(t){case"shopify":a=Routes.integration_shopify_site_path(e);break;case"magento":a=Routes.integration_magento_site_path(e);break;case"demandware":a=Routes.integration_demandware_site_path(e);break;default:a=Routes.integration_other_site_path(e,"general_integration")}return a},re=(e,t)=>{const a=["csp_only","read","write","admin"];if(!a.includes(t))throw"Invalid role";return e.staff_member||a.indexOf(e.role)>=a.indexOf(t)},ne=e=>v()(e)?"null":e,ie=(e="")=>`https://${Constants.DOCUMENTATION_HOST}/${e}`,oe=({value:t,timeZoneName:a,timeZoneIdentifier:r})=>{if(!t)return null;const n=dayjs(t).tz(r);return e.createElement(e.Fragment,null,e.createElement("span",{className:"datetime ac-time-zone-name is-without-pointer",title:a,"data-toggle":"tooltip","data-container":"body"},e.createElement("span",{className:"mrs ac-date-time"},n.format("MM/DD/YYYY [at] hh:mm A"))),e.createElement("small",{className:"datetime-label"},"(",n.fromNow(),")"))},se=t=>E()(t,((t,a)=>e.createElement("div",{key:a},e.createElement("strong",null,a),E()(t,((t,a)=>e.createElement("p",{key:a},t)))))),le=({location:e={},key:t,value:a})=>{const r=k.a.parse(e.search||{}),n=a?{...r,[t]:a}:w()(r,t),i=k.a.stringify(n);return`${e.pathname}${i?"?":""}${i}`},ce=e=>{const t=r.ab[e];return t?`${t} Integration`:"Integration"},pe=(e=0)=>{switch(e){case 0:return 0;case 1:case 2:case 3:return 1e3;default:return 3e3}},ue=()=>{window.location.href=`${window.Constants.DEFAULT_URL_OPTIONS.host}${Routes.tfa_settings_user_path()}`},de=e=>e.format("MM/DD/YYYY [at] h:mm A z"),me=e=>e.format("MM/DD/YYYY"),ge=({date:e,timeZone:t})=>dayjs(e).tz(t),he=({value:e,limit:t=1e4})=>{let a=numeral(e).format("0,[0]");return Math.abs(e)>=t?(a=`${numeral(t).format("0,[0]")}+`,e<0?`-${numeral(t).format("0,[0]")}+`:a):a},ye=e=>Array.from(new Array(e),((e,t)=>t<10?"0"+t:t)),fe=e=>e.map((e=>({value:String(e),label:String(e)}))),_e=e=>{switch(e){case"hour":{const e=ye(r.gb.HOURS_IN_DAY);return fe(e)}case"minute":{const e=ye(r.gb.MINUTES_IN_HOUR);return fe(e)}default:return[]}},be=e=>_.isNull(e)?"unlimited":0===e?"":e<r.gb.HOURS_IN_DAY?A()("hour",e,!0):A()("day",Math.floor(e/r.gb.HOURS_IN_DAY),!0),ve=e=>e>=r.gb.HOURS_IN_DAY&&e%r.gb.HOURS_IN_DAY===0,Se=e=>{if(e<0)return"";if(ve(e)){const t=e/r.gb.HOURS_IN_DAY;return`${t} ${A()("day",t)}`}return`${e} ${A()("hour",e)}`},we=e=>{return(t=e).includes("/conversion/")||"conversion"===O()(t.split("/"))?"conversion":(e=>e.includes("/loyalty/")||"loyalty"===O()(e.split("/")))(e)?"loyalty":"referral";var t},Ce=e=>{if(!["referral","conversion","loyalty"].includes(e))throw new Error("Invalid argument");return"referral"===e?"":e},Ee=e=>Ce(we(e)),Ne=({date:e,timeZoneIdentifier:t,format:a,defaultValue:r=""})=>e?dayjs(e).tz(t).format(a):r,Oe=e=>""===e?"":`#${e}`,xe=(e,{offset:t}={offset:-24})=>{const a=$(Oe(e));a.length&&U({position:(null==a?void 0:a.offset().top)+t})},Ie=e=>{null==window.ga||window.ga("set","dimension4",e)},Pe=({period:e,value:t,defaultPeriod:a=0})=>{if(e&&!["days","hours"].includes(e))throw new Error("unexpected value for period");return""===t?a:"days"===e?t*r.gb.HOURS_IN_DAY:t},Re=e=>{switch(e){case"image/gif":case"image/jpeg":case"image/png":case"image/svg+xml":return!0;default:return!1}},je=async e=>{const t=await fetch(e,{cache:"no-cache"}),a=await t.blob(),r=O()(e.split("/"))||"image";return new File([a],r,{type:a.type})}}).call(this,a("q1tI"))},V8d1:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("K+ho"),i=a("eQCO"),o=a("aFzQ");const s=r.types.compose("PlacementsEditPage",n.a,r.types.model({}).views((()=>({}))).actions((t=>({init(e){t.placementsRootPage.placements.getPlacementById(e)?(t.updatePlacementData(Object(o.toJS)(t.placementsRootPage.placements.getPlacementById(e))),t.initCampaignsFilter()):t.rootStore.models.router.push(Routes.placements_index_site_path(t.siteCachedSlug))},initCampaignsFilter(){const{available:e,ineligible:a}=Object(i.b)({campaigns:Object(o.toJS)(t.placementsRootPage.campaigns.data),category:t.placementData.category_abbreviation,placementId:t.placementData.id});t.updateCampaignsFilter({available:e,ineligible:a})},updateAttachedCampaigns:Object(r.flow)((function*(e=[]){const a=t.campaignsFilter.availableCampaigns.campaignsIdShouldBeAttached.map((e=>t.placementsRootPage.updateCampaignPlacementRequest({campaignId:e,placementId:t.placementData.id}))),r=t.campaignsFilter.availableCampaigns.campaignsIdShouldBeDetached.reduce(((a,r)=>(e.includes(r)||a.push(t.placementsRootPage.updateCampaignPlacementRequest({campaignId:r,placementId:null})),a)),[]);yield Promise.all([...a,...r])})),checkDetachedLiveCampaigns(){const e=t.placementsRootPage.campaigns.getCampaignsById(t.campaignsFilter.availableCampaigns.campaignsIdShouldBeDetached).map((e=>e.toJSON()));return t.placementsRootPage.campaignsDetacher.init({detachedCampaigns:e,placementId:t.placementData.id})},handleCancel(){t.init(t.placementData.id)},handleSave:Object(r.flow)((function*(a){if(null==a||a.preventDefault(),t.validate(),!t.placementData.isValid)throw new Error("Data is invalid");t.placementData.resetErrors();let n=[];try{n=yield t.checkDetachedLiveCampaigns()}catch(a){throw t.submit.updateLoading(!0),yield t.placementsRootPage.campaigns.apiGet(),t.initCampaignsFilter(),t.submit.updateLoading(!1),new Error(a)}const{normalizedPlacements:s,updatingPlacementIndex:l}=Object(i.a)({placements:Object(o.toJS)(t.placementsRootPage.placements.campaign_placements),updatedPlacement:Object(o.toJS)(t.placementData)});try{t.submit.updateLoading(!0),yield t.updateAttachedCampaigns(n),yield t.placementsRootPage.placements.apiPut(s),yield t.placementsRootPage.campaigns.apiGet(),yield t.placementsRootPage.placements.fetch(),t.init(t.placementData.id),t.submit.updateLoaded(!0)}catch(xhr){var c,p,u;const r=null==xhr||null==(c=xhr.responseJSON)||null==(p=c.result)||null==(u=p.errors)?void 0:u[l];throw r?(t.placementData.updateErrors(r),Validation.scrollToField(r)):(UINotifications.showErrorFlash(),e({name:"Unable to update placement",message:"Ajax failure",xhr:xhr})),new Error("Data is invalid")}finally{Object(r.isAlive)(t)&&t.submit.updateLoading(!1)}}))}))))}).call(this,a("B9cq").notifyDevelopers)},VzV6:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("x7QQ"),i=a("pm75"),o=a("YsCD");const s=r.types.compose("ViewSetupsData",n.a.array(o.a),i.c).views((e=>({get siteCachedSlug(){return Object(r.getRoot)(e).siteCachedSlug},get notDisabledViewSetups(){return e.data.filter((e=>!e.is_disabled&&!e.disabled_by_configuration))},findByViewCategory:t=>e.data.find((e=>e.view_category===t)),get offersClaimViewSetup(){return e.findByViewCategory("offers_claim")},get isDisabledOffersClaimViewSetup(){var t,a;return(null==(t=e.offersClaimViewSetup)?void 0:t.is_disabled)&&!(null!=(a=e.offersClaimViewSetup)&&a.disabled_by_configuration)},get isActiveOffersClaimViewSetup(){var t,a;return(null==(t=e.offersClaimViewSetup)?void 0:t.enabled)&&!(null!=(a=e.offersClaimViewSetup)&&a.disabled_by_configuration)},get actionInProgress(){return e.network.get.isLoading||e.network.patch.isLoading}}))).actions((t=>({apiGet:Object(r.flow)((function*(a){try{var n;t.network.get.updateLoading(!0);const e=yield $.ajax({url:Routes.internal_site_campaign_view_setups_path(t.siteCachedSlug,a),data:{no_spinner:!0}});t.dataApplySnapshot((null==e||null==(n=e.result)?void 0:n.view_setups)||[]),t.network.get.updateLoaded(!0)}catch(xhr){e({name:"Unable to get view setups data",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.network.get.updateLoading(!1)}})),apiPatch:Object(r.flow)((function*({campaignId:a,viewSetupId:n,data:i}){try{t.network.patch.updateLoading(!0),yield $.ajax({type:"PATCH",url:Routes.site_campaign_view_setup_path(t.siteCachedSlug,!1,a,n,{no_spinner:!0}),data:{view_setup:{is_disabled:i.is_disabled}}}),t.network.patch.updateLoaded(!0)}catch(xhr){e({name:"Unable to patch view setups data",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.network.patch.updateLoading(!1)}}))})))}).call(this,a("B9cq").notifyDevelopers)},WFLV:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("TN/B");const i=r.types.model("CampaignNewForm",{campaignTemplate:r.types.optional(n.a,{}),name:r.types.maybeNull(r.types.string),placement_id:r.types.maybeNull(r.types.string),errors:r.types.map(r.types.frozen()),submitting:!1,gdpr_and_ccpa_enabled:!1}).views((e=>({get title(){return`Create ${e.campaignTemplate.default_name}`},get sitePlacements(){return Object(r.getRoot)(e).models.sitePlacements},get selectedPlacement(){return e.sitePlacements.getById(e.placement_id)},get neededPlacementsByType(){return e.sitePlacements.campaign_placements.filter((t=>t.appearance===e.campaignTemplate.appearance))},get optionsPlacements(){return e.neededPlacementsByType.map((t=>({label:{preset_name:e.campaignTemplate.preset_name,name:t.name,category_abbreviation:t.category_abbreviation},value:String(t.id)})))},get defaultPlacementId(){var t;return 1===e.optionsPlacements.length?null==(t=e.optionsPlacements[0])?void 0:t.value:null},get haveErrors(){return e.errors.size}}))).actions((e=>({init:({campaignTemplate:t,name:a})=>{Object(r.applySnapshot)(e,{campaignTemplate:t,name:a})},reset:()=>{Object(r.applySnapshot)(e,{})},updateSubmitting:t=>{e.submitting=t},updateInitialPlacementId:()=>{e.placement_id=e.defaultPlacementId},onChangeName:t=>{e.name=t.target.value,e.errors.delete("error_message")},onToggleGdprCcpa:()=>{e.gdpr_and_ccpa_enabled=!e.gdpr_and_ccpa_enabled},onChangePlacementId:({selectedOption:t})=>{e.placement_id=String(t.value),e.errors.delete("placement_id")},updateErrors:t=>{Object(r.applySnapshot)(e.errors,t)},validate:()=>{e.placement_id?e.errors.clear():e.errors.set("placement_id",["Placement is required"])}})))},WWdt:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return d}));var r,n,i=a("TyAF"),o=a("vOnD"),s=a("GaHK"),l=a("fes7"),c=a("CreG");function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const u=o.default.div.withConfig({displayName:"placement_campaign__PlacementItemFooterGrid"})(["display:grid;grid-column-gap:16px;grid-template-columns:minmax(0,4fr) minmax(0,4fr) 1fr;"]),d=Object(i.c)((n=r=function(t){var a,r;function n(a){var r;return(r=t.call(this,a)||this).containerRef=e.createRef(),r.sortable=null,r}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,p(a,r),n.prototype.render=function(){const{placement:t}=this.props;return e.createElement(u,null,e.createElement("div",null,e.createElement(s.H5,{className:"mbs"},"Shown on"),_.isEmpty(t.inclusions)&&e.createElement(s.BodyS,null,"No inclusions defined."),e.createElement(l.a,{patterns:t.inclusions})),e.createElement("div",null,e.createElement(s.H5,{className:"mbs"},"Hidden on"),_.isEmpty(t.exclusions)&&e.createElement(s.BodyS,null,"No exclusions defined."),e.createElement(l.a,{patterns:t.exclusions})),e.createElement(c.a,{mobile:t.enable_mobile,tablet:t.enable_tablet,desktop:t.enable_desktop}))},n}(e.PureComponent),r.defaultProps={placement:PT.object.isRequired},n))}).call(this,a("q1tI"))},WxVm:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("AEM3"),i=a("Ipfk");const o=r.types.compose(i.a,r.types.model("PlacementBase",{}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get placementsRootPage(){return Object(r.getParentOfType)(e,n.a)},get siteCampaigns(){return e.placementsRootPage.campaigns},get attachedCampaigns(){return e.siteCampaigns.data.filter((t=>t.placement_id===e.id))},get attachedCampaignsLive(){return e.attachedCampaigns.filter((e=>"Live"===e.status))}}))))},XIAt:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("TyAF"),n=a("RoWf");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const o=Object(r.b)((({userSettingsRootStore:e})=>({userSettingsRootStore:e})))(Object(r.c)(function(t){var a,r;function o(){return t.apply(this,arguments)||this}return r=t,(a=o).prototype=Object.create(r.prototype),a.prototype.constructor=a,i(a,r),o.prototype.render=function(){const{userSettingsRootStore:t}=this.props;return e.createElement(n.a,{currentUser:t.currentUser})},o}(e.PureComponent)))}).call(this,a("q1tI"))},XKXH:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return m}));var r=a("NdUt"),n=a("BeA6"),i=a("CVk5"),o=a("CFgq"),s=a("CfEP"),l=a("u6wb"),c=a("5uFb"),p=a("ZQwf"),u=a("zeVt");function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let m=function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,d(a,r),n.prototype.render=function(){const{children:t}=this.props;return e.createElement("div",null,t)},n}(e.PureComponent);m.HeadCell=o.a,m.Search=r.a,m.Select=n.a,m.CheckBoxCell=s.a,m.MainInfoCell=i.a,m.UpdatesCell=l.a,m.OffersCell=c.a,m.Spoiler=p.g,m.Row=p.f,m.Block=p.a,m.Empty=p.c,m.FilteredHiddenCampaignsNote=p.d,m.Head=p.e,m.ShowMore=u.a}).call(this,a("q1tI"))},XbWu:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return i}));const r=e=>e.reduce(((e,t)=>[...e,...t.options]),[]),n=e=>{const t=_.get(e,"accessible_sites",[]),a=_.orderBy(t,["name"],["asc"]),r={own:[],granted:[]};return a.reduce(((t,a)=>{const n=e.account_id||_.get(window,"Account.id");return a.account_id===n?r.own.push(a):r.granted.push(a),r}),r)},i=({selectedOption:e,options:t})=>{var a;return null==(a=r(t).find((t=>t.value===e)))?void 0:a.label}},Y1Wb:function(e,t,a){(function(e){function t(e,a){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,a)}Widget.AbTestsModalFooter=function(a){var r,n;function i(e){var t;return(t=a.call(this,e)||this).handleButtonClick=e=>{const{footerButtonFunc:a=(()=>{})}=t.props;t.setState({isButtonDisabled:!0}),a(e)},t.state={isButtonDisabled:!1},t}return n=a,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,t(r,n),i.prototype.render=function(){const{closeAbPopup:t,template:a}=this.props,{buttonText:r,buttonType:n}=Widget.AbTestsModalConstants[a].footerParams,i=classNames("base-btn is-big",{"is-success":!n,"is-disabled":this.state.isButtonDisabled,[n]:n});return e.createElement("div",{className:"Locale-entries-assets-uploader-footer"},e.createElement("a",{className:"base-btn is-transparent",onClick:t},"Cancel"),e.createElement("button",{type:"button",className:i,onClick:this.handleButtonClick},r))},i}(e.PureComponent)}).call(this,a("q1tI"))},YMV4:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("pm75"),i=a("x7QQ");const o=r.types.model("AdvocateOffersChartSchema",{value:r.types.array(r.types.array(r.types.number))}),s=r.types.compose("AdvocateOffersChartData",i.a.model(o),n.c).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignShowRoot(){return e.rootStore.pages.campaignShowRoot},get currentCampaign(){return e.campaignShowRoot.currentCampaign},get chartYAxisType(){return e.plainValue.includes(0)?"linear":"logarithmic"},get isEmpty(){return 0===_.sum(e.flattenPlainValue)},get plainValue(){return e.data.value.toJSON()},get flattenPlainValue(){return _.flatten(e.plainValue)},get chartFromPoint(){return e.currentCampaign.chart_config.from},get isLoaded(){return e.network.get.isLoaded}}))).actions((t=>({apiGet:Object(r.flow)((function*(){try{t.network.get.updateLoading(!0);const e=yield $.ajax({url:t.currentCampaign.chart_config.data_url,data:{metric:"offers",no_spinner:!0}});t.dataUpdateKey({key:"value",value:e}),t.network.get.updateLoaded(!0)}catch(xhr){e({name:"Unable to get funnel data",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.network.get.updateLoading(!1)}}))})))}).call(this,a("B9cq").notifyDevelopers)},YPDw:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("B9cq");const i=r.types.model("LoyaltyTiersNetworkService",{}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug}}))).actions((e=>({apiGetMany:({campaignId:t,queryParams:a={no_spinner:!0}})=>Object(n.ajax)({url:Routes.internal_site_campaign_loyalty_tiers_path(e.siteCachedSlug,t,a)}),apiPost:({campaignId:t,tier:a,queryParams:r={no_spinner:!0}})=>Object(n.ajax)({withFileUpload:!0,type:"POST",url:Routes.internal_site_campaign_loyalty_tiers_path(e.siteCachedSlug,t,r),data:{tier:a}}),apiPut:({campaignId:t,tierId:a,tier:r,queryParams:i={no_spinner:!0}})=>Object(n.ajax)({withFileUpload:!0,type:"PUT",url:Routes.internal_site_campaign_loyalty_tier_path(e.siteCachedSlug,t,a,i),data:{tier:r}}),apiDelete:({campaignId:t,tierId:a,queryParams:r={no_spinner:!0}})=>Object(n.ajax)({type:"DELETE",url:Routes.internal_site_campaign_loyalty_tier_path(e.siteCachedSlug,t,a,r)})})))},YVJR:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("V0vo"),i=a("sT1B"),o=a("nPL6"),s=a("dOPl"),l=a("l91a");const c=r.types.model("DashboardTilesStore",{name:"DashboardTilesStore",initialDataFetched:!1,savingPriority:!1,resettingTilesPosition:!1,periodDifference:!1,offsetTop:0,startDate:r.types.maybeNull(r.types.string),endDate:r.types.maybeNull(r.types.string),confirmedStartDate:r.types.maybeNull(r.types.string),confirmedEndDate:r.types.maybeNull(r.types.string),currentTimeRange:r.types.maybeNull(r.types.string),COLUMNS_COUNT:2,priorityMode:Object(n.u)("change_order"),shouldBeStickyLast:!1,storeIsActive:!1,headerOffset:0,tilesConfig:r.types.optional(r.types.map(r.types.union(o.DashboardSiteRevenueTileConfigStore,o.DashboardCampaignsTileConfigStore,o.DashboardReferralsTileConfigStore,o.DashboardAdvocateRewardsTileConfigStore,o.DashboardFriendRewardsTileConfigStore,o.DashboardAdvocacyRateTileConfigStore,o.DashboardCampaignPerformanceTileConfigStore,o.DashboardTalkableRevenueTileConfigStore,o.DashboardCustomizableRevenueTileConfigStore,o.DashboardAbstractMetricTileConfigStore,o.DashboardAllTimeMetricTileConfigStore)),{}),tilesData:r.types.optional(r.types.map(r.types.union(s.DashboardAdvocacyRateTileValueStore,s.DashboardAdvocateRewardsTileValueStore,s.DashboardFriendRewardsTileValueStore,s.DashboardCampaignPerformanceTileValueStore,s.DashboardCustomizableRevenueTileValueStore,s.DashboardSiteRevenueTileValueStore,s.DashboardTalkableRevenueTileValueStore,s.DashboardReferralsTileValueStore,s.DashboardAbstractMetricTileValueStore,s.DashboardAllTimeMetricTileValueStore)),{})}).volatile((()=>({requestQ:new l.a}))).views((e=>({get needFetch(){return e.periodDifference},get rootStore(){return Object(r.getParent)(e,2)},get site(){return e.rootStore.models.site},get showLoyaltyBanner(){return e.rootStore.isLoyaltySpace&&!e.rootStore.models.currentUser.staffMember},get idealFriendTiming(){return e.site.ideal_friend_timing},get siteCachedSlug(){return e.site.cached_slug},validateTilesConfig(e){const t=e.filter((({type:e})=>_.includes(i.J,e)));return _.isEmpty(t)?[]:t},formatData:e=>dayjs(e).format("MM/DD/YYYY"),getTileData:t=>e.tilesData.has(`${t}`)?e.tilesData.get(`${t}`):{},hasTileConfig:t=>e.tilesConfig.has(`${t}`),get showTiles(){return e.initialDataFetched&&!e.resettingTilesPosition},get tilesConfigLikeArray(){return _.orderBy(Array.from(e.tilesConfig.values()),["order_position"])},get showTileEditLink(){return!e.priorityMode&&e.rootStore.models.currentUser.staffMember&&e.rootStore.isReferralSpace},get headerLinksConfig(){return[{href:Routes.edit_site_path(e.siteCachedSlug),gaAction:"Site Settings Click",text:"Site Settings",isRouterLink:!0},{href:Routes.placements_index_site_path(e.siteCachedSlug),gaAction:"Campaign Placements Click",text:"Campaign Placements"},{href:Routes.site_web_hooks_path(e.siteCachedSlug),gaAction:"Site Settings Click",text:"Webhooks",isRouterLink:!0},{href:Routes.fraud_site_path(e.siteCachedSlug),gaAction:"Fraud Click",text:"Fraud Settings",isRouterLink:!0},{href:"#",gaAction:"Change Order Dropdown Click",text:"Change Tiles Order",onClick:e.activatePriorityMode,staffMember:!0,showForSpace:e.rootStore.isReferralSpace},{href:Routes.edit_section_account_path(e.rootStore.models.site.siteAccount.account,"tiles"),gaAction:"Edit Tiles Dropdown Click",text:"Edit Tiles",staffMember:!0,showForSpace:e.rootStore.isReferralSpace}].filter((t=>t.showForSpace&&e.rootStore.models.currentUser.staffMember||!t.staffMember))}}))).actions((t=>({activateSavingPriority:()=>{t.savingPriority=!0},deactivateSavingPriority:()=>{t.savingPriority=!1},changeShouldBeStickyLastState:e=>{t.shouldBeStickyLast=e},activateStore:()=>{t.storeIsActive=!0},setHeaderOffset:e=>{t.headerOffset=e},activateResettingTilesPosition:Object(r.flow)((function*(){t.resettingTilesPosition=!0})),deactivateResettingTilesPosition:()=>{t.resettingTilesPosition=!1},loadInitialData:Object(r.flow)((function*(){try{const e=yield $.ajax({url:Routes.fetch_internal_site_dashboard_tiles_path(t.siteCachedSlug),data:{presenter:{overtime:!1,space:t.rootStore.space},no_spinner:!0}});t.setInitialData(e.result)}catch(xhr){e({name:"tiles, unable to load initial data",message:"Ajax failure",xhr:xhr})}})),fetchTilesConfig:Object(r.flow)((function*(){try{const e=yield $.ajax({url:Routes.fetch_internal_site_dashboard_tiles_path(t.siteCachedSlug),data:{presenter:{start_date:t.startDate,end_date:t.endDate,space:t.rootStore.space},no_spinner:!0}}),{result:{tilesConfig:a}}=e;t.resetPriorityMode(),t.updateTilesConfig(a),t.removeParamsFromUrl()}catch(xhr){e({name:"Unable to fetch Tiles Config",message:"Ajax failure",xhr:xhr})}})),clearTilesConfig:Object(r.flow)((function*(){t.initialDataFetched=!1,t.tilesConfig.clear()})),updateTilesConfig:e=>{t.validateTilesConfig(e).forEach((e=>{if(t.hasTileConfig(e.id))t.tilesConfig.put(e);else{const a=o[`${e.type}ConfigStore`].create(e);t.tilesConfig.put(a)}})),t.deactivateResettingTilesPosition(),t.initialDataFetched=!0},savePriority:a=>{t.activateSavingPriority(),$.ajax({url:Routes.rearrange_internal_account_dashboard_tiles_path(t.rootStore.models.site.siteAccount.account.id),type:"POST",data:{order:{...a},no_spinner:!0}}).then((()=>{t.savePriorityAction(a)})).fail((a=>{t.deactivateSavingPriority(),e({name:"Unable to save Dashboard Tiles priority",message:"Ajax failure",xhr:a})}))},savePriorityAction:e=>(t.deactivateSavingPriority(),Utils.trackGAEvent(i.E,"save tiles order"),t.activateResettingTilesPosition().then((()=>{t.updateTilesPosition(e)}))),updateTilesPosition:e=>{_.keys(e).forEach((a=>{e[a].forEach(((e,r)=>{t.tilesConfig.get(`${e}`).updatePosition({columnPosition:Number(a),orderPosition:Number(r)})}))})),t.resetPriorityMode(),t.deactivateResettingTilesPosition()},disablePriorityMode:e=>(e&&e.preventDefault(),t.resetPriorityMode(),t.removeParamsFromUrl(),Utils.trackGAEvent(i.E,"disable priority mode"),t.activateResettingTilesPosition().then((()=>{t.deactivateResettingTilesPosition()}))),removeParamsFromUrl:()=>{window.history.pushState({},document.title,window.location.pathname)},dropRequestsByIdentifier:Object(r.flow)((function*({identifier:e}){const a=t.requestQ.sizeByIdentifier(e);a&&(t.requestQ.clearByIdentifier(e),Utils.trackGAEvent(i.E,"drop old requests",_.padStart(a,3,0)))})),dropAllRequests:Object(r.flow)((function*(){t.requestQ.clear()})),clearTilesData:e=>{e?t.tilesData.delete(`${e}`):t.tilesData.clear()},setPeriodDifference:Object(r.flow)((function*(){t.periodDifference=!0})),resetPeriodDifference:()=>{t.periodDifference=!1},fetchData:Object(r.flow)((function*(a){const r={presenter:{..._.pick(a,["previous","overtime","campaign_appearance","distribution"]),start_date:a.start_date||t.startDate,end_date:a.end_date||t.endDate},no_spinner:!0},n=Routes.by_data_identifier_internal_site_dashboard_tile_path(t.siteCachedSlug,a.tile_id,a.data_identifier);try{const e=yield t.requestQ.ajax({url:n,data:r},{identifier:t.currentTimeRange});if(!t.storeIsActive)return!1;const{result:{id:i,data_identifier:o,values:s,value:l,report_url:c}}=e,p=a.previous?"previous_period":"current_period",u=l||s,d=a.metric_key||o;let m="",g=null;if(a.graph_data){m=`${d}.graph_data.${a.previous?"previous":"current"}`,g={value:u,report_url:c}}else m=`${d}.${p}`,g={value:u,report_url:c};t.modifyTile({id:i,path:m,tileType:a.tile_type,tileValue:g})}catch(xhr){const i={urlParams:r,currentPeriod:t.currentTimeRange,currentLocation:window.location.href,url:n};e({name:"Unable to fetch data for Dashboard Tile",message:"Ajax failure",xhr:xhr,custom:i})}})),modifyTile:e=>{const{id:a,path:r,tileValue:n,tileType:i}=e;if(t.tilesData.has(`${a}`)){t.tilesData.get(`${a}`).update({path:r,tileValue:n})}else{const e=s[`${i}ValueStore`].create();e.update({path:r,tileValue:n}),t.tilesData.set(`${a}`,e)}},setInitialData:e=>{const{endDate:a,startDate:r,tilesConfig:n}=e;t.endDate=a,t.startDate=r,t.updateConfirmedTime(),t.currentTimeRange=`${t.startDate}_${t.endDate}`,t.updateTilesConfig(n)},activatePriorityMode:e=>{e&&e.preventDefault(),t.priorityMode=!0,Object(n.K)(),Utils.trackGAEvent(i.E,"activate priority mode")},resetPriorityMode:()=>{t.priorityMode=!1},handleRangePickerSelect:e=>{t.startDate=e[0]?dayjs(e[0]).format("YYYY-MM-DD"):null,t.endDate=e[1]?dayjs(e[1]).format("YYYY-MM-DD"):null},setCurrentRange:()=>{t.currentTimeRange=`${t.startDate}_${t.endDate}`},updateConfirmedTime:()=>{t.confirmedStartDate=t.startDate,t.confirmedEndDate=t.endDate},reset:Object(r.flow)((function*(){t.storeIsActive=!1,t.dropAllRequests(),Object(r.applySnapshot)(t,{})})),handleDateChange:Object(r.flow)((function*(e){e&&e.preventDefault(),Utils.trackGAEvent(i.E,"Date Range Filter Click"),t.updateConfirmedTime();const a=`${t.startDate}_${t.endDate}`;_.isEqual(a,t.currentTimeRange)||(t.dropRequestsByIdentifier({identifier:t.currentTimeRange}),t.fetchTilesConfig(),t.clearTilesData(),t.setCurrentRange(),yield t.setPeriodDifference(),t.resetPeriodDifference())}))})));c.create()}).call(this,a("B9cq").notifyDevelopers)},YWrU:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("99Ma");const n=r.types.model("LoyaltyRedemptionRuleSchema",{id:r.types.maybeNull(r.types.number),available_coupons_count:r.types.maybeNull(r.types.number),coupon_list_id:r.types.maybeNull(r.types.number),points_cost:0,description:r.types.maybeNull(r.types.string)})},YgPs:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("Ifx+");const i=r.types.model("DeleteDomain",{inputValue:"",isOpenModal:!1,isLoading:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get customDomain(){return Object(r.getParent)(e)},get name(){return e.customDomain.name},get isDisable(){return e.inputValue!==e.name||e.isLoading}}))).actions((t=>({updateLoading:({isLoading:e=!0})=>{t.isLoading=e},toggleModal:()=>{t.isOpenModal=!t.isOpenModal,t.isOpenModal&&(t.inputValue="")},handleChange:({target:{value:e}})=>{t.inputValue=e},handleSubmit:Object(r.flow)((function*(a){try{a.preventDefault(),t.updateLoading({isLoading:!0}),yield $.ajax({url:Routes.reset_custom_domain_internal_site_path(t.customDomain.siteCachedSlug,{no_spinner:!0}),type:"DELETE",data:{reset_web_domain:"web"===t.customDomain.type||"consistent"===t.customDomain.type,reset_email_domain:"email"===t.customDomain.type||"consistent"===t.customDomain.type}}),Validation.showSuccessFlash("Domain was successfully deleted",15e3)}catch(xhr){Object(n.b)(),e({name:"Unable to delete custom domain",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&(yield t.rootStore.fetchSiteAndCurrentUser(t.siteCachedSlug),t.updateLoading({isLoading:!1}),t.reset())}})),reset:()=>{Object(r.applySnapshot)(t,{})}})))}).call(this,a("B9cq").notifyDevelopers)},Ypvm:function(e,t){Widget.Utilities={dateFromNow:(e,t)=>{let a;return Widget.timestamps.map((t=>{const r={value:Math.floor((Number(dayjs().unix())-Number(dayjs(e).unix()))/t.value),dimension:t.dimension};!a&&r.value&&(a=r)})),t?`${_.get(a,"value")} ${_.get(a,"dimension","").charAt(0)}`:`${_.get(a,"value")} ${_.get(a,"dimension")}${1===_.get(a,"value")?"":"s"}`}}},YsCD:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("dhqo"),i=a.n(n),o=a("o2Zq");const s=r.types.model("ViewSetupSchema",{campaign_id:r.types.maybeNull(r.types.number),can_be_disabled:r.types.maybeNull(r.types.boolean),criteria:r.types.maybeNull(r.types.string),delay_at:r.types.maybeNull(r.types.string),delay_in:r.types.maybeNull(r.types.string),disabled_by_configuration:r.types.maybeNull(r.types.boolean),email_view:r.types.maybeNull(r.types.boolean),embeddable_view:r.types.maybeNull(r.types.boolean),enabled:r.types.maybeNull(r.types.boolean),for_friend:!1,human_criterias:r.types.maybeNull(r.types.array(r.types.string)),human_name:r.types.maybeNull(r.types.string),id:r.types.identifierNumber,identifier:r.types.maybeNull(r.types.string),is_disabled:r.types.maybeNull(r.types.boolean),locale_keys:r.types.optional(r.types.array(r.types.string),[]),page_view:!1,presets_or_default:r.types.array(o.a),presets_with_default:r.types.array(o.a),recipient:r.types.maybeNull(r.types.string),responsive:r.types.maybeNull(r.types.boolean),view_category:r.types.maybeNull(r.types.string),width_with_unit:r.types.maybeNull(r.types.string)}).views((e=>({get isEmailView(){return"email"===e.viewType},get viewType(){return e.page_view?"web":"email"},get formattedDelayAt(){return dayjs(e.delay_at).format("MMMM DD, [at] HH:mm")},get formattedDelayIn(){return"0"===e.delay_in?"0 (sends immediately)":`${e.delay_in} ${i()("hour",e.delay_in)}`}}))).actions((()=>({})))},Z5Pp:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return d}));var r=a("99Ma"),n=a("JHMc"),i=a("cYkR"),o=a("aFzQ"),s=a("l91a"),l=a("B9cq");function c(e,t,a){return _.set(e,"id",e.referral.id),_.set(e,"page",t),_.set(e,"filter_statuses",a),_.set(e,"advocate.person.type","advocate"),_.set(e,"friend.person.type","friend"),e}const p=r.types.model("StatusesData",{pending:r.types.optional(r.types.boolean,!0),flagged:r.types.optional(r.types.boolean,!0),in_progress:r.types.optional(r.types.boolean,!1),blocked:r.types.optional(r.types.boolean,!1),voided:r.types.optional(r.types.boolean,!1),approved:r.types.optional(r.types.boolean,!1)}),u=r.types.model("AllReferralsConfirmation",{approve:!1,void:!1}).actions((e=>({set:(t,a)=>{e[t]=a}}))),d=r.types.model("CspReferralsStore",{name:"CspReferralsStore",referrals:r.types.map(n.a),referralDetails:r.types.optional(i.a,{}),cspReferralsIsFetching:!0,cspReferralsFetched:!1,counterFetched:!1,allReferralsConfirmation:r.types.optional(u,{}),paginationPosition:1,statuses:r.types.optional(p,{}),count:0,countForApproval:0,offsetTop:0}).volatile((()=>({requestQ:new s.a}))).views((e=>({get parent(){return Object(r.getParent)(e)},get siteCachedSlug(){return e.parent.siteCachedSlug},get fraudPolicies(){return Object(r.getParent)(e).fraudSettings.fraud_policies},get currentCspReferrals(){return Object(o.values)(e.referrals).filter((t=>t.page===e.paginationPosition))},get fraudReasonsStatuses(){return e.fraudPolicies.reduce(((e,t)=>(t.isIncludeFilter&&e.push(t.key),e)),[])},get convertStatuses(){return _.keys(_.pickBy(e.statuses,_.identity))},get bulkActionsStatuses(){const t=["pending","flagged"],a=_.keys(_.pickBy(e.statuses,_.identity));let r=[];return _.isEmpty(a)?r=t:t.forEach((e=>{a.includes(e)&&r.push(e)})),r},get currentPerson(){return Object(r.getParent)(e).currentPerson}}))).actions((t=>({resetFetchState:()=>{t.cspReferralsIsFetching=!0,t.cspReferralsFetched=!1},retryFetch:()=>{t.paginationPosition=t.paginationPosition-1,t.fetchData()},killPendingRequests:()=>{t.requestQ.clear(),Utils.trackGAEvent(t.parent.gaCategory,"drop old request")},fetchData:Object(r.flow)((function*(){try{t.resetFetchState(),t.clearReferrals(),t.killPendingRequests(),t.fetchCount(),t.fetchCountForApproval();const{result:{records:e}}=yield t.requestQ.ajax({debug:!0,url:Routes.internal_site_customer_service_referrals_path(t.siteCachedSlug,{page:t.paginationPosition,status:t.convertStatuses,matched_fraud_policy:t.fraudReasonsStatuses,no_spinner:!0})});_.some(e)||1===t.paginationPosition?t.updateReferrals(e):t.retryFetch()}catch(xhr){e({name:"Unable to fetch CSP Referrals",message:"Ajax failure",xhr:xhr})}})),fetchReferral:Object(r.flow)((function*(a){try{const e=yield Object(l.ajax)({url:Routes.internal_site_customer_service_referral_path(t.siteCachedSlug,a)});t.updateReferral(e.result.record)}catch(xhr){e({name:"Unable to fetch referral from referral store",message:"Ajax failure",xhr:xhr})}})),clearReferrals:()=>{t.referrals.clear()},fetchCount:Object(r.flow)((function*(){try{t.counterFetched=!1;const e=yield t.requestQ.ajax({url:Routes.count_internal_site_customer_service_referrals_path(t.siteCachedSlug),data:{status:t.convertStatuses,matched_fraud_policy:t.fraudReasonsStatuses,no_spinner:!0}});t.updateCounters(e.result.count)}catch(xhr){e({name:"Unable to fetch CSP referrals counters",message:"Ajax failure",xhr:xhr})}})),fetchCountForApproval:Object(r.flow)((function*(){try{if(_.isEmpty(t.bulkActionsStatuses))t.updateCountersForApproval(0);else{const e=yield t.requestQ.ajax({url:Routes.count_internal_site_customer_service_referrals_path(t.siteCachedSlug),data:{status:t.bulkActionsStatuses,matched_fraud_policy:t.fraudReasonsStatuses,no_spinner:!0}});t.updateCountersForApproval(e.result.count)}}catch(xhr){e({name:"Unable to fetch CSP referrals counters",message:"Ajax failure",xhr:xhr})}})),updateCounters:e=>{t.count=e,t.counterFetched=!0},updateCountersForApproval:e=>{t.countForApproval=e},modifyReferrals:e=>_.forOwn(e,(e=>c(e,t.paginationPosition,t.convertStatuses))),updateReferrals:(e=[])=>{e.forEach((e=>{const a=c(e,t.paginationPosition,t.convertStatuses);t.referrals.put(a)})),t.cspReferralsFetched=!0,t.cspReferralsIsFetching=!1},updateReferral:e=>{const a=c(e,t.paginationPosition,t.convertStatuses);t.referrals.put(a)},removeReferral:e=>{t.referrals.delete(e)},applyStatusFilter:e=>{t.statuses[e]=!t.statuses[e],t.paginationPosition=1,t.fetchData()},applyFraudReasonFilter:e=>{t.fraudPolicies.forEach((t=>{t.key===e&&t.updateFilter(!t.isIncludeFilter)})),t.fetchData()},setPaginationPosition:(e,a)=>{a&&a.preventDefault(),e!==t.paginationPosition&&(t.paginationPosition=e,_.isEmpty(t.currentReferrals)&&t.fetchData())},approveAllReferrals:Object(r.flow)((function*(a){a&&a.preventDefault();try{const e=yield Object(l.ajax)({url:Routes.approve_all_internal_site_customer_service_referrals_path(t.siteCachedSlug),type:"POST",data:{status:t.bulkActionsStatuses}});t.currentPerson.loadReferrals(),t.setSyntheticStatusForReferrals("approve"),t.allReferralsConfirmation.set("approve",!1),Validation.showSuccessFlash(e.result.message,12e3)}catch(xhr){Validation.fail(_.get(xhr,"responseJSON.result.errors")||xhr.responseJSON),e({name:"Unable to approveAllReferrals CSP",message:"Ajax failure",xhr:xhr})}})),voidAllReferrals:a=>{a&&a.preventDefault(),Object(l.ajax)({url:Routes.void_all_internal_site_customer_service_referrals_path(t.siteCachedSlug),type:"POST",data:{status:t.bulkActionsStatuses}}).then((e=>{t.currentPerson.loadReferrals(),t.setSyntheticStatusForReferrals("void"),t.allReferralsConfirmation.set("void",!1),Validation.showSuccessFlash(e.result.message,12e3)})).fail((t=>{Validation.fail(_.get(t,"responseJSON.result.errors")||t.responseJSON),e({name:"Unable to voidAllReferrals CSP",message:"Ajax failure",xhr:t})}))},setOffsetTop:e=>{t.offsetTop=e},setSyntheticStatusForReferrals:e=>{t.referrals.forEach((({referral:a})=>{t.bulkActionsStatuses.includes(a.status)&&a.setSyntheticStatus(e)})),t.updateCountersForApproval(0)}})))}).call(this,a("B9cq").notifyDevelopers)},ZKCC:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var r=a("99Ma"),n=a("rfrl"),i=a("sT1B"),o=a("RQ/8"),s=a("G/JG"),l=a("ojmY"),c=a("pm75"),p=a("t/S2"),u=a("V0vo");const d=r.types.model("RulesNewStore",{data:r.types.optional(p.a,{}),initialData:r.types.optional(p.a,{}),type:r.types.maybeNull(r.types.string),category_id:r.types.maybeNull(r.types.union(r.types.number,r.types.string)),fetchImageNetwork:r.types.optional(c.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get loyaltyRulesRootStore(){return Object(r.getParent)(e)},get ruleCategoriesStore(){return e.loyaltyRulesRootStore.ruleCategoriesStore},get rulesStore(){return e.loyaltyRulesRootStore.rulesStore},get ruleTypeOptions(){const t=[{value:i.V.optin,label:"Loyalty join",urlParam:"optin",category_id:null},{value:i.V.event,label:"Purchase points",urlParam:"event",category_id:null},{value:i.V.referral,label:"Refer a friend",urlParam:"referral",category_id:null}];return e.ruleCategoriesStore.data.forEach((e=>{var a;e.rule&&t.push({label:null==(a=e.rule)?void 0:a.name,identifier:e.identifier,value:i.V.other,urlParam:"other",category_id:e.id})})),e.rootStore.models.currentUser.staffMember&&t.push({identifier:null,label:"Create new action",value:i.V.other,urlParam:"other",category_id:null,isNewRuleType:!0,staff:!0}),t},get selectedTypeOption(){return e.ruleTypeOptions.find((t=>t.value===e.type&&e.category_id===t.category_id))||null},get showFormInner(){return Boolean(e.type)},get availableRuleData(){if(e.category_id){const t=e.ruleCategoriesStore.getCategoryById(e.category_id);return{...t.rule,identifier:t.identifier,type:e.type,category_id:e.category_id}}const t={...e.rulesStore.getFirstRuleByType(e.type)||{},type:e.type};return Object(l.b)({type:e.type})||Object(l.c)({type:e.type})?t.once_per_member=!1:t.once_per_member=!0,t},get isAvailableForAction(){return"in_progress"!==e.rulesStore.network.post.status&&"in_progress"!==e.fetchImageNetwork.status&&e.loyaltyRulesRootStore.isAvailableForAction},get isIdentifierRequired(){return e.data.isCustomRule&&!e.data.category_id},get isPristine(){return _.isEqual(e.initialData.toJSON(),e.data.toJSON())}}))).actions((e=>({init(t={}){if(t.rule_type&&i.V[t.rule_type]){const a={value:i.V[t.rule_type]};(t.category_id&&e.ruleCategoriesStore.getCategoryById(Number(t.category_id))||null===t.category_id)&&(a.category_id=Number(t.category_id)),e.handleSelectType({selectedOption:a})}},updateData(t){const a=Object(n.b)(t,(e=>{delete e.id}));e.data.updateData(a),e.initialData.updateData(a)},handleSelectType({selectedOption:t}){e.type=t.value,e.category_id=t.category_id;const a=e.loyaltyRulesRootStore.variablesStore.getVariablesByType(e.type);Object(l.a)({type:e.type})&&null===e.category_id?e.updateData({type:e.type,criteria_sample_interpolations:a}):e.updateData({...e.availableRuleData,criteria_sample_interpolations:a,criteria:e.rootStore.models.currentUser.staffMember?e.availableRuleData.criteria:""})},createNewCategory:Object(r.flow)((function*(t){try{return yield e.ruleCategoriesStore.apiPost({identifier:t})}catch(a){throw{identifier:[a]}}})),getImageFile:Object(r.flow)((function*(){const t=yield fetch(e.data.iconUrl,{cache:"no-cache"}),a=yield t.blob(),r=_.last(e.data.iconUrl.split("/"));return new File([a],r,{type:a.type})})),handleCreate:Object(r.flow)((function*(){try{const{data:t,identifier:a}=e.data.prePareDataForServer;if(e.isIdentifierRequired&&!a)throw{identifier:["is required"]};if(a){const r=yield e.createNewCategory(a);t.category_id=r.id}if(!t.icon)try{e.fetchImageNetwork.update("in_progress"),t.icon=yield Object(u.k)(e.data.iconUrl),e.fetchImageNetwork.update("success")}catch{throw e.fetchImageNetwork.update("error"),"CDN failure"}yield e.rulesStore.apiPost({campaignId:e.loyaltyRulesRootStore.campaign.id,data:{rule:t}}),yield e.loyaltyRulesRootStore.init(),e.updateData({}),UINotifications.showSuccessFlash("New loyalty action was created")}catch(t){throw"CDN failure"!==t&&e.data.updateErrors(t),UINotifications.showErrorFlash(t.icon),new Error("Unable create loyalty rule")}})),handleDiscardChanges(){e.updateData(e.initialData.toJSON())},reset(){Object(r.applySnapshot)(e,{})}})));var m=a("fcK3");const g=r.types.model("LoyaltyRulesRootStore",{variablesStore:r.types.optional(s.b,{}),rulesStore:r.types.optional(s.a,{}),ruleCategoriesStore:r.types.optional(o.a,{}),rulesNewStore:r.types.optional(d,{}),rulesEditStore:r.types.optional(m.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignRulesStore(){return Object(r.getParent)(e)},get campaign(){return e.campaignRulesStore.campaign},get rulesPreview(){return(e=>{const t=_.groupBy(e.sort(((e,t)=>{var a,r;return(null==(a=e.name)?void 0:a.toUpperCase())>=(null==(r=t.name)?void 0:r.toUpperCase())?1:-1})),"type"),a=Object.values(_.groupBy(t[i.V.other],"category_id"));return[t[i.V.optin]||[],t[i.V.event]||[],t[i.V.referral]||[],a].flat(1/0)})(e.rulesStore.data.map((t=>Object(n.a)(t,(t=>{var a;t.identifier=t.category_id&&(null==(a=e.ruleCategoriesStore.getCategoryById(t.category_id))?void 0:a.identifier),t.fixedReward=t.isEventRule?!t.based_on_subtotal:!t.isReferralRule})))))},get isSomeBasedOnSubtotalRule(){return e.rulesStore.data.some((e=>e.based_on_subtotal))},get loaded(){return e.rulesStore.network.get.isLoaded&&e.ruleCategoriesStore.network.get.isLoaded},get isAvailableForAction(){return"success"===e.rulesStore.network.get.status&&"success"===e.ruleCategoriesStore.network.get.status},getRuleDataWithCategory(t){const a=e.rulesStore.getRuleById(Number(t));let r;return a.category_id&&(r=e.ruleCategoriesStore.getCategoryById(Number(a.category_id))),{rule:a,category:r}}}))).actions((e=>({init:Object(r.flow)((function*(){yield Promise.all([e.variablesStore.apiGetForAllTypes(e.campaign.id),e.rulesStore.apiGet(e.campaign.id),e.ruleCategoriesStore.apiGet()])})),reset(){Object(r.applySnapshot)(e,{})}})))},ZQwf:function(e,t,a){"use strict";(function(e){a.d(t,"f",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"d",(function(){return p})),a.d(t,"e",(function(){return u}));var r=a("vOnD"),n=a("GaHK");const i=r.default.div.withConfig({displayName:"components__Row"})(["display:flex;justify-content:space-between;padding:16px 0;",""],(({divider:e})=>e&&Object(r.css)(["border-bottom:1px solid #e5e5e5;"])));i.propTypes={divider:PT.bool},i.defaultProps={divider:!0};const o=r.default.div.withConfig({displayName:"components__Block"})(["display:flex;justify-content:space-between;margin-bottom:24px;"]),s=r.default.div.withConfig({displayName:"components__Cell"})(["box-sizing:border-box;padding-right:16px;flex-shrink:0;",";",";",";&:last-child{padding-right:0;}"],(({width:e})=>e&&Object(r.css)(["width:",";"],e)),(({stretch:e})=>e&&Object(r.css)(["flex-grow:1;"])),(({shrink:e})=>e&&Object(r.css)(["flex-shrink:1;"])));s.defaultProps={shrink:!1};const l=({children:t,title:a,defaultShow:r,classNameTitle:i})=>e.createElement(n.UISpoiler,{defaultShow:r,text:a,styleTitle:{color:n.Theme.color.link},style:{width:"100%"},classNameTitle:i},t);l.defaultProps={defaultShow:!0};const c=({children:t,selectedCampaignsCount:a})=>e.createElement(n.BodyM,{className:"mtl",color:n.Theme.color.black50},t||a?`No campaigns found, but ${a} is selected`:"No campaigns found"),p=({children:t,hiddenCampaignsNote:a})=>e.createElement(n.BodyM,{className:"mtl",color:n.Theme.color.black50},t||a),u=i}).call(this,a("q1tI"))},ZaDd:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return l}));var r=a("99Ma");const n="{ }",i="[ ]",o=(e="")=>`variable-${e.split(".").join("-")}`,s=e=>`{{ ${e} }}`,l=r.types.model("InfoSidebarStore",{data:r.types.optional(r.types.frozen(),{}),query:"",pathNodeVariables:r.types.optional(r.types.array(r.types.string),[]),haveMatches:!1,matchNodes:r.types.optional(r.types.array(r.types.string),[]),activeMatchNode:-1,gaCategory:"Variables"}).views((e=>({get showVariables(){return""===e.query||e.haveMatches},get frequentlyUsedVariables(){return[{path:"advocate_incentive",key:"description",description:"Incentive for Advocate"},{path:"friend_incentive",key:"description",description:"Incentive for Friend"},{path:"site_setup",key:"url",description:"Site URL"},{path:"site_setup",key:"name",description:"Site Name"}].reduce(((t,a)=>{const r=_.get(e.data,`${a.path}.value.${a.key}.value`);return r&&t.push({...a,value:r}),t}),[])},get pathActiveMatchNode(){return e.matchNodes.length>0&&e.matchNodes[e.activeMatchNode]}}))).actions((e=>({afterCreate(){Object(r.onSnapshot)(e.matchNodes,(()=>{_.some(e.matchNodes)&&e.initActiveMatchNode()}))},onChangeQuery(t){e.query=t.target.value,e.cleanMatchNodes(),e.updateDataByQuery()},updateData(t){e.data=e.normalizeData(t)},updatePathToNode:(e,t)=>e.slice(0,e.length-t.length-1),resetQuery(){e.query="",e.activeMatchNode=-1,e.cleanMatchNodes(),e.updateDataByQuery()},updateHaveMatches(t){e.haveMatches=t},updateMatchNodes(t){e.matchNodes.includes(t)||e.matchNodes.push(t)},cleanMatchNodes(){e.matchNodes.replace([])},openParentNodesByPath(t=""){const a=_.cloneDeep(e.data);let r=t;t.split(".").reverse().forEach(((t,n,i)=>{"value"!==t&&_.update(a,r,(e=>({...e,open:!0}))),r=e.updatePathToNode(r,t)})),e.data=a},previousActiveMatchNode(){e.activeMatchNode=0!==e.activeMatchNode?e.activeMatchNode-1:e.matchNodes.length-1,e.openParentNodesByPath(e.matchNodes[e.activeMatchNode]),e.scrollToVariable()},nextActiveMatchNode(){e.activeMatchNode=e.activeMatchNode+1>=e.matchNodes.length?0:e.activeMatchNode+1,e.openParentNodesByPath(e.matchNodes[e.activeMatchNode]),e.scrollToVariable()},initActiveMatchNode(){e.activeMatchNode=0,setTimeout((()=>{e.scrollToVariable()}),200)},scrollToVariable(){if(e.haveMatches){const t=$(`.${o(e.matchNodes[e.activeMatchNode])}`)[0];t?t.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}):setTimeout((()=>{e.scrollToVariable()}),0)}},updateDataByQuery(){const t=_.cloneDeep(e.data);let a=!1;e.pathNodeVariables.forEach((a=>{let r=a;a.split(".").reverse().forEach(((a,n,i)=>{"value"!==a&&_.update(t,r,(e=>({...e,open:!1,match:!1}))),r=e.updatePathToNode(r,a)}))})),e.pathNodeVariables.forEach((r=>{let n=r,i=!1;r.split(".").reverse().forEach(((r,o,s)=>{"value"!==r&&(_.update(t,n,(t=>({...t,match:e.matchQuery({path:t.copyPath,key:r}),open:t.open||i}))),e.matchQuery({path:_.get(t,`${n}.copyPath`),key:r})&&(i=!0,a=!0,e.updateMatchNodes(_.get(t,`${n}.path`)))),n=e.updatePathToNode(n,r)}))})),e.updateHaveMatches(a),e.data=t},matchQuery:({path:t,key:a})=>""!==e.query&&(_.includes(e.query,".")||_.includes(e.query,"[")||_.includes(e.query,"]")?_.includes(t,e.query):_.includes(s(a),e.query)),updatePathNodeVariables(t){e.pathNodeVariables.push(t)},normalizeData(t){const a=({data:t,parentPath:r,depth:o,path:l,description:c,mark:p})=>{const u=0===o;if(_.isObject(t)){if(_.isArray(t)){if(_.some(t)){const n=_.filter(t,(e=>!_.isObject(e)));return _.some(n)?(e.updatePathNodeVariables(l),{description:c,mark:p,path:l,copyPath:s(r),value:n.join(", "),open:u,match:!1,type:"array"}):{description:c,value:_.reduce(t,((e,t,n)=>(e[n]={...a({data:_.isUndefined(null==t?void 0:t.value)?t:null==t?void 0:t.value,description:_.isString(null==t?void 0:t.description)?null==t?void 0:t.description:null,parentPath:`${r}[${n}]`,depth:o+1,path:`${l}.value.${n}`,mark:null==t?void 0:t.mark}),path:`${l}.value.${n}`,copyPath:s(`${r}[${n}]`),open:!1,match:!1,type:"object"},e)),{})}}return e.updatePathNodeVariables(l),{mark:p,description:c,path:l,copyPath:s(r),value:i,open:u,match:!1,type:"object"}}return _.some(t)?{description:c,value:_.reduce(t,((e,t,n)=>(e[n]={...a({data:_.isUndefined(null==t?void 0:t.value)?t:null==t?void 0:t.value,description:_.isString(null==t?void 0:t.description)?null==t?void 0:t.description:null,parentPath:`${r}.${n}`,depth:o+1,path:`${l}.value.${n}`,mark:null==t?void 0:t.mark}),path:`${l}.value.${n}`,copyPath:s(`${r}.${n}`),open:!1,match:!1},e)),{})}:(e.updatePathNodeVariables(l),{mark:p,description:c,path:l,copyPath:s(r),value:n,open:u,match:!1,type:"object"})}return e.updatePathNodeVariables(l),{mark:p,description:c,path:l,copyPath:s(r),value:"string"!==typeof t?String(t):`"${t}"`,open:u,match:!1,type:typeof t}},r={};return _.map(t,(({description:e,value:t,options:n,mark:i},o)=>{e&&(r[o]={options:n,...a({mark:i,description:e,data:t,parentPath:o,depth:0,path:o}),open:!1,path:o,copyPath:s(o),match:!1,type:typeof t})})),r},hideChildVariables(t){_.map(t,((a,r)=>{t[r].open=!1,_.isObject(a.value)&&e.hideChildVariables(a.value)}))},toggleOpenByPath(t,a){t.stopPropagation();const r=_.cloneDeep(e.data);_.update(r,`${a}.open`,(e=>!e)),Utils.trackGAEvent(e.gaCategory,(_.get(r,`${a}.open`)?"open":"close")+" variable",a),_.isObject(_.get(r,`${a}.value`))&&e.hideChildVariables(_.get(r,`${a}.value`)),e.data=r},gaTrackCopyVariable(t){Utils.trackGAEvent(e.gaCategory,"copy to clipboard",t)},reset(){Object(r.applySnapshot)(e,{data:{},query:"",pathNodeVariables:[],haveMatches:!1,matchNodes:[],activeMatchNode:-1,gaCategory:"Variables"})}})))},ZbcR:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("99Ma");const n=r.types.model("TileMetricValueStore",{plain:r.types.maybeNull(r.types.number),formatted:r.types.maybeNull(r.types.string),humanized:r.types.maybeNull(r.types.string)});n.create()},ZoHw:function(e,t,a){"use strict";async function r(e){return new Promise(((t,a)=>{try{let a=new XMLHttpRequest;a.onload=function(){let e=new Uint8Array(a.response),r=String.fromCharCode.apply(null,e),n=btoa(r);t(n)},a.open("GET",e),a.responseType="arraybuffer",a.send()}catch(r){a(r)}}))}a.r(t),a.d(t,"default",(function(){return r}))},Zrvx:function(e,t,a){"use strict";a.r(t),t.default="/assets/v1/packs/gotham-book-6fdc2fbc1ba2369930c0b309c51d64cf.ttf"},a0d0:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return d}));var r=a("99Ma"),n=a("aFzQ"),i=a("B9cq"),o=a("BpJz"),s=a("AHpt");const l=["clicked_at","opened_at","delivered_at","created_at"],c=r.types.model("ViewSetupData",{id:r.types.maybeNull(r.types.number),campaign_id:r.types.maybeNull(r.types.number),human_view_category:r.types.maybeNull(r.types.string)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get viewSetupLink(){return Routes.site_campaign_view_setup_path(e.rootStore.models.site.cached_slug,e.campaign_id,e.id)}}))),p=r.types.model("CustomerEmailData",{id:r.types.maybeNull(r.types.number),view_setup:r.types.maybeNull(c),campaign:r.types.maybeNull(s.a),recipient:r.types.maybeNull(o.a),created_at:r.types.maybeNull(r.types.string),processed:r.types.maybeNull(r.types.boolean),processed_at:r.types.maybeNull(r.types.string),bounced:r.types.maybeNull(r.types.boolean),rejected:r.types.maybeNull(r.types.boolean),human_rejected_reason:r.types.maybeNull(r.types.string),reply_to_person:r.types.maybeNull(o.a),reply_to_recipient:r.types.maybeNull(r.types.string),delivered_at:r.types.maybeNull(r.types.string),opened_at:r.types.maybeNull(r.types.string),clicked_at:r.types.maybeNull(r.types.string),from:r.types.maybeNull(r.types.string),scheduled_for:r.types.maybeNull(r.types.string)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get getEmailStatus(){let t="";return l.some((a=>(t=a,e[a]))),t},get emailStatusDate(){return e.rootStore.models.site.formatDate(e[e.getEmailStatus])},get normalizedEmailStatus(){return e.rejected?"rejected":e.processed_at&&"created_at"===e.getEmailStatus?"sent":!e.processed_at&&dayjs(e.scheduled_for).diff()>0?"scheduled":e.getEmailStatus.replace("_at","")},get showAdvocatedEmail(){return _.some(e.reply_to_person)&&("Friend share email reminder"===e.view_setup.human_view_category||"Friend share email"===e.view_setup.human_view_category)},get originPath(){return Routes.site_customer_email_path(e.rootStore.models.site.cached_slug,e.id)},get formattedDateScheduled(){return e.rootStore.models.site.formatDate(e.scheduled_for)},get relativeDateScheduled(){return e.relativeDate(e.scheduled_for)},relativeDate:e=>dayjs(e).fromNow()}))).actions((t=>({emailAction:a=>{const r="send_now"===a?Routes.send_now_internal_site_customer_email_path(t.rootStore.siteCachedSlug,t.id):Routes.resend_internal_site_customer_email_path(t.rootStore.siteCachedSlug,t.id);Object(i.ajax)({url:r,type:"POST"}).then((e=>{if(e.ok){const{fetchEmailsReceived:e,searchQuery:r}=t.rootStore.pages.customerServiceStore.currentPerson.emailsReceivedStore;e(r),"send_now"===a?UINotifications.add({type:"success",text:`Email was successfully sent to ${t.recipient.email}. ${t.from} has been put to BCC.`,delay:2e4}):UINotifications.add({type:"success",text:"The email has been resent. Talkable will not update existing email statuses when the email was delivered or clicked.",delay:2e4})}else Validation.showErrorFlash(e.result.error_message)})).fail((t=>{Validation.fail(_.get(t,"responseJSON.result.errors")||t.responseJSON),e({name:`Unable to ${a} email`,message:"Ajax failure",xhr:t})}))},sendNow:e=>{null==e||e.preventDefault(),null==e||e.stopPropagation(),t.emailAction("send_now")},resend:e=>{null==e||e.preventDefault(),null==e||e.stopPropagation(),t.emailAction("resend")}}))),u=r.types.model("EmailReceived",{id:r.types.identifierNumber,page:r.types.maybeNull(r.types.number),customer_email:r.types.optional(p,{})}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({}))).actions((e=>({update:t=>{_.forEach(t,((a,r)=>{e[r]=t[r]}))}}))),d=r.types.model("EmailsReceivedStore",{emailsReceived:r.types.optional(r.types.map(u),{}),searchQuery:"",emailsReceivedFetched:r.types.optional(r.types.boolean,!1),paginationPosition:r.types.optional(r.types.number,1)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get currentEmailsReceived(){return Object(n.values)(e.emailsReceived).filter((t=>t.page===e.paginationPosition))}}))).actions((t=>({resetFetchState:()=>{t.emailsReceivedFetched=!1},fetchEmailsReceived:Object(r.flow)((function*(a){t.resetFetchState();try{const e=yield Object(i.ajax)({url:Routes.internal_site_customer_service_for_scope_path(t.rootStore.models.site.cached_slug,"received_emails",{q:a,page:t.paginationPosition,no_spinner:!0})});t.updateEmailsReceived(e.result.records,a)}catch(xhr){e({name:"Unable to fetch CSP Email Delivery",message:"Ajax failure",xhr:xhr})}})),modifyEmailReceived:e=>(_.set(e,"id",e.customer_email.id),_.set(e,"page",t.paginationPosition),e),clearEmailsReceived:()=>{t.emailsReceived.clear()},updateEmailsReceived:(e=[],a)=>{e.forEach(((e,a)=>{const r=t.modifyEmailReceived(e);t.emailsReceived.put(r)})),t.emailsReceivedFetched=!0,t.searchQuery=a},setPaginationPosition:(e,a)=>{a&&a.preventDefault(),e!==t.paginationPosition&&(t.paginationPosition=e,t.fetchEmailsReceived(t.searchQuery))}})))}).call(this,a("B9cq").notifyDevelopers)},aCAj:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("Dg7y"),i=a("MrdO"),o=a("ZbcR"),s=a("GaHK");const l=r.types.model("DashboardReferralsTileConfig",{configuration:r.types.maybeNull(i.a),report_urls:r.types.maybeNull(r.types.model({referrals:r.types.maybeNull(r.types.model({in_progress:r.types.maybeNull(r.types.string),pending:r.types.maybeNull(r.types.string),flagged:r.types.maybeNull(r.types.string),approved:r.types.maybeNull(r.types.string),blocked:r.types.maybeNull(r.types.string),voided:r.types.maybeNull(r.types.string)}))})),inline_values:r.types.maybeNull(r.types.model({referrals:r.types.maybeNull(r.types.model({in_progress:r.types.maybeNull(o.a),pending:r.types.maybeNull(o.a),flagged:r.types.maybeNull(o.a),approved:r.types.maybeNull(o.a),blocked:r.types.maybeNull(o.a),voided:r.types.maybeNull(o.a)}))}))}).views((t=>({get eventsForTooltip(){const e=t.configuration.event_categories;return _.some(e)?`'${e.join("', '")}'`:"all events"},get campaignTagsForTooltip(){const e=t.configuration.campaign_tags;return _.some(e)?`'${e.join("', '")}'`:"all"},get dynamicDescription(){return`Referrals are broken down by referral status, taken from the following conversion events: ${t.eventsForTooltip} (both referral and not), and ${t.campaignTagsForTooltip} campaign tags. Includes QA-generated data.`},get referralStats(){return{approved:e.createElement(s.UIIcon,{width:"12",height:"12",name:"successTickNew"}),pending:e.createElement(s.UIIcon,{width:"12",height:"12",name:"pending"}),flagged:e.createElement(s.UIIcon,{width:"12",height:"12",name:"flagged"}),blocked:e.createElement(s.UIIcon,{width:"12",height:"12",name:"blocked"})}},get referralsData(){return _.get(t.tileDataStore.referrals,"current_period")||{}},reportLink:e=>_.get(t.referralsData,`report_url.${e}`,"#"),currentValue:e=>_.get(t.referralsData,`value.${e}.humanized`)}))).actions((e=>({}))),c=r.types.compose(l,n.a)}).call(this,a("q1tI"))},aetS:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r=a("99Ma").types.model("Modal",{shouldShow:!1}).actions((e=>({open:()=>{e.shouldShow=!0},close:()=>{e.shouldShow=!1},toggle:()=>{e.shouldShow=!e.shouldShow}})))},af5v:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l}));var r=a("99Ma"),n=a("B9cq"),i=a("V0vo");const o=r.types.model("AccessibleSites",{id:r.types.identifierNumber,account_id:r.types.maybeNull(r.types.number),cached_slug:"",name:"",pii:r.types.maybeNull(r.types.boolean)}),s=r.types.model("CurrentUser",{id:r.types.maybeNull(r.types.number),account_id:r.types.maybeNull(r.types.number),email:"",permission_manager:!1,role:"",show_campaign_wizard:"0",show_csp_tutorial:"0",show_new_csp:"0",staff_member:!1,accessible_sites:r.types.optional(r.types.array(o),[]),signature:r.types.maybeNull(r.types.string),isFetched:!1,tfa_enabled:!1,restrict_login_to_sso_only:!1,current_site_slug:r.types.maybeNull(r.types.string)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get site(){return this.rootStore.models.site},get staffMember(){return e.staff_member},get isReadOnlyRole(){return"read"===e.role},get isCSPOnlyRole(){return"csp_only"===e.role},get isWriteRole(){return Object(i.d)(e,"write")},get isReadRole(){return Object(i.d)(e,"read")},get isCSPRole(){return Object(i.d)(e,"csp_only")},get isReadOrCspRole(){return"csp_only"===e.role||"read"===e.role},get showNewCSP(){return"1"===e.show_new_csp},get showWizard(){return"1"===e.show_campaign_wizard},get hasPiiForCurrentSite(){return _.find(e.accessible_sites,{id:this.site.id}).pii}}))).actions((t=>{const a=e=>{Object(r.applySnapshot)(t,e)},i=Object(r.flow)((function*(){try{const{result:e}=yield Object(n.ajax)({url:Routes.current_internal_user_path({no_spinner:!0}),xhrFields:{withCredentials:!0}});a({...e.user,current_site_slug:e.current_site_slug}),t.isFetched=!0}catch(xhr){e({name:"Unable to fetch current_user data",message:"Ajax failure",xhr:xhr})}}));return{update:a,updatePiiAccessibleSites:(e,a)=>{t.accessible_sites.replace(t.accessible_sites.map((t=>({...t,pii:e===t.account_id?a:t.pii}))))},fetch:i}})),l=s.create({...window.current_user})}).call(this,a("B9cq").notifyDevelopers)},amyL:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return S}));var r=a("vOnD"),n=a("+XQG"),i=a("GaHK"),o=a("ne91"),s=a("V0vo"),l=a("vWkL"),c=a("Md/s"),p=a("yx1D"),u=a("P0Hl"),d=a("OuKs"),m=a("qqdH"),g=a("UHDK"),h=a("5Sw6"),y=a("sAvP"),f=a("sT1B");function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const v=Object(r.default)(i.UILink).withConfig({displayName:"header__LinkHelp"})(["&&{line-height:1;color:#555;transition:color 0.3s;svg{.sign-svg-fill-outer{transition:0.3s;}}&:focus,&:hover,&:active{color:",";.sign-svg-fill-outer{fill:#30a32f;}}}"],i.Theme.color.black100);let S=function(t){var a,r;function S(){return t.apply(this,arguments)||this}return r=t,(a=S).prototype=Object.create(r.prototype),a.prototype.constructor=a,b(a,r),S.prototype.render=function(){const{currentUser:t,site:a,account:r,locationRouter:b,accountCurrentSite:S,goToAnotherSite:w,className:C}=this.props,E=Object(o.b)({site:a,accountCurrentSite:S,currentUser:t}),N=Boolean(E),O=t&&Object(s.d)(t,"read"),x=t&&Object(s.d)(t,"write"),I=t&&Object(s.d)(t,"admin"),P=null==t?void 0:t.staff_member,R=null==t?void 0:t.permission_manager,j=Object(o.c)({currentSiteCachedSlug:E,currentUser:t}),D=N&&"referral"===Object(s.t)(location.pathname);return e.createElement(c.b,{className:classNames("header",C),"data-testid":"ac-header"},e.createElement(c.d,null,e.createElement("div",{className:"App-container-inner"},e.createElement(c.e,{className:classNames("flex justify-space-between align-items-center",C)},e.createElement("div",{className:"flex align-items-center"},e.createElement(u.a,{locationRouter:b,urlHome:j}),Object(o.g)({currentUser:t,locationRouter:b})&&e.createElement("div",{className:"mll"},e.createElement(g.a,{goToAnotherSite:w,site:a,currentUser:t,account:r,isSitePersisted:N,isAdmin:I,currentSiteCachedSlug:E})),N&&t&&O&&e.createElement(d.a,{site:a,currentSiteCachedSlug:E,locationRouter:b,urlHome:j})),t?e.createElement("div",{className:"flex align-items-center","data-testid":"ac-header-csp-link"},D&&e.createElement(c.c,{className:"mrl",isActive:Object(o.d)(),href:Routes.customer_service_portal_person_lookup_site_path(E),type:"customerServicePortal",locationRouter:b},e.createElement(i.UIIcon,{name:"manCircled",className:"mrd"}),e.createElement("span",null,"Customer service portal")),e.createElement(v,{href:"https://talkable.freshdesk.com/support/solutions",target:"_blank",rel:"noopener noreferrer","data-category":f.Q,"data-action":"click to help in header",className:"mrl js-ga-click"},e.createElement(i.UIIcon,{className:"mrx",name:"questionCircleWithBorder",fill:"#555"}),e.createElement("span",null,"Help")),e.createElement(c.i,null),e.createElement("div",{className:"mlm"},e.createElement(n.a,{account:r,currentUser:t,site:a,currentSiteCachedSlug:E,locationRouter:b}))):e.createElement(m.a,null))),(P||R)&&e.createElement(l.a,{isPermissionManager:R})),N&&t&&_.some(a)&&e.createElement(e.Fragment,null,"conversion"===Object(s.t)(location.pathname)&&e.createElement(h.a,{currentSiteCachedSlug:E,isSitePersisted:N,isReadRole:O,locationRouter:b}),"referral"===Object(s.t)(location.pathname)&&e.createElement(p.a,{currentSiteCachedSlug:E,isSitePersisted:N,isReadRole:O,isWriteRole:x,locationRouter:b}),"loyalty"===Object(s.t)(location.pathname)&&P&&e.createElement(y.a,{currentSiteCachedSlug:E,isSitePersisted:N,isReadRole:O,isWriteRole:x,locationRouter:b})))},S}(e.PureComponent)}).call(this,a("q1tI"))},bPB2:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("aetS"),i=a("WxVm"),o=a("AEM3"),s=a("aFzQ");const l=r.types.compose("PlacementDetails",i.a,r.types.model({}).volatile((e=>({initialIndexNumber:0,key:""}))).views((e=>({get eventCategory(){return e.placementsRootPage.getEventCategoryById(e.event_category_id)},get attachedCampaignsTest(){return e.attachedCampaigns.filter((e=>"Test"===e.status))},get attachedCampaignsDisabled(){return e.attachedCampaigns.filter((e=>"Disabled"===e.status))},get attachedCampaignsScheduled(){return e.attachedCampaigns.filter((e=>"Scheduled"===e.status))}})))),c=r.types.model("PlacementsDetailsPage",{placement:r.types.optional(l,{}),deleteModal:r.types.optional(n.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get router(){return e.rootStore.models.router},get placementsRootPage(){return Object(r.getParentOfType)(e,o.a)},isPlacementExist:t=>Boolean(e.getPlacementById(t)),getPlacementById:t=>e.placementsRootPage.placements.campaign_placements.find((e=>Number(e.id)===Number(t)))}))).actions((t=>({toggleDeleteModal(){t.placementsRootPage.placements.network.put.isLoading||t.deleteModal.toggle()},hideDeleteModal(){t.deleteModal.close()},deletePlacement:Object(r.flow)((function*(){if(_.some(t.placement.attachedCampaignsLive))try{t.hideDeleteModal(),yield t.placementsRootPage.campaignsDetacher.init({placementId:t.placement.id,detachedCampaigns:t.placement.attachedCampaignsLive.map((e=>e.toJSON()))})}catch(a){return console.warn(a),void(yield t.placementsRootPage.campaigns.apiGet())}try{t.placementsRootPage.placements.network.put.updateLoading(!0),yield t.placementsRootPage.placements.apiPut([{id:t.placement.id,_destroy:!0}]),yield t.placementsRootPage.init(),Validation.showSuccessFlash()}catch(xhr){Validation.showErrorFlash(),e({name:"Unable to delete placement",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&(t.placementsRootPage.placements.network.put.updateLoading(!1),t.hideDeleteModal())}})),init(e){t.isPlacementExist(e)&&Object(r.applySnapshot)(t,{placement:Object(s.toJS)(t.getPlacementById(e))})},reset(){Object(r.applySnapshot)(t,{})}})))}).call(this,a("B9cq").notifyDevelopers)},bPeU:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("x7QQ"),i=a("pm75");const o=r.types.compose("CachedOffersCountData",n.a.literal(),i.c).views((e=>({get siteCachedSlug(){return Object(r.getRoot)(e).siteCachedSlug},get formatted(){return _.toUpper(numeral(e.data).format("0[.][0]a"))},get isLoaded(){return e.network.get.isLoaded}}))).actions((t=>({apiGet:Object(r.flow)((function*(a){t.network.get.updateLoading(!0);try{var n;const e=yield $.ajax({url:Routes.offers_info_internal_site_campaign_path(t.siteCachedSlug,a),data:{no_spinner:!0}});t.dataUpdate(null==e||null==(n=e.result)?void 0:n.cached_offers_count),t.network.get.updateLoaded(!0)}catch(xhr){e({name:"Unable to get offers info data",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.network.get.updateLoading(!1)}}))})))}).call(this,a("B9cq").notifyDevelopers)},broW:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return _}));var r=a("99Ma"),n=a("B9cq"),i=a("V0vo"),o=a("oA8Q"),s=a("mwIZ"),l=a.n(s),c=a("3WF5"),p=a.n(c),u=a("xaJk"),d=a.n(u),m=a("TP7S"),g=a.n(m),h=a("jRrE"),y=a.n(h);const f=r.types.model("Constants",{INDUSTRIES:r.types.optional(r.types.array(r.types.string),[]),CURRENCY_SETTINGS:r.types.frozen(),PLATFORMS:r.types.frozen(),PUBLIC_KEY_URL:r.types.maybeNull(r.types.string)}),_=r.types.model("Site",{account_id:r.types.maybeNull(r.types.number),anti_fraud_by_ip_and_time_enabled:r.types.optional(r.types.maybeNull(r.types.boolean),!1),auto_approve_rewards_in_hours:r.types.maybeNull(r.types.number),allow_rewarding_auto_approved_flagged_referrals:r.types.maybeNull(r.types.boolean),allow_rewarding_auto_approved_pending_referrals:r.types.maybeNull(r.types.boolean),bcc_owner_on_reward:r.types.optional(r.types.maybeNull(r.types.boolean),!1),block_fr_by_email_or_visitor:r.types.optional(r.types.maybeNull(r.types.boolean),!1),block_fr_by_ip:r.types.optional(r.types.maybeNull(r.types.boolean),!1),block_fr_by_ip_and_user_agent:r.types.optional(r.types.maybeNull(r.types.boolean),!1),block_fr_by_similar_emails:r.types.optional(r.types.maybeNull(r.types.boolean),!1),block_fr_cross_referral:r.types.optional(r.types.maybeNull(r.types.boolean),!1),cached_slug:r.types.maybeNull(r.types.string),campaign_manager_email:r.types.maybeNull(r.types.string),campaign_manager_id:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),currency_code:r.types.maybeNull(r.types.string),currency_unit:r.types.maybeNull(r.types.string),custom_email_domain:r.types.maybeNull(r.types.string),custom_web_domain:r.types.maybeNull(r.types.string),custom_domains_consistent:!1,default_custom_domains:r.types.maybeNull(r.types.frozen()),customer_service_email:r.types.maybeNull(r.types.string),customer_service_name:r.types.maybeNull(r.types.string),enterprise_staging:r.types.optional(r.types.maybeNull(r.types.boolean),!1),event_categories:r.types.array(r.types.frozen()),focused:r.types.optional(r.types.maybeNull(r.types.boolean),!1),force_custom_web_domain_and_ssl:!1,use_custom_email_domain:!1,id:r.types.maybeNull(r.types.number),ideal_friend_timing:r.types.maybeNull(r.types.number),ideal_email_capture_timing:r.types.maybeNull(r.types.number),ignore_failed_transactions:r.types.optional(r.types.maybeNull(r.types.boolean),!1),limit_offer_email_period:r.types.maybeNull(r.types.number),loyalty_auto_signup:r.types.optional(r.types.maybeNull(r.types.boolean),!1),loyalty_current_balance_limit:r.types.maybeNull(r.types.number),loyalty_points_to_currency_conversion_rate:r.types.maybeNull(r.types.number),loyalty_referral_reward_to_points_rate:r.types.maybeNull(r.types.number),loyalty_referral_percentage_reward_to_points_rate:r.types.maybeNull(r.types.number),marketer_contact_email:r.types.maybeNull(r.types.string),monthly_licensing_cost:r.types.maybeNull(r.types.number),name:r.types.maybeNull(r.types.string),platform:r.types.maybeNull(r.types.string),physical_address:r.types.maybeNull(r.types.string),origin:r.types.maybeNull(r.types.string),referrer_reward_limit_reached_notify:r.types.optional(r.types.maybeNull(r.types.boolean),!1),reward_contact_email:r.types.maybeNull(r.types.string),self_serve_domain_creation:r.types.optional(r.types.maybeNull(r.types.boolean),!1),send_unpaid_reward_notifications:r.types.optional(r.types.maybeNull(r.types.boolean),!1),sharing_channels:r.types.array(r.types.string),sticky_advocates:r.types.optional(r.types.maybeNull(r.types.boolean),!1),success_manager_email:r.types.maybeNull(r.types.string),success_manager_id:r.types.maybeNull(r.types.number),suspicious_offer_clicks_notify:r.types.optional(r.types.maybeNull(r.types.boolean),!1),technical_contact_email:r.types.maybeNull(r.types.string),time_zone_identifier:r.types.maybeNull(r.types.string),time_zone_name:r.types.maybeNull(r.types.string),updated_at:r.types.maybeNull(r.types.string),url:r.types.maybeNull(r.types.string),url_for_fraud_visitor:r.types.maybeNull(r.types.string),web_hook_key:r.types.maybeNull(r.types.string),weekly_performance_report_enabled:r.types.optional(r.types.maybeNull(r.types.boolean),!1),industry:r.types.maybeNull(r.types.string),constants:r.types.optional(f,{}),siteAccount:r.types.optional(o.a,{}),isFetched:!1,integration_script_url:r.types.maybeNull(r.types.string),has_perclient_integration_script:r.types.optional(r.types.maybeNull(r.types.boolean),!1),shopify_coupon_auto_sync_enabled:!1,create_coupon_web_hook_exists:!1,is_version_suitable_for_placements:!1,is_version_suitable_for_static_widget:!1,min_suitable_version_for_multiple_placement_inclusions:r.types.maybeNull(r.types.string),min_suitable_version_for_placements:r.types.maybeNull(r.types.string),min_suitable_version_for_static_widget:r.types.maybeNull(r.types.string),lite_mode:r.types.maybeNull(r.types.boolean),main_level_domain:"",is_integrated:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get integrationPage(){return e.rootStore.pages.integrationPage},get siteCachedSlug(){return e.cached_slug},get showCouponAutoSyncBadge(){return e.isShopifyPlatform||e.create_coupon_web_hook_exists},get autoApproveRewardsIsActive(){return e.auto_approve_rewards_in_hours>0},get couponAutoSyncEnabled(){let t=!1;return e.create_coupon_web_hook_exists?t=!0:e.isShopifyPlatform&&(t=e.integrationPage.couponAutoSyncEnabled),t},get couponAutoSyncStatus(){return e.couponAutoSyncEnabled?"ON":"OFF"},get couponAutoSyncLink(){let t=Routes.site_web_hooks_path(e.cached_slug);return e.isShopifyPlatform&&!e.create_coupon_web_hook_exists&&(t=Routes.integration_shopify_site_path(e.cached_slug)),t},get optionsPlatform(){return p()(e.constants.PLATFORMS,((e,t)=>({label:e,value:t})))},get optionsCurrency(){return d()(e.constants.CURRENCY_SETTINGS,((e,t,a)=>(e.push({label:`${l()(t,"name")} (${l()(t,"code")}, ${l()(t,"format.unit")})`,value:l()(t,"code")}),e)),[])},get isShopifyPlatform(){return"shopify"===e.platform},getCurrencyFormatter:t=>y.a.format(t,{code:e.currency_code,precision:0}),getDateInSiteTimezone:t=>Object(i.m)({date:t,timeZone:e.time_zone_identifier}),formatDate:t=>Object(i.l)(e.getDateInSiteTimezone(t)),valueInSiteCurrency:t=>"string"===typeof t?String(e.getCurrencyFormatter(1)).replace(new RegExp(1),t):e.getCurrencyFormatter(t)}))).actions((t=>({fetch:Object(r.flow)((function*(a){try{const e=yield Object(n.ajax)({url:Routes.internal_site_path(a,{no_spinner:!0})});t.setSiteData(e.result.site),t.isFetched=!0}catch(xhr){return e({name:"Unable to fetch site data",message:"Ajax failure",xhr:xhr}),xhr}})),setSiteData:e=>{Object(r.applySnapshot)(t,e),t.siteAccount.update(l()(e,"account")),g()(window.Utils)||window.Utils.setCurrentSite(e.cached_slug)},update:Object(r.flow)((function*({site:e,no_spinner:a=!0}){yield Object(n.ajax)({type:"PATCH",url:Routes.site_path(t.siteCachedSlug,{no_spinner:a}),data:{site:e}}),yield t.rootStore.fetchSiteAndCurrentUser(t.siteCachedSlug)}))})))}).call(this,a("B9cq").notifyDevelopers)},bwsI:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("0+rQ");function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let i=function(t){var a,i;function o(e){var a;return(a=t.call(this,e)||this).setFirstPosition=e.setPaginationPosition.bind(null,1),a.setLastPosition=e.setPaginationPosition.bind(null,Math.ceil(e.data.length/e.defaultItemsPerPage)),a}return i=t,(a=o).prototype=Object.create(i.prototype),a.prototype.constructor=a,n(a,i),o.prototype.render=function(){const{data:t,setPaginationPosition:a,defaultItemsPerPage:n,paginationPosition:i,maxPaginationItems:o}=this.props,s=!_.isEmpty(t)&&t[Number(n)];let l,c,p,u=[];if(s){l=1!==i,c=t[n*i];const s=Math.ceil(t.length/n);if(s-o>0)if(p=Math.ceil(s/2),p>i){const n=o%2?Math.floor(o/2):o/2-1;for(let e=i-n,a=i;e<a;e++)t[e]&&e&&u.push(e);for(let e=i,t=o+i+1;e<t&&u.length!==o;e++)u.push(e);u=u.map((t=>e.createElement(r.a,{index:t,paginationPosition:i,setPaginationPosition:a,key:t})))}else{for(let e=i+Math.floor(o/2),t=i;e>t;e--)e>s||u.push(e);for(let e=i,t=i-o;e>t&&!(u.length===o||e>s);e--)u.push(e);u=u.reverse().map((t=>e.createElement(r.a,{index:t,paginationPosition:i,setPaginationPosition:a,key:t})))}else for(let t=0,n=s;t<n;t++)u.push(e.createElement(r.a,{index:t+1,paginationPosition:i,setPaginationPosition:a,key:t}))}return!!s&&e.createElement("div",{className:"pagination"},e.createElement("ul",null,l&&e.createElement("li",{className:"first"},e.createElement("a",{href:"#",onClick:this.setFirstPosition},"\xab First")),l&&e.createElement("li",{className:"prev"},e.createElement("a",{href:"#",onClick:a.bind(null,Number(this.props.paginationPosition)-1)},"\u2039 Prev")),u,c&&e.createElement("li",{className:"next_page"},e.createElement("a",{href:"#",onClick:a.bind(null,Number(this.props.paginationPosition)+1)},"Next \u203a")),c&&e.createElement("li",{className:"last next"},e.createElement("a",{href:"#",onClick:this.setLastPosition},"Last \xbb"))))},o}(e.PureComponent);i.defaultProps={maxPaginationItems:10,defaultItemsPerPage:10}}).call(this,a("q1tI"))},c7RZ:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("99Ma");const n=r.types.model("CouponStore",{id:r.types.maybeNull(r.types.number),code:r.types.maybeNull(r.types.string),coupon_list_id:r.types.maybeNull(r.types.number),amount:r.types.maybeNull(r.types.number),localized_amount:r.types.maybeNull(r.types.string),single_use:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get couponDetailsPath(){return Routes.site_coupon_path(e.rootStore.siteCachedSlug,e.id)},get formattedCode(){return _.toUpper(e.code)},get localizedAmountText(){return e.localized_amount?` for ${e.localized_amount}`:""},get singleUseText(){return e.single_use?"Single-use coupon":"Multi-use coupon"},get tooltipCoupon(){return`${e.singleUseText}${e.localizedAmountText}: ${e.formattedCode}\nCoupon usage: Used`}}))).actions((e=>({})))},cYkR:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("B9cq"),i=a("JHMc"),o=a("+CAZ");const s=r.types.model("ReferralDetailsStore",{name:"ReferralDetailsStore",referral:r.types.optional(i.a,{}),referralIsFetching:!0}).views((e=>({get rootStore(){return Object(r.getRoot)(e)}}))).actions((t=>({fetchReferral:Object(r.flow)((function*(a,i=!0){i&&t.updateReferralFetch(!0);try{const e=yield Object(n.ajax)({debug:!0,url:Routes.internal_site_customer_service_referral_path(t.rootStore.siteCachedSlug,a,{no_spinner:!0})});t.updateReferral(Object(o.a)(e.result.record))}catch(xhr){e({name:"Unable to fetch referral from pending referral store",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.updateReferralFetch(!1)}})),refetch(e){t.fetchReferral(e,!1)},updateReferral:e=>{t.referral=i.a.create(e),t.updateReferralFetch(!1)},updateReferralFetch:e=>{t.referralIsFetching=e}})))}).call(this,a("B9cq").notifyDevelopers)},cYwS:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("V0vo");const i=r.types.model("EventCategory",{id:r.types.number,identifier:r.types.string,monthly_events:r.types.number,monthly_referrals:r.types.number,referrable:r.types.maybeNull(r.types.boolean)}).views((e=>({get monthlyEventsFormatted(){return Object(n.o)({value:e.monthly_events})},get monthlyReferralsFormatted(){return Object(n.o)({value:e.monthly_referrals})}})))},dOPl:function(e,t,a){"use strict";a.r(t),a.d(t,"DashboardSiteRevenueTileValueStore",(function(){return g})),a.d(t,"DashboardAdvocateRewardsTileValueStore",(function(){return y})),a.d(t,"DashboardFriendRewardsTileValueStore",(function(){return b})),a.d(t,"DashboardAdvocacyRateTileValueStore",(function(){return S})),a.d(t,"DashboardCampaignPerformanceTileValueStore",(function(){return C})),a.d(t,"DashboardTalkableRevenueTileValueStore",(function(){return N})),a.d(t,"DashboardCustomizableRevenueTileValueStore",(function(){return P})),a.d(t,"DashboardReferralsTileValueStore",(function(){return F})),a.d(t,"DashboardAbstractMetricTileValueStore",(function(){return U})),a.d(t,"DashboardAllTimeMetricTileValueStore",(function(){return B}));var r=a("99Ma");const n=r.types.model("TileValueStore",{}).views((e=>({}))).actions((e=>({update:t=>{const{path:a,tileValue:r}=t;_.set(e,a,r)}})));n.create();var i=a("ZbcR"),o=a("sT1B");const s=e=>e.plain>=o.H&&e.humanized||e.formatted,l=e=>e.humanized!==e.formatted&&e.plain>o.H&&e.formatted,c=r.types.model("TileGraphPeriodSchema",{value:r.types.optional(r.types.map(r.types.frozen()),{}),report_url:r.types.maybeNull(r.types.string)}).views((e=>({}))).actions((e=>({}))),p=r.types.model("TileGraphSchema",{previous:r.types.optional(c,{}),current:r.types.optional(c,{})}).views((e=>({}))).actions((e=>({}))),u=r.types.model("TilePeriodSchema",{value:r.types.optional(i.a,{}),report_url:r.types.maybeNull(r.types.string)}),d=r.types.model("TileMetricStore",{current_period:r.types.optional(u,{}),previous_period:r.types.optional(u,{}),graph_data:r.types.optional(p,{})}).views((e=>({get currentMetricValue(){return e.current_period.value||{}},get previousMetricValue(){return e.previous_period.value||{}},get currentMetricValueReportLink(){return e.current_period.report_url||"#"},get normalizedCurrentMetricValue(){return s(e.currentMetricValue)},get normalizedPreviousMetricValue(){return s(e.previousMetricValue)},get formattedCurrentMetricValue(){return l(e.currentMetricValue)},get formattedPreviousMetricValue(){return l(e.previousMetricValue)},get isUpArrow(){return e.currentMetricValue.plain!==e.previousMetricValue.plain&&e.currentMetricValue.plain>e.previousMetricValue.plain},get isDownArrow(){return e.currentMetricValue.plain!==e.previousMetricValue.plain&&e.currentMetricValue.plain<e.previousMetricValue.plain},isGraphReady(t){let a=!1;return a=t?!_.isEmpty(e.currentPeriodGraphPlainData)&&!_.isEmpty(e.previousPeriodGraphPlainData):!_.isEmpty(e.currentPeriodGraphPlainData),a},get plainGraphData(){return e.graph_data.toJSON()||{}},get currentPeriodGraphData(){return e.plainGraphData.current.value||{}},get previousPeriodGraphData(){return e.plainGraphData.previous.value||{}},get currentPeriodGraphPlainData(){return _.values(e.currentPeriodGraphData).map((e=>e.plain))},get previousPeriodGraphPlainData(){return _.values(e.previousPeriodGraphData).map((e=>e.plain))},get bothPeriodGraphPlainData(){return _.uniq(_.concat(e.currentPeriodGraphPlainData,e.previousPeriodGraphPlainData))},get maxPeriodValue(){return _.max(e.bothPeriodGraphPlainData)},get yFormat(){return e.maxPeriodValue>1?"0.[0] a":"0.00[0] a"},get currentPeriodGraphDays(){return _.keys(e.currentPeriodGraphData||{})},get previousPeriodGraphDays(){return _.keys(e.previousPeriodGraphData||{})},get graphPeriodPoints(){return[e.currentPeriodGraphPlainData,e.previousPeriodGraphPlainData]},get graphFlattenPoints(){return _.uniq(_.flatten(e.graphPeriodPoints))},get sumGraphFlattenPoints(){return _.sum(e.graphFlattenPoints)}}))).actions((e=>({}))),m=(d.create(),r.types.model("DashboardAdvocateRewardsValue",{revenue:r.types.optional(d,{}),transactions:r.types.optional(d,{}),aov:r.types.optional(d,{}),all_time_revenue:r.types.optional(d,{})}).views((e=>({}))).actions((e=>({})))),g=r.types.compose(m,n),h=r.types.model("DashboardAdvocateRewardsValue",{rewards:r.types.optional(d,{}),coupons_redeemed:r.types.optional(d,{})}).views((e=>({}))).actions((e=>({}))),y=r.types.compose(h,n),f=r.types.model("DashboardFriendRewardsTileValue",{rewards:r.types.optional(d,{}),coupons_redeemed:r.types.optional(d,{})}).views((e=>({}))).actions((e=>({}))),b=r.types.compose(f,n),v=r.types.model("DashboardAdvocacyRateTileValue",{advocacy_percentage:r.types.optional(d,{}),sharers:r.types.optional(d,{}),sharing_rate:r.types.optional(d,{})}).views((e=>({}))).actions((e=>({}))),S=r.types.compose(v,n),w=r.types.model("DashboardCampaignPerformanceTileValue",{impressions:r.types.optional(d,{}),shares:r.types.optional(d,{}),sharers:r.types.optional(d,{}),clicks:r.types.optional(d,{}),visits:r.types.optional(d,{}),purchases:r.types.optional(d,{})}).views((e=>({}))).actions((e=>({}))),C=r.types.compose(w,n),E=r.types.model("DashboardTalkableRevenueTileValue",{revenue:r.types.optional(d,{}),transactions:r.types.optional(d,{}),aov:r.types.optional(d,{}),revenue_percentages:r.types.optional(d,{}),all_time_revenue:r.types.optional(d,{})}).views((e=>({}))).actions((e=>({}))),N=r.types.compose(E,n),O=r.types.model("CustomTilePeriodSchema",{value:r.types.optional(r.types.model({all:r.types.optional(i.a,{}),advocates_all:r.types.optional(i.a,{}),advocates_new_customers:r.types.optional(i.a,{}),advocates_existing_customers:r.types.optional(i.a,{}),advocates_all_percentage:r.types.optional(i.a,{}),friends_new_customers:r.types.optional(i.a,{}),friends_existing_customers:r.types.optional(i.a,{}),friends_all:r.types.optional(i.a,{}),friends_all_percentage:r.types.optional(i.a,{}),new_customers:r.types.optional(i.a,{}),new_customers_percentage:r.types.optional(i.a,{}),existing_customers:r.types.optional(i.a,{}),existing_customers_percentage:r.types.optional(i.a,{})}),{}),report_url:r.types.maybeNull(r.types.string)}),x=r.types.model("CustomTileMetricStore",{previous_period:r.types.optional(O,{}),current_period:r.types.optional(O,{})}).views((e=>({get currentMetricValue(){return e.current_period.value||{}},get previousMetricValue(){return e.previous_period.value||{}}}))),I=(x.create(),r.types.model("DashboardCustomizableRevenueTileValue",{aov:r.types.optional(d,{}),revenue:r.types.optional(d,{}),transactions:r.types.optional(d,{}),revenue_percentages:r.types.optional(d,{}),all_time_revenue:r.types.optional(d,{}),revenue_distribution:r.types.optional(x,{}),transactions_distribution:r.types.optional(x,{}),aov_distribution:r.types.optional(x,{})}).views((e=>({}))).actions((e=>({})))),P=r.types.compose(I,n),R=r.types.model("TileMetric",{plain:r.types.maybeNull(r.types.number),formatted:r.types.maybeNull(r.types.string),humanized:r.types.maybeNull(r.types.string)}),j=r.types.model("TileMetricValue",{approved:r.types.optional(R,{}),blocked:r.types.optional(R,{}),flagged:r.types.optional(R,{}),in_progress:r.types.optional(R,{}),pending:r.types.optional(R,{}),voided:r.types.optional(R,{})}),D=r.types.model("TileMetricReportUrlSchema",{approved:r.types.maybeNull(r.types.string),blocked:r.types.maybeNull(r.types.string),flagged:r.types.maybeNull(r.types.string),in_progress:r.types.maybeNull(r.types.string),pending:r.types.maybeNull(r.types.string),voided:r.types.maybeNull(r.types.string)}),k=r.types.model("TilePeriodSchema",{value:r.types.optional(j,{}),report_url:r.types.optional(D,{})}),T=r.types.model("TileReferralMetricStore",{current_period:r.types.optional(k,{})}),A=(T.create(),r.types.model("DashboardAdvocateRewardsValue",{referrals:r.types.optional(T,{})}).views((e=>({}))).actions((e=>({})))),F=r.types.compose(A,n),M=r.types.model("DashboardAbstractMetricTileValue",{first_metric:r.types.optional(d,{}),second_metric:r.types.optional(d,{}),third_metric:r.types.optional(d,{})}).views((e=>({}))).actions((e=>({}))),U=r.types.compose(M,n),L=r.types.model("DashboardAllTimeMetricTileValue",{metric_values:r.types.optional(d,{})}).views((e=>({}))).actions((e=>({}))),B=r.types.compose(L,n)},dQ6V:function(e,t,a){"use strict";(function(e){var t=a("dhqo"),r=a.n(t);function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Widget.AbTestsModalChooseWinnerConfirmation=function(t){var a,i;function o(){return t.apply(this,arguments)||this}return i=t,(a=o).prototype=Object.create(i.prototype),a.prototype.constructor=a,n(a,i),o.prototype.render=function(){const{data:t}=this.props;return e.createElement("div",{className:"Locale-entries-assets-uploader-static"},e.createElement("p",null,"Once you mark this variant as a Winner the A/B Test will stop and only this variant will be shown in"," ",e.createElement("strong",null,t.campaigns.length," ",r()("Campaign",t.campaigns.length))," ","that were attached to it."))},o}(e.PureComponent)}).call(this,a("q1tI"))},dSKc:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return g}));var r=a("99Ma"),n=a("zSPh"),i=a("uEXj"),o=a("5OB8"),s=a("B9cq"),l=a("nwwn"),c=a("Bb2w");const p=(e={})=>Object.keys(e).map((t=>({name:{value:t},value:{value:e[t]}}))),u=({manifestParams:e=[],valuesParams:t})=>e.map((e=>({...e,value:t[e.key]}))),d=r.types.compose(n.a,r.types.model().views((e=>({get valuesForServer(){return{id:e.id,active:e.active,configuration_override:e.configuration.valuesForServer}},get valuesToggleAction(){return{id:e.id,active:e.active}}})))),m=r.types.compose(n.b,r.types.model({data:r.types.array(d)}).views((e=>({get valuesToggleAction(){return e.data.map((e=>e.valuesToggleAction))}})))),g=r.types.compose("AppStoreEditPage",l.a,r.types.model("AppStoreEditPageBase",{id:r.types.maybeNull(r.types.number),actions:r.types.optional(m,{}),configuration:r.types.optional(i.a,{}),active:!1,redirect:!1,isLoading:!1,isOpenedDeleteModal:!1}).views((e=>({get currentApp(){return e.appStorePage.getAppById({id:e.id})},get currentManifest(){return e.appStorePage.getManifestById({id:e.id})},get isWithSteps(){var t;return _.some(null==(t=e.currentManifest)?void 0:t.actions)},get showSettings(){return _.some(e.actions.data.toJSON())},get info(){var t,a,r,n,i,o,s,l,c,p;return{title:"custom_app"===(null==(t=e.currentManifest)?void 0:t.identifier)&&e.currentApp.configuration.ui.name||(null==(a=e.currentManifest)?void 0:a.title),titleBadge:{text:null!=(r=e.currentApp)&&r.active?"ENABLED":"DISABLED",color:null!=(n=e.currentApp)&&n.active?"green":"gray"},description:null==(i=e.currentManifest)?void 0:i.description,iconUrl:e.currentManifest&&e.currentManifest.icon,iconBackground:null==(o=e.currentManifest)?void 0:o.icon_background,supportLink:null==(s=e.currentManifest)||null==(l=s.links)?void 0:l.find((e=>"support"===e.type)),websiteLink:null==(c=e.currentManifest)||null==(p=c.links)?void 0:p.find((e=>"website"===e.type))}},get isCancelShown(){return!e.configuration.isPristine||!e.actions.isPristine||!e.criteria.isPristine},get isDisabledToggleAction(){return!e.actions.isPristine||!e.configuration.isPristine||!e.criteria.isPristine},get isEditableToggleAction(){return!e.isLoading},get isDisabledToggleApp(){return!e.actions.isPristine||!e.configuration.isPristine||!e.criteria.isPristine},get isEditableToggleApp(){return!e.isLoading},get prepareInitialConfiguration(){return{params:u({manifestParams:e.currentManifest.configuration.params,valuesParams:e.currentApp.configuration.params}),ui:u({manifestParams:e.currentManifest.configuration.ui,valuesParams:e.currentApp.configuration.ui})}},get prepareInitialActions(){return e.currentApp.actions.map((t=>{var a;const r=(({actionManifests:e,actionIdentifier:t})=>e.find((e=>e.identifier===t)))({actionManifests:e.currentManifest.actions,actionIdentifier:t.identifier});return r?{...r,...t,configuration:{params:u({manifestParams:null==(a=r.configuration)?void 0:a.params,valuesParams:t.configuration.params}),extras:{data:p(t.configuration.extra_fields)}}}:{}}))}}))).actions((t=>({setAppId:({id:a})=>{try{if(t.id=Number(a),!t.currentApp)throw new Error("No app with id");t.setInitialValues()}catch(r){"No app with id"!==(null==r?void 0:r.message)&&(e({name:"App store failure",message:`Enable to init app store edit page; app id: ${t.id}`,xhr:r}),UINotifications.showErrorFlash("Something went wrong. Please try letter.")),t.leavePage()}},updateActive:(e=!1)=>{t.active=e},setInitialValues:()=>{var e;t.active=null==(e=t.currentApp)?void 0:e.active;const{params:a,ui:n}=t.prepareInitialConfiguration;Object(r.applySnapshot)(t.configuration.params,a),Object(r.applySnapshot)(t.configuration.ui,n),Object(r.applySnapshot)(t.criteria,c.a.create({value:t.currentApp.criteria,variables:t.variables,show:Boolean(t.currentApp.criteria)}).toJSON()),t.isWithSteps&&Object(r.applySnapshot)(t.actions.data,t.prepareInitialActions)},updateApp:Object(r.flow)((function*({app:e}){const{result:{app:a,app:{id:r}}}=yield Object(s.ajax)({url:Routes.internal_site_store_app_path(t.rootStore.siteCachedSlug,t.id,{no_spinner:!1}),type:"PUT",data:{app:e}});t.appStorePage.updateApp({id:r,app:a})})),deleteApp:Object(r.flow)((function*(){try{yield Object(s.ajax)({url:Routes.internal_site_store_app_path(t.rootStore.siteCachedSlug,Number(t.currentApp.id),{no_spinner:!0}),type:"DELETE"}),t.appStorePage.removeAppById({id:t.currentApp.id}),t.leavePage(),Validation.showSuccessFlash("Application was successfully deleted")}catch(a){var e;const t=null==a||null==(e=a.result)?void 0:e.error_message;t?Validation.showErrorFlash(t):Validation.showErrorFlash()}})),toggleAction:Object(r.flow)((function*({actionTitle:e,state:a}){try{t.updateLoading(!0),yield t.updateApp({app:{active:t.active,actions_attributes:t.actions.valuesToggleAction}}),t.setInitialValues(),Validation.showSuccessFlash(`Action "${e}" was ${a?"enabled":"disabled"}`)}catch(n){t.setInitialValues(),Object(o.b)({response:n,actionsErrorsHandler:t.actions.updateErrors,configurationErrorsHandler:t.configuration.updateErrors})}finally{Object(r.isAlive)(t)&&t.updateLoading(!1)}})),onSaveChanges:Object(r.flow)((function*(e){try{if(null==e||e.preventDefault(),t.configuration.checkRequiredFields(),t.actions.checkRequiredFields(),!t.actions.isValid||!t.configuration.isValid||!t.criteria.isValid)return void UINotifications.showErrorFlash();t.updateLoading(!0),yield t.updateApp({app:{configuration_override:t.configuration.valuesForServer,actions_attributes:t.actions.valuesForServer,criteria:t.criteria.value}}),t.setInitialValues(),Validation.showSuccessFlash()}catch(a){Object(o.b)({response:a,actionsErrorsHandler:t.actions.updateErrors,configurationErrorsHandler:t.configuration.updateErrors,criteriaErrorsHandler:e=>{t.criteria.setError({error:e.criteria})},onError:()=>{t.setInitialValues()}})}finally{Object(r.isAlive)(t)&&t.updateLoading(!1)}})),toggleApp:Object(r.flow)((function*(){const e=t.active;var a;(t.updateActive(!e),t.actions.data.slice().length)&&(null==(a=t.actions.data[0])||a.updateActive(!e));try{t.updateLoading(!0),yield t.updateApp({app:{active:t.active,actions_attributes:t.actions.valuesToggleAction}}),Validation.showSuccessFlash("Application was "+(t.active?"enabled":"disabled"))}catch(i){var n;t.updateActive(null==(n=t.currentApp)?void 0:n.active),Object(o.b)({response:i,actionsErrorsHandler:t.actions.updateErrors,configurationErrorsHandler:t.configuration.updateErrors})}finally{Object(r.isAlive)(t)&&t.updateLoading(!1)}})),toggleDeleteModal:()=>{t.isOpenedDeleteModal=!t.isOpenedDeleteModal},resetChanges:()=>{t.setInitialValues()},leavePage:()=>{t.router.replace(Routes.app_store_site_path(t.rootStore.siteCachedSlug)),t.resetStore()},resetStore:()=>{Object(r.applySnapshot)(t,{})}}))))}).call(this,a("B9cq").notifyDevelopers)},e96j:function(e,t,a){"use strict";(function(e){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}a.d(t,"a",(function(){return n}));let n=function(t){var a,n;function i(){return t.apply(this,arguments)||this}return n=t,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,r(a,n),i.prototype.render=function(){const{mode:t}=this.props,a=t?"incentive":"content";return e.createElement("div",null,"How to set up a campaign ",a," A/B test:")},i}(e.PureComponent)}).call(this,a("q1tI"))},eQCO:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var r=a("HzpY"),n=a("4mPH");const i=({placements:e,updatedPlacement:t})=>{let a;return{normalizedPlacements:Object(n.f)(e.map(((e,r)=>e.id===t.id?(a=r,t):e))),updatingPlacementIndex:a}},o=({category:e,campaigns:t,placementId:a})=>{const i=e=>Number(e.placement_id)===Number(a);let o=[],s=[];if(t.forEach((t=>{Object(n.c)({campaign:t,category:e})&&(null===t.placement_id||i(t))?o.push({...t,checked:i(t)}):s.push(t)})),Object(n.d)(o)){const e=o.filter((e=>!e.checked&&Object(r.d)(e)));s=[...s,...e],o=o.filter((e=>e.checked||!Object(r.d)(e)))}return{available:o,ineligible:s}}},eTCU:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return p}));var r=a("TyAF"),n=a("vOnD"),i=a("GaHK"),o=a("XKXH"),s=a("u4nQ");function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const c=n.default.ul.withConfig({displayName:"campaigns_list__CampaignsListWrapper"})(["margin-left:0;a{font-size:14px;}.campaignfilter-campaign-offers{","}.campaignfilter-campaign-id{","}"],i.Theme.typography.bodyS,i.Theme.typography.bodyD),p=Object(r.b)((({rootStore:e})=>({rootStore:e})))(Object(r.c)(function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,l(a,r),n.prototype.render=function(){const{campaigns:t,rootStore:{siteCachedSlug:a}}=this.props;return e.createElement(c,{className:"campaignfilter-list"},_.some(t)&&t.map((t=>e.createElement("div",{className:"flex justify-space-between mbm",key:t.id},e.createElement(o.a.MainInfoCell,{campaign:t,siteCachedSlug:a,divider:!1,withDate:!0},e.createElement(s.a,{key:t.key,campaign:t,siteCachedSlug:a,editMode:!1})),e.createElement(o.a.OffersCell,{align:"right",campaign:t})))),_.isEmpty(t)&&e.createElement("div",{className:"flex justify-center"},e.createElement(i.BodyS,null,"No Campaigns")))},n}(e.PureComponent)))}).call(this,a("q1tI"))},eVYL:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return d}));var r=a("99Ma"),n=a("V0vo"),i=a("B9cq"),o=a("AHpt");const s=r.types.model("FraudPoliciesStatus",{blocked:r.types.maybeNull(r.types.array(r.types.string)),flagged:r.types.maybeNull(r.types.array(r.types.string)),skipped:r.types.maybeNull(r.types.array(r.types.string)),passed:r.types.maybeNull(r.types.array(r.types.string))}),l=r.types.model("ShippingAddressFraudReportAddress",{address:r.types.maybeNull(r.types.string),match:r.types.maybeNull(r.types.boolean)}),c=r.types.model("ShippingAddressFraudReport",{addresses:r.types.optional(r.types.array(l),[]),base_address:r.types.maybeNull(r.types.string)}),p=r.types.model("ModalConfirmation",{isActiveModal:r.types.optional(r.types.boolean,!1),type:r.types.optional(r.types.string,""),value:r.types.optional(r.types.string,"")}).actions((e=>({updateModalConfirmation:({type:t,value:a,status:r})=>{e.isActiveModal=r,t&&(e.type=t),a&&(e.value=a)}}))),u=r.types.model("ProcessorEmail",{email:r.types.maybeNull(r.types.string)}),d=r.types.model("ReferralData",{id:0,fraud_details:r.types.maybeNull(r.types.string),human_track_method:r.types.maybeNull(r.types.string),status:r.types.maybeNull(r.types.string),track_method:r.types.maybeNull(r.types.string),waiting_for_approval:r.types.maybeNull(r.types.boolean),auto_approval_in_hours:r.types.maybeNull(r.types.number),child_id:r.types.maybeNull(r.types.number),parent_id:r.types.maybeNull(r.types.number),campaign:r.types.maybeNull(o.a),fraud_policies_status:r.types.maybeNull(s),shipping_address_fraud_report:r.types.maybeNull(c),synthetic_status:r.types.maybeNull(r.types.string),processing:r.types.optional(r.types.boolean,!1),isShowDetailsReferral:r.types.optional(r.types.boolean,!1),modalConfirmation:r.types.optional(p,{}),processed_at:r.types.maybeNull(r.types.string),processor:r.types.maybeNull(u),processor_known:r.types.optional(r.types.boolean,!1)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.models.site.cached_slug},get formatDateProcessedAt(){return e.processed_at?`on ${e.rootStore.models.site.formatDate(e.processed_at)}`:null},get isFraud(){return _.some(e.fraud_policies_status.flagged)||_.some(e.fraud_policies_status.blocked)},get autoApprovalHelper(){return _.isNull(e.auto_approval_in_hours)?"":0===e.auto_approval_in_hours?"soon":`within ${Object(n.y)(e.auto_approval_in_hours)}`},get processorEmail(){return e.processor?e.processor.email:"Talkable"},get fraudText(){return _.some(e.fraud_policies_status.blocked)?"Blocked":"Flagged"},get fraudReasons(){return _.some(e.fraud_policies_status.blocked)?e.fraud_policies_status.blocked:e.fraud_policies_status.flagged},get humanizedFraudReasons(){return e.fraudReasons.join(",\n")},get likeApproved(){return["approved"].includes(e.status)},get likePending(){return["pending","in_progress"].includes(e.status)},get likeVoided(){return["voided","blocked"].includes(e.status)},get referralsStore(){return Object(r.getParent)(e,3)},get referralsStoreName(){return e.referralsStore.name},get referralDetailsStore(){return Object(r.getParent)(e,2)},get isReferralDetailsStore(){return"ReferralDetailsStore"===e.referralDetailsStore.name},get referralDetails(){return Routes.site_referral_path(e.siteCachedSlug,e.id)},get statusUnblockedReferral(){return"approved"===e.status&&e.parent_id},tieredAdvocateIncentives:t=>e.campaign.tiered&&"advocate"===t&&"force_generated"!==e.track_method}))).actions((t=>({addToBlacklist:({type:e,value:a})=>{t.rootStore.models.site.siteAccount.addToBlacklist({type:`${e}s`,value:a})},toggleShowDetailsReferral:()=>{t.isShowDetailsReferral=!t.isShowDetailsReferral},referralAction:Object(r.flow)((function*({url:e,action:a,referralLocation:r}){t.freeze();try{switch(yield Object(i.ajax)({url:e,type:"PUT"}),Validation.succeed(),r){case"csp_person_referral_details":yield t.referralDetailsStore.fetchReferral(t.id);break;case"csp_person_referrals_table":yield t.referralsStore.fetchReferral(t.id);break;case"csp_referrals_table":t.setSyntheticStatus(a),t.referralsStore.currentPerson.loadReferrals(),t.referralsStore.fetchCount();break;case"csp_referral_details":t.referralDetailsStore.fetchReferral(t.id),t.referralsStore.currentPerson.loadReferrals(),t.referralsStore.removeReferral(t.id),t.referralsStore.fetchData()}t.unfreeze()}catch(xhr){throw Validation.fail(_.get(xhr,"responseJSON.result.errors")||xhr.responseJSON),t.unfreeze(),new Error("Unable update referral")}})),freeze:()=>{t.processing=!0},unfreeze:()=>{Object(r.isAlive)(t)&&(t.processing=!1)},approveReferral:a=>t.referralAction({url:Routes.approve_internal_site_customer_service_referral_path(t.siteCachedSlug,t.id),action:"approve",referralLocation:a}).catch((t=>{e({name:"Unable to approve referral",message:"Ajax failure",xhr:t})})),voidReferral:a=>t.referralAction({url:Routes.void_internal_site_customer_service_referral_path(t.siteCachedSlug,t.id),action:"void",referralLocation:a}).catch((t=>{e({name:"Unable to void referral",message:"Ajax failure",xhr:t})})),setSyntheticStatus:e=>{t.synthetic_status={approve:"approved",void:"voided"}[e]}})))}).call(this,a("B9cq").notifyDevelopers)},f1uX:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return b}));var r,n,i=a("TyAF"),o=a("vOnD"),s=a("GaHK"),l=a("JAXR"),c=a("ko0n"),p=a("pW1z"),u=a("pQ8y");function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const m=o.default.div.withConfig({displayName:"info_sidebar_container__Wrapper"})(["position:fixed;top:0;bottom:0;z-index:1021;background-color:#fff;",";",";"],(({align:e})=>e&&Object(o.css)(["",":0"],e)),(({state:e,width:t,align:a})=>{const r="right"===a?t:`-${t}`;switch(e){case"exited":case"entering":return Object(o.css)(["transform:translateX(",");"],r);case"entered":return Object(o.css)(["transform:translateX(0);box-shadow:0 2px 20px 0 rgba(0,0,0,0.16);transition:transform 0.25s;"])}})),g=o.default.div.withConfig({displayName:"info_sidebar_container__Container"})(["position:relative;",";height:100%;display:flex;flex-direction:column;box-shadow:1px 0 0 #e6e6e6;"],(e=>e.width&&`width: ${e.width}`)),h=o.default.div.withConfig({displayName:"info_sidebar_container__Header"})(["background-color:#fff;padding-top:20px;padding-bottom:1px;box-shadow:inset 0 -1px 0 #ebebeb;"]),y=o.default.div.withConfig({displayName:"info_sidebar_container__Title"})(["margin-bottom:20px;padding:0 30px;color:#333;font-family:'gotham-htf-bold',Arial,sans-serif;font-size:27px;line-height:32px;"]),f=o.default.div.withConfig({displayName:"info_sidebar_container__Main"})(["background-color:#fff;padding:20px 0;overflow-y:auto;overflow-x:hidden;flex-grow:1;"]),_=o.default.span.withConfig({displayName:"info_sidebar_container__Close"})(["position:absolute;top:10px;right:10px;cursor:pointer;.sign-svg{fill:rgba(0,0,0,0.4);stroke:rgba(0,0,0,0.15);}&:hover .sign-svg{fill:rgba(0,0,0,0.8);stroke:rgba(0,0,0,0.3);}"]),b=Object(i.c)((n=r=function(t){var a,r;function n(...a){var r;return(r=t.call(this,...a)||this).handleEscape=e=>{"Escape"!==e.key&&27!==e.keyCode||r.props.onClose()},r.renderMainContent=()=>{const{isFetched:t,content:a,infoSidebarStore:n}=r.props;return t?a?a():e.createElement(l.a,{infoSidebarStore:n}):e.createElement(s.UILoader,null)},r}r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,d(a,r);var i=n.prototype;return i.componentDidMount=function(){document.addEventListener("keydown",this.handleEscape)},i.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleEscape)},i.render=function(){const{show:t,width:a,onClose:r,isFetched:n,title:i,content:o,infoSidebarStore:s,align:l}=this.props;return e.createElement(u.a,{in:t,timeout:0,classNames:""},(t=>e.createElement(m,{className:"js-keep-propagating",state:t,width:a,align:l,"data-testid":"ac-info-sidebar-container"},e.createElement(g,{className:"info-sidebar-bar",width:a},e.createElement(h,{className:"info-sidebar-bar-header"},e.createElement(y,null,i()),e.createElement(_,{className:"modal-close",onClick:r}),!o&&e.createElement(c.a,{infoSidebarStore:s}),!o&&n&&e.createElement(p.a,{infoSidebarStore:s})),e.createElement(f,{className:"info-sidebar-bar-main"},this.renderMainContent())))))},n}(e.Component),r.defaultProps={width:"480px",title:()=>null,isFetched:!0,align:"right"},n))}).call(this,a("q1tI"))},fEXv:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return p}));var r=a("TyAF"),n=a("GaHK"),i=a("vOnD"),o=a("fRW6"),s=a("mUBM");function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const c=Object(i.default)(n.UIFormTip).withConfig({displayName:"campaign_copy_step_copying__RecommendationText"})(["margin-bottom:20px;font-size:14px;line-height:24px;"]),p=Object(r.b)((({campaignCopyStore:e})=>({campaignCopyStore:e})))(Object(r.c)(function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,l(a,r),n.prototype.render=function(){const{campaignCopyStore:{haveConflictsByType:t,checkingTypes:a,isThemeStoreSite:r,errors:n}}=this.props;return e.createElement(e.Fragment,null,e.createElement(c,{font:"book"},r?t.assets&&"We found some conflicts during the campaign copy check. These are not critical errors but rather some conflicts due to which some data cannot be copied to a newly created campaign.":"Just making sure you are aware of the following campaign copy policies."),a.map((t=>e.createElement("div",{key:t.type,className:"mbl"},e.createElement(s.a,{checkingType:t})))),Object(o.a)(n.base))},n}(e.PureComponent)))}).call(this,a("q1tI"))},fRW6:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return r}));const r=t=>t&&e.createElement("div",{className:"form-validation","data-testid":"ac-form-validation"},t.join(", "))}).call(this,a("q1tI"))},fcK3:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("aetS"),i=a("t/S2");const o=r.types.model("RulesEditStore",{data:r.types.optional(i.a,{}),initialData:r.types.optional(i.a,{}),type:r.types.maybeNull(r.types.string),category_id:r.types.maybeNull(r.types.number),deleteModal:r.types.optional(n.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get loyaltyRulesRootStore(){return Object(r.getParent)(e)},get ruleCategoriesStore(){return e.loyaltyRulesRootStore.ruleCategoriesStore},get rulesStore(){return e.loyaltyRulesRootStore.rulesStore},get rulePutStatus(){return e.rulesStore.network.put.status},get ruleDeleteStatus(){return e.rulesStore.network.delete.status},get isAvailableForUpdateAction(){return"in_progress"!==e.rulePutStatus&&"success"===e.rulesStore.network.get.status},get isAvailableForDeleteAction(){return"in_progress"!==e.ruleDeleteStatus&&"success"===e.rulesStore.network.get.status},get isAvailableForAction(){return e.isAvailableForUpdateAction&&e.isAvailableForDeleteAction},get isPristine(){return _.isEqual(_.omit(e.initialData.toJSON(),"showCriteriaFieldTextArea"),_.omit(e.data.toJSON(),"showCriteriaFieldTextArea"))}}))).actions((t=>({init(e={}){if(!e.rule_id)throw new Error("Need to provide rule_id");{const{rule:a,category:r}=t.loyaltyRulesRootStore.getRuleDataWithCategory(Number(e.rule_id));if(!a)throw new Error(`No rule with id ${e.rule_id}`);const n=t.loyaltyRulesRootStore.variablesStore.getVariablesByType(a.type);t.updateData({...a,criteria_sample_interpolations:n,identifier:null==r?void 0:r.identifier})}},updateData(e){t.data.updateData(e),Object(r.applySnapshot)(t.initialData,e)},handleUpdate:Object(r.flow)((function*(a){null==a||a.preventDefault(),null==a||a.stopPropagation();try{const{data:e}=t.data.prePareDataForServer;delete e.type,yield t.rulesStore.apiPut({campaignId:t.loyaltyRulesRootStore.campaign.id,ruleId:t.data.id,data:{rule:e}}),yield t.loyaltyRulesRootStore.init(),t.init({rule_id:t.data.id}),UINotifications.showSuccessFlash()}catch(xhr){if(422!==(null==xhr?void 0:xhr.status))e({message:`Unable to update Loyalty rule ${t.data.id}`,name:"Ajax failure",xhr:xhr}),UINotifications.showErrorFlash();else{var r,n;const e=null==(r=xhr.responseJSON)||null==(n=r.result)?void 0:n.errors;t.data.updateErrors(e),e.icon&&UINotifications.showErrorFlash(e.icon)}throw new Error("Unable update loyalty rule")}})),handleDelete:Object(r.flow)((function*(e){null==e||e.preventDefault(),t.handleDiscardChanges();try{yield t.rulesStore.apiDelete({campaignId:t.loyaltyRulesRootStore.campaign.id,ruleId:t.data.id}),yield t.loyaltyRulesRootStore.init(),UINotifications.showSuccessFlash("Action was successfully deleted")}catch(e){t.data.updateErrors(e),UINotifications.showErrorFlash()}})),reset(){Object(r.applySnapshot)(t,{})},handleDiscardChanges(){Object(r.applySnapshot)(t.data,t.initialData.toJSON())},openDeleteModal(){t.deleteModal.open()},closeDeleteModal(){t.deleteModal.close()}})))}).call(this,a("B9cq").notifyDevelopers)},fcLJ:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("x7QQ"),i=a("pm75"),o=a("B9cq");const s=r.types.model({amount:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),expires_at:r.types.maybeNull(r.types.string),id:r.types.identifierNumber,localized_amount:"",name:r.types.maybeNull(r.types.string),percentage_discount:r.types.maybeNull(r.types.boolean),site_id:r.types.maybeNull(r.types.number),updated_at:r.types.maybeNull(r.types.string),total_coupons_count:r.types.maybeNull(r.types.number)}).views((e=>({get selectLabel(){return`${e.name} (${e.localized_amount}), ${e.expires_at?`expires at ${dayjs(list.expires_at).format("MM/DD/YYYY")}`:"never expires"} `}}))),l=r.types.compose("CouponListsDataStore",n.a.map(s),r.types.model("CustomNetworkModel",{network:r.types.optional(r.types.model({getAll:r.types.optional(i.a,{}),getOneById:r.types.optional(i.a,{})}),{})})).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get couponLists(){return Array.from(e.data.values())},getCouponListById:t=>e.data.get(t)}))).actions((t=>({apiGetAll:Object(r.flow)((function*(a){try{t.network.getAll.update("in_progress");const e=yield Object(o.ajax)({url:Routes.internal_site_coupon_lists_path(t.siteCachedSlug,{no_spinner:!0,space:a})});t.update(e.result.coupon_lists),t.network.getAll.update("success")}catch(xhr){e({name:`Unable to get coupon ${a} lists`,message:"Ajax failure",xhr:xhr}),t.network.getAll.update("error")}})),apiGetOneById:Object(r.flow)((function*({id:a,space:r}){try{t.network.getOneById.update("in_progress");const e=(yield Object(o.ajax)({url:Routes.internal_site_coupon_list_path(t.siteCachedSlug,a,{no_spinner:!0,space:r})})).result.coupon_list;t.data.set(e.id,e),t.network.getOneById.update("success")}catch(xhr){e({name:`Unable to get coupon ${r} list with id: ${a}`,message:"Ajax failure",xhr:xhr}),t.network.getAll.update("error")}})),update(e){e.forEach((e=>t.data.set(e.id,s.create(e))))},reset(){Object(r.applySnapshot)(t,{})}})))}).call(this,a("B9cq").notifyDevelopers)},fes7:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return m}));var r=a("vOnD"),n=a("TyAF"),i=a("GaHK");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let c=function(t){function a(a){var r;return(r=t.call(this,a)||this).refTextarea=e.createRef(),r}s(a,t);var r=a.prototype;return r.componentDidMount=function(){autosize(this.refTextarea.current)},r.render=function(){return e.createElement(p,o({ref:this.refTextarea},this.props))},a}(e.PureComponent);const p=r.default.textarea.withConfig({displayName:"placement_patterns__RegexpPreviewStyle"})(["width:100%;background-color:rgba(51,51,51,0.03) !important;box-shadow:none !important;color:",";resize:none;box-sizing:border-box;font-size:12px;font-family:Monaco,Menlo,Consolas,'Courier New',monospace;cursor:auto !important;max-height:350px;"],i.Theme.color.black100),u=Object(r.default)(i.UILink).withConfig({displayName:"placement_patterns__UILinkStyledOverride"})(["max-width:100%;span{min-width:0;overflow:hidden;text-overflow:ellipsis;}svg{flex-shrink:0;}"]),d=({patternData:t})=>t.showPreview?t.pattern?e.createElement("div",{className:"flex align-items-center mbs"},e.createElement(u,{className:"ac-preview-link placements-pattern-preview-link",target:"_blank",href:t.previewUrl},e.createElement(i.UIIcon,{name:"eyeBlank",className:"ac-preview-icon mrs"}),e.createElement("span",null,t.pattern))):e.createElement("div",{className:"flex align-items-center mbs"},e.createElement(u,{className:"ac-preview-link placements-pattern-preview-link",target:"_blank",href:t.previewUrl},e.createElement(i.UIIcon,{name:"eyeBlank",className:"ac-preview-icon mrs"})),e.createElement(i.BodyS,{className:"ac-default-text"},"All pages")):t.regexp?e.createElement("div",{className:"mbs"},e.createElement("div",{className:"flex align-items-center mbs"},e.createElement("div",{className:"flex align-items-center","aria-label":"Does not have preview","data-balloon-pos":"up","data-balloon-length":"medium"},e.createElement(i.UIIcon,{name:"eyeRestricted",className:"ac-no-preview-icon mrs",fill:i.Theme.color.link})),e.createElement(i.BodyS,{bold:!0,className:"ac-regexp-title mrs"},"Regular expression"),!t.pattern&&e.createElement(i.BodyS,{className:"ac-default-text"},"All pages")),t.pattern&&e.createElement(c,{className:"ac-regexp-pattern",disabled:!0,value:t.pattern})):e.createElement("div",{className:"flex align-items-center mbs"},e.createElement("div",{className:"flex align-items-center","aria-label":"Does not have preview","data-balloon-pos":"up","data-balloon-length":"medium"},e.createElement(i.UIIcon,{name:"eyeRestricted",className:"ac-no-preview-icon mrs",fill:i.Theme.color.link})),e.createElement(i.BodyS,{className:"ac-no-preview-text"},t.pattern||"All pages")),m=Object(n.c)(function(t){function a(){return t.apply(this,arguments)||this}return s(a,t),a.prototype.render=function(){const{patterns:t}=this.props;return t.map(((t,a)=>e.createElement(d,{patternData:t,key:a})))},a}(e.PureComponent))}).call(this,a("q1tI"))},fnrr:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("vOnD");function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const i=r.default.div.withConfig({displayName:"scroll_shadow__ScrollableWrapper"})(["display:flex;flex:1 1 auto;width:100%;position:relative;min-height:0;&::before{content:'';position:absolute;top:0;left:0;right:0;height:","px;background:",";z-index:10;}&::after{content:'';position:absolute;bottom:0;left:0;right:0;height:","px;background:",";z-index:10;}"],(({size:e})=>e),(({topShadowActiveColor:e})=>e),(({size:e})=>e),(({bottomShadowActiveColor:e})=>e)),o=r.default.div.withConfig({displayName:"scroll_shadow__ScrollableContent"})(["flex:1 1 auto;overflow-y:auto;overflow-x:hidden;display:flex;flex-direction:column;&::before{content:'';height:","px;width:100%;background:",";flex-shrink:0;z-index:11;transform:translate3d(0,0,0);}&::after{content:'';height:","px;width:100%;background:",";flex-grow:1;flex-shrink:0;z-index:11;transform:translate3d(0,0,0);}"],(({size:e})=>e),(({topShadowInactiveColor:e})=>e),(({size:e})=>e),(({bottomShadowInactiveColor:e})=>e));let s=function(t){var a,r;function s(){return t.apply(this,arguments)||this}return r=t,(a=s).prototype=Object.create(r.prototype),a.prototype.constructor=a,n(a,r),s.prototype.render=function(){const{children:t,height:a,maxHeight:r,bottomShadowColors:n,topShadowColors:s,shadowSize:l}=this.props,c={height:a,maxHeight:r};return e.createElement(i,{size:l,topShadowActiveColor:s.active,bottomShadowActiveColor:n.active},e.createElement(o,{size:l,topShadowInactiveColor:s.inactive,bottomShadowInactiveColor:n.inactive,style:c},t))},s}(e.PureComponent);s.defaultProps={shadowSize:8,topShadowColors:{inactive:"#fff",active:"radial-gradient(at top, rgba(0, 0, 0, 0.2), transparent 70%)"},bottomShadowColors:{inactive:"#fff",active:"radial-gradient(at bottom, rgba(0, 0, 0, 0.2), transparent 70%)"}}}).call(this,a("q1tI"))},g1Iw:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("micW");const i=r.types.model("StaticWidgets",{data:r.types.optional(r.types.map(n.a),{})}).views((e=>({staticWidget:({id:t})=>e.data.get(t)}))).actions((e=>({add:({id:t,campaign_id:a})=>{!e.data.has(t)&&e.data.put(n.a.create({id:t,campaign_id:a}))},createStaticWidgetStore:({siteCachedSlug:t,campaign_id:a})=>{const r=`${t}_${a}`;return e.add({id:r,campaign_id:a}),e.staticWidget({id:r})}})))},gQCd:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return d}));var r=a("aFzQ"),n=a("99Ma"),i=a("cr+I"),o=a.n(i),s=a("aetS"),l=a("TN/B"),c=a("WFLV");const p="show-campaign-new-modal",u=n.types.compose("CreateModal",s.a,n.types.model({}).views((()=>({}))).actions((e=>({init:()=>{e.shouldShow="true"===_.get(o.a.parse(window.location.search),p)}})))),d=n.types.model("CampaignsNewPage",{campaignsTypes:n.types.optional(l.b,{}),createModal:n.types.optional(u,{}),campaignNewForm:n.types.optional(c.a,{})}).views((e=>({get rootStore(){return Object(n.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get router(){return e.rootStore.models.router},get sitePlacements(){return e.rootStore.models.sitePlacements},getCampaignNewRoute:({preset_name:t,appearance:a})=>Routes.site_new_campaign_path(e.rootStore.siteCachedSlug,{[p]:!0,preset_name:t,appearance:a}),get isLoaded(){return e.sitePlacements.isFetched&&e.campaignsTypes.network.get.isLoaded},get dataForServer(){if(e.rootStore.isReferralSpace)return{preset_name:e.campaignNewForm.campaignTemplate.preset_name,appearance:e.campaignNewForm.selectedPlacement.appearance,placement_id:e.campaignNewForm.placement_id,name:e.campaignNewForm.name,gdpr_and_ccpa_enabled:e.campaignNewForm.gdpr_and_ccpa_enabled};if(e.rootStore.isConversionSpace)return{preset_name:e.campaignNewForm.campaignTemplate.preset_name,appearance:"popup",name:e.campaignNewForm.name,type:"email_capture"};if(e.rootStore.isLoyaltySpace)return{preset_name:e.campaignNewForm.campaignTemplate.preset_name,appearance:"widget",name:e.campaignNewForm.name,type:"loyalty"};throw new Error("undefined space")}}))).actions((t=>({reset:()=>{Object(n.applySnapshot)(t,{})},init:Object(n.flow)((function*(){try{yield t.campaignsTypes.fetchCampaignTemplates(),t.createModal.init();const e=t.campaignsTypes.getCampaignTemplate({preset_name:_.get(o.a.parse(window.location.search),"preset_name",""),appearance:_.get(o.a.parse(window.location.search),"appearance","")});e&&t.campaignNewForm.init({campaignTemplate:e,name:e.default_name})}catch(xhr){e({name:"Unable to init new campaign",message:"Ajax failure",xhr:xhr})}})),updateQueryStringParams:({show:e,preset_name:a,appearance:r})=>{t.router.push(Routes.new_campaign_site_path(t.siteCachedSlug,t.rootStore.urlSpaceParameter,{[p]:e,preset_name:a,appearance:r}))},openCampaignNewForm:({campaignTemplate:e})=>{t.createModal.open(),t.campaignNewForm=c.a.create({campaignTemplate:Object(r.toJS)(e),name:e.default_name}),t.updateQueryStringParams({show:!0,preset_name:e.preset_name,appearance:e.appearance})},closeCampaignNewForm:()=>{t.createModal.close(),t.campaignNewForm.reset(),t.router.push(Routes.new_campaign_site_path(t.siteCachedSlug,t.rootStore.urlSpaceParameter))},createCampaign:Object(n.flow)((function*(a){null==a||a.preventDefault();try{var r;if(t.rootStore.isReferralSpace&&(t.campaignNewForm.validate(),t.campaignNewForm.haveErrors))return"not valid";t.campaignNewForm.updateSubmitting(!0);const e=yield t.rootStore.services.campaignsNetworkService.apiPost({data:t.dataForServer,queryParams:{no_spinner:!0}});UINotifications.add({text:"Campaign created",type:"success"}),t.router.push(Routes.site_campaign_path(t.siteCachedSlug,t.rootStore.urlSpaceParameter,null==e||null==(r=e.result)?void 0:r.id))}catch(xhr){var n;t.campaignNewForm.updateErrors((null==xhr||null==(n=xhr.responseJSON)?void 0:n.result)||{}),t.campaignNewForm.updateSubmitting(!1),UINotifications.add({text:"Campaign wasn't created",type:"error"}),e({name:"Unable to create campaign",message:"Ajax failure",xhr:xhr})}}))})))}).call(this,a("B9cq").notifyDevelopers)},gXXH:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("x7QQ"),i=a("pm75");const o=r.types.compose("UserIpAddressData",n.a.literal(""),i.c,r.types.model({}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug}}))).actions((t=>({apiGet:Object(r.flow)((function*(){t.network.get.updateLoading(!0);try{const{result:e}=yield $.ajax({url:Routes.ip_address_internal_site_campaigns_path(t.siteCachedSlug)});t.dataUpdate(e.ip_address),t.network.get.updateLoading(!1)}catch(xhr){t.network.get.updateLoading(!1),e({name:"Unable to get ip address",message:"Ajax failure",xhr:xhr})}}))}))))}).call(this,a("B9cq").notifyDevelopers)},gpnO:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a("99Ma");const n=r.types.model({id:r.types.maybeNull(r.types.number),active:!1,campaign_id:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),deactivated_at:r.types.maybeNull(r.types.string),icon_url:r.types.maybeNull(r.types.string),multiplier:1,name:"",secret:!1,threshold:0});var i=a("vrPu"),o=a("dhqo"),s=a.n(o);const l=r.types.compose("LoyaltyTier",n,r.types.model({})).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignRulesStore(){return Object(r.getParentOfType)(e,i.a)},get thresholdInUnit(){return this.getThresholdInUnit(e.threshold)},getThresholdInUnit(e){return"points"===this.campaignRulesStore.values.tiers_metric_identifier?s()("point",e,!0):this.rootStore.models.site.valueInSiteCurrency(e)}})))},ho87:function(e,t,a){"use strict";(function(e){var r=a("i8i4"),n=a("mwIZ"),i=a.n(n);const o={getProps:function(e){const t=i()(e,"dataset.props","{}");return JSON.parse(t)},findComponentNode:function(e){return document.querySelector(`[data-component="${e}"]`)},renderComponent:function(t,a){if(!a)return console.error("No component was passed to renderComponent()");Object(r.render)(e.createElement(a,this.getProps(t)),t)},render:function(e,t){const a=this.findComponentNode(t);if(!a)return console.error(`No element found with data-component='${t}' attribute`);this.renderComponent(a,e)},unmount:function(e){const t=this.findComponentNode(e);if(!t)return console.error(`No element found with data-component='${e}' attribute`);Object(r.unmountComponentAtNode)(t)}};t.a=o}).call(this,a("q1tI"))},huDt:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),Widget.AbTestsModalConstants={existingTemplate:{headerParams:{title:"Add to existing A/B Test",text:"Do you want to add this campaign to the existing A/B Tests you already have for "},footerParams:{buttonText:"Create new A/B Test"}},unsavedChangesTemplate:{headerParams:{title:"Warning",text:"You have changes on the page. Do you want to leave without saving them?"},footerParams:{buttonText:"Leave"}},confirmationTemplateHasWinner:{headerParams:{title:"Confirmation",text:"You already have a Winner. Once you mark this variant as a Winner, the A/B Test will stop and only this variant will be shown in your Campaigns."},footerParams:{buttonText:"Mark As Winner"}},confirmationTemplateUnmarkWinner:{headerParams:{title:"Confirmation",text:"Once you unmark the variant as a Winner, the A/B Test will start again and all variants in this A/B Test will start to be shown in the Campaigns."},footerParams:{buttonText:"Unmark As Winner"}},confirmationTemplateMarkWinner:{headerParams:{title:"Confirmation",text:"Once you mark this variant as a Winner, the A/B Test will stop and only this variant will be shown in your Campaigns."},footerParams:{buttonText:"Mark As Winner"}},createNewTemplate:{headerParams:{title:"Create a New Content A/B Test"}},confirmDeletePopup:{headerParams:{title:"Confirmation"},footerParams:{buttonText:"Delete A/B Test",buttonType:"is-danger"}},confirmDeleteVariantPopup:{headerParams:{title:"Confirmation"},footerParams:{buttonText:"Delete Variant",buttonType:"is-danger"}},confirmChooseWinnerPopup:{headerParams:{title:"Confirmation"},footerParams:{buttonText:"Set as Winner"}}};const r=[{className:"text",text:"Copy",rules:function(e){return _.includes(["string","message"],e.trait)&&0===e.enum_values.length}},{className:"asset",text:"Images",rules:function(e){return"asset"===e.trait||"share_image"===e.trait}},{className:"color",text:"Color",rules:function(e){return"color"===e.trait}},{className:"enum",text:"Configuration",rules:function(e){return 0!==e.enum_values.length}}];Widget.timestamps=[{value:86400,dimension:"day"},{value:3600,dimension:"hour"},{value:60,dimension:"minute"},{value:1,dimension:"second"}]},"iY+z":function(e,t,a){"use strict";(function(e){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}a.d(t,"a",(function(){return n}));let n=function(t){var a,n;function i(...e){var a;return(a=t.call(this,...e)||this).changeAbTestVariant=()=>{a.props.changeAbTestVariant(a.props.index)},a}return n=t,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,r(a,n),i.prototype.render=function(){const{index:t,abTestVariantChosen:a}=this.props,r=UI.ALPHABET.charAt(t),n=classNames("base-btn is-small is-flex",{"is-pressed":t===a});return e.createElement("div",{className:n,"data-index":t,onClick:this.changeAbTestVariant},e.createElement("span",null,r))},i}(e.PureComponent)}).call(this,a("q1tI"))},iZUv:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return y}));var r=a("99Ma"),n=a("Ttsf"),i=a("cr+I"),o=a.n(i),s=a("dhqo"),l=a.n(s),c=a("GdP4"),p=a("sT1B"),u=a("3u+K");const d={status:"all",preset_name:"all",tag_name:"all",appearance:"all",query:""},m=r.types.model("CampaignsFilter",d),g=r.types.compose("CampaignWarningsByCampaign",u.a,r.types.model({id:r.types.identifierNumber})),h=r.types.model("CampaignsWarnings",{campaigns:r.types.map(g)}).views((e=>({getCampaignSignificantWarningsTitle(t){const a=e.campaigns.get(String(t));if(!a)return"";const r=a.significantWarnings.length;return r?`The campaign has ${r} critical ${l()("warning",r)}. Click to visit QA tab for details.`:""}}))).actions((e=>({initCampaign(t){e.campaigns.put({id:t});e.campaigns.get(String(t)).startPolling({id:t,count:0})},killAjaxRequests:()=>{e.campaigns.forEach((e=>{e.killAjaxRequests()}))}}))),y=r.types.model("CampaignsIndex",{campaignsGroups:r.types.optional(r.types.map(n.a),{live:{status:"live"},scheduled:{status:"scheduled"},test:{status:"test"},disabled:{status:"disabled"}}),campaigns_filter:r.types.optional(m,{...d,...o.a.parse(window.location.search)}),campaignsWarnings:r.types.optional(h,{}),campaignTagNames:r.types.optional(r.types.array(r.types.string),[])}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get site(){return e.rootStore.models.site},get siteCachedSlug(){return e.site.siteCachedSlug},get isFetchedCampaigns(){return p.h.reduce(((t,a)=>t&&e.campaignsGroups.get(a).isFetched),!0)},get totalCampaigns(){return p.h.reduce(((t,a)=>t+e.campaignsGroups.get(a).campaigns.size),0)},get totalCampaignsByFilters(){return"all"===e.campaigns_filter.status?p.h.reduce(((t,a)=>t+e.campaignsGroups.get(a).getCampaignsByFilters.length),0):e.campaignsGroups.get(e.campaigns_filter.status).getCampaignsByFilters.length},get urlParams(){return Object(c.a)(e.campaigns_filter)},get clearPath(){return Routes.site_campaigns_path(e.siteCachedSlug)},get optionsCampaignsFilters(){const t=(e=[],t="Any")=>[{label:t,value:"all"},...e];return{status:t(p.g,"Any status"),appearance:t(p.i,"Any placement category"),preset_name:t(p.j,"Any type"),tag_name:t(e.campaignTagNames.map((e=>({label:e,value:e}))),"Any tag")}},get campaignsABTestCount(){return e.rootStore.models.siteSplitTests.data.reduce(((e,t)=>(t.campaigns.forEach((t=>{const a=t.id;e[a]=(e[a]||0)+1})),e)),{})},campaignsPathWithQueryParams:()=>e.rootStore.isReferralSpace?Routes.site_campaigns_path(e.siteCachedSlug,e.urlParams):e.rootStore.isConversionSpace?Routes.campaigns_site_path(e.siteCachedSlug,"conversion",e.urlParams):void 0,get showNavNewCampaignButton(){return e.rootStore.models.currentUser.isWriteRole&&!e.rootStore.isLoyaltySpace}}))).actions((t=>{let a=null;return{fetchCampaigns(){p.h.forEach((e=>{t.campaignsGroups.get(e).fetchCampaignsGroup()}))},fetchCampaignsForCreate:Object(r.flow)((function*(){window.showSpinner();try{yield Promise.all([t.campaignsGroups.get("live").fetchCampaignsGroup(),t.campaignsGroups.get("scheduled").fetchCampaignsGroup()]),window.hideSpinner()}catch{window.hideSpinner()}})),onChangeCampaignsFilter({name:e,value:a}){t.campaigns_filter[e]=a,t.updateQueryParamsByCampaignsFilter()},updateQueryParamsByCampaignsFilter(){clearTimeout(a),a=setTimeout((()=>{p.h.forEach((e=>{t.campaignsGroups.get(e).setPaginationPosition(1)})),t.rootStore.models.router.push(t.campaignsPathWithQueryParams(t.siteCachedSlug,t.urlParams))}),500)},onChangeCampaignsFilterQuery(e){t.onChangeCampaignsFilter({name:e.target.name,value:e.target.value})},onChangeCampaignsFilterSelect({name:e,selectedOption:a}){t.onChangeCampaignsFilter({name:e,value:a.value})},clearCampaignsFilter(){_.mapKeys(t.campaigns_filter,((e,a)=>{switch(a){case"query":t.campaigns_filter[a]="";break;default:t.campaigns_filter[a]="all"}})),t.updateQueryParamsByCampaignsFilter()},fetchCampaignTagNames:Object(r.flow)((function*(){try{const e=yield t.rootStore.services.campaignsNetworkService.apiGetManyCampaignsTags();t.updateCampaignTagName(_.get(e,"result.campaign_tags",[]))}catch(xhr){e({name:"Unable to fetch Campaign Tag Names",message:"Ajax failure",xhr:xhr})}})),updateCampaignTagName(e){t.campaignTagNames.replace(e)},deleteCampaign:Object(r.flow)((function*(a){try{const e=t.campaignsGroups.get(_.lowerCase(a.status)),r=e.campaigns.get(String(a.id));r.deleteModal.close(),r.network.delete.updateLoading(!0),yield t.rootStore.services.campaignsNetworkService.apiDelete({id:a.id,queryParams:{no_spinner:!0}}),e.deleteCampaignFromGroup(a.id),UINotifications.add({text:"Campaign deleted",type:"success"})}catch(xhr){var r;const a=null==xhr||null==(r=xhr.responseJSON)?void 0:r.result.error_message;UINotifications.add({text:a,type:"error"}),a||e({name:"Unable to destroy campaign",message:"Ajax failure",xhr:xhr})}})),checkDeactivationCampaign:e=>{e.deactivation.checkDeactivationRules()&&t.deactivateCampaign(e)},deactivateCampaign:Object(r.flow)((function*(e){try{const a=yield e.deactivation.deactivate();t.fetchCampaigns(),UINotifications.add({text:a.message,type:"success"})}catch(xhr){UINotifications.add({text:_.get(xhr,"responseJSON.message"),type:"error"})}})),onShowModalIncentives:e=>{p.h.forEach((a=>{t.campaignsGroups.get(a).campaigns.forEach((t=>{t.id===e?t.onShowModalIncentives({campaignId:t.id,personalCouponListId:t.personal_coupon_list_id}):t.onHideModalIncentives()}))}))},reset(){t.campaignsWarnings.killAjaxRequests(),Object(r.applySnapshot)(t,{})}}}))}).call(this,a("B9cq").notifyDevelopers)},iuKr:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("BpJz"),i=a("aFzQ"),o=a("B9cq"),s=a("pm75");const l=r.types.model("Purchase",{id:r.types.identifierNumber,page:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),order_number:r.types.maybeNull(r.types.string),person:r.types.maybeNull(n.a),subtotal:r.types.maybeNull(r.types.string),refunded:r.types.maybeNull(r.types.boolean),refundNetworkStatus:r.types.optional(s.a,{})}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).volatile((e=>({type:"Purchase"}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get formattedCreatedAt(){return e.rootStore.models.site.formatDate(e.created_at)},get relativeCreatedAt(){return e.relativeDate(e.created_at)},get originPath(){return Routes.site_origin_path(e.rootStore.siteCachedSlug,e.id)},get isRefunded(){return e.refunded||e.refundNetworkStatus.isLoading},relativeDate:e=>dayjs(e).fromNow()}))).actions((e=>({update:t=>{_.forEach(t,((a,r)=>{e[r]=t[r]}))},setRefundedStatus(t){e.refunded=t}}))),c=r.types.model("PurchasesStore",{purchases:r.types.optional(r.types.map(l),{}),searchQuery:"",purchasesFetched:!1,paginationPosition:1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get currentPurchases(){return Object(i.values)(e.purchases).filter((t=>t.page===e.paginationPosition))}}))).actions((t=>({resetFetchState:()=>{t.purchasesFetched=!1},fetchPurchases:Object(r.flow)((function*(a){try{t.resetFetchState();const e=yield Object(o.ajax)({debug:!0,url:Routes.internal_site_customer_service_for_scope_path(t.rootStore.siteCachedSlug,"purchases",{q:a,page:t.paginationPosition,no_spinner:!0})});t.updatePurchases(e.result.records,a)}catch(xhr){e({name:"Unable to fetch CSP Purchases",message:"Ajax failure",xhr:xhr})}})),modifyPurchase:e=>(_.set(e,"event.page",t.paginationPosition),e),clearPurchases:()=>{t.purchases.clear()},updatePurchases:(e=[],a)=>{e.forEach((e=>{const a=t.modifyPurchase(e);t.purchases.put(a.event)})),t.purchasesFetched=!0,t.searchQuery=a},setPaginationPosition:(e,a)=>{a&&a.preventDefault(),e!==t.paginationPosition&&(t.paginationPosition=e,t.fetchPurchases(t.searchQuery))}})))}).call(this,a("B9cq").notifyDevelopers)},iwB2:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("TyAF"),n=a("Ty5D"),i=a("Mx/S"),o=a("0Hrz");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const l=Object(n.o)(Object(r.b)((({rootStore:e})=>({campaignShowRoot:e.pages.campaignShowRoot})))(Object(r.c)(function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r),n.prototype.render=function(){const{isSpa:t}=this.props;return e.createElement("div",{className:"flex align-items-center ac-actions-data"},e.createElement(o.a,{isSpa:t}),e.createElement(i.a,{isSpa:t}))},n}(e.PureComponent))))}).call(this,a("q1tI"))},jF7R:function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"loadCampaignPreviewPdf",(function(){return p}));var r=a("i680"),n=a("GaHK"),i=a("ZoHw"),o=a("y/HF"),s=a("Pe0B"),l=a("V0vo");let c=function({logo:e,cachedSlug:t,campaignId:a,fontBase64:n,fontBoldBase64:i,userAgent:o="desktop"}){this.addFonts=({fontBase64:e,fontBoldBase64:t})=>{this.doc.addFileToVFS("gotham-book.ttf",e),this.doc.addFont("gotham-book.ttf","gotham-book","book"),this.doc.addFileToVFS("gotham-htf-bold.ttf",t),this.doc.addFont("gotham-htf-bold.ttf","gotham-bold","bold")},this.getImageSize=({width:e,height:t,marginTop:a})=>{const r=this.pageHeight-this.y-a-this.paddingBottom,n={h:t,w:e,x:this.paddingLeft,y:this.y+a};return e>this.viewPortWidth&&(n.h=t*this.viewPortWidth/e,n.w=this.viewPortWidth),n.h>r&&(n.w=n.w*r/n.h,n.h=r),n.x=this.pageWidth/2-n.w/2,n},this.addSiteInfo=()=>{const e="Site: ";this.doc.setFont("gotham-bold","bold"),this.doc.setFontSize(this.subtitleFontSize*this.ratio),this.doc.setTextColor(51,51,51),this.doc.text(e,this.paddingLeft,this.y),this.doc.setFont("gotham-book","book"),this.doc.setTextColor(15,108,215);const t=this.doc.getTextWidth(e)+3,a=this.doc.splitTextToSize(this.cachedSlug,this.viewPortWidth-t);this.doc.textWithLink(a,this.paddingLeft+t,this.y,{url:`${window.origin}${Routes.site_path(this.cachedSlug)}`}),this.y+=this.doc.getTextDimensions(a).h+3;const r="Campaign id: ",n=`#${this.campaignId}`;this.doc.setFont("gotham-bold","bold"),this.doc.setFontSize(this.subtitleFontSize*this.ratio),this.doc.setTextColor(51,51,51),this.doc.text(r,this.paddingLeft,this.y),this.doc.setFont("gotham-book","book"),this.doc.setTextColor(15,108,215);const i=this.doc.getTextWidth(r)+3;this.doc.textWithLink(n,this.paddingLeft+i,this.y,{url:`${window.origin}${Routes.site_campaign_path(this.cachedSlug,Object(l.v)(window.location.pathname),this.campaignId)}`,maxWidth:this.viewPortWidth-(this.paddingLeft+i)}),this.y+=this.doc.getTextDimensions(n).h+15},this.addPageTemplate=async()=>{this.doc.addPage(),this.doc.addImage(this.logo.base64,"jpeg",this.paddingLeft,this.paddingTop,this.logo.width/2*this.ratio,this.logo.height/2*this.ratio),this.doc.setFont("gotham-book","book"),this.doc.setFontSize(this.cachedSlugFontSize*this.ratio),this.doc.setTextColor(62,77,110),this.y=this.paddingTop+this.logo.height*this.ratio+20},this.addMainTitle=({title:e,marginBottom:t=15})=>{this.doc.setFont("gotham-bold","bold"),this.doc.setFontSize(this.mainTitleFontSize*this.ratio),this.doc.setTextColor(51,51,51);const a=`${e} #${this.campaignId}`,r=this.doc.splitTextToSize(a,this.viewPortWidth);this.doc.text(r,this.paddingLeft,this.y,{url:`${window.origin}${Routes.site_campaign_path(this.cachedSlug,Object(l.v)(window.location.pathname),this.campaignId)}`}),this.y+=this.doc.getTextDimensions(r).h+t},this.addTitle=({title:e,url:t,marginBottom:a=10})=>{this.doc.setFont("gotham-bold","bold"),this.doc.setFontSize(this.titleFontSize*this.ratio),this.doc.setTextColor(66,79,107);const r=this.doc.splitTextToSize(e,this.viewPortWidth);t?this.doc.textWithLink(r,this.paddingLeft,this.y,{url:t}):this.doc.text(r,this.paddingLeft,this.y),this.y+=this.doc.getTextDimensions(r).h+a},this.addPreset=({text:e="",marginBottom:t=3})=>{const a="Preset: ";this.doc.setFont("gotham-bold","bold"),this.doc.setFontSize(this.subtitleFontSize*this.ratio),this.doc.setTextColor(51,51,51),this.doc.text(a,this.paddingLeft,this.y),this.doc.setFont("gotham-book","book");const r=this.doc.splitTextToSize(e,this.viewPortWidth-this.doc.getTextWidth(a)-3);this.doc.text(r,this.paddingLeft+this.doc.getTextWidth(a)+3,this.y),this.y+=this.doc.getTextDimensions(r).h+t},this.addSmallTitle=({title:e="Title",text:t=this.cachedSlug,marginBottom:a=0})=>{const r=`${e}: `;this.doc.setFont("gotham-bold","bold"),this.doc.setFontSize(this.subtitleFontSize*this.ratio),this.doc.setTextColor(51,51,51),this.doc.text(r,this.paddingLeft,this.y),this.doc.setFont("gotham-book","book");const n=this.doc.splitTextToSize(t,this.viewPortWidth-this.doc.getTextWidth(r)-3);this.doc.text(this.paddingLeft+this.doc.getTextWidth(r)+3,this.y,n),this.y+=this.doc.getTextDimensions(n).h+a},this.addScreenShot=({base64:e,width:t,height:a,cachedSlug:r})=>{const n=this.getImageSize({width:t,height:a,marginTop:20}),i=20+n.h;this.doc.addImage(e,"jpeg",n.x,n.y,n.w,n.h,r,"MEDIUM"),this.y+=i},this.saveDoc=()=>{const e=new Date,t=`${e.getUTCMonth()+1}_${e.getUTCDate()}_${e.getUTCFullYear()}`;this.doc.save(`campaign_preview_${this.cachedSlug}_${this.campaignId}_${this.userAgent}_${t}`)},this.pageWidth=595,this.pageHeight=842,this.doc=new r.a({orientation:"p",unit:"pt",format:[this.pageWidth,this.pageHeight],putOnlyUsedFonts:!0}),this.doc.deletePage(1),this.y=0,this.paddingTop=40,this.paddingLeft=40,this.paddingBottom=40,this.viewPortWidth=this.pageWidth-2*this.paddingLeft,this.cachedSlug=t,this.logo=e,this.addFonts({fontBase64:n,fontBoldBase64:i}),this.callbacks=[],this.ratio=.75,this.mainTitleFontSize=24,this.titleFontSize=22,this.subtitleFontSize=15,this.cachedSlugFontSize=18,this.userAgent=o.toLowerCase(),this.campaignId=a};async function p(t="desktop",r,p){const{Site:u,Campaign:d}=window;try{const[{result:{view_setups:p}},{result:{urls:m}}]=await Promise.all([$.ajax({url:Routes.internal_site_campaign_view_setups_path(u.cached_slug,d.id),data:{no_spinner:!0}}).then((e=>e)),$.ajax({url:Routes.export_internal_site_campaign_previews_path(u.cached_slug,d.id,{key:d.public_key,user_agent:t}),data:{no_spinner:!0,selected_split_test_variant_ids:r}}).then((e=>e))]),g=[];p.forEach(((e,t)=>{e.presets_or_default.map((t=>{var a,r;const n=null==m||null==(a=m[e.identifier])?void 0:a[t.cached_slug],i={title:e.human_name,smallTitle:null==(r=t.sample)?void 0:r.caption,previewUrl:t.preview_url,preset:"default-preset"!==t.cached_slug?t.name:null,screenshotUrl:n,view_category:e.view_category,emailView:e.email_view};n&&(0===g.length&&(i.mainTitle=d.name),g.push(i))}))}));const h=[];_.some(m.social_sharing)&&Object.keys(m.social_sharing).forEach((e=>{var t;const a=null==(t=m.social_sharing)?void 0:t[e];a&&h.push({title:"Advocate social sharing",previewUrl:`${window.origin}${Routes.social_sharing_site_campaign_previews_path(u.cached_slug,Object(l.v)(window.location.pathname),d.id,{key:d.public_key,preset_slug:"default-preset",sharing_channel:e})}`,preset:e[0].toUpperCase()+e.slice(1),screenshotUrl:a})}));const y=g.reduce(((e,t,a)=>"offers_show"===t.view_category?a:e),null);null!==y&&h.length&&g.splice(y+1,0,...h);const f=await Promise.all(g.map((e=>Object(s.default)(e.screenshotUrl)))),b=Object(o.default)(e.createElement(n.UIIcon,{name:"logo",width:"224",height:"50"})),v=Object(i.default)(a("Zrvx").default),S=Object(i.default)(a("RFye").default),[w,C,E]=await Promise.all([b,v,S]),N=new c({logo:w,cachedSlug:u.cached_slug,campaignId:d.id,fontBase64:C,fontBoldBase64:E,userAgent:t});f.forEach(((e,t)=>{const a={...g[t],imgData:e};N.addPageTemplate(),a.mainTitle&&(N.addMainTitle({title:d.name}),N.addSiteInfo()),N.addTitle({title:a.title,url:a.previewUrl}),a.preset&&N.addPreset({text:a.preset}),N.addSmallTitle({title:a.emailView?"Subject":"Title",text:a.smallTitle}),N.addScreenShot({base64:e.base64,width:e.width,height:e.height,cachedSlug:`screen-${t}`}),t===g.length-1&&N.saveDoc()}))}catch(m){window.Bugsnag&&Bugsnag.notify(m),p(m)}}}.call(this,a("q1tI"))},jnO1:function(e,t,a){"use strict";(function(e){t.a=({errors:t,name:a,...r})=>{t=_.get(t,a,[]),a=_.get(r,"hideName")?"":a;const n=r.limit||1/0;return _.some(t)?e.createElement("div",null,e.createElement("ul",{className:"base-form-inline-message is-error"},t.slice(0,n).map(((t,r)=>e.createElement("li",{key:r},_.upperFirst(`${a} ${t}`.trim())))))):null}}).call(this,a("q1tI"))},kEQf:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return y}));var r=a("aoTL"),n=a("TyAF"),i=a("GaHK"),o=a("vOnD"),s=a("fnrr"),l=a("rXT5"),c=a("fEXv"),p=a("Ty5D");function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const d=Object(o.default)(i.UIButton).withConfig({displayName:"campaign_copy_modal__CancelButton"})(["padding:0;color:#666;&:hover{color:#666;}"]),m=({step:t,checkCopyingCampaign:a,createCopyCampaign:n,actionClose:o,onDiscard:s})=>e.createElement(i.UIFormFooter,{align:"space-between",disabled:!0},e.createElement(r.a,null,(()=>e.createElement(e.Fragment,null,"check"===t&&e.createElement(e.Fragment,null,e.createElement(d,{size:"small",trait:"transparent",onClick:o},"Cancel"),e.createElement(i.UIButton,{type:"submit",size:"small",trait:"success","data-testid":"ac-campaign-copy-modal-copy-campaign-button",onClick:a},"Copy Campaign")),"copy"===t&&e.createElement(e.Fragment,null,e.createElement(d,{size:"small",trait:"transparent",onClick:s},"Discard"),e.createElement(i.UIButton,{type:"submit",size:"small",trait:"success",onClick:n},"Proceed anyway")))))),g=()=>e.createElement("div",null,"Checking copying campaign...",e.createElement("br",null),"This may make some time."),h=()=>e.createElement("div",null,"Copying campaign...",e.createElement("br",null),"You will be redirected then."),y=Object(p.o)(Object(n.b)((({campaignCopyStore:e})=>({campaignCopyStore:e})))(Object(n.c)(function(t){var a,r;function n(...a){var r;return(r=t.call(this,...a)||this).handleCreateCopyCampaign=e=>{null==e||e.preventDefault(),r.props.campaignCopyStore.createCopyCampaign(r.props.history)},r.modalActions=()=>e.createElement(m,{step:r.props.campaignCopyStore.step,checkCopyingCampaign:r.props.campaignCopyStore.checkCopyingCampaign,updateStep:r.props.campaignCopyStore.updateStep,createCopyCampaign:r.handleCreateCopyCampaign,actionClose:r.props.actionClose,onDiscard:r.props.campaignCopyStore.onDiscard}),r}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,u(a,r),n.prototype.render=function(){const{actionClose:t,actionOverlay:a,campaignCopyStore:{step:r,title:n,submitting:o}}=this.props;return e.createElement(i.UIModal,{width:"560px",title:n,actions:this.modalActions,actionClose:t,actionOverlay:a,position:"center",submitting:o,submittingText:"check"===r?g:h},"check"===r&&e.createElement(l.a,null),"copy"===r&&e.createElement(s.a,{maxHeight:"calc(100vh - 48px - 198px)"},e.createElement(c.a,null)))},n}(e.PureComponent))))}).call(this,a("q1tI"))},kJRw:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma");const n=r.types.model("CampaignLaunchDate",{date:r.types.maybeNull(r.types.string),hour:"00",minute:"00"}).views((e=>({}))).actions((e=>({}))),i=r.types.model("CampaignLaunchValues",{flushData:!1,activates_at:r.types.optional(n,{}),expires_at:r.types.optional(n,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignLaunchPage(){return e.rootStore.pages.campaignShowRoot.campaignLaunchPage},get clearError(){return e.campaignLaunchPage.clearError},get errors(){return e.campaignLaunchPage.errors},normalizeDate:({value:e,timeZoneIdentifier:t})=>e?t?dayjs(e).tz(t).format("l"):dayjs(e).format("l"):null}))).actions((e=>({onChangeDate:({type:t,fieldKey:a,value:r,timeZoneIdentifier:n})=>{e[t][a]=e.normalizeDate({value:r,timeZoneIdentifier:n}),e.clearError(t)},onChangeTime:({type:t,fieldKey:a,value:r})=>{e[t][a]=String(r),e.clearError(t)},onChangeFlushData:()=>{e.flushData=!e.flushData}})))},kh6J:function(e,t,a){"use strict";(function(e){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function n({alerts:t,ListItem:a=i,...n}){const o=_.omit(n,["listIndex"]);return e.createElement("div",o,_.map(t,((t,n)=>e.createElement(a,r({key:n},t)))))}function i({type:t,className:a="",children:n,...i}){const o=_.omit(i,["listIndex"]);return e.createElement("div",r({},o,{className:`base-form-notice is-shown is-${t} ${a}`}),e.createElement("div",{className:"base-form-notice-left-part"},e.createElement("span",{className:"icon icon-cross-styled"})),e.createElement("div",{className:"base-form-notice-right-part"},n))}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}))}).call(this,a("q1tI"))},kigN:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return v}));var r=a("rfrl"),n=a("vOnD"),i=a("GaHK"),o=a("TyAF"),s=a("B9cq"),l=a("V0vo");function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const p=({user:e,current_password_confirmation:t})=>({user:Object(r.a)(e,(e=>(t||delete e.current_password,e)))}),u=({errors:e=[],key:t})=>e.map((e=>`${Object(l.z)(t)} ${e}`)),d=({messages:t,type:a})=>"string"===typeof t?e.createElement(i.UIInlineNotification,{type:"is-error"===a?"danger":"warning"},t):e.createElement(i.UIInlineNotification,{type:"is-error"===a?"danger":"warning"},_.isObject(t)&&Object.entries(t).map((([t,a])=>u({errors:a,key:t}).map(((t,a)=>e.createElement("div",{key:`${t} - ${a}`},t)))))),m=({name:t,inlineErrors:a})=>{const r=_.pick(a,t);return!_.isEmpty(r)&&e.createElement("ul",{className:"base-form-inline-message is-error"},Object.entries(r).map((([t,a])=>u({errors:a,key:t}).map(((t,a)=>e.createElement("li",{key:`${t} - ${a}`},t))))))},g=()=>e.createElement("div",{"data-balloon":"Login is restricted to SSO only","data-balloon-pos":"up",className:"mls mtx inline-flex"},e.createElement(i.UIIcon,{className:"mrn",name:"actionHint"})),h=n.default.form.withConfig({displayName:"user_settings_general_page__FormContainer"})(["min-height:100%;display:flex;flex-direction:column;justify-content:space-between;flex-grow:1;"]),y=Object(n.default)(i.UIFormRow).withConfig({displayName:"user_settings_general_page__UIFormRowStyleOverride"})(["max-width:625px;"]),f=n.default.div.withConfig({displayName:"user_settings_general_page__Container"})(["width:625px;"]),b=["email","password","password_confirmation","current_password","show_campaign_wizard"],v=Object(o.b)((({userSettingsRootStore:e})=>({userSettingsRootStore:e})))(Object(o.c)(function(t){var a,n;function o(e){var a;return(a=t.call(this,e)||this).handleSubmit=async e=>{e.preventDefault();const{userSettingsRootStore:t}=a.props;try{const e=await Object(s.ajax)({url:Routes.internal_user_path(),type:"PATCH",data:p({user:a.state.user,current_password_confirmation:a.state.current_password_confirmation})});if(await t.currentUser.fetch(),a.updateUser(),a.clearState(),Validation.succeed(),e.path)return setTimeout((()=>window.location=e.path),500)}catch(r){const e=_.get(r,"responseJSON.result.errors");if(1===_.keys(e).length&&"current_password"===_.keys(e)[0])return"is required"===e.current_password[0]?a.setState({current_password_confirmation:!0,confirmMessages:!1}):a.setState({current_password_confirmation:!0,confirmMessages:e,confirmMessagesState:"is-error"});delete e.current_password,a.parseErrors(e)}},a.parseErrors=e=>{const t=_.pick(e,b),r=_.difference(_.keys(e),_.keys(t)),n=!_.isEmpty(_.pick(e,r))&&_.pick(e,r);a.setState({inlineErrors:t,global_errors:n,confirmMessages:!1,current_password_confirmation:!1})},a.resetPassword=()=>{$.ajax({url:Routes.internal_password_resets_path({user:{email:a.initialUserData.email}}),type:"POST",success:e=>{a.setState({confirmMessages:e.result.message,confirmMessagesState:"is-success"})},error:e=>{a.setState({confirmMessages:e.responseJSON.result.error_message,confirmMessagesState:"is-error"})}})},a.closeConfirmPassword=e=>{null==e||e.preventDefault(),a.setState({user:_.clone(_.set(a.state.user,"current_password","")),current_password_confirmation:!1})},a.cancelChanges=e=>{null==e||e.preventDefault(),a.setState({user:a.state.initialUser},(()=>{a.clearState()}))},a.handleChangeField=({target:{name:e,value:t}})=>{a.setState({user:Object(r.a)(a.state.user,(a=>{a[e]="show_campaign_wizard"===e?t?"1":"0":t}))})},a.clearState=()=>{a.setState({inlineErrors:!1,global_errors:!1,confirmMessages:!1,current_password_confirmation:!1})},a.initialUserData={email:e.userSettingsRootStore.currentUser.email,show_campaign_wizard:e.userSettingsRootStore.currentUser.show_campaign_wizard,password:"",password_confirmation:"",current_password:""},a.state={inlineErrors:!1,global_errors:!1,confirmMessages:!1,confirmMessagesState:"is-error",current_password_confirmation:!1,initialUser:a.initialUserData,user:_.cloneDeep(a.initialUserData)},a}n=t,(a=o).prototype=Object.create(n.prototype),a.prototype.constructor=a,c(a,n);var u=o.prototype;return u.componentDidMount=function(){Utils.trackGAEvent("User Settings","show user settings")},u.checkField=function(e){return!_.isEmpty(_.pick(this.state.inlineErrors,e))},u.updateUser=function(){const e=Object(r.a)(this.state.user,(e=>{e.password="",e.password_confirmation="",e.current_password=""}));this.setState({initialUser:e,user:e})},u.render=function(){const{user:{show_campaign_wizard:t,email:a,password:r,password_confirmation:n,current_password:o},inlineErrors:s,global_errors:c,current_password_confirmation:p,confirmMessages:u,confirmMessagesState:b}=this.state,{userSettingsRootStore:{currentUser:v}}=this.props,S=!_.isEqual(this.state.user,this.state.initialUser);return e.createElement(e.Fragment,null,e.createElement(h,{onSubmit:this.handleSubmit,autoComplete:"off"},e.createElement(i.UIFormBody,null,e.createElement(i.H3,{className:"mbl"},"My profile"," ",v.restrict_login_to_sso_only&&e.createElement(g,null)),c&&e.createElement("div",null,e.createElement(d,{className:"mbl",messages:c,type:b})),e.createElement(y,{className:"mbl"},e.createElement(i.UILabel,{id:"email",text:"Your email"}),e.createElement(i.UIInputText,{type:"email",name:"email",id:"email",value:a,error:this.checkField("email"),disabled:v.restrict_login_to_sso_only,onChange:this.handleChangeField}),e.createElement(m,{name:"email",inlineErrors:this.state.inlineErrors})),e.createElement(f,null,e.createElement(i.UISpoiler,{render:()=>e.createElement(e.Fragment,null,e.createElement("span",null,"Change password")," ",v.restrict_login_to_sso_only&&e.createElement(g,null))},e.createElement(y,null,e.createElement(i.UILabel,{id:"password",text:"New password"}),e.createElement(i.UIInputText,{type:r?"password":"text",name:"password",id:"password",value:r,error:this.checkField("password"),disabled:v.restrict_login_to_sso_only,onChange:this.handleChangeField,autoComplete:"new-password"}),e.createElement(m,{name:"password",inlineErrors:s})),e.createElement(y,null,e.createElement(i.UILabel,{id:"password_confirmation",text:"Confirm new password"}),e.createElement(i.UIInputText,{type:n?"password":"text",name:"password_confirmation",id:"password_confirmation",value:n,error:this.checkField("password"),disabled:v.restrict_login_to_sso_only,onChange:this.handleChangeField,autoComplete:"new-password"}),e.createElement(m,{name:"password_confirmation",inlineErrors:s})))),Object(l.d)(v,"write")&&e.createElement(y,null,e.createElement(i.UIToggle,{labelText:"Campaign pre-launch checklist",id:"show_campaign_wizard",name:"show_campaign_wizard",checked:"1"===t,value:t,onChange:this.handleChangeField}))),e.createElement(i.UIFormBody,null,e.createElement(i.UIButton,{trait:"success",size:"xl",type:"submit",onClick:this.handleSubmit,disabled:!S},"Save Changes"),S&&e.createElement(i.UIButton,{className:"mlm",trait:"action",onClick:this.cancelChanges},"Cancel"))),p&&e.createElement(i.UIModal,{title:"Confirm Changes",actionClose:this.closeConfirmPassword,ribbon:"success",position:"center"},u&&e.createElement(d,{messages:u,type:b}),e.createElement(i.UIFormRow,null,e.createElement(i.UILabel,{id:"current_password",text:"To confirm changes please enter your current password"}),e.createElement(i.UIInputText,{type:o?"password":"text",name:"current_password",id:"current_password",value:o,onChange:this.handleChangeField})),e.createElement(i.UIButton,{trait:"action",size:"small",className:"mtm",onClick:this.resetPassword},"Forgot password?"),e.createElement("div",{className:"mtxl justify-space-between"},e.createElement(i.UIButton,{trait:"success",size:"small",type:"submit",onClick:this.handleSubmit},"Save Changes"),e.createElement(i.UIButton,{size:"small",className:"mlm",trait:"action",onClick:this.closeConfirmPassword},"Cancel"))))},o}(e.PureComponent)))}).call(this,a("q1tI"))},ko0n:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return h}));var r=a("TyAF"),n=a("vOnD"),i=a("GaHK");function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const s=Object(n.default)(i.UIIcon).withConfig({displayName:"input_search__ResetIcon"})(["&&{cursor:pointer;margin-right:0;&:hover{path{fill:#999;}}}"]),l=Object(n.default)(i.UIIcon).withConfig({displayName:"input_search__IconSearch"})(["&&{position:absolute;top:50%;left:10px;transform:translateY(-50%);margin-right:0;}"]),c=n.default.div.withConfig({displayName:"input_search__ScrollToVariable"})(["position:absolute;top:50%;transform:translateY(-50%);right:10px;display:flex;align-items:center;"]),p=Object(n.default)(i.UIIcon).withConfig({displayName:"input_search__IconPrevious"})(["&&{transform:rotate(180deg);cursor:pointer;&:hover{g{fill:#999;}}}"]),u=Object(n.default)(i.UIIcon).withConfig({displayName:"input_search__IconNext"})(["&&{margin-right:10px;cursor:pointer;&:hover{g{fill:#999;}}}"]),d=n.default.div.withConfig({displayName:"input_search__Matches"})(["margin-right:10px;padding-right:10px;border-right:1px solid #ccc;color:#333;"]),m=Object(n.default)(i.UIInputText).withConfig({displayName:"input_search__InputSearch"})(["&&{padding:0 130px 0 30px;&::-webkit-input-placeholder{opacity:0.5;}&:focus{border-color:rgba(0,112,217,0.5);box-shadow:0 1px 4px 0 rgba(0,112,217,0.2),inset 0 1px 2px 0 rgba(0,0,0,0.1);& + ","{g{stroke:#0070d9;}}}}"],l),g=n.default.div.withConfig({displayName:"input_search__WrapperInputSearch"})(["margin:0 30px 20px 30px;position:relative;"]),h=Object(r.c)(function(t){var a,r;function n(){var a;return(a=t.call(this)||this).handleKeyDown=e=>{13===e.keyCode&&(Utils.trackGAEvent(a.props.infoSidebarStore.gaCategory,"go to a variable by Enter/Shift + Enter"),e.shiftKey?a.props.infoSidebarStore.previousActiveMatchNode():a.props.infoSidebarStore.nextActiveMatchNode())},a.handleClickIconPrevious=()=>{Utils.trackGAEvent(a.props.infoSidebarStore.gaCategory,"go to a variable by icons Previous/Next"),a.props.infoSidebarStore.previousActiveMatchNode()},a.handleClickIconNext=()=>{Utils.trackGAEvent(a.props.infoSidebarStore.gaCategory,"go to a variable by icons Previous/Next"),a.props.infoSidebarStore.nextActiveMatchNode()},a.inputSearchRef=e.createRef(),a}r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,o(a,r);var i=n.prototype;return i.componentDidMount=function(){setTimeout((()=>{var e;null==(e=this.inputSearchRef.current)||e.refInput.current.focus()}),0)},i.render=function(){const{infoSidebarStore:{query:t,onChangeQuery:a,resetQuery:r,matchNodes:n,activeMatchNode:i}}=this.props;return e.createElement(g,null,e.createElement(m,{ref:this.inputSearchRef,size:"medium",value:t,onChange:_.debounce(a,200),placeholder:"Search variables",onKeyDown:this.handleKeyDown}),e.createElement(l,{name:"searchLite"}),e.createElement(c,null,_.some(n)&&e.createElement(e.Fragment,null,e.createElement(d,null,i+1,"/",n.length),e.createElement(p,{name:"downArrow",fill:"#ccc",onClick:this.handleClickIconPrevious}),e.createElement(u,{name:"downArrow",fill:"#ccc",onClick:this.handleClickIconNext})),t&&e.createElement(s,{name:"cross",onClick:r,fill:"#ccc"})))},n}(e.Component))}).call(this,a("q1tI"))},koaK:function(e,t,a){"use strict";(function(e){var t=a("GaHK");function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Widget.AbTestsModalExistingRow=function(a){var n,i;function o(e){var t;return(t=a.call(this,e)||this).redirectToSplitTestHandle=e.redirectToSplitTestHandle.bind(null,e.data.id,{campaign_id:window.Campaign.id}),t.previewDataChange=e.previewDataChange.bind(null,e.data),t}return i=a,(n=o).prototype=Object.create(i.prototype),n.prototype.constructor=n,r(n,i),o.prototype.render=function(){const{data:{key:a,name:r,id:n,created_at:i,last_impression_created_at:o,campaigns:s}}=this.props;return e.createElement("div",{className:"modal-existing-row"},e.createElement("div",{className:"modal-existing-row-left-box"},e.createElement("p",null,e.createElement("a",{href:Routes.site_split_test_path(Site,n),className:"modal-existing-row-name",target:"_blank"},r),Boolean(s.length)&&e.createElement("span",{className:"link is-icon","data-close":"true",onClick:this.previewDataChange},e.createElement(t.UIIcon,{name:"eye",position:"right"}))),e.createElement("p",null,a),e.createElement("p",{style:{whiteSpace:"nowrap"}},`ID: ${n}`)),e.createElement("div",{className:"modal-existing-row-center-box"},e.createElement("p",{className:"modal-existing-row-date"},dayjs(i).format("MM/DD/YYYY")),e.createElement("p",{className:"modal-existing-row-date-ago"},`${Widget.Utilities.dateFromNow(i)} ago`)),e.createElement("div",{className:"modal-existing-row-center-box"},o&&e.createElement("p",{className:"modal-existing-row-date"},dayjs(o).format("MM/DD/YYYY")),o&&e.createElement("p",{className:"modal-existing-row-date-ago"},`${Widget.Utilities.dateFromNow(o)} ago`),!o&&e.createElement("p",{className:"modal-existing-row-date"},"N/A")),e.createElement("div",{className:"base-btn is-success is-small",onClick:this.redirectToSplitTestHandle},"Add to this A/B Test"))},o}(e.PureComponent)}).call(this,a("q1tI"))},l91a:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("4b23"),n=a("B9cq");let i=function(){this.ajax=async(e={},t={})=>{const a=Object(r.a)();try{const r=Object(n.ajax)(e);return this.requestsQ.set(a,{request:r,identifier:t.identifier}),await r}catch(xhr){return xhr}finally{this.requestsQ.delete(a)}},this.clear=()=>{this.requestsQ.forEach((e=>{e.request.abort()})),this.requestsQ.clear()},this.clearByIdentifier=e=>{Array.from(this.requestsQ.keys()).forEach((t=>{const a=this.requestsQ.get(t);a.identifier===e&&(a.request.abort(),this.requestsQ.delete(t))}))},this.sizeByIdentifier=e=>Array.from(this.requestsQ.keys()).reduce(((t,a)=>this.requestsQ.get(a).identifier===e?t+1:t),0),this.requestsQ=new Map}},lI5h:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("uEXj"),i=a("zSPh"),o=a("5OB8"),s=a("B9cq"),l=a("nwwn");const c=r.types.compose("AppStoreNewPage",l.a,r.types.model("AppStoreNewPageBase",{configuration:r.types.optional(n.a,{}),actions:r.types.optional(i.b,{}),identifier:r.types.optional(r.types.string,""),isLoading:!1,step:1,errors:r.types.frozen({})}).views((e=>({get isWithSteps(){var t;return _.some(null==(t=e.currentManifest)?void 0:t.actions)},get title(){var t;return null==(t=e.currentManifest)?void 0:t.title},get description(){var t;return null==(t=e.currentManifest)?void 0:t.description},get currentManifest(){return e.appStorePage.manifest.get(e.identifier)},get isDisabledComplete(){return!e.configuration.isValid||!e.actions.isValid||e.isLoading},get isCancelShown(){return!e.actions.isPristine||!e.configuration.isPristine||!e.criteria.isPristine},get prepareManifestActions(){return e.currentManifest.actions.reduce(((e,t)=>{var a;return _.some(null==(a=t.configuration)?void 0:a.params)?[...e,{...t,configuration:{params:t.configuration.params||[],extras:{data:[]}}}]:e}),[])},get prepareDataForServer(){return{app:{identifier:e.identifier,criteria:e.criteria.value,configuration:e.configuration.valuesForServer,actions_attributes:e.actions.valuesForServer}}}}))).actions((t=>({updateLoading:(e=!0)=>{t.isLoading=e},setManifestIdentifier:({identifier:a})=>{try{if(t.identifier=a,!_.some(t.currentManifest)||t.appStorePage.isUniqueAndInstalled({identifier:a}))throw new Error("Can't set manifest identifier");t.setInitialValues()}catch(r){"Can't set manifest identifier"!==(null==r?void 0:r.message)&&(e({name:"App store failure",message:`Enable to init app store new page; app identifier: ${t.identifier}`,xhr:r}),UINotifications.showErrorFlash("Something went wrong. Please try letter.")),t.leavePage()}},setInitialValues:()=>{t.configuration.params.replace(t.currentManifest.configuration.params),t.configuration.ui.replace(t.currentManifest.configuration.ui||[]),t.isWithSteps&&Object(r.applySnapshot)(t.actions.data,t.prepareManifestActions),Object(r.applySnapshot)(t.criteria,{variables:t.variables})},leavePage(){t.router.replace(Routes.app_store_site_path(t.rootStore.siteCachedSlug)),t.resetStore()},resetStore(){Object(r.applySnapshot)(t,{})},resetFields(){t.resetConfiguration(),t.resetActions()},resetConfiguration(){t.configuration.resetAll()},resetActions(){t.actions.resetAll()},submitFirstStep:e=>{null==e||e.preventDefault(),t.configuration.checkRequiredFields(),t.configuration.isValid&&(t.step=2)},createApp:Object(r.flow)((function*(e){if(null==e||e.preventDefault(),t.configuration.checkRequiredFields(),t.actions.checkRequiredFields(),t.actions.isValid&&t.configuration.isValid&&t.criteria.isValid)try{t.updateLoading(!0);const e=yield Object(s.ajax)({url:Routes.internal_site_store_apps_path(t.rootStore.siteCachedSlug,{no_spinner:!1}),type:"POST",data:t.prepareDataForServer});t.appStorePage.addInstalledApp({app:e.result.app}),t.router.push(Routes.app_store_edit_site_path(t.rootStore.siteCachedSlug,e.result.app.id)),Validation.showSuccessFlash("Application was successfully created")}catch(a){Object(o.b)({response:a,actionsErrorsHandler:t.actions.updateErrors,configurationErrorsHandler:e=>{t.configuration.updateErrors(e)},criteriaErrorsHandler:e=>{t.criteria.setError({error:e.criteria})}})}finally{Object(r.isAlive)(t)&&t.updateLoading(!1)}}))}))))}).call(this,a("B9cq").notifyDevelopers)},lhCq:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("7GQj"),n=a("sT1B");const i=({campaign:t=window.Campaign,site:a=window.Site,currentUser:i=window.current_user,redirectTo:o=null,modalType:s="basic",isSpa:l=!1}={})=>{if(!document.getElementById(n.y)){let o=document.createElement("div");o.setAttribute("id",n.y),document.body.appendChild(o),ReactDOM.render(e.createElement(r.a,{campaign:t,site:a,currentUser:i,isSpa:l,modalType:s}),o)}}}).call(this,a("q1tI"))},loIY:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("V0vo"),i=a("Cpj0"),o=a("kJRw");const s=r.types.model("CampaignLaunchPage",{values:r.types.optional(o.a,{}),errors:r.types.optional(r.types.map(r.types.array(r.types.string)),{}),submitting:!1,liveScheduledCampaigns:r.types.optional(i.a,{}),ignoreWarnings:r.types.array(r.types.string),storeIsActive:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get router(){return e.rootStore.models.router},get campaignShowRoot(){return e.rootStore.pages.campaignShowRoot},get currentCampaign(){return e.campaignShowRoot.currentCampaign},get site(){return e.rootStore.models.site},get campaignHeadText(){return e.currentCampaign.test_mode?"launch":"relaunch"},get siteCachedSlug(){return e.rootStore.models.site.siteCachedSlug},get launchCampaignFetched(){return e.campaignShowRoot.campaignInitialDataFetched&&e.liveScheduledCampaigns.network.get.isLoaded},get launchCampaignType(){return e.values.activates_at.date?"Schedule campaign":"Launch campaign"},get launchCampaignSubmittingType(){return e.values.activates_at.date?"Scheduling...":"Launching..."},get launchButtonStatus(){return e.submitting?e.launchCampaignSubmittingType:e.launchCampaignType},get campaignWarnings(){return e.campaignShowRoot.campaignWarnings},get criticalWarnings(){return e.campaignWarnings.significantWarnings.filter((e=>!("static_widget"===e.category&&"Campaign is not live"===e.description)))},get warningsIsEmpty(){return e.campaignWarnings.network.get.isLoaded&&_.isEmpty(e.criticalWarnings)},isIgnoredWarning:t=>e.ignoreWarnings.includes(t),get canStartLaunching(){return e.campaignWarnings.network.get.isLoaded&&e.criticalWarnings.every((t=>e.ignoreWarnings.includes(t.id)))},get isDisabledLaunchedButton(){return!e.canStartLaunching||e.submitting},get isChangeDefaultValueForExpiredData(){return e.currentCampaign.test_mode&&e.currentCampaign.expires_at},get placementsPagePath(){return Routes.placements_index_site_path(e.siteCachedSlug)}}))).actions((t=>({updateActiveStore(e){t.storeIsActive=e},setDefaultValueForExpiresDate:()=>{const e=t.currentCampaign.expires_at,a=t.site.time_zone_identifier,r=Object(n.p)({date:e,timeZoneIdentifier:a,format:"HH",defaultValue:"00"}),i=Object(n.p)({date:e,timeZoneIdentifier:a,format:"mm",defaultValue:"00"});t.values.onChangeDate({type:"expires_at",fieldKey:"date",timeZoneIdentifier:a,value:e}),t.values.onChangeTime({type:"expires_at",fieldKey:"hour",value:r}),t.values.onChangeTime({type:"expires_at",fieldKey:"minute",value:i})},init:()=>{t.liveScheduledCampaigns.apiGet(t.currentCampaign.id),t.campaignWarnings.startPolling({id:t.currentCampaign.id,count:0,instantly:!0}),t.isChangeDefaultValueForExpiredData&&t.setDefaultValueForExpiresDate()},resetStore:()=>{Object(r.applySnapshot)(t,{})},clearError(e){t.errors.delete(e)},updateErrors(e){t.errors.replace(e)},addIgnoreWarning:e=>{t.ignoreWarnings.push(e)},updateSubmitting:e=>{t.submitting=e},prepareDataForServer:()=>{const{activates_at:e,expires_at:a}=t.values,r={id:t.currentCampaign.id,campaign:{name:t.currentCampaign.name,activates_at:{date:e.date,hour:e.hour,minute:e.minute},expires_at:{date:a.date,hour:a.hour,minute:a.minute}}};return t.currentCampaign.test_mode&&(r.flush_data=t.values.flushData),r},goToCampaignDetails:()=>{t.router.push(Routes.site_campaign_path(t.siteCachedSlug,t.rootStore.urlSpaceParameter,t.currentCampaign.id))},launchCampaign:Object(r.flow)((function*(){try{t.updateSubmitting(!0),yield $.ajax({type:"POST",url:Routes.launch_internal_site_campaigns_path(t.siteCachedSlug,{no_spinner:!0}),data:t.prepareDataForServer()}),t.goToCampaignDetails(),t.campaignShowRoot.fetchCampaignData({id:t.currentCampaign.id})}catch(xhr){const r=_.get(xhr,"responseJSON.result.errors",{});Object.keys(r).length>0?(t.updateErrors(r),UINotifications.add({text:"Unable to launch campaign",type:"error"})):(UINotifications.add({text:_.get(xhr,"responseJSON.result.error_message"),type:"error"}),e({name:"Unable to launch campaign",message:"Ajax failure",xhr:xhr}))}finally{Object(r.isAlive)(t)&&t.updateSubmitting(!1)}}))})))}).call(this,a("B9cq").notifyDevelopers)},m0wF:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("B9cq"),i=a("lI5h"),o=a("dSKc"),s=a("aFzQ");const l=r.types.model("Loading",{apps:!0,manifest:!0}).actions((e=>({setState:t=>{Object.keys(t).forEach((a=>{e[a]=t[a]}))}}))),c=r.types.model("AppStorePage",{appStoreNewPage:r.types.optional(i.a,{}),appStoreEditPage:r.types.optional(o.a,{}),apps:r.types.array(r.types.optional(r.types.frozen(),{})),manifest:r.types.map(r.types.optional(r.types.frozen(),{})),loading:r.types.optional(l,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get installedApps(){return e.manifest.size?{amount:e.apps.length,data:e.apps.map((t=>{const a=e.manifest.get(t.identifier);return{id:t.id,title:"custom_app"===a.identifier&&t.configuration.ui.name||a.title,iconUrl:a.icon,iconBackground:a.icon_background,description:a.short_description||a.description,type:t.active?"enabled":"disabled"}}))}:{amount:0,data:[]}},get availableApps(){const t=Array.from(e.manifest.values()).reduce(((t,a)=>a.unique&&e.apps.some((e=>e.identifier===a.identifier))?t:[...t,a]),[]);return{amount:t.length,data:t.map((e=>({identifier:e.identifier,title:e.title,iconUrl:e.icon,iconBackground:e.icon_background,description:e.short_description||e.description,type:"available"})))}},isUniqueAndInstalled:({identifier:t})=>e.manifest.get(t).unique&&_.some(e.apps.filter((e=>e.identifier===t))),getAppById:({id:t})=>e.apps.find((e=>e.id===t)),getManifestById({id:t}){var a;return e.manifest.get(null==(a=e.getAppById({id:t}))?void 0:a.identifier)},getActionsVariables({actionIdentifier:t,appIdentifier:a}){var r,n;return null==(r=e.manifest.get(a))||null==(n=r.actions.find((e=>e.identifier===t)))?void 0:n.variables},get variables(){return Array.from(Object(s.toJS)(e.manifest.values())).reduce(((e,{actions:t=[]})=>[...e,...t]),[]).flat().reduce(((e,t={})=>null!=t&&t.variables?{...e,...null==t?void 0:t.variables}:e),{})},get isLoading(){return e.loading.apps||e.loading.manifest}}))).actions((t=>({fetchInitialData:()=>{t.fetchApps(),t.fetchManifest()},updateApps:({apps:e})=>{Object(r.applySnapshot)(t.apps,e)},updateManifest:({identifier:e,app:a})=>{t.manifest.set(e,a)},fetchApps:Object(r.flow)((function*(){try{t.loading.setState({apps:!0});const{result:e}=yield Object(n.ajax)({url:Routes.internal_site_store_apps_path(t.rootStore.siteCachedSlug,{no_spinner:!0})});t.updateApps({apps:null==e?void 0:e.apps})}catch(xhr){e({name:"Unable to fetch store apps",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.loading.setState({apps:!1})}})),fetchManifest:Object(r.flow)((function*(){try{t.loading.setState({manifest:!0});const{result:e}=yield Object(n.ajax)({url:Routes.manifest_internal_site_store_apps_path(t.rootStore.siteCachedSlug,{no_spinner:!0})});e.manifest.forEach((e=>{t.updateManifest({identifier:e.identifier,app:e})}))}catch(xhr){e({name:"Unable to fetch manifest store apps",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.loading.setState({manifest:!1})}})),updateApp:({id:e,app:a})=>{t.updateApps({apps:t.apps.map((t=>t.id!==e?t:a))})},removeAppById:({id:e})=>{t.updateApps({apps:t.apps.filter((t=>t.id!==e))})},addInstalledApp:({app:e})=>{t.updateApps({apps:[...t.apps.toJSON(),e]})},resetStore:()=>{Object(r.applySnapshot)(t.apps,[]),Object(r.applySnapshot)(t.manifest,{})}})))}).call(this,a("B9cq").notifyDevelopers)},m3Dn:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return c}));const r=["SignupIncentive","SharingIncentive","ReferrerIncentive","ClickIncentive","ReferredIncentive","EmailCapture::GiveawayIncentive","EmailCapture::SignupIncentive"],n={type:r,incentive_type:r,amount:r,percentage_discount:r,coupon_list_id:r,multi_use_coupon_code:r,custom_description:r,identifier:r,criteria:r,sharing_channels:["SharingIncentive"],email_shares:["SharingIncentive"],new_customer:["ClickIncentive","ReferrerIncentive","ReferredIncentive"],subtotal_min:["ReferrerIncentive","ReferredIncentive"],subtotal_max:["ReferrerIncentive","ReferredIncentive"],referrals_min:["ReferrerIncentive"],referrals_max:["ReferrerIncentive"],reward_uniqueness:["ReferrerIncentive"],friend_event_category:["ReferrerIncentive"],new_optin:["ReferrerIncentive","ClickIncentive"],allow_on_expired_offer:["ClickIncentive"],allow_on_self_referral:["ClickIncentive"],once_per_person:["ClickIncentive","SharingIncentive","SignupIncentive"]},i={amount:"",incentive_type:"discount_coupon",percentage_discount:!1},o={SignupIncentive:{SignupIncentive:{type:"SignupIncentive",identifier:"signup",once_per_person:"1",...i}},SharingIncentive:{SharingIncentive:{type:"SharingIncentive",identifier:"sharing",sharing_channels:"",email_shares:null,...i}},ReferrerIncentive:{ReferrerIncentive:{type:"ReferrerIncentive",identifier:"referrer",reward_uniqueness:"once_per_friend",subtotal_min:"",subtotal_max:"",referrals_min:"",referrals_max:"",new_optin:"0",new_customer:"1",friend_event_category:"purchase",...i},ReferrerSubscription:{type:"ReferrerIncentive",identifier:"referrer_subscription",reward_uniqueness:"once_per_friend",referrals_min:"",referrals_max:"",new_optin:"1",new_customer:"",friend_event_category:"friend_signup",...i}},ClickIncentive:{ClickIncentive:{type:"ClickIncentive",identifier:"friend",new_customer:null,new_optin:"0",allow_on_expired_offer:"0",allow_on_self_referral:"0",...i},NewCustomer:{type:"ClickIncentive",identifier:"friend_new_customer",new_customer:"1",new_optin:"0",allow_on_expired_offer:"0",allow_on_self_referral:"0",...i},ExistingCustomer:{type:"ClickIncentive",identifier:"friend_existing_customer",new_customer:"0",new_optin:"0",allow_on_expired_offer:"0",allow_on_self_referral:"0",...i},ExpiredOffer:{type:"ClickIncentive",identifier:"friend_expired_offer",new_customer:null,new_optin:"0",allow_on_expired_offer:"1",allow_on_self_referral:"0",...i},SelfReferral:{type:"ClickIncentive",identifier:"friend_self_referral",new_customer:null,new_optin:"0",allow_on_expired_offer:"0",allow_on_self_referral:"1",...i},NewSubscriber:{type:"ClickIncentive",identifier:"friend_new_subscriber",new_customer:null,new_optin:"1",allow_on_expired_offer:"0",allow_on_self_referral:"0",...i}},ReferredIncentive:{ReferredIncentive:{type:"ReferredIncentive",identifier:"referred",subtotal_min:"",subtotal_max:"",new_customer:"",...i}},"EmailCapture::GiveawayIncentive":{"EmailCapture::GiveawayIncentive":{type:"EmailCapture::GiveawayIncentive",identifier:"email_capture_giveaway",...i}},"EmailCapture::SignupIncentive":{"EmailCapture::SignupIncentive":{type:"EmailCapture::SignupIncentive",identifier:"email_capture_signup",...i}}},s={discount_coupon:{main:["RewardType","RewardAmountField","CouponCodesType"],advanced:["CustomDescription","Identifier","OncePerPerson","Criteria"],advanced_keys:["custom_description","identifier","criteria"]},rebate:{main:["RewardType","RewardAmountField","RewardTypeDescription"],advanced:["CustomDescription","Identifier","OncePerPerson","Criteria"],advanced_keys:["custom_description","identifier","once_per_person","criteria"]}},l={discount_coupon:{main:["RewardType","RewardAmountField","CouponCodesType"],advanced:["CustomDescription","Identifier","OncePerPerson","BasicCriteria","Criteria"],advanced_keys:["custom_description","identifier","basic_criteria","criteria"]},rebate:{main:["RewardType","RewardAmountField","RewardTypeDescription"],advanced:["CustomDescription","Identifier","OncePerPerson","BasicCriteria","Criteria"],advanced_keys:["custom_description","identifier","once_per_person","basic_criteria","criteria"]}},c={SignupIncentive:{SignupIncentive:{title:"Advocate Signup Incentive",...s}},SharingIncentive:{SharingIncentive:{title:"Advocate Sharing Incentive",discount_coupon:{main:s.discount_coupon.main,advanced:["CustomDescription","Identifier","OncePerPerson","SharingChannel","EmailShares","Criteria"],advanced_keys:["custom_description","identifier","once_per_person","sharing_channels","email_shares","criteria"]},rebate:{main:s.rebate.main,advanced:["CustomDescription","Identifier","OncePerPerson","SharingChannel","EmailShares","Criteria"],advanced_keys:["custom_description","identifier","once_per_person","sharing_channels","email_shares","criteria"]}}},ReferrerIncentive:{ReferrerIncentive:{title:"Advocate Referral Incentive",discount_coupon:{main:["RewardTypeWithGiftCards","RewardAmountField","CouponCodesType"],advanced:["CustomDescription","Identifier","Subtotal","Referrals","FriendEventCategory","RewardUniqueness","Criteria"],advanced_keys:["custom_description","identifier","subtotal_min","subtotal_max","referrals_min","referrals_max","friend_event_category","reward_uniqueness","criteria"]},rebate:{main:["RewardTypeWithGiftCards","RewardAmountField","RewardTypeDescription"],advanced:["CustomDescription","Identifier","Subtotal","Referrals","FriendEventCategory","RewardUniqueness","Criteria"],advanced_keys:["custom_description","identifier","subtotal_min","subtotal_max","referrals_min","referrals_max","friend_event_category","reward_uniqueness","criteria"]},other:{main:["RewardTypeWithGiftCards","CustomDescription","RewardTypeDescription"],advanced:["Identifier","Subtotal","Referrals","FriendEventCategory","RewardUniqueness","Criteria"],advanced_keys:["custom_description","identifier","subtotal_min","subtotal_max","referrals_min","referrals_max","friend_event_category","reward_uniqueness","criteria"]},rybbon:{main:["RewardTypeWithGiftCards","RybbonInfo"]},tremendous:{main:["RewardTypeWithGiftCards","TremendousInfo"]}},ReferrerSubscription:{title:"Advocate Referral Incentive (New Subscriber)",discount_coupon:{main:s.discount_coupon.main,advanced:["CustomDescription","Identifier","Referrals","RewardUniqueness","Criteria"],advanced_keys:["custom_description","identifier","referrals_min","referrals_max","reward_uniqueness","criteria"]},rebate:{main:s.rebate.main,advanced:["CustomDescription","Identifier","Referrals","RewardUniqueness","Criteria"],advanced_keys:["custom_description","identifier","referrals_min","referrals_max","reward_uniqueness","criteria"]},other:{main:["RewardType","CustomDescription","RewardTypeDescription"],advanced:["Identifier","Referrals","RewardUniqueness","Criteria"]},rybbon:{main:["RewardType","RybbonInfo"]},tremendous:{main:["RewardType","TremendousInfo"]}}},ClickIncentive:{ClickIncentive:{title:"Friend Incentive",...s},NewCustomer:{title:"Friend Incentive (New Customer)",...l},ExistingCustomer:{title:"Friend Incentive (Existing Customer)",...l},ExpiredOffer:{title:"Friend Incentive (Expired Offer)",...l},SelfReferral:{title:"Friend Incentive (Self-Referral)",...l},NewSubscriber:{title:"Friend Incentive (New Subscriber)",...l}},ReferredIncentive:{ReferredIncentive:{title:"Friend Referred Incentive",discount_coupon:{main:s.discount_coupon.main,advanced:["CustomDescription","Identifier","Subtotal","FriendEventCategory","Criteria"],advanced_keys:["custom_description","identifier","subtotal_min","subtotal_max","friend_event_category","criteria"]},rebate:{main:s.rebate.main,advanced:["CustomDescription","Identifier","Subtotal","FriendEventCategory","Criteria"],advanced_keys:["custom_description","subtotal_min","subtotal_max","friend_event_category","criteria"]},other:{main:["RewardType","CustomDescription","RewardTypeDescription"],advanced:["CustomDescription","Identifier","Subtotal","FriendEventCategory","Criteria"],advanced_keys:["custom_description","identifier","subtotal_min","subtotal_max","friend_event_category","criteria"]}}},"EmailCapture::GiveawayIncentive":{"EmailCapture::GiveawayIncentive":{title:"Email capture giveaway incentive",discount_coupon:{main:["RewardAmountField","CouponCodesType"],advanced:["CustomDescription","Identifier","Criteria"],advanced_keys:["custom_description","identifier","criteria"]},other:{main:["CustomDescription","RewardTypeDescription"],advanced:["CustomDescription","Identifier","Criteria"],advanced_keys:["custom_description","identifier","criteria"]}}},"EmailCapture::SignupIncentive":{"EmailCapture::SignupIncentive":{title:"Email capture signup incentive",discount_coupon:{main:["RewardAmountField","CouponCodesType"],advanced:["CustomDescription","Identifier","Criteria"],advanced_keys:["custom_description","identifier","criteria"]},other:{main:["CustomDescription","RewardTypeDescription"],advanced:["CustomDescription","Identifier","Criteria"],advanced_keys:["custom_description","identifier","criteria"]}}}}},mUBM:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return f}));var r=a("TyAF"),n=a("GaHK"),i=a("vOnD"),o=a("dhqo"),s=a.n(o);function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const c=i.default.div.withConfig({displayName:"campaign_copy_step_copying_conflicts__CheckingTypeHead"})(["width:100%;display:flex;align-items:center;"]),p=i.default.div.withConfig({displayName:"campaign_copy_step_copying_conflicts__CheckingTypeTitle"})(["margin-left:15px;font-size:20px;font-family:'gotham-htf-bold',Arial,sans-serif;color:#333;"]),u=i.default.div.withConfig({displayName:"campaign_copy_step_copying_conflicts__CheckingTypeDescription"})(["margin-top:5px;padding-left:47px;font-size:14px;line-height:24px;color:#999;",";"],n.Theme.fontWeights.regular),d=i.default.div.withConfig({displayName:"campaign_copy_step_copying_conflicts__CheckingTypeConflictsCount"})(["margin-left:10px;padding:5px;font-size:14px;line-height:1;",";color:#da1a24;background-color:rgba(218,26,36,0.1);"],n.Theme.fontWeights.regular),m=i.default.div.withConfig({displayName:"campaign_copy_step_copying_conflicts__ConflictsList"})(["margin-top:10px;padding-left:47px;max-height:206px;overflow-y:auto;background:linear-gradient(white 30%,rgba(255,255,255,0)),linear-gradient(rgba(255,255,255,0),white 70%) 0 100%,radial-gradient(50% 0,farthest-side,rgba(0,0,0,0.2),rgba(0,0,0,0)),radial-gradient(50% 100%,farthest-side,rgba(0,0,0,0.2),rgba(0,0,0,0)) 0 100%;background:linear-gradient(white 30%,rgba(255,255,255,0)),linear-gradient(rgba(255,255,255,0),white 70%) 0 100%,radial-gradient(farthest-side at 50% 0,rgba(0,0,0,0.2),rgba(0,0,0,0)),radial-gradient(farthest-side at 50% 100%,rgba(0,0,0,0.2),rgba(0,0,0,0)) 0 100%;background-repeat:no-repeat;background-size:100% 40px,100% 40px,100% 15px,100% 15px;background-attachment:local,local,scroll,scroll;"]),g=i.default.div.withConfig({displayName:"campaign_copy_step_copying_conflicts__ConflictItem"})(["display:flex;align-items:center;justify-content:space-between;padding:10px 0;&:not(:last-child){border-bottom:solid 2px rgba(221,221,221,0.5);}"]),h=i.default.div.withConfig({displayName:"campaign_copy_step_copying_conflicts__ConflictItemName"})(["max-width:280px;font-size:14px;line-height:18px;",";color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;"],n.Theme.fontWeights.regular),y=i.default.div.withConfig({displayName:"campaign_copy_step_copying_conflicts__ConflictItemType"})(["font-size:14px;line-height:1;",";color:#999;"],n.Theme.fontWeights.regular),f=Object(r.b)((({campaignCopyStore:e})=>({campaignCopyStore:e})))(Object(r.c)(function(t){var a,r;function i(){return t.apply(this,arguments)||this}return r=t,(a=i).prototype=Object.create(r.prototype),a.prototype.constructor=a,l(a,r),i.prototype.render=function(){const{campaignCopyStore:{haveConflictsByType:t},checkingType:a}=this.props;return t[a.type]?_.some(a.values)?e.createElement(n.UISpoiler,{width:"100%","data-testid":"ac-campaign-copying-spoiler-with-errors",render:()=>e.createElement(c,null,e.createElement(n.UIIcon,{className:"mrn",name:"failAction"}),e.createElement(p,null,a.title),e.createElement(d,null,`${a.values.length} ${s()("conflict",a.values.length)}`))},e.createElement(m,null,a.values.map(((t,a)=>e.createElement(g,{key:t},e.createElement("div",{className:"flex align-items-center"},e.createElement("div",null,e.createElement(n.UIIcon,{name:"down",fill:"#da1a24",width:"18",height:"18"})),e.createElement(n.UICopyable,{text:t,balloonPosition:0!==a?"up":"right"},e.createElement("div",{className:"flex align-items-center"},e.createElement(h,null,t)))),e.createElement(y,null,_.upperCase(_.split(t,".").pop()))))))):e.createElement("div",{"data-testid":"ac-campaign-copying-check-fail"},e.createElement(c,null,e.createElement(n.UIIcon,{className:"mrn",name:"failAction"}),e.createElement(p,null,a.title)),e.createElement(u,null,a.description)):e.createElement("div",{"data-testid":"ac-campaign-copying-check-success"},e.createElement(c,null,e.createElement(n.UIIcon,{className:"mrn",name:"successAction"}),e.createElement(p,null,a.title)),e.createElement(u,null,a.description))},i}(e.PureComponent)))}).call(this,a("q1tI"))},mUb0:function(e,t,a){"use strict";(function(e){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}a.d(t,"a",(function(){return n}));let n=function(t){var a,n;function i(e){var a;return(a=t.call(this,e)||this).onQuerySearch=e.onQuerySearch.bind(null),a}n=t,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,r(a,n);var o=i.prototype;return o.componentDidMount=function(){$(document).on("click.dropdown.data-api",(e=>{const t=$(e.target),a=$(".js-status-filter");t.hasClass("keepopen")||t.parents(".keepopen").length?a.addClass("open"):a.removeClass("open")}))},o.render=function(){const{query:t,statuses:a,placeholder:r,onStatusChange:n}=this.props;let i=[],o=null;return _.forEach(a,((e,t)=>{e&&i.push(t)})),o=i.length&&i.length!==_.size(a)?i.join(", "):"All",e.createElement("div",{className:"campaignfilter"},e.createElement("div",{className:"campaignfilter-cell is-query"},e.createElement("input",{type:"text",className:"base-input",value:t||"",placeholder:r||"Search by campaign ID, name, or status",onChange:this.onQuerySearch}),e.createElement("div",{className:"campaignfilter-query-remove"})),e.createElement("div",{className:"campaignfilter-cell"}),a&&e.createElement("div",{className:"campaignfilter-cell js-status-filter"},e.createElement("div",{className:"campaignfilter-result","data-toggle":"dropdown",title:o},o,e.createElement("i",null)),e.createElement("ul",{className:"dropdown-menu pull-right keepopen"},_.keys(a).map((t=>e.createElement("li",{key:t},e.createElement("div",{className:"dropdown-link",onClick:n},e.createElement("span",{className:"base-checkbox"},e.createElement("input",{type:"checkbox",readOnly:!0,checked:a[t]}),e.createElement("label",null,t)))))))))},i}(e.PureComponent)}).call(this,a("q1tI"))},micW:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("sT1B"),i=a("N/Cz");const o=r.types.model("StaticWidgetStore",{campaign_id:r.types.maybeNull(r.types.number),dataFetched:!1,disabled_state:r.types.maybeNull(r.types.boolean),id:r.types.identifier,showStaticWidgetModal:!1,site_cached_slug:"",staticWidgetInfo:r.types.optional(i.a,{}),tooltipDescription:""}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.site_cached_slug||e.siteCachedSlugFromRoot},get site(){return e.rootStore.models.site},get siteCachedSlugFromRoot(){return e.site.siteCachedSlug},get isLoading(){return!e.disabled_state&&!e.dataFetched},get tooltipCanBeShown(){return!e.isLoading},get tooltipText(){return e.tooltipDescription||e.staticWidgetInfo.tooltipText}}))).actions((t=>({changeDataFetched:e=>{t.dataFetched=e},fetchData:Object(r.flow)((function*(){if(!t.disabled_state){t.changeDataFetched(!1);try{const e=yield $.ajax({url:Routes.static_widget_info_internal_site_campaign_path(t.siteCachedSlug,t.campaign_id),data:{no_spinner:!0}});t.updateData(e.result)}catch(xhr){e({name:"Unable to fetch static widget info data",message:"Ajax failure",xhr:xhr})}Utils.trackGAEvent(n.db,"fetch data")}})),updateData:e=>{t.staticWidgetInfo=i.a.create(e),t.changeDataFetched(!0)},showModal:()=>{t.showStaticWidgetModal=!0,Utils.trackGAEvent(n.db,"show modal")},hideModal:()=>{t.showStaticWidgetModal=!1,Utils.trackGAEvent(n.db,"hide modal")}})))}).call(this,a("B9cq").notifyDevelopers)},mxly:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return u}));var r=a("99Ma"),n=a("MJIl"),i=a.n(n),o=a("pm75"),s=a("pNxA"),l=a("DrZn"),c=a("1G/5");const p=e=>e.sort(((e,t)=>e.threshold-t.threshold)),u=r.types.model({tiersData:r.types.optional(c.a,{}),tiersCreate:r.types.optional(s.a,{}),tiersUpdate:r.types.optional(l.a,{}),tiersNetworkFetchStatus:r.types.optional(o.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignRulesStore(){return Object(r.getParent)(e)},get isLoaded(){return e.tiersData.status.fetching.isLoaded},get isLoading(){return"in_progress"===e.tiersData.status.fetching.status},get campaign(){return this.campaignRulesStore.campaign},get tiers(){return e.tiersData.data.filter((e=>e.active))},get sortedTiers(){return p(this.tiers.slice())},get inactiveTiers(){return e.tiersData.data.filter((e=>!e.active))},get sortedInactiveTiers(){return p(this.inactiveTiers.slice())},get showInactiveTiers(){return this.rootStore.isStaffMember&&i()(this.sortedInactiveTiers)}}))).actions((t=>{const a=Object(r.flow)((function*(){yield t.tiersData.fetchAll()}));return{init:a,fetchTiers:Object(r.flow)((function*(){try{t.tiersNetworkFetchStatus.update("in_progress");const e=yield t.rootStore.services.loyaltyTiersNetworkService.apiGetMany({campaignId:t.campaign.id});a=e.result.tiers,Object(r.applySnapshot)(t.tiers,a),t.tiersNetworkFetchStatus.update("success")}catch(xhr){e({name:"Unable to fetch loyalty tiers",message:"Ajax failure",xhr:xhr}),t.tiersNetworkFetchStatus.update("error")}var a})),reset:()=>{Object(r.applySnapshot)(t,{})}}}))}).call(this,a("B9cq").notifyDevelopers)},nKCY:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("DUGb");function r(e){return e}},nKL8:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return p}));var r=a("99Ma"),n=a("8C8s"),i=a("B9cq"),o=a("mwIZ"),s=a.n(o);const l=r.types.model("RequestsLeftWarnings",{pii:r.types.maybeNull(r.types.number),total:r.types.maybeNull(r.types.number)}),c=r.types.model("LimitAccess",{requests_left_warnings:r.types.optional(l,{}),requires_approval:!1}).actions((e=>({update:t=>{Object(r.applySnapshot)(e,t)}}))),p=r.types.model("AccessRequestPage",{pii:!1,submitting:!1,limitAccesses:r.types.optional(c,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get requestsLeft(){return e.limitAccesses.requests_left_warnings[e.pii?"pii":"total"]}}))).actions((t=>({updateSubmitting:e=>{t.submitting=e},updatePii:({target:{name:e,value:a}})=>{t.pii=a},request:Object(r.flow)((function*(e){t.updateSubmitting(!0);try{const a=yield Object(i.ajax)({url:Routes.account_accesses_path(t.rootStore.models.site.siteAccount.account),type:"POST",data:{...e&&{ongoing:e},access:{pii:t.pii}}});t.updateSubmitting(!1),n.a.showSuccessFlash("Access request submitted"),s()(a,"access.auto_approved")&&t.rootStore.models.currentUser.updatePiiAccessibleSites(s()(a,"access.account_id"),!0)}catch(a){t.updateSubmitting(!1),n.a.showErrorFlash(s()(a,"responseJSON.error_message","Server error occurred"))}})),fetchLeftAccountAccesses:Object(r.flow)((function*(){try{const e=yield Object(i.ajax)({url:Routes.requests_left_internal_account_accesses_path(t.rootStore.models.site.siteAccount.account)});t.limitAccesses.update(s()(e,"result.accesses"))}catch(xhr){e({name:"Unable to fetch left account accesses",message:"Ajax failure",xhr:xhr})}}))})))}).call(this,a("B9cq").notifyDevelopers)},nPL6:function(e,t,a){"use strict";a.r(t),a.d(t,"DashboardSiteRevenueTileConfigStore",(function(){return u})),a.d(t,"DashboardCampaignsTileConfigStore",(function(){return g})),a.d(t,"DashboardReferralsTileConfigStore",(function(){return h.a})),a.d(t,"DashboardAdvocateRewardsTileConfigStore",(function(){return b})),a.d(t,"DashboardFriendRewardsTileConfigStore",(function(){return w})),a.d(t,"DashboardAdvocacyRateTileConfigStore",(function(){return N})),a.d(t,"DashboardCampaignPerformanceTileConfigStore",(function(){return x})),a.d(t,"DashboardTalkableRevenueTileConfigStore",(function(){return P})),a.d(t,"DashboardCustomizableRevenueTileConfigStore",(function(){return k})),a.d(t,"DashboardAbstractMetricTileConfigStore",(function(){return M})),a.d(t,"DashboardAllTimeMetricTileConfigStore",(function(){return W}));var r=a("99Ma"),n=a("Dg7y");function i(e){return _.filter(e,{overtime:!0})}const o=r.types.model("TileConfigRevenue",{}).views((e=>({get chartTemplate(){let t=[];return e.configuration.ui.overtime_chart&&(t=i(e.filteredStatsTemplate),_.isEmpty(t)&&(t=i(e.statsTemplate))),t},get chartTemplateData(){return e.showOvertimeChart&&e.chartTemplate},get filteredStatsTemplate(){return _.filter(e.statsTemplate,(t=>e.revenueMetricIsEnabled(t.data_identifier)))},get showMetrics(){return e.configuration.ui.transactions||_.some(e.configuration.ui.revenue_metrics)},get showOvertimeChart(){return e.configuration.ui.overtime_chart},revenueMetricIsEnabled:t=>e.configuration.ui[t]||_.includes(e.configuration.ui.revenue_metrics,t),graphMetricIsEnabled:t=>e.revenueMetricIsEnabled(t)||e.showOvertimeChart}))).actions((e=>({}))),s=r.types.compose(o,n.a);s.create();var l=a("MrdO"),c=a("sT1B");const p=r.types.model("DashboardSiteRevenueTileConfigStore",{configuration:r.types.maybeNull(l.a),report_urls:r.types.maybeNull(r.types.model({revenue:r.types.maybeNull(r.types.string),transactions:r.types.maybeNull(r.types.string),aov:r.types.maybeNull(r.types.string),all_time_revenue:r.types.maybeNull(r.types.string)}))}).views((e=>({get eventsForTooltip(){const t=e.configuration.event_categories;return _.some(t)?`'${t.join("', '")}'`:"all"},get dynamicDescription(){return`Includes ${e.eventsForTooltip} conversion events (both referral and not). Includes QA-generated data.`},get statsTemplate(){return[{metric_title:"Revenue",metric_key:"revenue",data_identifier:"revenue",gaLabel:e.human_type,overtime:!0,gaAction:"Chart Revenue Click",gaCategory:c.E,className:"is-advocate",...e.graphMetricIsEnabled("revenue")&&{value:e.metricData("revenue")}},{metric_title:"Transactions",metric_key:"transactions",data_identifier:"transactions",overtime:!0,gaLabel:e.human_type,gaAction:"Chart Transactions Click",gaCategory:c.E,showPrefix:!1,...e.graphMetricIsEnabled("transactions")&&{value:e.metricData("transactions")}},{metric_title:"A.O.V.",metric_key:"aov",data_identifier:"aov",overtime:!1,gaLabel:e.human_type,gaAction:"Chart A.O.V. Click",gaCategory:c.E,...e.revenueMetricIsEnabled("aov")&&{value:e.metricData("aov")}},{metric_title:"All Time Revenue",metric_key:"all_time_revenue",data_identifier:"all_time_revenue",overtime:!1,is_right:!0,show_previous_period:!1,tooltip:"This metric does not include stats for today. It updates once per day, not in real time.",gaLabel:e.human_type,gaAction:"Chart All Time Revenue Click",gaCategory:c.E,...e.revenueMetricIsEnabled("all_time_revenue")&&{value:e.metricData("all_time_revenue")}}]},get showContent(){return e.showOvertimeChart}}))).actions((e=>({}))),u=r.types.compose(p,s);u.create();var d=a("ZbcR");const m=r.types.model("DashboardCampaignsTileConfig",{report_urls:r.types.maybeNull(r.types.model({campaigns:r.types.maybeNull(r.types.model({live:r.types.maybeNull(r.types.string),test:r.types.maybeNull(r.types.string),scheduled:r.types.maybeNull(r.types.string)}))})),inline_values:r.types.maybeNull(r.types.model({campaigns:r.types.maybeNull(r.types.model({live:r.types.maybeNull(d.a),scheduled:r.types.maybeNull(d.a),test:r.types.maybeNull(d.a)}))}))}).views((e=>({get dynamicDescription(){return"Number of live, scheduled and test campaigns. Includes QA-generated data."},get numberOfCampaigns(){return _.map(_.values(e.inline_values.campaigns),"plain")},get filteredNumberOfCampaigns(){return e.numberOfCampaigns.filter((e=>e>c.F))},get siteHasManyCampaigns(){return _.some(e.filteredNumberOfCampaigns)}}))).actions((e=>({}))),g=r.types.compose(m,n.a);var h=a("aCAj");const y={type:"column",colors:["rgba(146, 214, 242, .75)","rgba(58, 136, 210, .7)"],showPrefix:!1},f=r.types.model("DashboardAdvocateRewardsTileConfig",{report_urls:r.types.maybeNull(r.types.model({coupons_redeemed:r.types.maybeNull(r.types.string),rewards:r.types.maybeNull(r.types.string)}))}).views((e=>({get dynamicDescription(){return"All advocate rewards given & redeemed. Includes QA-generated data."},get statsTemplate(){return[{metric_title:"Rewards paid + pending",data_identifier:"rewards",metric_key:"rewards",metricTooltip:"The total number of advocate referral rewards from approved and pending referrals",gaLabel:e.human_type,gaAction:"Chart Rewards Click",overtime:!0,gaCategory:c.E,value:e.metricData("rewards"),...y},{metric_title:"Coupons Redeemed",metric_key:"coupons_redeemed",data_identifier:"coupons_redeemed",metricTooltip:"The total number of coupons redeemed at checkout",gaLabel:e.human_type,gaAction:"Chart Coupons Redeemed Click",overtime:!0,gaCategory:c.E,value:e.metricData("coupons_redeemed"),...y}]},get chartTemplate(){return i(e.statsTemplate)}}))).actions((e=>({}))),b=r.types.compose(f,n.a),v={type:"column",colors:["rgba(255, 170, 70, .6)","rgba(237, 115, 18, .8)"],showPrefix:!1},S=r.types.model("DashboardFriendRewardsTileConfig",{report_urls:r.types.maybeNull(r.types.model({coupons_redeemed:r.types.maybeNull(r.types.string),rewards:r.types.maybeNull(r.types.string)}))}).views((e=>({get dynamicDescription(){return"All friend rewards given & redeemed. Includes QA-generated data."},get statsTemplate(){return[{metric_title:"Rewards",metric_key:"rewards",data_identifier:"rewards",overtime:!0,metricTooltip:"The total number of rewards issued",gaLabel:e.human_type,gaAction:"Chart Rewards Click",gaCategory:c.E,value:e.metricData("rewards"),...v},{metric_title:"Coupons Redeemed",metric_key:"coupons_redeemed",data_identifier:"coupons_redeemed",metricTooltip:"The total number of coupons redeemed at checkout",gaLabel:e.human_type,gaAction:"Chart Coupons Redeemed Click",overtime:!0,gaCategory:c.E,value:e.metricData("coupons_redeemed"),...v}]},get chartTemplate(){return i(e.statsTemplate)}}))).actions((e=>({}))),w=r.types.compose(S,n.a),C={showPrefix:!1},E=r.types.model("DashboardAdvocacyRateTileConfig",{configuration:r.types.maybeNull(l.a),campaigns_appearance:"",appearance_changed:!1,report_urls:r.types.maybeNull(r.types.model({advocacy_percentage:r.types.maybeNull(r.types.string),sharers:r.types.maybeNull(r.types.string),sharing_rate:r.types.maybeNull(r.types.string)}))}).views((e=>({get campaignTagsForTooltip(){const t=e.configuration.campaign_tags;return _.some(t)?`'${t.join("', '")}'`:"all"},get dynamicDescription(){return`Advocacy rate metrics (number of sharers/number of advocate impressions), taken from ${e.campaignTagsForTooltip} campaign tags. Includes QA-generated data.`},get appearanceOptions(){return[{label:"Average Across All Campaigns",value:""},{label:"Post Purchase Campaigns",value:"popup"},{label:"Standalone Campaigns",value:"inline"},{label:"Floating Widget Campaigns",value:"widget"}]},get statsTemplate(){return[{metric_title:"Advocacy Percentage",metric_key:"advocacy_percentage",tab_title:"Sharers / Advocate Impressions",data_identifier:"advocacy_percentage",metricTooltip:"Sharers/Advocate impressions",gaLabel:e.human_type,gaAction:"Chart Advocacy Percentage Click",gaCategory:c.E,overtime:!0,campaign_appearance:e.campaigns_appearance,value:e.metricData("advocacy_percentage"),...C},{metric_title:"Sharers",metric_key:"sharers",data_identifier:"sharers",metricTooltip:"The number of Advocates who shared at least once",gaLabel:e.human_type,gaAction:"Chart Sharers Click",gaCategory:c.E,overtime:!1,campaign_appearance:e.campaigns_appearance,value:e.metricData("sharers")},{metric_title:"Sharing Rate",metric_key:"sharing_rate",tab_title:"Shares / Sharers",data_identifier:"sharing_rate",metricTooltip:"Shares/Sharers",gaLabel:e.human_type,gaAction:"Chart Sharing Rate Click",gaCategory:c.E,overtime:!0,campaign_appearance:e.campaigns_appearance,value:e.metricData("sharing_rate"),...C}]},get chartTemplate(){return i(e.statsTemplate)},get needFetchData(){return e.parentStore.needFetch||e.appearance_changed}}))).actions((e=>({deactivateAppearanceChange:()=>{e.appearance_changed=!1},changeAppearance:({selectedOption:{value:t}})=>{e.campaign_appearance!==t&&(e.campaigns_appearance=t,e.appearance_changed=!0,e.parentStore.clearTilesData(e.id),setTimeout((()=>{e.deactivateAppearanceChange()}),1),Utils.trackGAEvent(c.E,"change appearance"))}}))),N=r.types.compose(E,n.a),O=r.types.model("DashboardCampaignPerformanceTileConfig",{configuration:r.types.maybeNull(l.a)}).views((e=>({get campaignTagsForTooltip(){const t=e.configuration.campaign_tags;return _.some(t)?`'${t.join("', '")}'`:"all"},get eventsForTooltip(){const t=e.configuration.event_categories;return _.some(t)?`'${t.join("', '")}'`:"all"},get dynamicDescription(){return`Campaign performance metrics, taken from the following conversion events: ${e.eventsForTooltip} (both referral and not), and ${e.campaignTagsForTooltip} campaign tags. Includes QA-generated data.`},get statsTemplate(){return{advocate:[{metric_title:"Impressions",metric_key:"impressions",data_identifier:"impressions",explanationText:"The number of times an Advocate visited either Share page or Signup page, depending on campaign configuration",gaLabel:e.human_type,gaAction:"Chart Impressions Click",gaCategory:c.E,showPrefix:!1,value:e.metricData("impressions")},{metric_title:"Shares",metric_key:"shares",data_identifier:"shares",explanationText:"The number of times all Advocates shared",gaLabel:e.human_type,gaAction:"Chart Shares Click",gaCategory:c.E,showPrefix:!1,value:e.metricData("shares")},{metric_title:"Sharers",metric_key:"sharers",data_identifier:"sharers",explanationText:"The number of Advocates who shared at least once",gaLabel:e.human_type,gaAction:"Chart Sharers Click",gaCategory:c.E,showPrefix:!1,value:e.metricData("sharers")}],friend:[{metric_title:"Offer clicks",metric_key:"clicks",data_identifier:"clicks",gaLabel:e.human_type,gaCategory:c.E,gaAction:"Chart Offer clicks Click",explanationText:"The number of times a Friend clicked on an Advocate share link",showPrefix:!1,value:e.metricData("clicks")},{metric_title:"Site visits",metric_key:"visits",data_identifier:"visits",explanationText:"The number of times a Friend visited your site after clicking a share link",gaCategory:c.E,gaLabel:e.human_type,gaAction:"Chart Site visits Click",showPrefix:!1,value:e.metricData("visits")},{metric_title:"Referrals",metric_key:"purchases",data_identifier:"purchases",explanationText:"The number of referred friend checkouts",gaCategory:c.E,gaLabel:e.human_type,gaAction:"Chart Purchases Click",showPrefix:!1,value:e.metricData("purchases")}]}},get advocateStats(){return e.statsTemplate.advocate},get friendStats(){return e.statsTemplate.friend},get flattenedStatsList(){return[...e.advocateStats,...e.friendStats]}}))).actions((e=>({}))),x=r.types.compose(O,n.a),I=r.types.model("DashboardTalkableRevenueTileConfig",{inline_values:r.types.maybeNull(r.types.model({revenue_percentages:r.types.optional(r.types.map(r.types.frozen()),{})})),report_urls:r.types.maybeNull(r.types.model({all_time_revenue:r.types.maybeNull(r.types.string),aov:r.types.maybeNull(r.types.string),revenue:r.types.maybeNull(r.types.string),revenue_percentages:r.types.maybeNull(r.types.string),transactions:r.types.maybeNull(r.types.string)}))}).views((e=>({get dynamicDescription(){return"Ideal Sales. Excludes QA-generated data."},get statsTemplate(){return[{metric_title:"Revenue",metric_key:"revenue",data_identifier:"revenue",overtime:!0,gaLabel:e.human_type,gaAction:"Chart Revenue Click",gaCategory:c.E,className:"is-friend",colors:["rgba(237, 115, 18, 1)","rgba(149, 112, 195, .8)"],value:e.metricData("revenue")},{metric_title:"Transactions",metric_key:"transactions",data_identifier:"transactions",overtime:!0,gaLabel:e.human_type,gaAction:"Chart Transactions Click",gaCategory:c.E,showPrefix:!1,value:e.metricData("transactions")},{metric_title:"A.O.V.",metric_key:"aov",data_identifier:"aov",overtime:!1,gaLabel:e.human_type,gaAction:"Chart A.O.V. Click",gaCategory:c.E,value:e.metricData("aov")},{metric_title:"All Time Revenue",metric_key:"all_time_revenue",data_identifier:"all_time_revenue",overtime:!1,is_right:!0,show_previous_period:!1,tooltip:"This metric does not include stats for today. It updates once per day, not in real time.",gaLabel:e.human_type,gaAction:"Chart All Time Revenue Click",gaCategory:c.E,value:e.metricData("all_time_revenue")}]},get chartTemplate(){return i(e.statsTemplate)},get percentageOfRevenueTemplate(){return[{data_identifier:"revenue_percentages",show_previous_period:!1,overtime:!1,value:e.metricData("revenue_percentages")}]}}))).actions((e=>({}))),P=r.types.compose(I,n.a);var R=a("dhqo"),j=a.n(R);const D=r.types.model("DashboardCustomizableRevenueTileConfig",{configuration:r.types.maybeNull(l.a),inline_values:r.types.maybeNull(r.types.model({revenue_percentages:r.types.optional(r.types.map(r.types.frozen()),{})})),report_urls:r.types.maybeNull(r.types.model({all_time_revenue:r.types.maybeNull(r.types.string),aov:r.types.maybeNull(r.types.string),revenue:r.types.maybeNull(r.types.string),revenue_percentages:r.types.maybeNull(r.types.string),transactions:r.types.maybeNull(r.types.string)}))}).views((e=>({get advocateDescription(){const{advocate_sales:t}=e.configuration;if(!t.enabled)return"";return`${(()=>{const{friend_sales:t}=e.configuration;return t.enabled?"and ":""})()}advocate${(()=>{switch(t.options.new_customers){case"yes":return" (new customers)";case"no":return" (existing customers)";default:return""}})()}`},get advocateAdvancedDescription(){const{advocate_sales:t}=e.configuration;return t.enabled?"Advocate revenue is tracked via Talkable coupon code usage only.":""},get friendDescription(){const{friend_sales:t}=e.configuration;if(!t.enabled)return"";return`friend ${(()=>{switch(t.options.new_customers){case"yes":return" (new customers only)";case"no":return" (existing customers)";default:return""}})()}`},get friendAdvancedDescription(){const{friend_sales:t,friend_sales:{options:{ideal_timing:a,coupon_usage:r}}}=e.configuration;if(!t.enabled)return"";return`Friend revenue is tracked via Talkable ${"any"===r?"":r} coupon code${"unused"===r&&a?", follow Ideal Timing rules":""} or by cookie, email, or IP address${(()=>{const{isDashboardTilesStore:t,parentStore:{idealFriendTiming:a}}=e;return t?` for ${a} ${j()("days",a)} from the initial share/click`:""})()}.`},get dynamicDescription(){return`Includes ${e.friendDescription} ${e.advocateDescription} referral revenue. ${e.friendAdvancedDescription} ${e.advocateAdvancedDescription} Excludes QA-generated data.`},get percentageOfRevenueTemplate(){return[{data_identifier:"revenue_percentages",show_previous_period:!1,overtime:!1,...e.showRevenuePercentage&&{value:e.metricData("revenue_percentages")}}]},get distributionTemplate(){return[{metric_title:"Revenue",data_identifier:"revenue_distribution",...e.showRevenueSegmentation&&{value:e.metricData("revenue_distribution")}},{metric_title:"Transactions",data_identifier:"transactions_distribution",...e.showRevenueSegmentation&&{value:e.metricData("transactions_distribution")}},{metric_title:"A.O.V.",data_identifier:"aov_distribution",show_percentages:!1,...e.showRevenueSegmentation&&{value:e.metricData("aov_distribution")}}]},get statsTemplate(){return[{metric_title:"Revenue",metric_key:"revenue",data_identifier:"revenue",overtime:!0,gaLabel:e.human_type,gaAction:"Chart Revenue Click",gaCategory:c.E,className:"is-friend",colors:["rgba(237, 115, 18, 1)","rgba(149, 112, 195, .8)"],...e.graphMetricIsEnabled("revenue")&&{value:e.metricData("revenue")}},{metric_title:"Transactions",metric_key:"transactions",data_identifier:"transactions",overtime:!0,gaLabel:e.human_type,gaAction:"Chart Transactions Click",gaCategory:c.E,showPrefix:!1,...e.graphMetricIsEnabled("transactions")&&{value:e.metricData("transactions")}},{metric_title:"A.O.V.",metric_key:"aov",data_identifier:"aov",overtime:!1,gaLabel:e.human_type,gaAction:"Chart A.O.V. Click",gaCategory:c.E,...e.revenueMetricIsEnabled("aov")&&{value:e.metricData("aov")}},{metric_title:"All Time Revenue",metric_key:"all_time_revenue",data_identifier:"all_time_revenue",overtime:!1,is_right:!0,show_previous_period:!1,tooltip:"This metric does not include stats for today. It updates once per day, not in real time.",gaLabel:e.human_type,gaAction:"Chart All Time Revenue Click",gaCategory:c.E,...e.revenueMetricIsEnabled("all_time_revenue")&&{value:e.metricData("all_time_revenue")}}]},get showRevenueSegmentation(){return e.configuration.ui.revenue_segmentation.enabled},get showRevenuePercentage(){return e.configuration.ui.revenue_percentage},get showContent(){return e.showOvertimeChart||e.showRevenuePercentage||e.showRevenueSegmentation}}))).actions((e=>({}))),k=r.types.compose(D,s),T=r.types.model("TileConfigAbstractMetric",{}).views((e=>({get chartTemplate(){let t=[];return e.configuration.ui.overtime_chart&&(t=i(e.filteredStatsTemplate),_.isEmpty(t)&&(t=i(e.statsTemplate))),t},get chartTemplateData(){return e.showOvertimeChart&&e.chartTemplate},get filteredStatsTemplate(){return _.filter(e.statsTemplate,(t=>e.metricIsEnabled(t.metric_key)))},get showMetrics(){return _.some(e.filteredStatsTemplate)},get showOvertimeChart(){return e.configuration.ui.overtime_chart},metricIsEnabled:t=>_.get(e.configuration.ui,`${t}.identifier`)}))).actions((e=>({}))),A=r.types.compose(T,n.a),F=(A.create(),r.types.model("DashboardAbstractMetricTileConfig",{configuration:r.types.maybeNull(l.a)}).views((e=>({get dynamicDescription(){return`Includes ${e.metricsDescription} ${e.overtimeChartDescription} the overtime chart. Includes QA-generated data.`},get tileAbstractMetrics(){return _.values(_.pick(e.configuration.ui,["first_metric","second_metric","third_metric"]))},get tileAbstractMetricsHumanNameDescription(){return _.compact(_.map(e.tileAbstractMetrics,"humanName"))},get metricsDescription(){return e.tileAbstractMetricsHumanNameDescription.join(", ")},get overtimeChartDescription(){return e.showOvertimeChart?"with":"without"},get statsTemplate(){const{configuration:{ui:{first_metric:t,second_metric:a,third_metric:r}}}=e;return[{metric_key:"first_metric",data_identifier:t.identifier,metric_title:t.humanName,overtime:!0,...e.chartConfig("first_metric"),gaLabel:e.human_type,gaAction:`chart ${t.identifier} click`,gaCategory:c.E,...e.metricIsEnabled("first_metric")&&{value:e.metricData("first_metric")}},{metric_key:"second_metric",data_identifier:a.identifier,metric_title:a.humanName,overtime:!0,...e.chartConfig("second_metric"),gaLabel:e.human_type,gaAction:`chart ${a.identifier} click`,gaCategory:c.E,...e.metricIsEnabled("second_metric")&&{value:e.metricData("second_metric")}},{metric_key:"third_metric",data_identifier:r.identifier,metric_title:r.humanName,overtime:!0,...e.chartConfig("third_metric"),gaLabel:e.human_type,gaAction:`chart ${r.identifier} click`,gaCategory:c.E,...e.metricIsEnabled("third_metric")&&{value:e.metricData("third_metric")}}]},get showContent(){return e.showOvertimeChart},resultType:t=>e.configuration.ui[t].result_type,chartConfig:t=>({showPrefix:"money"===e.resultType(t),suffix:"percent"===e.resultType(t)&&"%"})}))).actions((e=>({})))),M=r.types.compose(F,A);var U=a("V0vo");const L=()=>Object(U.Q)({endDate:dayjs().subtract(1,"day").format("YYYY-MM-DD")}),B=r.types.model("DateValueSchema",{startDate:r.types.optional(r.types.maybeNull(r.types.string),L().startDate),endDate:r.types.optional(r.types.maybeNull(r.types.string),L().endDate)}),V=r.types.model("MetricSchema",{label:"Last 12 months",value:r.types.optional(B,{})}),$=r.types.model("TileConfigAllTimeMetric",{confirmedStartDate:r.types.maybeNull(r.types.string),confirmedEndDate:r.types.maybeNull(r.types.string),currentTimeRange:r.types.maybeNull(r.types.string),selectedRangeOption:r.types.optional(V,{}),periodDifference:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get dashboardTilesStore(){return e.rootStore.pages.dashboardTilesStore},get site(){return e.rootStore.models.site},get startDate(){return e.selectedRangeOption.value.startDate},get endDate(){return e.selectedRangeOption.value.endDate},get selectOptionsSiteAge(){return Object(U.T)({date:e.site.created_at})},get disableRangeSelect(){return _.isEmpty(e.selectOptionsSiteAge)},get disabledRangeSelectTooltip(){return e.disableRangeSelect?"This site was created less than a year ago, you cannot choose prior dates":null},get selectOptions(){return[{label:"Last 12 months",value:L()},...e.selectOptionsSiteAge]},get rawSelectedRangeOption(){return e.selectedRangeOption.toJSON()},get needFetch(){return e.periodDifference},get customReportUrl(){var t,a,r;return null==(t=e.statsTemplate[0].value)||null==(a=t.graph_data)||null==(r=a.current)?void 0:r.report_url}}))).actions((e=>({updateConfirmedTime:()=>{e.confirmedStartDate=e.startDate,e.confirmedEndDate=e.endDate},setCurrentRange:()=>{e.currentTimeRange=`${e.startDate}_${e.endDate}`},setPeriodDifference:Object(r.flow)((function*(){e.periodDifference=!0})),resetPeriodDifference:()=>{e.periodDifference=!1},handleDateChange:Object(r.flow)((function*(t){const{selectedOption:a}=t;e.selectedRangeOption=a,Utils.trackGAEvent(c.E,"All time metric tile date range filter click"),yield e.setNewTimeRange()})),setNewTimeRange:Object(r.flow)((function*(){e.updateConfirmedTime();const t=`${e.startDate}_${e.endDate}`;_.isEqual(t,e.currentTimeRange)||(e.setCurrentRange(),e.dashboardTilesStore.clearTilesData(e.id),yield e.setPeriodDifference(),e.resetPeriodDifference())}))}))),z=r.types.compose($,n.a),q=(z.create(),r.types.model("DashboardAllTimeMetricTileConfig",{configuration:r.types.maybeNull(l.a)}).views((e=>({get dynamicDescription(){return`${e.metricDescription} metric is displayed as an all-time bar chart by month.`},get metricDescription(){var t;return null==(t=e.configuration.ui)?void 0:t.metric.humanName},get metricResultType(){var t;return null==(t=e.configuration.ui)?void 0:t.metric.result_type},get chartScaleSuffix(){let t=!1;return"percent"===e.metricResultType&&(t="%"),t},get chartShowScalePrefix(){return"money"===e.metricResultType},get chartShowDataLabels(){return"percent"===e.metricResultType},get chartConfig(){return{type:"column",colors:["rgba(146, 214, 242, .75)","rgba(58, 136, 210, .7)"],hideLegend:!0,showPrefix:e.chartShowScalePrefix,calculatePeriod:!1,suffix:e.chartScaleSuffix,showDataLabels:e.chartShowDataLabels,prefix:e.site.currency_unit}},get statsTemplate(){return[{data_identifier:"metric_values",show_previous_period:!1,overtime:!1,...e.chartConfig,value:e.metricData("metric_values")}]}}))).actions((e=>({})))),W=r.types.compose(q,z)},ne91:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"g",(function(){return p})),a.d(t,"d",(function(){return u})),a.d(t,"b",(function(){return d}));var r=a("cr+I"),n=a.n(r),i=a("V0vo");const o=({currentSiteCachedSlug:e,currentUser:t})=>t?e?(e=>e&&Object(i.d)(e,"read"))(t)?Routes.site_path(e):Routes.customer_service_portal_person_lookup_site_path(e):"":_.get(window,"Constants.PUBLIC_URL_OPTIONS.host","/"),s=e=>c(Routes.site_origins_path(e))&&"Purchase"===n.a.parse(window.location.search)["origin[type]"],l=e=>{const t=[Routes.site_static_assets_path(e),Routes.site_coupon_lists_path(e),Routes.site_personal_coupon_lists_path(e),Routes.locale_entries_site_reports_path(e),Routes.site_settings_changes_path(e),Routes.site_previous_customers_path(e),Routes.site_event_uploads_path(e),Routes.site_secured_files_path(e)],a=[Routes.site_origins_path(e),Routes.site_visitor_offers_path(e),Routes.site_customer_emails_path(e)],r=[Routes.site_page_snapshots_path(e)],n=[...t,...a,...[Routes.site_split_tests_path(e)],...r];return c(Routes.site_reports_path(e))&&!c(Routes.site_reports_metrics_aggregation_path(e))||n.some(c)&&!s(e)},c=e=>location.pathname.includes(e),p=({currentUser:e,locationRouter:t})=>e&&!_.startsWith(_.get(t,"pathname")||location.pathname,"/staff"),u=()=>c(Routes.customer_service_portal_path()),d=({site:e,accountCurrentSite:t,currentUser:a})=>{var r;return(null==e?void 0:e.cached_slug)||(null==t?void 0:t.cached_slug)||(null==a?void 0:a.current_site_slug)||(null==(r=Utils)?void 0:r.getCurrentSite())}},nwwn:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("Bb2w");const i=r.types.model({criteria:r.types.optional(n.a,{})}).views((e=>({get router(){return e.rootStore.models.router},get rootStore(){return Object(r.getRoot)(e)},get appStorePage(){return Object(r.getParent)(e)},get variables(){return e.appStorePage.variables}}))).actions((e=>({updateLoading:(t=!0)=>{e.isLoading=t}})))},"o+QP":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return m}));var r=a("TyAF"),n=a("GaHK"),i=a("Ty5D"),o=a("kigN"),s=a("KfdZ"),l=a("1rZ2"),c=a("XIAt"),p=a("TGZC"),u=a("H42K");function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const m=Object(r.c)(function(t){var a,r;function m(){return t.apply(this,arguments)||this}return r=t,(a=m).prototype=Object.create(r.prototype),a.prototype.constructor=a,d(a,r),m.prototype.render=function(){return e.createElement(e.Fragment,null,e.createElement("div",{className:"App-holder"},e.createElement(l.a,null),e.createElement("div",{className:"App-container-inner"},e.createElement(n.H1,{className:"mbxl"},"My profile"),e.createElement(n.UIHolder,null,e.createElement(p.a,null),e.createElement(n.UIHolderContent,null,e.createElement(i.g,null,e.createElement(i.d,{exact:!0,path:Routes.edit_user_path(),component:o.b}),e.createElement(i.d,{path:Routes.tfa_settings_user_path(),component:s.b}),e.createElement(i.d,{path:Routes.invite_user_path(),component:u.a})))))),e.createElement(c.a,null))},m}(e.PureComponent))}).call(this,a("q1tI"))},o2Zq:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("99Ma");const n=r.types.model("SampleData",{caption:r.types.maybeNull(r.types.string),email_sender:r.types.maybeNull(r.types.string)}),i=r.types.model("PresetSchema",{id:r.types.identifierNumber,cached_slug:r.types.maybeNull(r.types.string),default:!1,height:r.types.maybeNull(r.types.string),identifier:r.types.maybeNull(r.types.string),name:r.types.maybeNull(r.types.string),preview_url:r.types.maybeNull(r.types.string),sample:r.types.maybeNull(r.types.optional(n,{})),updated_at:r.types.maybeNull(r.types.string),view_setup_id:r.types.maybeNull(r.types.number),width:r.types.maybeNull(r.types.string),split_test_variant_ids:r.types.array(r.types.number)}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({get firstSplitTestVariantId(){return e.split_test_variant_ids.slice()[0]||""},get iframeName(){return`${e.view_setup_id}_${e.id||""}_${e.firstSplitTestVariantId}`}}))).actions((()=>({}))),o=r.types.model({showHumanCriteria:!1}).views((()=>({}))).actions((e=>({toggleHumanCriteria:()=>{e.showHumanCriteria=!e.showHumanCriteria}}))),s=r.types.model("SampleEmail",{sendingSampleEmail:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get currentUser(){return e.rootStore.models.currentUser}}))).actions((t=>({updateSendingSampleEmail:e=>{t.sendingSampleEmail=e},sendSampleEmail:Object(r.flow)((function*({campaignId:a,viewSetupId:n,presetId:i}){try{t.updateSendingSampleEmail(!0);const e=yield $.ajax({type:"PUT",url:Routes.deliver_sample_email_site_campaign_view_setup_view_preset_path(t.siteCachedSlug,a,n,i||"default-preset"),data:{email:t.currentUser.email,emailtests:!1}});UINotifications.add({text:e.message,type:"success"})}catch(xhr){UINotifications.add({text:"Unable to send sample email",type:"error"}),e({name:"Unable to send sample email",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.updateSendingSampleEmail(!1)}}))}))),l=r.types.compose("Preset",i,s,o)}).call(this,a("B9cq").notifyDevelopers)},"o8+a":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("9Fy+"),i=a("pm75"),o=a("x7QQ");const s=r.types.compose("PerformanceData",o.a.model(n.a),i.c).views((e=>({get campaignShowPage(){return Object(r.getParent)(e)},get siteCachedSlug(){return e.campaignShowPage.siteCachedSlug},get currentCampaign(){return e.campaignShowPage.currentCampaign},get isLoaded(){return e.network.get.isLoaded},get metrics(){return e.data.report_data.metrics}}))).actions((t=>({apiGet:Object(r.flow)((function*(){try{t.network.get.updateLoading(!0);const e=yield $.ajax({url:Routes.widget_internal_site_campaign_path(t.siteCachedSlug,t.currentCampaign.id,{report:"funnel",no_spinner:!0})});t.dataApplySnapshot(e.result),t.network.get.updateLoaded(!0)}catch(xhr){e({name:"Unable to get funnel data",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.network.get.updateLoading(!1)}}))})))}).call(this,a("B9cq").notifyDevelopers)},oA8Q:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return y}));var r=a("99Ma"),n=a("E+oP"),i=a.n(n),o=a("bNQv"),s=a.n(o),l=a("Puqe"),c=a.n(l),p=a("UlA6"),u=a("V0vo"),d=a("B9cq"),m=a("nKCY"),g=a("3R0T");const h=r.types.model("AccountData",{id:r.types.maybeNull(r.types.number),name:r.types.maybeNull(r.types.string),created_at:r.types.maybeNull(r.types.string),updated_at:r.types.maybeNull(r.types.string),billing_start_at:r.types.maybeNull(r.types.string),time_zone:r.types.maybeNull(r.types.string),time_zone_identifier:r.types.maybeNull(r.types.string),api_key:r.types.optional(r.types.union(r.types.string,r.types.null),""),public_api_key:r.types.optional(r.types.union(r.types.string,r.types.null),""),database_shard:r.types.maybeNull(r.types.number),require_branding:r.types.optional(r.types.union(r.types.boolean,r.types.null),!1),blocked_ips:r.types.maybeNull(r.types.string),blocked_emails:r.types.maybeNull(r.types.string),qa_ips:r.types.maybeNull(r.types.string),qa_emails:r.types.maybeNull(r.types.string),password_expiration_period:r.types.maybeNull(r.types.number),inactivity_timeout:r.types.maybeNull(r.types.number),restrict_login_to_sso_only:r.types.optional(r.types.union(r.types.boolean,r.types.null),!1),saml_idp_entity_id:r.types.maybeNull(r.types.string),saml_idp_cert:r.types.maybeNull(r.types.string),saml_idp_cert_fingerprint:r.types.maybeNull(r.types.string),saml_idp_configure_automatically:r.types.maybeNull(r.types.boolean),saml_idp_metadata_url:r.types.maybeNull(r.types.string),saml_idp_sso_target_url:r.types.maybeNull(r.types.string),self_serve:r.types.maybeNull(r.types.boolean)}),y=r.types.model("AccountStore",{account:r.types.optional(h,{}),accountData:r.types.optional(h,{}),constants:r.types.frozen(),current_site_slug:r.types.maybeNull(r.types.string),errors:r.types.frozen(),submitting:!1,initialDataFetched:!1,metrics:r.types.array(g.a),metricsFetched:!1}).views((e=>({get changesExist(){return!i()(e.changes)},get changes(){return Object(u.g)(e.accountData,e.account)},get visibleMetrics(){return e.metrics.filter((e=>e.visible))},get metricsForSelect(){return _.transform(e.visibleMetrics,((e,t)=>{const a={label:t.name,value:t.identifier,human_type:t.human_type};e.push(a)}),[])},get groupedMetrics(){return _.groupBy(e.metricsForSelect,"human_type")},get groupedMetricsForSelect(){return _.transform(e.groupedMetrics,((e,t,a)=>{const r={label:a,options:t};e.push(r)}),[])}}))).actions((t=>({changeMetricsFetched:e=>{t.metricsFetched=e},handleChangeField:e=>{const{target:{name:a,value:r}}=e;t.accountData[a]=r,t.changesExist&&t.clearErrors()},handleChangeConfigureAutomatically:e=>{t.handleChangeField(e),["saml_idp_entity_id","saml_idp_sso_target_url","saml_idp_cert","saml_idp_cert_fingerprint"].forEach((e=>{t.handleChangeField({target:{name:e,value:t.account[e]}})}))},cancelChanges:e=>{e&&e.preventDefault(),s()(t.account,((e,a)=>{t.accountData[a]=t.account[a]})),t.clearErrors()},updateSubmitting:e=>{t.submitting=e},prepareData:()=>c()(t.changes,p.a),addToBlacklist:Object(r.flow)((function*({type:e,value:a}){const r=i()(t.accountData[`blocked_${e}`])?a:t.accountData[`blocked_${e}`]+`\n${a}`;t.accountData[`blocked_${e}`]=r,yield t.handleSubmit()})),fetchData:Object(r.flow)((function*(a=!0){try{const{result:e}=yield Object(d.ajax)({url:Routes.internal_account_path(t.account.id)});t.updateData(e),a&&Validation.succeed()}catch(xhr){e({name:"Unable to fetch Account data",message:"Ajax failure",xhr:xhr})}})),updateData:e=>{t.update(e.account),t.updateConstants(e.constants),t.updateCurrentSiteSlug(e.current_site_slug),t.initialDataFetched=!0},updateCurrentSiteSlug:e=>{t.current_site_slug=e},fetchMetrics:()=>{$.ajax({url:Routes.internal_account_metrics_path(t.account.id),data:{no_spinner:!0}}).then((e=>{t.updateAccountMetrics(e.result.metrics),t.changeMetricsFetched(!0)})).fail((t=>{e({name:"Unable to fetch account metrics",message:"Ajax failure",xhr:t})}))},updateAccountMetrics:e=>{t.metrics=e},handleSubmit:async a=>{null==a||a.preventDefault(),t.updateSubmitting(!0);try{await Object(d.ajax)({url:Routes.internal_account_path(t.account.id),type:"PUT",data:{account:t.prepareData()}}),t.updateSubmitting(!1),t.fetchData()}catch(xhr){var r,n;Validation.showErrorFlash(),t.updateSubmitting(!1);const i=null==xhr||null==(r=xhr.responseJSON)||null==(n=r.result)?void 0:n.errors;t.handleErrors(i||{}),i||e({message:"Unable update account data",name:"Ajax failure",xhr:xhr})}},handleErrors:e=>{t.errors=e},clearErrors:()=>{t.errors={}},update:e=>{s()(e,((a,r)=>{switch(r){case"billing_start_at":{const a=e[r]?dayjs(e[r]).tz(e.time_zone_identifier).format("L"):e[r];t.account[r]=a,t.accountData[r]=a;break}default:t.account[r]=e[r],t.accountData[r]=e[r]}}))},updateConstants:e=>{t.constants=e}}))),f=y.create();Object(m.a)(f)}).call(this,a("B9cq").notifyDevelopers)},oYvJ:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return d}));var r=a("vOnD"),n=a("TyAF"),i=a("55Ip"),o=a("Ty5D"),s=a("GaHK"),l=a("sT1B");function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const p=Object(r.default)(s.UIButton).withConfig({displayName:"campaign_navigation_main__NavigationLink"})(["padding-top:16px;padding-bottom:16px;border-bottom:3px solid transparent !important;border-radius:0;",""],(e=>{if(e.isActive)return Object(r.css)(["color:#000;border-bottom:3px solid #ff4f00 !important;&:hover,&:active,&:focus,&:visited{color:#000;}"])})),u=Object(r.default)(i.NavLink).withConfig({displayName:"campaign_navigation_main__NavLinkStyle"})(["",";font-size:16px;padding-top:16px;padding-bottom:16px;border-bottom:3px solid transparent !important;border-radius:0;&.is-active{color:#000;border-bottom:3px solid #ff4f00 !important;}"],s.Theme.fontWeights.bold),d=Object(o.o)(Object(n.b)((({rootStore:e})=>({rootStore:e,campaignShowRoot:e.pages.campaignShowRoot})))(Object(n.c)(function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,c(a,r),n.prototype.render=function(){const{rootStore:t,campaignShowRoot:{editorPath:a,currentCampaign:r,currentCampaign:{leaderboard:n,test_mode:i,gleam:o},campaignWarnings:s,campaignShowPage:{siteCachedSlug:c}},active_tab:d,isSpa:m}=this.props;return e.createElement("ul",{className:"flex align-items-center man mtl ac-campaign-navigation-main"},(r.referralSpace||r.conversionSpace)&&e.createElement("li",{className:"mrxl"},m?e.createElement(u,{exact:!0,to:Routes.site_campaign_path(c,t.urlSpaceParameter,r.id),className:"link js-ga-click",activeClassName:"is-active","data-category":l.q,"data-action":"nav click","data-label":"details","data-router":!0},"Details"):e.createElement(p,{trait:"action",href:Routes.site_campaign_path(c,t.urlSpaceParameter,r.id),isActive:"details"===d,"data-category":l.q,"data-action":"nav click","data-label":"details"},"Details")),n&&!i&&e.createElement("li",{className:"mrxl"},e.createElement(p,{trait:"action",href:Routes.leaderboard_path(c,r.id),isActive:"leaderboard"===d,"data-category":l.q,"data-action":"nav click","data-label":"leaderboard"},"Leaderboard")),e.createElement("li",{className:"mrxl"},m?e.createElement(u,{exact:!0,to:Routes.edit_site_campaign_path(c,t.urlSpaceParameter,r.id),className:"link js-ga-click",activeClassName:"is-active","data-category":l.q,"data-action":"nav click","data-label":"rules","data-router":!0,"data-wizard-area":"rules"},"Rules"):e.createElement(p,{trait:"action",href:Routes.edit_site_campaign_path(c,t.urlSpaceParameter,r.id,{anchor:"/"}),isActive:"rules"===d,"data-category":l.q,"data-action":"nav click","data-label":"rules","data-wizard-area":"rules"},"Rules")),e.createElement("li",{className:"mrxl"},e.createElement(p,{trait:"action",href:Routes.preview_site_campaign_path(c,t.urlSpaceParameter,r.id),isActive:"preview"===d,"data-category":l.q,"data-action":"nav click","data-label":"preview"},"Preview")),e.createElement("li",{className:"mrxl"},e.createElement(p,{trait:"action",className:"js-ga-click","data-wizard-area":"editor","data-category":l.q,"data-action":"nav click","data-label":"editor",href:a},"Editor")),t.isReferralSpace&&e.createElement(e.Fragment,null,e.createElement("li",{className:"mrxl"},o?e.createElement("div",{"aria-label":"You cannot create A/B tests inside Gleam campaign","data-balloon-pos":"up"},e.createElement(p,{trait:"action",disabled:!0,className:"is-disabled"},"A/B Tests")):e.createElement(p,{trait:"action",href:Routes.ab_tests_site_campaign_path(c,r.id),isActive:"ab_tests"===d,"data-category":l.q,"data-action":"nav click","data-label":"a/b tests"},"A/B Tests")),e.createElement("li",{className:"mrxl"},e.createElement(p,{trait:"action",isActive:"qa"===d,"data-category":l.q,"data-action":"nav click","data-label":"QA",href:Routes.qa_test_site_campaign_path(c,r.id)},"QA",s.isSignificantSeverities&&e.createElement("span",{"data-testid":"ac-cd-warnings-badge",className:"subnav-menu-unread"},"!")))))},n}(e.PureComponent))))}).call(this,a("q1tI"))},ojmY:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o}));var r=a("sT1B");const n=e=>e.type===r.V.event,i=e=>e.type===r.V.other,o=e=>e.type===r.V.referral},pNxA:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a("99Ma"),n=a("aFzQ"),i=a("sT1B"),o=a("vrPu"),s=a("Jpk0"),l=a("mxly");const c=r.types.compose(s.a,r.types.model({})).views((e=>({get loyaltyTiersRootStore(){return Object(r.getParentOfType)(e,l.a)},get prevTier(){return _.last(this.loyaltyTiersRootStore.sortedTiers)},get isBaseTier(){return _.isEmpty(this.prevTier)},get minThreshold(){return this.prevTier?_.round(this.prevTier.threshold+i.fb.thresholdStep,2):0},get maxThreshold(){return this.isBaseTier?0:1/0},get minMultiplier(){return this.isBaseTier?1:this.prevTier.multiplier},get maxMultiplier(){return 1/0}}))),p=r.types.model("LoyaltyRedemptionRulesNewStore",{data:r.types.optional(c,{}),initialData:r.types.optional(s.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignRulesStore(){return Object(r.getParentOfType)(e,o.a)},get loyaltyTiersRootStore(){return Object(r.getParentOfType)(e,l.a)},get isPristine(){return _.isEqual(Object(n.toJS)(e.initialData),Object(n.toJS)(e.data))}}))).actions((e=>{const t=t=>{Object(r.applySnapshot)(e.data,t),Object(r.applySnapshot)(e.initialData,t)},a=Object(r.flow)((function*(){try{yield e.loyaltyTiersRootStore.tiersData.create({campaignId:e.campaignRulesStore.campaign.id,data:{tier:e.data.preparedDataForServer},iconUrl:e.data.iconUrl}),i()}catch(t){throw"CDN failure"!==t&&e.data.updateErrors(t),new Error("Unable to create points redemption batch")}})),i=()=>{Object(r.applySnapshot)(e,{})};return{init:()=>{const t={name:e.data.prevTier?"":"Base",threshold:e.data.minThreshold,multiplier:e.data.minMultiplier};Object(r.applySnapshot)(e,{data:t,initialData:t})},updateData:t,handleCreate:a,handleDiscardChanges:()=>{t(Object(n.toJS)(e.initialData))},reset:i}}))},pTlx:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("q1tI");const n=()=>(Object(r.useEffect)((()=>{window.scrollTo(0,0)}),[]),null)},pW1z:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return h}));var r=a("TyAF"),n=a("vOnD"),i=a("GaHK");function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const s=n.default.div.withConfig({displayName:"frequently_used_variables__Wrapper"})(["padding:20px 0;background-color:#fafafa;border-top:1px solid #ebebeb;"]),l=n.default.div.withConfig({displayName:"frequently_used_variables__Title"})(["margin:0 30px 20px 30px;color:#333;font-family:'gotham-htf-bold',Arial,sans-serif;font-size:18px;line-height:1;"]),c=n.default.div.withConfig({displayName:"frequently_used_variables__Variable"})(["position:relative;padding:5px 30px;display:flex;align-items:center;justify-content:space-between;&:last-child{margin-bottom:0;}&:hover{background-color:#e5f0fb;}"]),p=n.default.div.withConfig({displayName:"frequently_used_variables__Name"})(["cursor:pointer;"]),u=n.default.span.withConfig({displayName:"frequently_used_variables__Path"})(["font-size:13px;color:#2aa198;font-weight:bold;font-family:Monaco,Menlo,Consolas,'Courier New',monospace;",":hover &{color:#0070d9;}"],c),d=n.default.span.withConfig({displayName:"frequently_used_variables__Key"})(["font-size:13px;color:#666;font-family:Monaco,Menlo,Consolas,'Courier New',monospace;",":hover &{color:#0070d9;}"],c),m=n.default.div.withConfig({displayName:"frequently_used_variables__Value"})(["max-width:165px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:13px;color:#d33682;font-family:Monaco,Menlo,Consolas,'Courier New',monospace;"]),g=Object(n.default)(i.UICopyable).withConfig({displayName:"frequently_used_variables__CopyableIcon"})(["&&{position:absolute;top:50%;right:5px;transform:translateY(-50%);display:none;cursor:pointer;.sign-svg{margin-right:0;}",":hover &{display:block;}}"],c),h=Object(r.c)(function(t){var a,r;function n(...e){var a;return(a=t.call(this,...e)||this).handleClickCopy=e=>()=>{a.props.infoSidebarStore.gaTrackCopyVariable(e)},a}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,o(a,r),n.prototype.render=function(){const{infoSidebarStore:{frequentlyUsedVariables:t}}=this.props;return _.some(t)&&e.createElement(s,{"data-testid":"ac-info-sidebar-variables-block"},e.createElement(l,null,"Frequently used variables"),t.map(((t,a)=>e.createElement(c,{key:a},e.createElement(p,{"aria-label":t.description,"data-balloon-pos":"right","data-balloon-length":"medium"},e.createElement(u,null,t.path),e.createElement(d,null,`.${t.key}`)),e.createElement(m,null,`${t.value}`),e.createElement(g,{text:`{{ ${t.path}.${t.key} }}`,balloonPosition:"left",onClick:this.handleClickCopy(`${t.path}.${t.key}`)},e.createElement(i.UIIcon,{name:"copy",width:"20",fill:"#0070d9"}))))))},n}(e.Component))}).call(this,a("q1tI"))},pX3F:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("sT1B");const n=()=>{var e;e=r.y,ReactDOM.unmountComponentAtNode(document.getElementById(e))}},pm75:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o}));var r=a("99Ma");const n=r.types.model("LoadingStatus",{status:r.types.optional(r.types.union(r.types.literal("blank"),r.types.literal("in_progress"),r.types.literal("success"),r.types.literal("error")),"blank"),isLoading:!1,isLoaded:!1}).actions((e=>({updateLoading:t=>{e.isLoading=t},update(t){e.status=t,"in_progress"!==t?("success"===e.status&&e.updateLoaded(!0),e.updateLoading(!1)):e.updateLoading(!0)},updateLoaded:t=>{e.isLoaded=t}}))),i=r.types.model("Network",{post:r.types.optional(n,{}),patch:r.types.optional(n,{}),get:r.types.optional(n,{}),put:r.types.optional(n,{}),delete:r.types.optional(n,{})}),o=r.types.model("NetworkModel",{network:r.types.optional(i,{})})},q42M:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("pm75"),i=a("x7QQ");const o=r.types.model("RewardMetric",{identifier:"",plain:r.types.maybeNull(r.types.number),formatted:"",humanized:""}).views((e=>({}))).actions((e=>({}))),s=r.types.model("RewardsEventCategory",{identifier:"",metrics:r.types.array(o),report_path:""}).views((e=>({get rewardCount(){return e.getMetricByName("email_capture_rewards_count")},get rewardsSum(){return e.getMetricByName("email_capture_rewards_sum")},get couponCount(){return e.getMetricByName("email_capture_used_coupon_count")},get couponSum(){return e.getMetricByName("email_capture_used_coupon_sum")},getMetricByName:t=>e.metrics.find((e=>e.identifier===t))}))).actions((e=>({}))),l=r.types.model("RewardsSchema",{report_data:r.types.array(s),report_path:r.types.maybeNull(r.types.string)}).views((e=>({get filteredEventCategories(){return e.report_data.filter((e=>0!==_.sumBy(e.metrics,"plain")))},get anyFilteredEventCategories(){return _.some(e.filteredEventCategories)}}))).actions((e=>({}))),c=r.types.compose("RewardsData",i.a.model(l),n.c).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignShowRoot(){return e.rootStore.pages.campaignShowRoot},get currentCampaign(){return e.campaignShowRoot.currentCampaign},get site(){return e.rootStore.models.site},get siteCachedSlug(){return e.site.siteCachedSlug},get isLoaded(){return e.network.get.isLoaded}}))).actions((t=>({apiGet:Object(r.flow)((function*(){try{t.network.get.updateLoading(!0);const e=yield $.ajax({url:Routes.widget_internal_site_campaign_path(t.siteCachedSlug,t.currentCampaign.id,{report:"rewards",no_spinner:!0})});t.dataApplySnapshot(e.result),t.network.get.updateLoaded(!0)}catch(xhr){e({name:"Unable to fetch email capture rewards",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.network.get.updateLoading(!1)}}))})))}).call(this,a("B9cq").notifyDevelopers)},qfPl:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return p}));var r=a("vOnD"),n=a("GaHK"),i=a("55Ip");function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const s=Object(r.default)(n.UIMenuDropdown.Item).withConfig({displayName:"header_menu_item__HeaderUserMenuItemStyleOverride"})(["&&{padding:0;min-width:200px;display:flex;align-items:center;max-width:240px;& > a{padding:12px 20px;",";width:100%;color:",";display:flex;",";",";&:hover{",";}}span{white-space:normal;}&:first-child{border-top:none;}}"],(({isSmall:e})=>e&&Object(r.css)(["padding:10px 12px;"])),(({color:e})=>e||"#555555"),n.Theme.fontWeights.medium,(({withDescription:e})=>e?Object(r.css)(["","{margin-top:3px;}"],c):Object(r.css)(["align-items:center;"])),(({hoveredColor:e,iconHoveredColor:t})=>Object(r.css)(["color:",";.sign-svg-fill{fill:",";}"],e||n.Theme.color.black100,t||e||n.Theme.color.black100))),l=r.default.div.withConfig({displayName:"header_menu_item__LinkStyleOverride"})(["display:block;"]),c=r.default.div.withConfig({displayName:"header_menu_item__IconWrap"})(["width:24px;height:24px;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-right:8px;svg{margin:0;}",""],(({isSmall:e})=>e&&Object(r.css)(["width:16px;height:16px;"])));let p=function(t){var a,r;function p(...e){var a;return(a=t.call(this,...e)||this).checkActive=(e,t)=>{const{locationRouter:r}=a.props;return Array.isArray(t)?t.some(a.checkActive):_.startsWith(_.get(r,"pathname")||location.pathname,e.split("?")[0])},a}return r=t,(a=p).prototype=Object.create(r.prototype),a.prototype.constructor=a,o(a,r),p.prototype.render=function(){const{href:t,locationRouter:a,isRouterLink:r,name:o,linksActive:p,icon:u,color:d,hoveredColor:m,iconHoveredColor:g,description:h,isSmall:y}=this.props;return e.createElement(s,{color:d,hoveredColor:m,iconHoveredColor:g,isActive:this.checkActive(t,p),isLink:!0,withDescription:h,isSmall:y},e.createElement(l,{to:a&&r?t:void 0,href:a&&r?void 0:t,as:a&&r?i.Link:"a"},e.createElement(c,{isSmall:y},u()),e.createElement("span",null,o,h&&e.createElement(e.Fragment,null,e.createElement("br",null),e.createElement(n.BodyD,{color:n.Theme.color.black75},h)))))},p}(e.PureComponent)}).call(this,a("q1tI"))},qnoz:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return S}));var r=a("TyAF"),n=a("vOnD"),i=a("ZaDd"),o=a("GaHK");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const l=Object(n.default)(o.UIIcon).withConfig({displayName:"variable__TriangleWarningStyleOverride"})(["width:12px;height:12px;margin-left:6px;"]),c=({children:t,mark:a})=>e.createElement("div",{className:"flex align-items-center"},t,"deprecated"===a&&e.createElement("div",{className:"flex align-items-center",title:"Variable is deprecated","data-toggle":"tooltip","data-placement":"top","data-container":"body"},e.createElement(l,{name:"triangleWarning"}))),p=n.default.div.withConfig({displayName:"variable__View"})(["margin-bottom:10px;"]),u=n.default.div.withConfig({displayName:"variable__HeadContainer"})(["",";display:flex;padding-right:30px;justify-content:space-between;align-items:center;height:28px;",";",";&:hover{background-color:#e5f0fb;}"],(e=>e.open?Object(n.css)(["position:sticky;top:-20px;z-index:1;margin-right:10px;background-color:#fff;box-shadow:0 10px 20px -10px rgba(0,0,0,0.16);"]):Object(n.css)(["position:relative;"])),(e=>e.match&&Object(n.css)(["background-color:#e5f0fb;"])),(e=>e.active&&Object(n.css)(["background-color:yellow;"]))),d=n.default.div.withConfig({displayName:"variable__NestedContainer"})(["margin-left:25px;"]),m=n.default.div.withConfig({displayName:"variable__NestedKey"})(["margin-left:25px;padding-right:30px;position:relative;cursor:pointer;",";",";",";&:hover{background-color:#e5f0fb;}"],(e=>e.spaceBetween&&Object(n.css)(["display:flex;justify-content:space-between;align-items:center;"])),(e=>e.match&&Object(n.css)(["background-color:#e5f0fb;"])),(e=>e.active&&Object(n.css)(["background-color:yellow;"]))),g=Object(n.default)(o.UICopyable).withConfig({displayName:"variable__CopyableIcon"})(["&&{position:absolute;top:50%;right:5px;transform:translateY(-50%);display:none;cursor:pointer;.sign-svg{margin-right:0;}",":hover &{display:block;}",":hover &{display:block;}}"],m,u),h=n.default.div.withConfig({displayName:"variable__Name"})(["position:relative;padding-left:30px;display:inline-flex;font-size:13px;font-family:Monaco,Menlo,Consolas,'Courier New',monospace;font-weight:",";color:",";line-height:18px;cursor:pointer;&:before{position:absolute;top:50%;left:10px;transform:translateY(-50%);display:block;",";}",";",":hover &{color:#0070d9;}",":hover &{color:#0070d9;}"],(e=>e.head?"bold":"normal"),(e=>e.head?"#2aa198":"#666"),(e=>{return t=e.preContent,a=e.open,t?`content: "${a?"-":"+"}"`:'content: ""';var t,a}),(e=>e.match&&Object(n.css)(["color:#0070d9;"])),m,u),y=n.default.div.withConfig({displayName:"variable__TypeValue"})(["max-width:190px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:13px;line-height:18px;font-family:Monaco,Menlo,Consolas,'Courier New',monospace;color:",";",":hover &{color:#0070d9;}",":hover &{color:#0070d9;}"],(e=>e.match?"#0070d9":(e=>{switch(e){case"object":return"#999";case"string":case"array":return"#d33682";case"number":return"#5199dd";case"boolean":return"#b58900"}})(e.type)),m,u),f=n.default.div.withConfig({displayName:"variable__OptionsWrapper"})(["margin-left:56px;font-family:Monaco,Menlo,Consolas,'Courier New',monospace;font-size:12px;line-height:22px;color:#999;"]),b=({className:e,path:t,match:a})=>classNames(e,{[Object(i.d)(t)]:a}),v=({name:t,value:a,type:r,open:n,match:i,pathActiveMatchNode:s,toggleOpenByPath:l,onClickCopy:p})=>_.isObject(a)?_.reduce(a,((t,a,r)=>{if(n||a.open){let n={};n=_.isObject(a.value)?e.createElement(e.Fragment,{key:r},e.createElement(m,{onClick:e=>{l(e,a.path)},match:a.match,className:b({className:"pts pbs",path:a.path,match:a.match}),active:s===a.path},e.createElement(c,{mark:a.mark},e.createElement(h,{preContent:!0,open:a.open,match:a.match},e.createElement("div",{title:a.description,"data-toggle":"tooltip","data-placement":"top","data-container":"body"},r)))),e.createElement(d,null,e.createElement(v,{name:r,value:a.value,open:a.open,type:a.type,match:a.match,pathActiveMatchNode:s,onClickCopy:p,toggleOpenByPath:l}))):e.createElement(m,{key:r,spaceBetween:!0,match:a.match,className:b({className:"pts pbs",path:a.path,match:a.match}),active:s===a.path},e.createElement(c,{mark:a.mark},e.createElement("div",{title:a.description,"data-toggle":"tooltip","data-placement":"top","data-container":"body"},e.createElement(h,{preContent:!1,open:a.open,match:a.match},`${r}`))),e.createElement(v,{name:r,value:a.value,open:a.open,type:a.type,match:a.match,pathActiveMatchNode:s,onClickCopy:p,toggleOpenByPath:l}),e.createElement(g,{text:a.copyPath,balloonPosition:"left",onClick:p(a.path)},e.createElement(o.UIIcon,{name:"copy",width:"20",fill:"#0070d9"}))),t.push(n)}return t}),[]):e.createElement(y,{type:r,match:i},`${a}`),S=Object(r.c)(function(t){var a,r;function n(...e){var a;return(a=t.call(this,...e)||this).handleClickCopy=e=>()=>{a.props.gaTrackCopyVariable(e)},a}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r),n.prototype.render=function(){const{name:t,value:a,open:r,match:n,type:s,description:l,mark:d,path:m,copyPath:S,options:w,toggleOpenByPath:C,pathActiveMatchNode:E}=this.props;return e.createElement(p,{"data-testid":"ac-info-sidebar-bar-variable"},_.isObject(a)&&a!==i.b&&a!==i.a?e.createElement(e.Fragment,null,e.createElement(u,{match:n,className:b({path:m,match:n}),active:E===m,open:r},e.createElement(c,{mark:d},e.createElement(h,{onClick:e=>{C(e,m)},head:!0,preContent:!0,open:r,match:n},e.createElement("div",{title:l,"data-toggle":"tooltip","data-placement":"top","data-container":"body"},e.createElement("span",null,t))))),e.createElement("div",null,e.createElement(v,{name:t,value:a,open:r,type:s,match:n,description:a.description,pathActiveMatchNode:E,toggleOpenByPath:C,onClickCopy:this.handleClickCopy}))):e.createElement(u,{match:n,className:b({path:m,match:n}),active:E===m},e.createElement(h,{head:!0,title:l,"data-toggle":"tooltip","data-placement":"top","data-container":"body",match:n},e.createElement("span",null,t)),e.createElement(y,{type:s,match:n},a),e.createElement(g,{text:S,balloonPosition:"left",onClick:this.handleClickCopy(m)},e.createElement(o.UIIcon,{name:"copy",width:"20",fill:"#0070d9"}))),_.some(w)&&e.createElement(f,null,"Options: ",w.join(", ")))},n}(e.Component))}).call(this,a("q1tI"))},qqdH:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("Md/s");function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let i=function(t){var a,i;function o(){return t.apply(this,arguments)||this}return i=t,(a=o).prototype=Object.create(i.prototype),a.prototype.constructor=a,n(a,i),o.prototype.render=function(){return e.createElement("div",{className:"flex","data-testid":"ac-unautorized-user-subheader"},e.createElement(r.c,{href:"/",className:"mll",height:"54px"},"Home"),e.createElement(r.c,{href:Routes.walkthrough_path(),height:"54px",className:"mll"},"Learn More"),e.createElement(r.c,{href:documentationURL(),height:"54px",target:"_blank",className:"mll"},"Documentation"))},o}(e.PureComponent)}).call(this,a("q1tI"))},rSsM:function(e,t,a){"use strict";(function(e){var r=a("55Ip"),n=a("GaHK");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(t=[]){return t.map(((t={})=>{const a=classNames("App-navbar-links",{[t.className]:t.className});return t.isRouterLink?e.createElement(r.Link,{to:t.href,className:a,key:`link-${_.uniqueId()}`},t.icon&&e.createElement(n.UIIcon,{name:t.icon}),e.createElement("span",{className:"inline"},t.text)):e.createElement("a",{href:t.href,className:a,key:`link-${_.uniqueId()}`},t.icon&&e.createElement(n.UIIcon,{name:t.icon}),e.createElement("span",{className:"inline"},t.text))}))}let s=function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,i(a,r),n.prototype.render=function(){const{leftPanel:t,rightPanel:a,children:r}=this.props;return e.createElement("div",{className:"App-navbar"},e.createElement("div",{className:"App-container-inner App-navbar-grid"},e.createElement("div",{className:"App-navbar-box"},r||o(t)),e.createElement("div",{className:"App-navbar-box"},o(a))))},n}(e.PureComponent);t.a=s}).call(this,a("q1tI"))},rToH:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return g}));var r=a("99Ma"),n=a("sT1B"),i=a("lhCq"),o=a("+FEe"),s=a("wtXR"),l=a("TKiR"),c=a("StnM"),p=a("vrPu"),u=a("loIY"),d=a("VzV6"),m=a("3u+K");const g=r.types.model("CampaignShowRoot",{campaignInitialDataFetched:!1,campaignMigratePage:r.types.optional(c.a,{}),campaignShowPage:r.types.optional(l.a,{}),campaignRulesStore:r.types.optional(p.a,{}),campaignLaunchPage:r.types.optional(u.a,{}),currentCampaign:r.types.optional(o.a,{affiliate:!1,created_at:"",gleam:!1,leaderboard:!1,name:"",normalized_preset_name:"",preset_name:"",static_widget:"",status:"Test",test_mode:!0,deletable:!1,origin_class:"",version_suitable_for_placements:!1,constants:{},public_key:"",supports_offer_blasts:!1}),view_setups:r.types.optional(d.a,{}),campaignWarnings:r.types.optional(m.a,{}),campaignFlushData:r.types.optional(s.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get site(){return e.rootStore.models.site},get siteCachedSlug(){return e.site.siteCachedSlug},get currentUser(){return e.rootStore.models.currentUser},get router(){return e.rootStore.models.router},get editorPath(){return Routes.editor_site_campaign_path(e.siteCachedSlug,e.rootStore.urlSpaceParameter,e.currentCampaign.id,{anchor:"view_setups"})},get launchButtonText(){return e.currentCampaign.test_mode?"Launch Campaign":"Reactivate Campaign"}}))).actions((t=>({init:Object(r.flow)((function*({id:e,showSpinner:a=!0}){yield t.fetchCampaignData({id:e,showSpinner:a}),t.campaignLaunchPage.storeIsActive||t.campaignWarnings.startPolling({id:e,count:0,instantly:!1})})),fetchCampaignData:Object(r.flow)((function*({id:a,showSpinner:r=!0}){try{r&&t.changeCampaignInitialDataFetched(!1);const e=(yield $.ajax({url:Routes.details_internal_site_campaign_path(t.siteCachedSlug,a,{no_spinner:!0})})).result;t.updateCampaignData(e),r&&t.changeCampaignInitialDataFetched(!0)}catch(xhr){e({name:"Unable to get campaign details data",message:"Ajax failure",xhr:xhr})}})),updateCampaignData:Object(r.flow)((function*(e){t.currentCampaign=o.a.create(e)})),changeCampaignInitialDataFetched:e=>{t.campaignInitialDataFetched=e},resetStore:()=>{Object(r.applySnapshot)(t,{})},destroyCampaign:Object(r.flow)((function*(a=!0){t.currentCampaign.deleteModal.close();try{t.currentCampaign.network.delete.updateLoading(!0);if((yield t.rootStore.services.campaignsNetworkService.apiDelete({id:t.currentCampaign.id})).ok){UINotifications.add({text:"Campaign deleted",type:"success"});const e=Routes.site_campaigns_path(t.siteCachedSlug,t.rootStore.urlSpaceParameter);a?t.router.push(e):window.location.href=e}else UINotifications.add({text:"Campaign can't be deleted",type:"error"}),Utils.trackGAEvent(n.q,"unable to destroy campaign ok:false")}catch(xhr){UINotifications.add({text:"Campaign can't be deleted",type:"error"}),Utils.trackGAEvent(n.q,"unable to destroy campaign"),e({name:"Unable to destroy campaign",message:"Ajax failure",xhr:xhr})}finally{t.currentCampaign.network.delete.updateLoading(!1)}})),flushCampaignData:Object(r.flow)((function*(e=!0){try{(yield t.campaignFlushData.apiDelete(t.currentCampaign.id)).ok?(UINotifications.add({text:"Campaign data was successfully flushed",type:"success"}),e?(yield t.init({id:t.currentCampaign.id}),t.campaignShowPage.clearStore()):window.location.reload()):(UINotifications.add({text:"Unable to flush campaign data",type:"error"}),Utils.trackGAEvent(n.q,"unable to flush campaign data ok:false")),Utils.trackGAEvent(n.q,"flush campaign data")}catch{UINotifications.add({text:"Unable to flush campaign data",type:"error"}),Utils.trackGAEvent(n.q,"unable to flush campaign data")}})),openCopyModal:e=>{Object(i.a)({campaign:t.currentCampaign,site:t.site.toJSON(),currentUser:t.currentUser.toJSON(),isSpa:e})},openThemeStoreModal:e=>{Object(i.a)({campaign:t.currentCampaign,site:t.site.toJSON(),currentUser:t.currentUser.toJSON(),modalType:"themeStore",isSpa:e}),Utils.trackGAEvent(n.q,"open theme store modal")},checkDeactivationCampaign:()=>{t.currentCampaign.deactivation.checkDeactivationRules()&&t.deactivateCampaign()},deactivateCampaign:Object(r.flow)((function*(){try{const e=yield t.currentCampaign.deactivation.deactivate();UINotifications.add({text:e.message,type:"success"}),yield t.init({id:t.currentCampaign.id}),yield t.campaignShowPage.init(t.currentCampaign.id)}catch{UINotifications.add({text:"Unable to deactivate campaign",type:"error"})}}))})))}).call(this,a("B9cq").notifyDevelopers)},rXT5:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("TyAF"),n=a("GaHK"),i=a("fRW6");function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const s=Object(r.b)((({campaignCopyStore:e})=>({campaignCopyStore:e})))(Object(r.c)(function(t){var a,r;function s(){var a;return(a=t.call(this)||this).refName=e.createRef(),a}r=t,(a=s).prototype=Object.create(r.prototype),a.prototype.constructor=a,o(a,r);var l=s.prototype;return l.componentDidMount=function(){this.refName.current.focus()},l.render=function(){const{campaignCopyStore:{values:t,errors:a,onChange:r,onChangeSite:o,sitesOptions:s,valueSiteCachedSlugSelect:l,disabledSiteCachedSlugSelect:c}}=this.props;return e.createElement(e.Fragment,null,e.createElement(n.UIFormRow,null,e.createElement(n.UILabel,{text:"Campaign name",id:"campaign-copy-name"}),e.createElement(n.UIInputText,{size:"medium",ref:this.refName,value:t.name,id:"campaign-copy-name",name:"name",onChange:r,error:_.some(a.name)}),Object(i.a)(a.name)),e.createElement(n.UIFormRow,null,e.createElement(n.UILabel,{text:"Destination site",id:"campaign-copy-destination-site"}),e.createElement(n.UIInputSelect,{value:l,name:"cached_slug",id:"campaign-copy-destination-site",options:s,onChange:o,disabled:c,placeholder:"Choose destination site"}),Object(i.a)(a.cached_slug)))},s}(e.PureComponent)))}).call(this,a("q1tI"))},rgIu:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("99Ma"),n=a("aFzQ"),i=a("B9cq"),o=a("BYlJ");const s=r.types.model("RewardsStore",{rewards:r.types.map(o.a),searchQuery:"",rewardsFetched:!1,paginationPosition:1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get currentRewards(){return Object(n.values)(e.rewards).filter((t=>t.page===e.paginationPosition))}}))).actions((t=>({resetFetchState:()=>{t.rewardsFetched=!1},fetchRewards:Object(r.flow)((function*(a){t.resetFetchState();try{const e=yield Object(i.ajax)({url:Routes.internal_site_customer_service_for_scope_path(t.rootStore.siteCachedSlug,"rewards",{q:a,page:t.paginationPosition,no_spinner:!0})});t.updateRewards(e.result.records,a)}catch(xhr){e({name:"Unable to fetch CSP rewards",message:"Ajax failure",xhr:xhr})}})),modifyReward:e=>(_.set(e,"reward.page",t.paginationPosition),e),updateRewards:(e=[],a)=>{e.forEach(((e,a)=>{const r=t.modifyReward(e);t.rewards.put(r.reward)})),t.rewardsFetched=!0,t.searchQuery=a},setPaginationPosition:(e,a)=>{a&&a.preventDefault(),e!==t.paginationPosition&&(t.paginationPosition=e,t.fetchRewards(t.searchQuery))}})))}).call(this,a("B9cq").notifyDevelopers)},rgKW:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a("99Ma"),n=a("dhqo"),i=a.n(n),o=a("V0vo"),s=a("B9cq"),l=a("pm75");const c=r.types.model("FraudPolicyData",{id:r.types.maybeNull(r.types.number),site_id:r.types.maybeNull(r.types.number),key:r.types.maybeNull(r.types.string),value:r.types.maybeNull(r.types.string),created_at:r.types.maybeNull(r.types.string),updated_at:r.types.maybeNull(r.types.string),name:r.types.maybeNull(r.types.string),isIncludeFilter:r.types.optional(r.types.boolean,!1)}).actions((e=>({updateFilter:t=>{e.isIncludeFilter=t}}))),p=r.types.model("FraudSettingsStore",{auto_approve_rewards_in_hours:r.types.maybeNull(r.types.number),allow_rewarding_auto_approved_pending_referrals:r.types.maybeNull(r.types.boolean),limit_coupon_farming:r.types.maybeNull(r.types.number),limit_friend_rewards_mass_distribution:r.types.maybeNull(r.types.number),limit_rds_month:r.types.maybeNull(r.types.number),limit_rds_total:r.types.maybeNull(r.types.number),url_for_fraud_visitor:r.types.maybeNull(r.types.string),anti_fraud_by_ip_and_time_enabled:r.types.maybeNull(r.types.boolean),block_fr_by_email_or_visitor:r.types.maybeNull(r.types.boolean),block_fr_by_ip_and_user_agent:r.types.maybeNull(r.types.boolean),block_fr_by_ip:r.types.maybeNull(r.types.boolean),block_fr_by_similar_emails:r.types.maybeNull(r.types.boolean),block_fr_cross_referral:r.types.maybeNull(r.types.boolean),constants:r.types.maybeNull(r.types.map(r.types.frozen())),fraud_policies:r.types.optional(r.types.array(c),[]),network:r.types.optional(l.b,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get allowedStatuses(){return _(Object(r.getParent)(e).currentCspReferrals.statuses).reduce(((e,t,a)=>(t&&e.push(Object(o.z)(a)),e)),[])},get allowedFraudReasons(){return e.fraud_policies.reduce(((e,t)=>(t.isIncludeFilter&&e.push(t.name),e)),[])},get allowedStatusesLabel(){let t=null;return t=e.allowedStatuses.length&&e.allowedStatuses.length!==_.size(Object(r.getParent)(e).currentCspReferrals.statuses)?_.upperFirst(e.allowedStatuses.join(", ")):"All",t},get allowedFraudReasonsLabel(){let t=null;return t=e.allowedFraudReasons.length&&e.allowedFraudReasons.length!==_.size(e.fraud_policies)?e.allowedFraudReasons.join(", "):"All",t},get humanFriendFraudSettings(){return e.constants.get("HUMAN_FRIEND_FRAUD_SETTINGS")},get fraudPolicyValues(){return e.constants.get("FRAUD_POLICY_VALUES")},get fraudPolicyHumanValues(){return e.constants.get("FRAUD_POLICY_HUMAN_VALUES")},get urlForFraudVisitorValue(){var t,a;return e.url_for_fraud_visitor||`Defaults to ${null==(t=e.rootStore.models)||null==(a=t.site)?void 0:a.url}`},get limitRdsMonth(){return`${e.limit_rds_month?`${e.limit_rds_month} ${i()("reward",e.limit_rds_month)}`:"No limit"} in 30 days`},get limitRdsTotal(){return`${e.limit_rds_total?`${e.limit_rds_total} ${i()("reward",e.limit_rds_total)}`:"No limit"} in total`},humanPolicyName:t=>e.fraudPolicyHumanValues[t],humanFriendPolicyName:t=>e[t]?"Block Friend":"Skip"}))).actions((e=>({fetchData:Object(r.flow)((function*(){e.network.get.updateLoading(!0);const t=yield Object(s.ajax)({url:Routes.fraud_settings_internal_site_path(e.rootStore.siteCachedSlug,{no_spinner:!0})});Object(r.applySnapshot)(e,{...t.result.fraud_settings}),e.network.get.updateLoading(!1),e.network.get.updateLoaded(!0)})),reset:()=>{Object(r.applySnapshot)(e,{})}})))},rwDS:function(e,t,a){"use strict";a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return u}));var r=a("nKCY"),n=a("99Ma"),i=a("LhCv"),o=a("wB/l"),s=a("af5v");const l=n.types.model({router:n.types.optional(o.a,{}),currentUser:n.types.optional(s.a,{...window.current_user})}),c=n.types.model("UserSettingsRootStore",{models:n.types.optional(l,{}),shouldRenderSpa:!1}).views((e=>({get currentUser(){return e.models.currentUser},get router(){return e.models.router}}))).actions((e=>({afterCreate(){e.fetchInitialDataCurrentUser(),Object(n.onPatch)(e,(({path:t,value:a})=>{switch(t){case"/models/router/location/pathname":_.endsWith(a,"/")&&e.models.router.replace(_.trimEnd(a,"/")+window.location.search)}}))},updateShouldRenderSpa:t=>{e.shouldRenderSpa=t},fetchInitialDataCurrentUser:Object(n.flow)((function*(){e.updateShouldRenderSpa(!1),yield e.models.currentUser.fetch(),e.updateShouldRenderSpa(!0)}))}))),p=Object(r.a)(c.create()),u=Object(o.b)(Object(i.a)(),p.models.router)},sAvP:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("Md/s"),n=a("ne91");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let o=function(t){var a,o;function s(){return t.apply(this,arguments)||this}return o=t,(a=s).prototype=Object.create(o.prototype),a.prototype.constructor=a,i(a,o),s.prototype.render=function(){const{isSitePersisted:t,isReadRole:a,currentSiteCachedSlug:i,locationRouter:o}=this.props;return t&&a&&e.createElement(r.f,{"data-testid":"ac-subheader-loyalty-container"},e.createElement("div",{className:"App-container-inner"},e.createElement(r.g,null,e.createElement("div",{className:"flex align-items-center"},e.createElement(r.h,{isActive:location.pathname===Routes.loyalty_site_path(i),href:Routes.loyalty_site_path(i),locationRouter:o},"Dashboard"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.campaigns_site_path(i,"loyalty")),href:Routes.campaigns_site_path(i,"loyalty"),locationRouter:o},"Campaigns"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.site_loyalty_metrics_aggregation_path(i)),href:Routes.site_loyalty_metrics_aggregation_path(i)},"Metrics"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.site_loyalty_members_path(i)),href:Routes.site_loyalty_members_path(i)},"Members"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.site_loyalty_purchases_path(i)),href:Routes.site_loyalty_purchases_path(i)},"Purchases"),e.createElement(r.h,{className:"mll",isActive:Object(n.a)(Routes.site_coupon_lists_path(i,"loyalty")),href:Routes.site_coupon_lists_path(i,"loyalty")},"Coupon Lists")))))},s}(e.PureComponent)}).call(this,a("q1tI"))},sT1B:function(e,t,a){"use strict";a.d(t,"hb",(function(){return r})),a.d(t,"E",(function(){return n})),a.d(t,"Q",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"v",(function(){return s})),a.d(t,"q",(function(){return l})),a.d(t,"p",(function(){return c})),a.d(t,"o",(function(){return p})),a.d(t,"n",(function(){return u})),a.d(t,"m",(function(){return d})),a.d(t,"z",(function(){return m})),a.d(t,"S",(function(){return g})),a.d(t,"u",(function(){return h})),a.d(t,"D",(function(){return y})),a.d(t,"a",(function(){return f})),a.d(t,"cb",(function(){return _})),a.d(t,"ib",(function(){return b})),a.d(t,"N",(function(){return v})),a.d(t,"bb",(function(){return S})),a.d(t,"O",(function(){return w})),a.d(t,"t",(function(){return C})),a.d(t,"db",(function(){return E})),a.d(t,"P",(function(){return N})),a.d(t,"W",(function(){return O})),a.d(t,"gb",(function(){return x})),a.d(t,"T",(function(){return I})),a.d(t,"J",(function(){return P})),a.d(t,"l",(function(){return R})),a.d(t,"s",(function(){return j})),a.d(t,"r",(function(){return D})),a.d(t,"x",(function(){return k})),a.d(t,"w",(function(){return T})),a.d(t,"g",(function(){return A})),a.d(t,"h",(function(){return F})),a.d(t,"j",(function(){return M})),a.d(t,"i",(function(){return U})),a.d(t,"U",(function(){return L})),a.d(t,"R",(function(){return B})),a.d(t,"M",(function(){return V})),a.d(t,"B",(function(){return $})),a.d(t,"A",(function(){return z})),a.d(t,"C",(function(){return q})),a.d(t,"I",(function(){return W})),a.d(t,"G",(function(){return G})),a.d(t,"H",(function(){return H})),a.d(t,"F",(function(){return Q})),a.d(t,"c",(function(){return J})),a.d(t,"Y",(function(){return K})),a.d(t,"f",(function(){return Y})),a.d(t,"k",(function(){return Z})),a.d(t,"eb",(function(){return X})),a.d(t,"y",(function(){return ee})),a.d(t,"L",(function(){return te})),a.d(t,"ab",(function(){return ae})),a.d(t,"X",(function(){return re})),a.d(t,"Z",(function(){return ne})),a.d(t,"e",(function(){return ie})),a.d(t,"d",(function(){return oe})),a.d(t,"K",(function(){return se})),a.d(t,"V",(function(){return le})),a.d(t,"fb",(function(){return ce}));const r="1",n="New Site Dashboard",i="Header site",o="Account Tiles",s="Campaign Show",l="Campaign navigation",c="Campaign Migrate Tool",p="Campaign Launch",u="Campaign Index",d="Campaign Incentive",m="Create New Campaign",g="Integration",h="Campaign Rules",y="Customer Service",f="Account Settings",_="Site Settings",b="Webhooks",v="Fraud Settings",S="Reports",w="Freshdesk",C="Campaign preview",E="Static Widget",N="Grid Export",O="Multiple Campaign Editor Modal",x={UNIT:1,HOURS_IN_DAY:24,MINUTES_IN_HOUR:60,SECONDS_IN_MINUTE:60,SECONDS_IN_HOUR:3600,SECONDS_IN_DAY:86400,SECONDS_IN_WEEK:604800},I={ENTER:13,ESCAPE:27,S:83},P=["DashboardAdvocacyRateTile","DashboardAdvocateRewardsTile","DashboardCampaignPerformanceTile","DashboardCampaignsTile","DashboardCustomizableRevenueTile","DashboardFriendRewardsTile","DashboardReferralsTile","DashboardSiteRevenueTile","DashboardTalkablePercentageOfRevenueTile","DashboardTalkableRevenueTile","DashboardAbstractMetricTile","DashboardAllTimeMetricTile"],R={INLINE:"inline",POPUP:"popup",WIDGET:"widget",GLEAM:"gleam"},j={DASHBOARD:"dashboard",GLEAM:"gleam",INVITE:"invite",EMAIL_CAPTURE:"email_capture",LOYALTY:"loyalty"},D={STANDALONE:"SA",POST_EVENT:"PE",POST_PURCHASE:"PP",REWARD_GLEAM:"RG",FLOATING_WIDGET:"FW",EMAIL_CAPTURE:"EC",LOYALTY:"LO"},k=["LIVE","SCHEDULED","TEST","DISABLED"],T={LIVE:"Live",SCHEDULED:"Scheduled",TEST:"Test",DISABLED:"Disabled"},A=[{label:"Live",value:"live"},{label:"Scheduled",value:"scheduled"},{label:"Test",value:"test"},{label:"Disabled",value:"disabled"}],F=A.map((e=>e.value)),M=[{label:"Advocate Dashboard",value:"dashboard"},{label:"Reward Gleam",value:"gleam"},{label:"Invite",value:"invite"},{label:"Invite Full Screen",value:"invite_full_bleed"},{label:"Leaderboard",value:"leaderboard"},{label:"Tiered Rewards",value:"tiered"}],U=[{label:"Post Purchase & Post Event",value:"popup"},{label:"Floating Widget",value:"widget"},{label:"Standalone",value:"inline"},{label:"Gleam",value:"gleam"}],L={ASSET:"asset",COLOR:"color",SHARE_IMAGE:"share_image",STRING:"string",BOOLEAN:"boolean",MESSAGE:"message"},B={csp_only:"CSP only",read:"Read",write:"Write",admin:"Admin"},V=5,$=25,z=15,q=5,W=15,G=5,H=1e6,Q=100,J="any",K="other",Y=10,Z=5,X="talkable-theme-store",ee="campaign-copy-modal",te=36e6,ae={shopify:"Shopify",demandware:"Salesforce Commerce Cloud",magento:"Magento"},re=5,ne={PE:"PE",PP:"PP",FW:"FW",RG:"RG",SA:"SA"},ie={inline:"Standalone",popup:"Post Purchase",widget:"Floating Widget",gleam:"Gleam",event:"Post Event"},oe="api@talkable.com",se="DESC",le={event:"Loyalty::EventRule",referral:"Loyalty::ReferralRule",other:"Loyalty::CustomRule",optin:"Loyalty::OptinRule"},ce={thresholdStep:1,multiplierStep:.1}},soYR:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var r=a("99Ma"),n=a("On4Y");const i=r.types.model("SitePersonalCouponLists",{personalCouponListsDataFetched:!1,currentPersonalCouponListDataFetched:!1,personalCouponLists:r.types.optional(r.types.map(n.a),{}),currentPersonalCouponList:r.types.optional(n.a,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get site(){return e.rootStore.models.site},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get personalCouponListsForSelect(){return _.transform(Array.from(e.personalCouponLists.values()),((e,t)=>{const a={label:t.humanSelectName,value:t.id};e.push(a)}),[])}}))).actions((t=>({reset:()=>{Object(r.applySnapshot)(t,{})},changePersonalCouponListsDataFetched:e=>{t.personalCouponListsDataFetched=e},changePersonalCouponListDataFetched:e=>{t.currentPersonalCouponListDataFetched=e},updatePersonalCouponListsData:e=>{e.forEach((e=>{t.personalCouponLists.put(e)})),t.changePersonalCouponListsDataFetched(!0)},updatePersonalCouponListData:e=>{t.currentPersonalCouponList=e,t.changePersonalCouponListDataFetched(!0)},fetchCurrentPersonalCouponList:Object(r.flow)((function*(a){try{const e=yield $.ajax({url:Routes.internal_site_personal_coupon_list_path(t.siteCachedSlug,a),data:{no_spinner:!0}});t.updatePersonalCouponListData(e.result.personal_coupon_list)}catch(xhr){e({name:"Unable to get personal coupon list",message:"Ajax failure",xhr:xhr})}})),fetchPersonalCouponLists:Object(r.flow)((function*(){try{const e=yield $.ajax({url:Routes.internal_site_personal_coupon_lists_path(t.siteCachedSlug),data:{no_spinner:!0}});t.updatePersonalCouponListsData(e.result.personal_coupon_lists)}catch(xhr){e({name:"Unable to get personal coupon lists",message:"Ajax failure",xhr:xhr})}}))})))}).call(this,a("B9cq").notifyDevelopers)},"t/S2":function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a("99Ma"),n=a("rfrl"),i=a("85NH"),o=a("sT1B");var s=a("V0vo"),l=a("ZKCC"),c=a("vrPu");const p=r.types.compose("LoyaltyRuleFormStore",i.a,r.types.model({icon:r.types.maybeNull(r.types.frozen()),identifier:"",showCriteriaFieldTextArea:!1,errors:r.types.optional(r.types.frozen(),{})})).preProcessSnapshot((e=>({...e,showCriteriaFieldTextArea:Boolean(e.criteria)}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get campaignRulesStore(){return Object(r.getParentOfType)(e,c.a)},get iconUrl(){return(({icon_url:e,type:t,identifier:a})=>{if(e)return e;switch(t){case o.V.optin:return"/assets/v1/packs/loyalty_optin-995fc10bcba7b4c517b0400d61a50179.svg";case o.V.event:return"/assets/v1/packs/event-756af8580936753cee7d56ca0fb00b21.svg";case o.V.referral:return"/assets/v1/packs/referral-ac5d91ea0ef0219e8a804ea385a6f0cb.svg"}switch(a){case"facebook_follow":return"/assets/v1/packs/facebook_follow-0b3a7a95c37b3823d9f8cb9d2169964d.svg";case"tweet":return"/assets/v1/packs/tweet-2fb5e52803a52c51d27fceed4ac5929a.svg";default:return"/assets/v1/packs/custom-15f863bd90a0c2dfa199a985a3f77b4c.svg"}})({type:e.type,identifier:e.identifier,icon_url:e.icon_url})},get disableIdentifier(){return e.isCustomRule&&null!==e.category_id},get showIdentifierFormBlock(){return e.isCustomRule},get prePareDataForServer(){let t=_.pick(e,["type","points","enabled","criteria","once_per_member","name","description","icon"]),a=e.identifier;return e.isCustomRule?e.category_id&&(t.category_id=e.category_id,a=null):(e.isEventRule&&(t.event_category="purchase",t.based_on_subtotal=e.based_on_subtotal),a=null),{data:Object(n.b)(t,(e=>{t.icon||delete e.icon})),identifier:a}},get isValidIconFileType(){var t;return null==(t=e.icon)||!t.type||Object(s.D)(e.icon.type)},get isDisabledSingleUseOption(){return e.type===o.V.event&&e.based_on_subtotal},get initialData(){return Object(r.getParent)(e).initialData},get loyaltyRulesRootStore(){return Object(r.getParentOfType)(e,l.a)},get basedOnSubtotalDisabled(){return e.loyaltyRulesRootStore.isSomeBasedOnSubtotalRule&&!e.loyaltyRulesRootStore.rulesStore.data.filter((e=>e.based_on_subtotal)).map((e=>e.id)).includes(e.id)},get showBasedOnSubtotalRuleTieredNote(){return e.campaignRulesStore.values.tiered&&e.based_on_subtotal}}))).actions((e=>({handleChange({target:{name:t,value:a}}){e[t]=a,e.resetErrorByName(t),e.type===o.V.event&&"based_on_subtotal"===t&&(e.once_per_member=!a&&e.initialData.once_per_member)},handleChangeImage(t){e.icon=t.target.files[0]},handleAddCriteria(){e.showCriteriaFieldTextArea=!0},updateErrors(t){e.errors=t},updateData(t){Object(r.applySnapshot)(e,t),e.basedOnSubtotalDisabled&&(e.based_on_subtotal=!1)},resetErrors(){e.errors={}},resetErrorByName(t){e.errors=Object(n.b)(e.errors,(e=>{_.unset(e,t)}))}})))},tkrC:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("V0vo");function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function i(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s({children:t,simpleLayout:a}){return e.createElement("div",{className:"Previews-view-setup-preset-device-content-wrapper"},!a&&e.createElement("div",{className:"Previews-view-setup-preset-device-content is-top"}),t,!a&&e.createElement("div",{className:"Previews-view-setup-preset-device-content is-bottom"}))}let l=function(t){var a,l;function c(...e){var a;return(a=t.call(this,...e)||this).applyIframeScripts=e=>{UI.previewSubscribe("offer_loaded",(t=>{UI.previewPublish("preview_styles",e.name,{remove_preview_styles:!0})}))},a}l=t,(a=c).prototype=Object.create(l.prototype),a.prototype.constructor=a,o(a,l);var p,u,d,m=c.prototype;return m.renderPreviewIframe=function(e){return"true"===this.props.autoLoad?e:null},m.render=function(){const{ViewSetup:t,ViewPreset:a,simpleLayout:i,platformType:o,className:l}=this.props,c=t.embeddable_view,p=t.email_view,u="desktop"===o||this.isSocialShare,d=o.replace("iPhone","mobile").replace("iPad","tablet"),m=`\n        Previews\n        ${d}\n        ${l}\n        ${i?"is-simple-layout":""}\n        ${u?"is-desktop-mode":`is-${d}-mode`}\n      `,g=`\n        Previews-view-setup js-cover\n        ${t.responsive?"is-responsive":"is-non-responsive"}\n        ${c?"is-embeddable":"is-selfhosted"}\n        ${p?"is-email":"is-web"}\n      `,h=Constants.PUBLIC_URL_OPTIONS.host+Routes.cover_site_campaign_preview_path(Site,Object(r.v)(window.location.href),this.campaignId,t,{key:this.campaignPublicKey,preset_slug:a.cached_slug,user_agent:o,use_fake_layout:!i,selected_split_test_variant_ids:a.split_test_variant_ids,...this.localizationParams}),y={ref:this.applyIframeScripts};let f;if(u&&!p&&i){const{scaleIframe:e,nodeIframe:t,ViewSetup:a}=this.props,r=$(t).height()/e;"social_sharing"!==a.id&&(f={minWidth:"1280px",height:"originalSize"===localStorage.getItem("iframeScale")?"100%":r,transformOrigin:"0 0",transform:`scale(${e})`,position:"absolute"})}const _={name:"preview-embeddable-cover",className:"js-preview-embeddable-cover Previews-view-setup-preset-cover-iframe",src:h,style:f,"data-testid":"ac-campaign-preview-iframe"},b={className:"js-campaign-preview Previews-view-setup-preset-cover-iframe",width:"100%",height:"100%",frameBorder:"0",style:f,"data-testid":"ac-campaign-preview-iframe"},v=c?e.createElement("iframe",n({},y,_)):e.createElement("iframe",n({},y,b,this.nonEmbeddablePreviewAttrs)),S=e.createElement("div",{className:"Previews-view-setup-preset-wrapper"},e.createElement("div",{className:"Previews-view-setup-preset-device-body"},e.createElement("div",{className:"Previews-view-setup-preset-device-display"},c?this.renderPreviewIframe(e.createElement("iframe",n({},y,_))):this.renderPreviewIframe(e.createElement(s,{simpleLayout:i},e.createElement("iframe",n({},y,b,this.nonEmbeddablePreviewAttrs)))))));return e.createElement("div",{className:m},e.createElement("div",{className:g},i?this.renderPreviewIframe(v):S))},p=c,(u=[{key:"localizationParams",get:function(){const{localizationOverride:e}=this.props;return e?{localization_override:e}:{}}},{key:"isSocialShare",get:function(){const{ViewSetup:{id:e}}=this.props;return"social_sharing"===e}},{key:"nonEmbeddablePreviewAttrs",get:function(){const{ViewPreset:e,ViewSetup:t,platformType:a}=this.props,n=e.split_test_variant_ids||[],i={preset_slug:e.cached_slug,key:this.campaignPublicKey,user_agent:a,selected_split_test_variant_ids:n,...this.localizationParams},o=_.pickBy(i,_.identity);let s="";return s=this.isSocialShare?`${Constants.PUBLIC_URL_OPTIONS.host}${Routes.social_sharing_site_campaign_previews_path(Site,Object(r.v)(window.location.href),this.campaignId,o)}`:`${Constants.PUBLIC_URL_OPTIONS.host}${Routes.site_campaign_preview_path(Site,Object(r.v)(window.location.href),this.campaignId,t,o)}`,{src:s,name:`${t.id}_${e.cached_slug}_${n[0]}`}}},{key:"campaignId",get:function(){return _.get(this.props.ViewSetup,"campaign_id",_.get(window.Campaign,"id"))}},{key:"campaignPublicKey",get:function(){return(_.get(this.props.ViewPreset,"preview_url","").match(/key=([a-z0-9]+)/i)||[])[1]||_.get(window.Campaign,"public_key")}}])&&i(p.prototype,u),d&&i(p,d),c}(e.PureComponent);l.defaultProps={className:"",simpleLayout:!1,platformType:"desktop",autoLoad:"true"},window.ViewSetupPreview={UI:l}}).call(this,a("q1tI"))},u4nQ:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return u}));var r,n,i=a("TyAF"),o=a("vOnD"),s=a("U6ye"),l=a("micW");function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const p=o.default.div.withConfig({displayName:"campaigns_filter_static_widget__StaticWidgetWrapper"})(["display:inline-block;position:relative;margin-left:5px;"]),u=Object(i.c)((n=r=function(t){var a,r;function n(e){var a;return(a=t.call(this,e)||this).staticWidgetStore="1"===e.campaign.static_widget&&l.a.create({id:`${e.siteCachedSlug}_${e.campaign.id}`,campaign_id:e.campaign.id,site_cached_slug:e.siteCachedSlug,disabled_state:e.is_edit&&!0,tooltipDescription:e.is_edit&&"This campaign uses \u201cStatic trigger widget\u201d setting"}),a}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,c(a,r),n.prototype.render=function(){const{campaign:t,editMode:a}=this.props;return"1"===t.static_widget&&e.createElement(p,null,e.createElement(s.a,{size:"small",background:"#fff",polling:"Live"===t.status&&!a,staticWidgetStore:this.staticWidgetStore}))},n}(e.PureComponent),r.defaultProps={editMode:!1,campaign:{id:null,appearance:null,status:""}},n))}).call(this,a("q1tI"))},u6wb:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("GaHK"),n=a("ZQwf");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let o=function(t){var a,o;function s(){return t.apply(this,arguments)||this}return o=t,(a=s).prototype=Object.create(o.prototype),a.prototype.constructor=a,i(a,o),s.prototype.render=function(){const{campaign:{latest_change:{formattedCreatedAt:t,email:a}},width:i}=this.props;return e.createElement(n.b,{width:i},e.createElement(r.BodyS,{color:r.Theme.color.black100,className:"mbx"},t),e.createElement(r.BodyD,null,a))},s}(e.PureComponent);o.defaultProps={width:"220px"}}).call(this,a("q1tI"))},u7Uh:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return h}));var r=a("nKCY"),n=a("TyAF"),i=a("aoTL"),o=a("f1uX"),s=a("ZaDd"),l=a("VeD8");function c(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const u="info-sidebar",d=()=>{document.getElementById(u)&&document.body.removeChild(document.getElementById(u))},m=Object(r.a)(s.c.create()),g=Object(n.c)(function(e){function t(){var t;t=e.call(this)||this;const a=document.createElement("div");return a.setAttribute("id",u),t.sidebar=a,t}c(t,e);var a=t.prototype;return a.componentDidMount=function(){document.body.appendChild(this.sidebar);const{infoSidebarStore:e,isFetched:t,data:a,fetchData:r}=this.props;t?e.updateData(a):"function"===typeof r&&r(),Utils.trackGAEvent(e.gaCategory,"open")},a.componentDidUpdate=function(e){this.props.isFetched&&!_.isEqual(e.data,this.props.data)&&this.props.infoSidebarStore.updateData(this.props.data)},a.componentWillUnmount=function(){Utils.trackGAEvent(this.props.infoSidebarStore.gaCategory,"close"),this.props.infoSidebarStore.reset(),d()},a.render=function(){return ReactDOM.createPortal(this.props.children,this.sidebar)},t}(e.Component));let h=function(t){function a(...e){var a;return(a=t.call(this,...e)||this).state={show:!1},a.toggleShow=()=>{a.setState((e=>({show:!e.show})),(()=>{a.props.toggleShow()}))},a.onClose=()=>{a.setState({show:!1},(()=>{a.props.toggleShow()}))},a}c(a,t),a.getDerivedStateFromProps=function(e){return e.needUseShowProp&&!e.show?{show:!1}:null};var r=a.prototype;return r.componentWillUnmount=function(){d()},r.render=function(){const{title:t,content:a,fetchData:r,data:n,isFetched:s,render:c,align:p,width:u}=this.props,d=this.props.show||this.state.show;return e.createElement("div",{className:"inline-flex align-items-center"},c(this.toggleShow,d),e.createElement(l.a,null,e.createElement(i.a,null,(()=>d&&e.createElement(g,{infoSidebarStore:m,isFetched:s,fetchData:r,data:n},e.createElement(o.a,{width:u,infoSidebarStore:m,title:t,isFetched:s,show:d,onClose:this.onClose,content:a,align:p}))))))},a}(e.Component);h.defaultProps={needUseShowProp:!1,show:!1,toggleShow:()=>null,fetchData:()=>null,title:()=>null,isFetched:!0,align:"right"}}).call(this,a("q1tI"))},uEXj:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var r=a("99Ma"),n=a("/ZTi"),i=a("4b23"),o=a("rfrl");Object(o.c)(!1);const s=r.types.model("ExtrasInput",{value:"",initialValue:""}).views((e=>({get isPristine(){return e.value===e.initialValue}}))).actions((e=>({afterCreate:()=>{e.initialValue=e.value},onChange:({target:{value:t}})=>{e.value=t,Object(r.getParentOfType)(e,c).resetError()}}))),l=r.types.model("ExtrasRow",{name:r.types.optional(s,{}),value:r.types.optional(s,{}),isInitialFocus:!1,key:r.types.maybeNull(r.types.string)}).views((e=>({get values(){return e.name.value&&e.value.value?{[e.name.value]:e.value.value}:{}},get isPristine(){return e.name.isPristine&&e.value.isPristine}}))).actions((e=>({afterCreate:()=>{e.key||(e.key=Object(i.a)())}}))),c=r.types.model("Extras",{data:r.types.array(l),initialData:r.types.array(r.types.frozen()),error:r.types.frozen()}).views((e=>({get isValid(){return!Array.isArray(e.error)||!e.error.length},get dataArray(){return e.data.toJSON()},get rowsAmount(){return e.dataArray.length},get values(){const t=e.data.reduce(((e,t)=>({...e,...t.values})),{}),a=Object.keys(e.initialDataValues).reduce(((e,a)=>t[a]?e:{...e,[a]:null}),{});return{...t,...a}},get initialDataValues(){return e.initialData.toJSON().reduce(((e,t)=>t.name.value&&t.value.value?{...e,[t.name.value]:t.value.value}:e),{})},get isPristine(){return e.data.every((e=>e.isPristine))&&_.isEqual(e.values,e.initialDataValues)}}))).actions((e=>({afterCreate(){e.initialData=Object(r.getSnapshot)(e.data)},handleAddRow:t=>{e.resetError(),Object(r.applySnapshot)(e.data,Object(o.a)(e.dataArray,(a=>{a.forEach((e=>{e.isInitialFocus=!1})),a.splice(t||0===t?t+1:e.rowsAmount,0,{isInitialFocus:!0})})))},handleDeleteRow:t=>{e.resetError(),Object(r.applySnapshot)(e.data,Object(o.a)(e.dataArray,(a=>{const r=(({rowIndex:e,array:t})=>{switch(!0){case e+1<=t.length-1:return e+1;case e-1>=0:return e-1;default:return null}})({rowIndex:t,array:a});a.forEach(((e,t)=>{if(t===r)return e.isInitialFocus=!0,void delete e.key;e.isInitialFocus=!1})),a.splice(t||0===t?t:e.rowsAmount-1,1)})))},updateError:t=>{var a;e.error=Array.isArray(t)?t:(a=t,Object.entries(a).reduce(((e,[t,a])=>[...e,`${t}: ${a}`]),[]))},resetError:()=>{e.error=[]},reset:()=>{Object(r.applySnapshot)(e,{data:e.initialData.toJSON(),initialData:e.initialData.toJSON()})}}))),p=e=>e.reduce(((e,{key:t,value:a,isPristine:r})=>r?e:{...e,[t]:"undefined"===typeof a?null:a}),{}),u=r.types.model("Configuration",{params:r.types.array(n.a),ui:r.types.array(n.a)}).views((e=>({get data(){return[...e.params,...e.ui]},get isValid(){return e.data.every((e=>e.isValid))},get isPristine(){return e.data.every((e=>e.isPristine))},get paramsValues(){return p(e.params)},get uiValues(){return p(e.ui)},get valuesForServer(){return JSON.stringify({params:e.paramsValues,ui:e.uiValues})}}))).actions((e=>({resetAll:()=>{e.data.forEach((e=>{e.reset()}))},setErrorField:({key:t,error:a=null})=>{var r;null==(r=e.data.find((e=>e.key===t)))||r.setError({error:a})},updateErrors:t=>{let a={};a=Array.isArray(t)?t[0].params:t.params,a&&Object.keys(a).forEach((t=>{e.setErrorField({key:t,error:a[t]})}))},checkRequiredFields:()=>{e.data.filter((e=>!e.optional)).forEach((e=>{e.value||e.setError({error:["Field is required"]})}))}}))),d=r.types.compose(u,r.types.model({extras:r.types.optional(c,{})}).views((e=>({get isPristine(){return e.data.every((e=>e.isPristine))&&e.extras.isPristine},get valuesForServer(){return JSON.stringify({params:e.paramsValues,extra_fields:e.extras.values})},get isValid(){return e.data.every((e=>e.isValid))&&e.extras.isValid}}))).actions((e=>({updateErrors:t=>{let a={},r=[];Array.isArray(t)?(a=t[0].params,r=t[0].extra_fields):(a=t.params,r=t.extra_fields),a&&Object.keys(a).forEach((t=>{e.setErrorField({key:t,error:a[t]})})),r&&e.extras.updateError(r)},resetAll:()=>{e.data.forEach((e=>{e.reset()})),e.extras.reset()}}))))},uZue:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var r=a("99Ma"),n=a("rfrl"),i=a("UlA6"),o=a("broW"),s=a("Ifx+");const l=["custom_web_domain","custom_email_domain","self_serve_domain_creation"],c=["web","email"],p=r.types.model("NewDomainData",{custom_domain:"",self_serve_domain_creation:!1,setup_together:!0}).actions((e=>({updateData:t=>{Object(r.applySnapshot)(e,t)}}))),u=r.types.model("NewDomain",{type:r.types.optional(r.types.string,"web"),data:r.types.optional(p,{}),errors:r.types.optional(r.types.map(r.types.frozen()),{}),isSubmitting:!1,isSuccess:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get router(){return e.rootStore.models.router},get siteDataInitial(){return e.rootStore.models.site.toJSON()},get siteCachedSlug(){return e.siteDataInitial.cached_slug},get customDomainsPage(){return Object(r.getParent)(e)},get siteEditPage(){return e.rootStore.pages.siteEditPage},get mainLevelDomain(){return e.siteDataInitial.main_level_domain},get domainPreview(){return e.onlySubDomain?`${e.data.custom_domain}.${e.mainLevelDomain}`:e.data.custom_domain},get onlySubDomain(){return!e.rootStore.models.currentUser.staff_member},get isDisabledSubmit(){return!e.data.custom_domain||_.some(e.errors.toJSON())||e.isSuccess||e.isSubmitting},get isDisabledInputs(){return e.isSuccess||e.isSubmitting},get disabledInputs(){return{custom_domain:e.isDisabledInputs,self_serve_domain_creation:e.isDisabledInputs||e.customDomainsPage.isSet,setup_together:e.isDisabledInputs||e.customDomainsPage.isSet||e.data.self_serve_domain_creation}},get prepareDataForServer(){return Object(s.a)(Object(i.e)({custom_web_domain:"web"===e.type||e.data.setup_together?e.domainPreview:void 0,custom_email_domain:"email"===e.type||e.data.setup_together?e.domainPreview:void 0,self_serve_domain_creation:e.data.self_serve_domain_creation}))},get isLoadingRecords(){return e.customDomainsPage[e.type].isLoading},get records(){return e.customDomainsPage[e.type].records.map((e=>({...e,valid:!0})))},get recordsError(){return e.customDomainsPage[e.type].error}}))).actions((e=>({updateSubmitting:({isSubmitting:t})=>{e.isSubmitting=t},updateSuccess:({isSuccess:t})=>{e.isSuccess=t},updateType:({type:t})=>{c.includes(t)||e.leavePage(),("web"===t&&e.customDomainsPage.web.isSet||"email"===t&&e.customDomainsPage.email.isSet)&&e.leavePage(),e.customDomainsPage.isSet&&e.data.updateData({setup_together:!1,self_serve_domain_creation:e.siteDataInitial.self_serve_domain_creation}),e.type=t},leavePage:()=>{e.reset(),e.router.replace(Routes.custom_domains_site_path(e.siteCachedSlug))},handleChange:({target:{value:t,name:a}})=>{e.deleteError({name:a}),e.data[a]="self_serve_domain_creation"===a?Boolean(t):t,"self_serve_domain_creation"===a&&(e.data.setup_together=!t)},updateErrors:t=>{e.errors.replace(t)},clearErrors:()=>{Object(r.applySnapshot)(e.errors,{})},deleteError:({name:t})=>{"custom_domain"===t?(e.errors.delete("custom_web_domain"),e.errors.delete("custom_email_domain")):e.errors.delete(t)},updateSiteData:()=>{Object(r.applySnapshot)(e.data,{...e.data,custom_domain:"web"===e.type?e.siteDataInitial.custom_web_domain:e.siteDataInitial.custom_email_domain,self_serve_domain_creation:e.siteDataInitial.self_serve_domain_creation})},checkDomainStatus:()=>{e.customDomainsPage[e.type].checkStatus()},showDomainSetup:()=>e.isSuccess,handleSubmit:Object(r.flow)((function*(t){t.preventDefault(),e.updateSubmitting({isSubmitting:!0}),e.clearErrors();try{yield e.rootStore.models.site.update({site:e.prepareDataForServer,no_spinner:!1}),e.updateSiteData(),e.updateSuccess({isSuccess:!0}),e.checkDomainStatus(),Validation.showSuccessFlash("Domain has been set")}catch(a){const t=_.get(a,"responseJSON.errors");if(_.isPlainObject(t)){_.some(_.difference(_.keys(t),l))?Object(s.b)():e.updateErrors(t)}else Object(s.b)()}finally{Object(r.isAlive)(e)&&e.updateSubmitting({isSubmitting:!1})}})),handleCompleteSetupClick:t=>{t.preventDefault(),e.leavePage()},reset:()=>{Object(r.applySnapshot)(e,{})}})));var d=a("cr+I"),m=a.n(d);var g=a("B9cq"),h=a("YgPs");const y=r.types.model("DomainSwitcher",{value:!1,isLoading:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get customDomain(){return Object(r.getParent)(e)},get siteEditPage(){return e.rootStore.pages.siteEditPage},get siteDataInitial(){return e.rootStore.models.site.toJSON()},get type(){return e.customDomain.type},get isDisabled(){return!e.customDomain.isUp},get defaultDomains(){return e.customDomain.defaultDomains},get isToggle(){return!1},toggleDomainMessage:()=>""}))).actions((e=>({afterCreate(){e.setInitialData()},setInitialData:()=>{e.updateToggle(e.isToggle)},updateLoading:(t=!1)=>{e.isLoading=t},updateToggle:(t=!1)=>{e.value=t},_getSiteDomainSettings:e=>({force_custom_web_domain_and_ssl:e,use_custom_email_domain:e}),handleChange:Object(r.flow)((function*({target:{value:t}}){try{e.updateLoading(!0),e.updateToggle(t),yield e.rootStore.models.site.update({site:e._getSiteDomainSettings(t),no_spinner:!1}),Validation.showSuccessFlash(e.toggleDomainMessage(t),15e3)}catch{Object(s.b)()}finally{Object(r.isAlive)(e)&&(e.setInitialData(),e.updateLoading(!1))}}))}))),f=r.types.compose(y,r.types.model("DomainSwitcherWeb",{}).views((e=>({get isToggle(){return e.siteDataInitial.force_custom_web_domain_and_ssl},toggleDomainMessage:t=>t?"Domain was successfully enabled":`Custom domain is disabled and ${e.defaultDomains.web} is used as a fallback`}))).actions((e=>({_getSiteDomainSettings:e=>{const t={force_custom_web_domain_and_ssl:e,use_custom_email_domain:e};return Object(n.a)(t,(e=>{delete e.use_custom_email_domain}))}})))),b=r.types.compose(y,r.types.model("DomainSwitcherEmail",{}).views((e=>({get isToggle(){return e.siteDataInitial.use_custom_email_domain},toggleDomainMessage:t=>t?"Domain was successfully enabled":`Custom domain is disabled and ${e.defaultDomains.email.share_email}, ${e.defaultDomains.email.other} are used as a fallback`}))).actions((e=>({_getSiteDomainSettings:e=>{const t={force_custom_web_domain_and_ssl:e,use_custom_email_domain:e};return Object(n.a)(t,(e=>{delete e.force_custom_web_domain_and_ssl}))}})))),v=r.types.compose(y,r.types.model("DomainSwitcherConsistent",{}).views((e=>({get isToggle(){return e.siteDataInitial.force_custom_web_domain_and_ssl&&e.siteDataInitial.use_custom_email_domain},toggleDomainMessage:t=>t?"Domains where successfully enabled":`Custom domains are disabled and ${e.defaultDomains.email.share_email}, ${e.defaultDomains.email.other} are used as a fallback for emails and ${e.siteDataInitial.default_custom_domains.web} for web`})))),S=r.types.model("CustomDomain",{type:r.types.maybeNull(r.types.string),status:r.types.maybeNull(r.types.frozen()),domainSwitcher:r.types.optional(y,{}),deleteDomain:r.types.optional(h.a,{}),isLoading:!1,error:r.types.maybeNull(r.types.string)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get router(){return e.rootStore.models.router},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get siteDataInitial(){return e.rootStore.models.site.toJSON()},get customDomainsPage(){return Object(r.getParent)(e)},get name(){return""},get isSet(){return _.some(e.name)},get isSelfManaged(){return e.siteDataInitial.self_serve_domain_creation},get isUp(){return!1},get records(){return null},get defaultDomains(){return e.customDomainsPage.defaultDomains}}))).actions((e=>({updateStatus:(t=null)=>{e.status=t},updateLoading:(t=!0)=>{e.isLoading=t},updateError:t=>{e.error=t},checkStatus:Object(r.flow)((function*({onError:t,showErrorFlash:a=!0}={}){try{e.updateLoading(!0),e.updateStatus(null),e.updateError(null);let t=Routes[`custom_${e.type}_domain_internal_site_path`](e.siteCachedSlug,{force:!0,no_spinner:!0});0;const{result:a}=yield Object(g.ajax)({url:t});e.updateStatus(a),e.domainSwitcher.setInitialData(),e.updateError(null)}catch(o){var n,i;"function"===typeof t&&t(o),null!=o&&null!=(n=o.responseJSON)&&null!=(i=n.result)&&i.error_message?e.updateError(o.responseJSON.result.error_message):a&&Object(s.b)()}finally{Object(r.isAlive)(e)&&e.updateLoading(!1)}})),reset:()=>{Object(r.applySnapshot)(e,{type:e.type})}}))),w=r.types.compose(S,r.types.model("CustomWebDomain",{type:"web",domainSwitcher:r.types.optional(f,{})}).views((e=>({get showSslValidationNotice(){return e.isSelfManaged&&!e.isUp&&e.status&&!e.status.ssl_validation_record},get sslValidationRecord(){var t;return e.isSelfManaged&&(null==(t=e.status)?void 0:t.ssl_validation_record)},get emphasizeSslValidationRecords(){const{ssl_validation_record_emphasize:t}=m.a.parse(e.router.location.search);return t&&!e.isUp},get records(){return(null==(t=e.status)||null==(a=t.record_table)?void 0:a.map((e=>({valid:!0,type:e.type,name:t.custom_web_domain,value:e.value}))))||[];var t,a},get isUp(){var t;return null==(t=e.status)?void 0:t.custom_web_domain_up},get name(){return e.siteDataInitial.custom_web_domain}})))),C=r.types.compose(S,r.types.model("CustomEmailDomain",{type:"email",domainSwitcher:r.types.optional(b,{})}).views((e=>({get records(){return(e=>{var t,a,r,n,i;if(null!=e&&e.delegated)return(null==e||null==(i=e.records)?void 0:i.map((t=>({valid:!0,type:t.type,name:e.domain,value:t.value}))))||[];const o=e=>{switch(e.record_type){case"MX":case"CNAME":return"unknown"===e.valid||"valid"===e.valid;default:return"valid"===e.valid}};return[...(null==e||null==(t=e.domain_info)||null==(a=t.sending_dns_records)?void 0:a.map((t=>({valid:o(t),type:t.record_type,name:t.name||e.domain,value:t.value}))))||[],...(null==e||null==(r=e.domain_info)||null==(n=r.receiving_dns_records)?void 0:n.map((t=>({valid:o(t),type:t.record_type,name:t.name||e.domain,value:`${t.priority} ${t.value}`}))))||[]]})(e.status)},get isUp(){var t,a,r;return"active"===(null==(t=e.status)||null==(a=t.domain_info)||null==(r=a.domain)?void 0:r.state)},get name(){return e.siteDataInitial.custom_email_domain}})))),E=r.types.compose(S,r.types.model("CustomConsistentDomain",{type:"consistent",domainSwitcher:r.types.optional(v,{})}).views((e=>({get records(){return e.customDomainsPage.web.records},get isUp(){return e.customDomainsPage.web.isUp&&e.customDomainsPage.email.isUp},get name(){return e.siteDataInitial.custom_web_domain}}))).actions((e=>({checkStatus:Object(r.flow)((function*(){try{e.updateLoading(!0),e.updateStatus(null),e.updateError(null),yield Promise.all([e.customDomainsPage.web.checkStatus({onError:e=>{throw e},showErrorFlash:!1}),e.customDomainsPage.email.checkStatus({onError:e=>{throw e},showErrorFlash:!1})]),e.domainSwitcher.setInitialData()}catch(n){var t,a;null!=n&&null!=(t=n.responseJSON)&&null!=(a=t.result)&&a.error_message?e.updateError(n.responseJSON.result.error_message):Object(s.b)()}finally{Object(r.isAlive)(e)&&e.updateLoading(!1)}}))})))),N=r.types.model("CustomDomainsPage",{web:r.types.optional(w,{}),email:r.types.optional(C,{}),consistent:r.types.optional(E,{}),newDomain:r.types.optional(u,{})}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.models.site.cached_slug},get siteDataInitial(){return e.rootStore.models.site.toJSON()},get isSet(){return e.web.isSet||e.email.isSet},get isConsistent(){return e.siteDataInitial.custom_domains_consistent},get defaultDomains(){return e.siteDataInitial.default_custom_domains}})));var O=a("NdV1"),x=a("AEM3");const I=r.types.model("SiteEditPage",{customDomainsPage:r.types.optional(N,{}),eventCategoriesPage:r.types.optional(O.a,{}),placementsRootPage:r.types.optional(x.a,{}),siteData:r.types.optional(o.a,{}),errors:r.types.optional(r.types.map(r.types.frozen()),{}),submitting:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.models.site.cached_slug},get siteDataInitial(){return e.rootStore.models.site.toJSON()},get pristine(){return _.isEqual(e.siteData.toJSON(),e.siteDataInitial)},get generalSettingsLink(){return Routes.edit_site_path(e.siteCachedSlug)},get pathKeyModified(){let t=[i.c];return e.rootStore.models.currentUser.staff_member&&t.push(i.b),t=t.flat(1/0),e.rootStore.models.site.isShopifyPlatform||(t=t.filter((e=>"lite_mode"!==e))),t},get prepareDataForServer(){return Object(i.e)(_.pick(e.siteData.toJSON(),e.pathKeyModified))}}))).actions((e=>({updateSiteData:()=>{Object(r.applySnapshot)(e.siteData,e.siteDataInitial)},reset:()=>{Object(r.applySnapshot)(e,{siteData:{},errors:{}})},updateSubmitting:t=>{e.submitting=t},deleteError:t=>{e.errors.delete(t)},updateErrors:t=>{e.errors.replace(t)},clearErrors:()=>{Object(r.applySnapshot)(e.errors,{})},onChangeSiteData:({target:{name:t,value:a}})=>{e.siteData[t]=a,e.deleteError(t)},onChangeSelect:({name:t,selectedOption:{value:a}})=>{e.onChangeSiteData({target:{name:t,value:a}})},cancelChanges:()=>{Object(r.applySnapshot)(e.siteData,e.siteDataInitial),e.clearErrors()},removeItemsFromArray:(e,t)=>Object(n.b)(e,(e=>(t.forEach((t=>{_.remove(e,(e=>_.isEqual(t,e)))})),e))),onSaveChanges:Object(r.flow)((function*(t){t&&t.preventDefault(),e.updateSubmitting(!0);try{yield e.rootStore.models.site.update({site:e.prepareDataForServer,no_spinner:!1}),e.updateSiteData(),e.clearErrors(),Validation.showSuccessFlash("Changes have been saved",6e3),e.rootStore.pages.integrationPage.reset()}catch(a){const t=_.get(a,"responseJSON.errors");if(_.isPlainObject(t)){_.some(_.difference(_.keys(t),_.keys(e.siteData)))?Validation.showErrorFlash("Something went wrong, please contact support@talkable.com",15e3):(e.updateErrors(t),Validation.showErrorFlash())}else Validation.showErrorFlash("Something went wrong, please contact support@talkable.com",15e3)}finally{Object(r.isAlive)(e)&&e.updateSubmitting(!1)}}))})))},v6cQ:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("UBih"),i=a("AEM3"),o=a("4mPH"),s=a("aFzQ");const l=e=>{const t=new Map;return e.map((e=>{t.set(e.event_category_id,t.get(e.event_category_id)?[...t.get(e.event_category_id),e]:[e])})),Array.from(t).map((([e,t])=>({eventCategoryId:e,placements:t.map(((e,t)=>({...e,indexNumber:t})))})))},c=r.types.model("PlacementsIndexPage",{placementsStreams:r.types.array(n.a),isChangeOrderMode:!1}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get router(){return e.rootStore.models.router},get placements(){return Object(r.getParentOfType)(e,i.a).placements},get siteEventCategories(){return e.rootStore.models.site.event_categories},getEventCategoryById:t=>e.siteEventCategories.find((e=>e.id===t)),get placementsStreamsSorted(){return e.placementsStreams.slice().sort(((t,a)=>((e,t)=>e<t?-1:0)(e.getEventCategoryById(t.eventCategoryId).identifier,e.getEventCategoryById(a.eventCategoryId).identifier)))},get isPristineOrder(){return e.placementsStreams.every((e=>e.isPristineOrder))},get isDisabledChangeOrderModeButton(){return e.placements.network.put.isLoading}}))).actions((t=>({toggleChangeOrderMode:()=>{t.isChangeOrderMode?t.init():t.isChangeOrderMode=!0},handleSubmitChangeOrder:Object(r.flow)((function*(){const a=(e=>{const t=[];return e.forEach((({placements:e})=>{[...e].sort(((e,t)=>e.indexNumber-t.indexNumber)).forEach((e=>{t.push({...e})}))})),t})(Object(s.toJS)(t.placementsStreams));try{t.placements.network.put.updateLoading(!0);const e=yield t.placements.apiPut(Object(o.f)(a));t.placements.updateData(e.campaign_placement),t.init()}catch(xhr){e({message:"Failed to save changes",name:"Ajax failure 500",xhr:xhr}),UINotifications.showErrorFlash()}finally{Object(r.isAlive)(t)&&t.placements.network.put.updateLoading(!1)}})),init:()=>{Object(r.applySnapshot)(t,{placementsStreams:l(Object(s.toJS)(t.placements.campaign_placements))})},reset:()=>{Object(r.applySnapshot)(t,{})}})))}).call(this,a("B9cq").notifyDevelopers)},vWkL:function(e,t,a){"use strict";(function(e){a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var r=a("vOnD"),n=a("GaHK"),i=a("qfPl");function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const l=Object(r.default)(n.UIMenuDropdown).withConfig({displayName:"header_staff_menu__UIMenuDropdownStyleOverride"})(["position:absolute;right:0;top:0;height:100%;width:32px;","{min-width:240px;margin-right:16px;z-index:5;}"],n.UIMenuDropdown.CLASS_NAMES.list),c=r.default.div.withConfig({displayName:"header_staff_menu__StaffMenuIconWrapper"})(["height:100%;width:100%;display:flex;align-items:center;justify-content:center;cursor:pointer;background-color:#ffde00;svg{margin:0 !important;}",""],(({isOpened:e})=>e&&Object(r.css)(["svg{width:12px;height:12px;}"]))),p=Object(r.default)(n.UIMenuDropdown.GroupTitle).withConfig({displayName:"header_staff_menu__MenuItemTitle"})(["padding:10px 12px;color:",";"],n.Theme.color.black50),u=t=>e.createElement(i.a,s({isSmall:!0},t));let d=function(t){var a,r;function i(){return t.apply(this,arguments)||this}return r=t,(a=i).prototype=Object.create(r.prototype),a.prototype.constructor=a,o(a,r),i.prototype.render=function(){const{isPermissionManager:t}=this.props;return e.createElement(l,{"data-testid":"ac-header-staff-menu",renderButton:({isOpened:t,disabled:a})=>e.createElement(c,{className:"staff-menu-icon-wrapper",disabled:a,isOpened:t},e.createElement(n.UIIcon,{name:t?"cross":"lockFilled",fill:n.Theme.color.black100}))},t&&e.createElement(e.Fragment,null,e.createElement(u,{name:"Access",href:Routes.account_accesses_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"events"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"All users",href:Routes.staff_users_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"users"})}),e.createElement(n.UIDivider,null)),!t&&e.createElement(e.Fragment,null,e.createElement(p,null,"Resources"),e.createElement(n.UIDivider,null),e.createElement(u,{name:"My access",href:Routes.account_accesses_path({accesses_grid:{active:"YES"}}),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"events"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Liquid search",icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"search"}),href:Routes.staff_liquid_search_path()}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"All campaigns",icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"campaigns"}),href:Routes.staff_campaigns_path()}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"All sites",href:Routes.staff_sites_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"sites"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"All users",href:Routes.staff_users_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"users"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Webhooks",href:Routes.staff_web_hooks_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"webhook"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Job positions",href:Routes.staff_jobs_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"case"})}),e.createElement(n.UIDivider,null),e.createElement(p,null,"Reports"),e.createElement(n.UIDivider,null),e.createElement(u,{name:"A/B tests",href:Routes.split_tests_staff_reports_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"split"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Customer health",href:Routes.customer_health_staff_reports_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"plusSquared"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Settings changes",href:Routes.settings_changes_staff_reports_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"changes"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Email performance",href:Routes.staff_email_performances_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"emailDomain"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Focus billing",href:Routes.billing_staff_reports_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"pay"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Support scripts",href:Routes.staff_support_scripts_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"staffPage"})}),e.createElement(n.UIDivider,null),e.createElement(p,null,"Monitoring"),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Offer blasts",href:Routes.staff_offer_blasts_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"postEvent"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Sidekiq",href:Routes.staff_sidekiq_web_path(),iconHoveredColor:"#b5141c",icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"sidekiq"})}),e.createElement(n.UIDivider,null),e.createElement(u,{name:"Tables stats",href:Routes.staff_tables_stats_path(),icon:()=>e.createElement(n.UIIcon,{fill:n.Theme.color.black75,name:"staffPage"})})))},i}(e.Component);d.defaultProps={isPermissionManager:!1}}).call(this,a("q1tI"))},varW:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return p}));var r=a("UVaA"),n=a("Z5Pp"),i=a("rgKW"),o=a("99Ma"),s=a("sT1B"),l=a("Leho"),c=a("B9cq");const p=o.types.model("CustomerServiceStore",{searchFieldValue:"",searchQuery:"",personalData:o.types.maybeNull(o.types.map(o.types.frozen())),personIsFetching:!1,isAnonymizeModal:!1,isPersonalModal:!1,currentPerson:o.types.optional(r.a,{}),currentCspReferrals:o.types.optional(n.a,{}),fraudSettings:o.types.optional(i.a,{}),showFraudSettings:o.types.optional(o.types.boolean,!1),gaCategory:s.D,createReferralStore:o.types.optional(l.a,{}),cspPersonStore:o.types.optional(r.a,{})}).views((e=>({get rootStore(){return Object(o.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get fraudSettingsFetched(){var t,a,r;return null==(t=e.fraudSettings)||null==(a=t.network)||null==(r=a.get)?void 0:r.isLoaded}}))).actions((t=>({hideFraudSettings:()=>{t.showFraudSettings=!1},toggleFraudSettings:e=>{e&&e.preventDefault(),t.fetchFraudSettings(),t.showFraudSettings=!t.showFraudSettings},fetchFraudSettings:Object(o.flow)((function*(){t.fraudSettingsFetched||(yield t.fraudSettings.fetchData())})),resetFraudSettings:()=>{t.showFraudSettings=!1,t.fraudSettings.reset()},fetchPerson:async()=>{if(!t.personIsFetching){t.personIsFetching=!0;try{const e=await t.cspPersonStore.fetchData(t.searchQuery);t.replacePerson(e)}catch(xhr){e({message:"Unable to get person",name:"Ajax failure",xhr:xhr})}}},replacePerson:e=>{var a;t.currentPerson.update((null==e||null==(a=e.result)?void 0:a.person)||{}),t.currentPerson.resetCounters(),t.currentPerson.fetchCounters(t.searchQuery),t.personIsFetching=!1},updateSearchFieldValue:e=>{t.searchFieldValue=e},updateSearchQuery:e=>{t.searchQuery=e},updateSearch:e=>{t.updateSearchFieldValue(e),t.updateSearchQuery(e)},applySearchFieldValue:({target:{value:e}})=>{t.updateSearchFieldValue(e.toLowerCase())},resetSearch:()=>{t.updateSearchFieldValue(""),t.updateSearchQuery("")},resetPerson:()=>{t.currentPerson.reset()},searchPerson:e=>(e&&e.preventDefault(),t.searchQuery=t.searchFieldValue,t.fetchPerson(),t.searchQuery),resetCurrentCspReferrals:()=>{Object(o.applySnapshot)(t.currentCspReferrals,{})},resetCSP:()=>{t.resetPerson(),t.resetSearch(),t.resetCurrentCspReferrals(),t.resetFraudSettings()},onToggleModal:(e,a)=>{t[e]=a},updatePersonalData:e=>{t.personalData=e},handleAnonymize:(e,a,r)=>Object(c.ajax)({type:"POST",url:Routes.anonymize_internal_site_person_path(e,a)}).then((()=>{t.onToggleModal("isAnonymizeModal",!1),t.updateSearch(""),t.resetPerson(),r.push({search:""}),Validation.showSuccessFlash("Person was successfully anonymized")})).fail((()=>{t.onToggleModal("isAnonymizeModal",!1),Validation.showErrorFlash("Error trying to anonymize person\u2019s data")})),getPersonalData:(e,a)=>Object(c.ajax)({type:"GET",url:Routes.personal_data_internal_site_person_path(e,a)}).then((e=>{t.updatePersonalData(e.result.person),t.onToggleModal("isPersonalModal",!0)})).fail((()=>{t.onToggleModal("isPersonalModal",!1),Validation.showErrorFlash("Error trying to export personal data")})),unsubscribePerson:(e,a)=>Object(c.ajax)({type:"PATCH",url:Routes.unsubscribe_internal_site_person_path(e,a)}).then((e=>{const a=_.get(e,"result.person.unsubscribed_at",{});t.currentPerson.updateUnsubscribedValue(a),Validation.showSuccessFlash("Person was unsubscribed")})).fail((()=>{Validation.showErrorFlash("Error trying to unsubscribe person")})),resubscribePerson:(e,a)=>Object(c.ajax)({type:"PATCH",url:Routes.resubscribe_internal_site_person_path(e,a)}).then((e=>{const a=_.get(e,"result.person.unsubscribed_at",{});t.currentPerson.updateUnsubscribedValue(a),Validation.showSuccessFlash("Person was re-subscribed")})).fail((()=>{Validation.showErrorFlash("Error trying to re-subscribe person")})),reset(){Object(o.applySnapshot)(t,{})}})))}).call(this,a("B9cq").notifyDevelopers)},vrPu:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return j}));var r=a("aFzQ"),n=a("99Ma"),i=a("rfrl"),o=a("dhqo"),s=a.n(o),l=a("sT1B"),c=a("V0vo"),p=a("KA3C"),u=a("CmFo"),d=a("xEex"),m=a("gXXH"),g=a("aetS"),h=a("2zfS"),y=a("ZKCC"),f=a("9LaU"),b=a("UEOA"),v=a("2TKB"),S=a("1Vml"),w=a("mxly");const C='<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner no-max-width h-wabs-5"></div></div>',E="Advocate origin max age must be greater than advocate origin min age",N="You need to remove subscription incentives in order to enable this field.",O=["criteria","description","deactivate_on_no_coupons","destination_url_override","expires_at","friend_deadline","gdpr_and_ccpa_enabled","ip_address_filtering_mode","ip_address_filtering_value","loyalty_dashboard_url","merchant_signup_url","name","new_customer","offer_duration","origin_max_age","origin_min_age","redirect_on_expired_claim","require_email_to_claim","require_email_to_share","show_claim_page_for_self_referral","single_visitor_for_direct_shares","smart_advocate_signup","static_widget","tags_attributes","use_facebook_app_id","tiered","tiers_metric_identifier","tiers_period_months"],x=[{label:"sec",value:l.gb.UNIT},{label:"min",value:l.gb.SECONDS_IN_MINUTE},{label:"hour",value:l.gb.SECONDS_IN_HOUR},{label:"day",value:l.gb.SECONDS_IN_DAY},{label:"week",value:l.gb.SECONDS_IN_WEEK}],I=({age:e,static_widget:t})=>{return"1"===t?null:0!==(a=e.fields.time.value*e.fields.unit.value)?a:null;var a},P=n.types.model("VariablesModel",{show:!1,isFetched:!1,data:n.types.map(n.types.frozen())}).views((e=>({get preparedData(){return Object.fromEntries(Object(r.toJS)(e.data))}}))),R=n.types.compose("CampaignRules",v.b,n.types.model({active:n.types.boolean,advocate_incentives:n.types.array(b.a),all_liquid_interpolations:n.types.frozen(),criteria:n.types.maybeNull(n.types.string),deactivate_on_no_coupons:n.types.maybeNull(n.types.string),description:n.types.maybeNull(n.types.string),destination_url_override:n.types.maybeNull(n.types.string),friend_incentives:n.types.array(b.a),gdpr_and_ccpa_compatible_views:n.types.maybeNull(n.types.boolean),gdpr_and_ccpa_compatible:n.types.boolean,gdpr_and_ccpa_enabled:n.types.boolean,gleam_integration_css:n.types.maybeNull(n.types.string),has_activities:n.types.boolean,new_customer:n.types.maybeNull(n.types.string),offer_integration_css:n.types.maybeNull(n.types.string),offers_count:n.types.maybeNull(n.types.number),origin_max_age:n.types.maybeNull(n.types.union(n.types.number,n.types.string)),origin_min_age:n.types.maybeNull(n.types.union(n.types.number,n.types.string)),parent:n.types.maybeNull(S.a),parent_id:n.types.maybeNull(n.types.number),preview_short_url:n.types.maybeNull(n.types.string),redirect_on_expired_claim:n.types.string,require_email_to_claim:n.types.string,require_email_to_share:n.types.string,scheduled:n.types.maybeNull(n.types.boolean),show_claim_page_for_self_referral:n.types.string,single_visitor_for_direct_shares:n.types.string,smart_advocate_signup:n.types.string,tiered:n.types.maybeNull(n.types.boolean),trigger_integration_css:n.types.maybeNull(n.types.string),updated_at:n.types.maybeNull(n.types.string),use_facebook_app_id:n.types.string,uses_tags_for_integration:n.types.maybeNull(n.types.boolean),tiers_metric_identifier:n.types.maybeNull(n.types.string),tiers_period_months:n.types.maybeNull(n.types.number),constants:n.types.optional(n.types.model({MIN_SUITABLE_VERSION_FOR_PLACEMENTS:"",TIER_METRICS:n.types.array(n.types.model({format:n.types.string,identifier:n.types.string,name:n.types.string}))}),{})})),j=n.types.model("CampaignRulesStore",{tagName:"",userIpAddress:n.types.optional(m.a,{}),showUserIpAddress:!1,campaign:n.types.optional(R,{active:!1,description:"",gdpr_and_ccpa_compatible:!1,has_activities:!1,redirect_on_expired_claim:"",scheduled:!1,show_claim_page_for_self_referral:"",smart_advocate_signup:"",use_facebook_app_id:"",gleam:!1,leaderboard:!1,name:"",normalized_preset_name:"",preset_name:"",static_widget:"",status:"Test",test_mode:!1,single_visitor_for_direct_shares:"",deletable:!1,gdpr_and_ccpa_enabled:!1,require_email_to_claim:"",require_email_to_share:""}),values:n.types.frozen(),initialValues:n.types.frozen(),errors:n.types.map(n.types.frozen()),submitting:!1,isInitialLoading:!0,tags:n.types.array(n.types.frozen()),incentiveHighlightNewId:n.types.maybeNull(n.types.number),incentiveHighlightEditId:n.types.maybeNull(n.types.number),variables:n.types.optional(n.types.model({join_criteria_interpolations:n.types.optional(P,{}),destination_url_interpolations:n.types.optional(P,{})}),{}),incentiveFormStore:n.types.optional(p.a,{}),incentiveActions:n.types.optional(u.a,{}),incentives:n.types.optional(d.a,{}),sidebarActiveLinkId:"",offerDuration:n.types.optional(h.a,{}),loyaltyTiersRoot:n.types.optional(w.a,{}),loyaltyRulesRoot:n.types.optional(y.a,{}),loyaltyRedemptionRulesRoot:n.types.optional(f.a,{}),updateTieredTypeModal:n.types.optional(g.a,{}),switchLoyaltyCampaignTypeModal:n.types.optional(g.a,{})}).volatile((()=>({staticWidgetValueHasBeenUpdated:!1,sections:{},tieredToSwitch:null}))).views((e=>({get rootStore(){return Object(n.getRoot)(e)},get site(){return e.rootStore.models.site},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get currentUser(){return e.rootStore.models.currentUser},get campaignShowRoot(){return e.rootStore.pages.campaignShowRoot},get sitePersonalCouponLists(){return e.rootStore.models.sitePersonalCouponLists},get isIncentivesFetched(){return e.incentives.network.get.isLoaded},get isIncentivesOrPersonalCouponsFetched(){let t=!1;return t=e.campaign.personal_coupon_list_id?e.isIncentivesFetched&&e.sitePersonalCouponLists.currentPersonalCouponListDataFetched:e.isIncentivesFetched,t},get allowScrolling(){return e.campaign.loyaltySpace?e.loyaltyRulesRoot.loaded:e.isIncentivesOrPersonalCouponsFetched},get isIncentivesOrPersonalCouponsExists(){return e.campaign.personal_coupon_list_id||e.incentives.isIncentivesExists},get view_setups(){return e.campaignShowRoot.view_setups},buildOriginAge(e){if(!e)return{time:null,unit:l.gb.UNIT};const t=[...x].reverse().find((t=>e%t.value===0));return{time:e/t.value,unit:t.value}},get staticWidgetEnabled(){return"1"===e.values.static_widget},get mustBeDisabledCriteria(){return"1"===e.initialValues.static_widget&&!e.staticWidgetValueHasBeenUpdated},get hasUnsavedChanges(){return!_.isEqual(e.values,e.initialValues)},get allowEdit(){return e.campaign.test_mode||!e.campaign.has_activities},get isCampaignDeactivated(){return e.campaign.expires_at&&"Disabled"===e.campaign.status},get shouldShowPlacement(){var t;return Boolean(null==(t=e.campaign.placement)?void 0:t.id)},get campaignNewPath(){return Routes.new_campaign_site_path(e.siteCachedSlug,e.rootStore.urlSpaceParameter)},normalizeValues:t=>Object.entries(t).filter((([e,t])=>O.includes(e))).reduce(((t,[a,r])=>{switch(a){case"origin_min_age":case"origin_max_age":t[a]=e.createAgeField({key:a,value:r});break;case"expires_at":case"friend_deadline":t[a]=e.createTimeField({key:a,value:r});break;default:t[a]=r}return t}),{}),createAgeField({key:t,value:a}){const{unit:r,time:n}=e.buildOriginAge(a);return{name:t,fields:{time:{value:n},unit:{value:r,extra:{options:x}},isUnlimited:{value:0===Number(n)}}}},createTimeField:({key:t,value:a})=>({name:t,fields:{date:{value:Object(c.p)({date:a,timeZoneIdentifier:e.site.time_zone_identifier,format:"MM/DD/YYYY"})},hour:{value:Object(c.p)({date:a,timeZoneIdentifier:e.site.time_zone_identifier,format:"HH",defaultValue:"00"})},minute:{value:Object(c.p)({date:a,timeZoneIdentifier:e.site.time_zone_identifier,format:"mm",defaultValue:"00"})},zone:{value:Object(c.p)({date:a,timeZoneIdentifier:e.site.time_zone_identifier,format:"Z",defaultValue:e.campaign.created_at&&dayjs(e.campaign.created_at).tz(e.site.time_zone_identifier).format("Z")})}}}),isOriginAgeInvalid(){const{origin_max_age:t,origin_min_age:a}=e.values;if(_.isUndefined(a)||_.isUndefined(t))return!1;if(_.isNull(t.fields.time.value))return!1;return Number(t.fields.time.value)*t.fields.unit.value<Number(a.fields.time.value)*a.fields.unit.value},prepareCampaignDataForServer(){const t=e=>({date:e.fields.date.value,hour:e.fields.hour.value,minute:e.fields.minute.value,zone:e.fields.zone.value});if(e.campaign.referralSpace){const e=Object(i.a)(this.values,(e=>{"1"===e.static_widget&&_.isEmpty(this.initialValues.criteria)&&_.isEmpty(e.criteria)&&delete e.criteria})),{origin_min_age:a,origin_max_age:r,ip_address_filtering_value:n,expires_at:o,friend_deadline:s}=e;return{campaign:{...e,origin_min_age:I({age:a,static_widget:e.static_widget}),origin_max_age:I({age:r,static_widget:e.static_widget}),ip_address_filtering_value:n||null,expires_at:t(o),friend_deadline:t(s)}}}if(e.campaign.conversionSpace||e.campaign.loyaltySpace){const a=Object(i.a)(this.values,(a=>{e.campaign.loyaltySpace&&delete a.expires_at,e.campaign.conversionSpace&&(a.expires_at=t(a.expires_at)),delete a.friend_deadline}));return{campaign:{...a,ip_address_filtering_value:a.ip_address_filtering_value||null}}}},normalizePersonalizedCouponData:()=>({campaign:Object(i.a)({},(t=>{const{pages:{personalCouponFormStore:{mode:a,selectedPersonalCouponListId:r}}}=e.rootStore;a&&(t.personal_coupon_list_id=r)}))}),get advocateIncentives(){return _.filter(e.incentives.data,"for_advocate")},get advancedSettingsCheckboxesConfig(){const t=_.some(e.incentives.data,_.matchesProperty("new_optin",l.hb));let a="";return e.campaign.has_activities&&(a="You cannot change the value because this campaign already has activity (shares, affiliate members, etc)."),t&&(a+=` ${N}`),{require_email_to_share:{label:"Email gating for advocate",extra:{tips:[{title:"Require Advocate to enter their email address in order to share with Friends."}],warning:{text:"Please be aware that without Advocate email gating,\n                    Talkable will not capture email addresses for Advocates who are not logged in to your site.\n                    That means those users will be considered anonymous and will not be eligible for rewards or able\n                    to be identified in reports.",show:!Number(e.values.require_email_to_share)&&e.advocateIncentives.length}}},require_email_to_claim:{label:"Email gating for friend",disabled:t,extra:{tips:[{title:"Require Friend to enter their email address in order to get a coupon code on the Friend Claim Page."},{title:N,hideWhen:!t}],warning:{text:"Impossible to enter Friend email on a disabled Claim page. Either enable Friend Claim Page or disable email gating.",show:Boolean(Number(e.values.require_email_to_claim))&&_.some(e.view_setups.data,(e=>"offers_claim"===e.view_category&&!e.enabled))}}},use_facebook_app_id:{label:"Use Facebook App Share instead of sharer.php"},single_visitor_for_direct_shares:{label:"Single visitor for email shares",disabled:e.campaign.has_activities||t,extra:{tips:[{title:"<ol className='h-hgap-s'>\n                <li>Allows to embed Coupon Code into Friend Share Email and its reminder</li>\n                <li>Only one Coupon Code is given per Email Share per Offer. That means if multiple Friends click on the Share link they all get the same Coupon Code. It works great for Fraud prevention as the Coupon Code will be applied only once by a first Friend who buys.</li>\n                <li>Friends automatically skip Email Gating on the Friend Claim Page</li>\n                <li>Friend's email address is available for use on the Friend Claim Page at all times</li>\n                <li>Friend Share Email will not be sent if Friend Incentive Criteria does not succeed</li>\n              </ol>"},{title:a,showWhen:e.campaign.has_activities||t}],tipTemplate:C}},smart_advocate_signup:{label:"Smart advocate signup",extra:{tips:[{title:"Advocate Signup page will be skipped in a case when Advocate email address is known from their previous activity, there are no other emails associated with this Advocate, and the email was not passed through the integration."}],tipTemplate:C}},show_claim_page_for_self_referral:{label:"Show claim page to a self-referral"},redirect_on_expired_claim:{label:"Show claim page when friend offer expires"},static_widget:{label:"Static trigger widget",disabled:!e.rootStore.models.currentUser.staffMember,extra:{staffOnly:!0,tips:[{title:"With this setting Talkable does not create advocate offers as soon as an advocate trigger widget is rendered. The offer is only created whenever an advocate signup page or advocate share page is rendered."}],warning:{text:`Require integration v. ${e.rootStore.models.site.min_suitable_version_for_static_widget}+`,show:e.staticWidgetEnabled&&!e.rootStore.models.site.is_version_suitable_for_static_widget}}},gdpr_and_ccpa_enabled:{label:"GDPR & CCPA compliance",disabled:!e.campaign.gdpr_and_ccpa_compatible,extra:{tips:[{title:e.campaign.gdpr_and_ccpa_compatible_views?"This campaign does not have GDPR & CCPA compliant templates.":"This campaign uses friend share email or friend share email reminder view. You can disable them inside Editor.",showWhen:!e.campaign.gdpr_and_ccpa_compatible}]}},deactivate_on_no_coupons:{label:"Deactivate this campaign automatically in case incentives run out of coupons",extra:{tips:[{title:"The campaign will stay live in case advocate referral or friend referred incentives run out of coupons because Talkable will wait until more coupons are added to issue rewards."}],tipTemplate:C}}}},get joinCriteriaDescription(){let t="This criteria can be used to customize advocate's offer creation conditions. Use it when the above UI controls aren't enough. Since the criteria is a logical expression it should return `true` to allow advocate offer creation and anything else to deny.";return e.campaign.referralSpace?e.campaign.gleam&&(t="This criteria can be used to customize offer creation conditions. Use it when the above UI controls aren't enough. Since the criteria is a logical expression it should return `true` to allow offer creation and anything else to deny."):t="This criteria can be used to customize visitor's offer creation conditions. Use it when the above UI controls aren't enough. Since the criteria is a logical expression it should return `true` to allow visitor offer creation and anything else to deny.",t},get IPFilteringTitle(){let t="Limit advocate offer access by IP address:";return e.campaign.referralSpace?e.campaign.gleam&&(t="Limit offer access by IP address:"):t="Limit visitor offer access by IP address:",t},get originAgeFieldData(){return e.campaign.gleam?{label:"Timeframe when the Gleam is shown:",extra:{tip:"An example would be: Setting 'From' timeframe to 1 day will make the new visitor who is coming to a site don't see the Gleam. However when they return back to a site in 24 hours they will be able to see it.",tipTemplate:C}}:{label:"Limit advocate offer access by its creation date:",extra:{tip:"An example would be: show Floating Widget to existing visitors only (people who previously landed on the site at least once). Setting 'From' timeframe to 1 day will make all Advocates see the campaign only in 1 day from the first page visit. If the new visitor who is coming to a site they will not see the campaign. However when they return back to a site after 24 hours timeframe they will be able to see it.",tipTemplate:C}}},get destinationUrlTitle(){let t="Friend destination URL:";return e.campaign.conversionSpace&&(t="Visitor destination URL:"),t},get destinationUrlDescription(){let t="This is a destination URL that friends visit upon clicking on the main CTA on the friend claim page, or when it is disabled.";return e.campaign.conversionSpace&&(t="Visitors who click on the CTA inside email capture campaign will be redirected to this page. The URL should contain query parameters to help you track the traffic coming through Talkable."),t},get tiersMetricOptions(){return e.campaign.constants.TIER_METRICS.map((e=>({value:e.identifier,label:e.name})))},get selectedTiersMetric(){return e.campaign.constants.TIER_METRICS.find((t=>t.identifier===e.values.tiers_metric_identifier))||null},get currentTiersPeriod(){const t=Math.floor(e.values.tiers_period_months/12),a=e.values.tiers_period_months%12;let r=t?s()("year",t,!0):"";return r+=a?` ${s()("month",a,!0)}`:"",r.trim()},get showTieredProgramBlocks(){return e.values.tiered}}))).actions((t=>({init:Object(n.flow)((function*(a={reloadWizard:!0}){try{const e=t.campaign.id||a.id,{result:r}=yield $.ajax({url:Routes.rules_internal_site_campaign_path(t.siteCachedSlug,e,{no_spinner:!0})});t.view_setups.network.get.isLoaded||t.view_setups.apiGet(e),t.incentives.apiGet(e),t.updateCampaign(r),t.updateValues(r),t.offerDuration.init(r.offer_duration),t.updateTags(r.tags),t.updateInitialLoading(!1),t.updateSubmitting(!1),a.reloadWizard&&t.currentUser.show_campaign_wizard===l.hb&&Wizard.reload()}catch(xhr){e({name:"Unable campaign data Campaign Rules",message:"Ajax failure",xhr:xhr})}})),updateInitialLoading(e){t.isInitialLoading=e},updateSidebarActiveLinkId:e=>{t.sidebarActiveLinkId=e},handleEnterSection:e=>{t.sections[e]?t.sections[e]=t.sections[e]+1:t.sections[e]=1,t.updateActiveSection()},handleLeaveSection:e=>{t.sections[e]&&(t.sections[e]=t.sections[e]-1),0===t.sections[e]&&delete t.sections[e],t.updateActiveSection()},updateActiveSection(){var e;const a=null==(e=Object.entries(t.sections).sort(((e,t)=>t[1]-e[1]))[0])?void 0:e[0];a&&t.updateSidebarActiveLinkId(a)},updateTagName:e=>{t.tagName=e},onChangeTag:e=>{t.updateValue({key:"tags_attributes",value:[{name:e}]}),t.updateTagName(e)},updateTags(e){Object(n.applySnapshot)(t.tags,e)},addTag(){t.tags.push({name:t.tagName}),t.saveChanges()},removeTag:Object(n.flow)((function*(a){const n=t.tags.find((e=>e.id===a)),i=t.tags.findIndex((e=>e.id===a));t.updateTags(t.tags.filter((e=>e.id!==a)));try{yield $.ajax({url:Routes.internal_site_campaign_path(t.siteCachedSlug,t.campaign.id),type:"PUT",dataType:"json",data:{campaign:{tags_attributes:{id:a,_destroy:!0}}}}),Validation.showSuccessFlash()}catch(xhr){const o=Object(r.toJS)(t.tags);o.splice(i,0,n),t.updateTags(o),e({name:"Unable delete tag Campaign Rules",message:"Ajax failure",xhr:xhr})}})),filterRealTag(){Object(n.applySnapshot)(t.tags,t.tags.filter((e=>_.has(e,"id"))))},updateCampaign:e=>{t.campaign=R.create(e)},updateSubmitting:e=>{t.submitting=e},updateValues:e=>{t.values=t.normalizeValues(e),t.updateInitialValues(e)},updateInitialValues:e=>{t.initialValues=t.normalizeValues(e)},updateValue({key:e,value:a}){t.values={...t.values,[e]:a}},handleChangeLoyaltyCampaignType({target:{name:e,value:a}}){const r=e=>_.omit(e,"tiered");_.isEqual(r(t.values),r(t.initialValues))?t.updateValue({key:e,value:a}):(t.switchLoyaltyCampaignTypeModal.open(),t.tieredToSwitch=a)},onChangeValue(e){const{name:a,value:r}=e.target;switch(a){case"ip_address_filtering_mode":r||t.updateValue({key:"ip_address_filtering_value",value:""}),t.updateValue({key:a,value:r||null});break;case"offer_duration.unlimited":r?t.updateValue({key:"offer_duration",value:null}):(t.updateValue({key:"offer_duration",value:1}),t.offerDuration.init(1));break;case"static_widget":t.staticWidgetValueHasBeenUpdated=!0,t.updateValue({key:"static_widget",value:r});break;default:t.updateValue({key:a,value:r})}},updateFieldValue({name:e,fieldKey:a,value:r}){t.values=Object(i.a)(t.values,(t=>{t[e].fields[a].value=r}))},handleSelectChange({selectedOption:e,name:a}){t.onChangeField({target:{value:e.value,name:a}})},onChangeField(e){const{name:a,value:r}=e.target,[n]=a.split(".");switch(a){case"origin_min_age.time":case"origin_max_age.time":"0"===r&&t.updateFieldValue({name:n,fieldKey:"isUnlimited",value:!0}),t.updateFieldValue({name:n,fieldKey:"time",value:r});break;case"origin_min_age.unit":case"origin_max_age.unit":t.updateFieldValue({name:n,fieldKey:"unit",value:r});break;case"origin_min_age.isUnlimited":case"origin_max_age.isUnlimited":t.updateFieldValue({name:n,fieldKey:"time",value:r?null:1}),t.updateFieldValue({name:n,fieldKey:"unit",value:1}),t.updateFieldValue({name:n,fieldKey:"isUnlimited",value:r});break;case"expires_at.date":case"friend_deadline.date":t.updateFieldValue({name:n,fieldKey:"date",value:r?dayjs(r).format("l"):null}),t.updateFieldValue({name:n,fieldKey:"hour",value:"00"}),t.updateFieldValue({name:n,fieldKey:"minute",value:"00"});break;case"expires_at.hour":case"friend_deadline.hour":t.updateFieldValue({name:n,fieldKey:"hour",value:r});break;case"expires_at.minute":case"friend_deadline.minute":t.updateFieldValue({name:n,fieldKey:"minute",value:r})}},updateErrors(e){Object(n.applySnapshot)(t.errors,e)},clearErrors(){t.errors.clear()},reset(){Object(n.applySnapshot)(t,{})},savePersonalCouponList:Object(n.flow)((function*(){if(!t.submitting){t.updateSubmitting(!0);try{yield $.ajax({url:Routes.internal_site_campaign_path(t.siteCachedSlug,t.campaign.id),type:"PUT",dataType:"json",data:t.normalizePersonalizedCouponData()}),t.clearErrors(),t.rootStore.pages.personalCouponFormStore.hidePersonalCouponForm(),t.rootStore.pages.personalCouponFormStore.hidePersonalCouponRemoveModal(),yield t.init(),t.rootStore.pages.personalCouponFormStore.showHighlightChanges(),Validation.succeed(),Utils.trackGAEvent(l.u,"update personal coupon list")}catch(xhr){t.failSaveChanges(xhr)}}})),resolveSwitchCampaignType(){"boolean"===typeof t.tieredToSwitch&&(t.updateValue({key:"tiered",value:t.tieredToSwitch}),t.tieredToSwitch=null)},resetSwitchCampaignType(){t.tieredToSwitch=null},handleSaveChanges:()=>{t.resetSwitchCampaignType(),t.saveChanges()},saveChanges:Object(n.flow)((function*(){if(t.submitting)return"submitting";if(t.updateSubmitting(!0),t.isOriginAgeInvalid())return Validation.showErrorFlash(E),t.updateSubmitting(!1),"not valid";if(t.campaign.loyaltySpace&&t.values.tiered&&t.loyaltyTiersRoot.tiers.length<2)return t.updateTieredTypeModal.open(),t.updateSubmitting(!1),"not valid";try{yield $.ajax({url:Routes.internal_site_campaign_path(t.siteCachedSlug,t.campaign.id),type:"PUT",dataType:"json",data:t.prepareCampaignDataForServer()}),t.clearErrors(),yield t.init(),yield t.campaignShowRoot.init({id:t.campaign.id,showSpinner:!1}),t.resolveSwitchCampaignType(),Validation.succeed(),t.updateTagName("")}catch(xhr){t.failSaveChanges(xhr)}})),failSaveChanges(e){t.filterRealTag();const a=_.get(e,"responseJSON.result.errors",{});a.tiers&&t.updateTieredTypeModal.open(),t.updateErrors(a),Validation.fail(a),t.updateSubmitting(!1)},saveOnEnter(e){e.which&&(e.metaKey||e.ctrlKey)&&e.which===l.T.S&&(e.preventDefault(),t.saveChanges())},updateShowUserIpAddress(e){t.showUserIpAddress=e},fetchUserIpAddress:Object(n.flow)((function*(){Utils.trackGAEvent(l.u,"fetch current ip");try{yield t.userIpAddress.apiGet(),t.updateShowUserIpAddress(!0)}catch(xhr){e({name:"Unable to fetch current ip",message:"Ajax failure",xhr:xhr})}})),updateIncentiveHighlightNewId(e){t.incentiveHighlightNewId=e},updateIncentiveHighlightEditId(e){t.incentiveHighlightEditId=e},clearIncentiveHighlightId(){t.incentiveHighlightNewId=null,t.incentiveHighlightEditId=null},toggleShowVariables(e){_.mapKeys(t.variables,((a,r)=>{t.variables[r].show=r===e&&!t.variables[r].show}))},updateVariables(e,a){Object(n.applySnapshot)(t.variables[e].data,a[e]),t.variables[e].isFetched=!0},getVariables:Object(n.flow)((function*(a){if(!t.variables[a].isFetched)try{const e=yield $.ajax(Routes[`${a}_internal_site_campaign_path`](t.siteCachedSlug,t.campaign.id,{no_spinner:!0})),{result:r}=e;t.updateVariables(a,r)}catch(xhr){e({name:`Unable get ${a} variables Campaign Rules`,message:"Ajax failure",xhr:xhr})}})),convertOfferDurationIntoHours(e){const a=Object(c.r)({period:t.offerDuration.period,value:e||""});t.updateValue({key:"offer_duration",value:a})},onChangeOfferDuration(e){const{name:a}=e;switch(a){case"offer_duration_period":t.offerDuration.updatePeriod(e.selectedOption.value),t.convertOfferDurationIntoHours(t.offerDuration.delay);break;case"offer_duration":t.offerDuration.updateDelay(e.value),t.convertOfferDurationIntoHours(e.value)}},onChangePeriodMetricUnit({target:{value:e}}){t.periodMetricUnit=e}})))}).call(this,a("B9cq").notifyDevelopers)},vxPL:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var r=a("99Ma"),n=a("aFzQ"),i=a("B9cq"),o=a("BpJz"),s=a("AHpt");const l=r.types.model("Offer",{id:r.types.identifierNumber,page:r.types.maybeNull(r.types.number),created_at:r.types.maybeNull(r.types.string),short_url_code:r.types.maybeNull(r.types.string),person:r.types.maybeNull(o.a),campaign:r.types.maybeNull(s.a),clicks_count:r.types.maybeNull(r.types.number),referrals_count:r.types.maybeNull(r.types.number),shares_count:r.types.maybeNull(r.types.number),visits_count:r.types.maybeNull(r.types.number)}).preProcessSnapshot((e=>({...e,id:_.isNil(_.get(e,"id"))?0:e.id}))).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get formattedCreatedAt(){return e.rootStore.models.site.formatDate(e.created_at)},get relativeCreatedAt(){return e.relativeDate(e.created_at)},get offerPath(){return Routes.site_offer_path(e.rootStore.siteCachedSlug,e.short_url_code)},relativeDate:e=>dayjs(e).fromNow(),get originPath(){return Routes.show_offer_path(e.rootStore.siteCachedSlug,e.short_url_code)}}))).actions((e=>({update:t=>{_.forEach(t,((a,r)=>{e[r]=t[r]}))}}))),c=r.types.model("OffersStore",{offers:r.types.optional(r.types.map(l),{}),searchQuery:"",offersFetched:r.types.optional(r.types.boolean,!1),paginationPosition:r.types.optional(r.types.number,1)}).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get currentOffers(){return Object(n.values)(e.offers).filter((t=>t.page===e.paginationPosition))}}))).actions((t=>({resetFetchState:()=>{t.offersFetched=!1},fetchOffers:Object(r.flow)((function*(a){t.resetFetchState();try{const e=yield Object(i.ajax)({url:Routes.internal_site_customer_service_for_scope_path(t.rootStore.siteCachedSlug,"offers",{q:a,page:t.paginationPosition,no_spinner:!0})});t.updateOffers(e.result.records,a)}catch(xhr){e({name:"Unable to fetch CSP Offers",message:"Ajax failure",xhr:xhr})}})),modifyOffers:e=>(_.set(e,"offer.page",t.paginationPosition),e),clearOffers:()=>{t.offers.clear()},updateOffers:(e=[],a)=>{e.forEach(((e,a)=>{const r=t.modifyOffers(e);t.offers.put(r.offer)})),t.offersFetched=!0,t.searchQuery=a},setPaginationPosition:(e,a)=>{a&&a.preventDefault(),e!==t.paginationPosition&&(t.paginationPosition=e,t.fetchOffers(t.searchQuery))}})))}).call(this,a("B9cq").notifyDevelopers)},"wB/l":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var r=a("99Ma");const n=r.types.model("Location",{hash:"",key:"",pathname:"",search:""}),i=r.types.model("Router",{location:r.types.optional(n,{}),action:r.types.optional(r.types.string,"")}).actions((e=>{let t;return{_updateLocation(a){e.location=a,e.action=t.action},_setHistory(a){t=a,e.location={...t.location}},push(){t.push(...arguments)},replace(e){t.replace(...arguments)},go(e){t.go(e)},goBack(){t.goBack()},goForward(){t.goForward()},block(){t.block(...arguments)}}})),o=(e,t)=>{t._setHistory(e);const a=e=>{t._updateLocation({...e})},r=e.listen(a);return a(e.location),e.unsubscribe=r,e}},wY3E:function(e,t,a){(function(e){function t(e,a){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,a)}Widget.AbTestsModalExisting=function(a){var r,n;function i(){return a.apply(this,arguments)||this}return n=a,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,t(r,n),i.prototype.render=function(){const{redirectToSplitTestHandle:t,data:a,previewDataChange:r}=this.props,n=a.sort(((e,t)=>dayjs(t.created_at).unix()-dayjs(e.created_at).unix()));return e.createElement("div",{className:"modal-existing-rows is-table"},e.createElement("div",{className:"modal-existing-row is-header"},e.createElement("div",{className:"modal-existing-row-left-box"},"A/B Test"),e.createElement("div",{className:"modal-existing-row-center-box"},"Created"),e.createElement("div",{className:"modal-existing-row-center-box"},"Last Impression")),e.createElement("div",{className:"modal-existing-rows is-body"},n.map(((a,n)=>e.createElement(Widget.AbTestsModalExistingRow,{redirectToSplitTestHandle:t,previewDataChange:r,key:n,data:a})))))},i}(e.PureComponent)}).call(this,a("q1tI"))},wkfc:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("GaHK"),n=a("dhqo"),i=a.n(n),o=a("DDol");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}let l=function(t){var a,n;function l(a){var r;return(r=t.call(this,a)||this).trackTooltipHover=()=>{Utils.trackGAEvent("A/B Tests","campaign tooltip hover")},r.toggle=e=>{e.preventDefault();const t=window.scrollY;window.location.hash=e.target.hash===window.location.hash?"":e.target.hash,window.scrollTo(0,t)},r.tooltipRef=e.createRef(),r}n=t,(a=l).prototype=Object.create(n.prototype),a.prototype.constructor=a,s(a,n);var c=l.prototype;return c.componentDidMount=function(){window.location.hash===`#${this.props.id}/info`&&(window.location.hash="");const e=this.tooltipRef.current;e&&e.addEventListener("mouseover",this.trackTooltipHover)},c.render=function(){const{id:t,campaigns:a,label:n}=this.props,s=["campaignstip-wrapper",this.props.className].join(" ");return e.createElement("div",{className:s},e.createElement("div",{className:"campaignstip-trigger"},e.createElement(r.UIIcon,{name:"circles"}),n,"\xa0",e.createElement("a",{href:`#${t}/info`,className:"link",onClick:this.toggle},a.length," ",i()("campaign",a.length)),e.createElement("span",{ref:this.tooltipRef,"data-toggle":"tooltip","data-container":"body",className:"mls",title:"Includes all campaigns used in the A/B test, even though they may not be in rotation as of today"},e.createElement("span",{className:"icon icon-question"}))),e.createElement("div",{className:"campaignstip",id:`${t}/info`,"aria-hidden":"true"},e.createElement("a",{className:"modal-close",href:"#","aria-hidden":"true",onClick:this.toggle}),e.createElement("h3",null,"A/B Test Used in ",a.length," ",i()("campaign",a.length)),e.createElement("ul",{className:"campaignfilter-list"},_.sortBy(a,(e=>Constants.CAMPAIGN_STATUSES_ORDER[e.status])).map((t=>e.createElement(o.a,{abbreviation:!0,campaign:t,key:t.id,checked:!1,noOffers:!0})))),e.createElement("div",{className:"campaignstip-ear"})))},l}(e.PureComponent);l.defaultProps={campaigns:[],label:"Used in"},Widget.CampaignsTip=l}).call(this,a("q1tI"))},wtXR:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var r=a("99Ma"),n=a("aetS"),i=a("pm75");const o=r.types.model("CampaignFlushData",{modal:r.types.optional(n.a,{}),network:r.types.optional(i.b,{})}).views((e=>({get siteCachedSlug(){return Object(r.getRoot)(e).siteCachedSlug}}))).actions((t=>({apiDelete:Object(r.flow)((function*(a){t.modal.close();try{t.network.delete.updateLoading(!0);const n=yield $.ajax({type:"DELETE",url:Routes.flush_data_internal_site_campaign_path(t.siteCachedSlug,a)});return n.ok||e({name:"Unable to flush campaign data ok:false",message:"Ajax failure",xhr:xhr}),n}catch(xhr){return e({name:"Unable to flush campaign data",message:"Ajax failure",xhr:xhr}),xhr}finally{Object(r.isAlive)(t)&&t.network.delete.updateLoading(!1)}}))})))}).call(this,a("B9cq").notifyDevelopers)},wwNg:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("99Ma"),n=a("l91a"),i=a("M+GS"),o=a("OdtE"),s=a("3CKC");const l=r.types.model("IncentiveWithCouponList",{couponList:r.types.optional(s.a,{})}).volatile((()=>({requestQ:new n.a}))).views((e=>({get siteCachedSlug(){return Object(r.getRoot)(e).siteCachedSlug}}))).actions((t=>({apiGetCouponList:Object(r.flow)((function*(){if(t.coupon_list_id)try{var a;t.couponList.network.get.updateLoading(!0);const e=yield t.requestQ.ajax({url:Routes.internal_site_coupon_list_path(t.siteCachedSlug,t.coupon_list_id),data:{no_spinner:!0}});t.couponList.dataApplySnapshot((null==e||null==(a=e.result)?void 0:a.coupon_list)||{}),t.couponList.network.get.updateLoaded(!0)}catch(xhr){e({name:"Unable to get coupon list data",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.couponList.network.get.updateLoading(!1)}}))}))),c=r.types.compose("CampaignIncentive",o.a,l).views((e=>({get shouldShowCouponListExpirationWarning(){return Object(i.l)({coupon_list_expires_at:e.couponList.data.expires_at,latest_coupon_expiration_date:e.latest_coupon_expiration_date})}})))}).call(this,a("B9cq").notifyDevelopers)},x7QQ:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("99Ma");const n=r.types.model({}).actions((e=>({dataApplySnapshot:t=>{Object(r.applySnapshot)(e.data,t)}})));let i=function(){function e(){}return e.map=function(e){return r.types.compose("DataModel",r.types.model({data:r.types.map(e)}),n,r.types.model({}).views((()=>({}))).actions((e=>({dataEachUpdate:(t=[])=>{t.forEach((t=>{e.data.put(t)}))}}))))},e.array=function(e){return r.types.compose("DataModel",r.types.model({data:r.types.array(e)}),n)},e.model=function(e){return r.types.compose("DataModel",r.types.model({data:r.types.optional(e,{})}),n,r.types.model({}).views((()=>({}))).actions((e=>({dataUpdateKey:({key:t,value:a})=>{e.data[t]=a}}))))},e.literal=function(e=null){return r.types.compose("DataModel",r.types.model({data:r.types.optional(r.types.maybeNull(r.types.union(r.types.number,r.types.string,r.types.boolean,r.types.undefined)),e)}),r.types.model({}).views((()=>({}))).actions((e=>({dataUpdate:t=>{e.data=t}}))))},e}()},xEex:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var r=a("99Ma"),n=a("wwNg"),i=a("x7QQ"),o=a("pm75"),s=a("M+GS");const l=r.types.compose("CampaignIncentivesData",i.a.array(n.a),o.c).views((e=>({get rootStore(){return Object(r.getRoot)(e)},get siteCachedSlug(){return e.rootStore.siteCachedSlug},get plain(){return e.data.toJSON()},get groupedByAdvocate(){return _.chain(e.data).groupBy("for_advocate").value()},get advocateIncentives(){return e.data.filter((e=>e.for_advocate))},get advocateIncentivesGrouped(){return _.groupBy(e.advocateIncentives,"identifier")},get advocateIncentivesGroupsWithOptions(){return _.map(e.advocateIncentivesGrouped,(t=>({data:Object(s.m)(t),...e.getIncentivesGroupOptions(t)})))},getIncentivesGroupOptions:e=>({hasWinnerIncentive:Object(s.i)(e),noSuchWinnerIncentive:Object(s.k)(e),isSplitTested:e.some((e=>e.split_tested))}),get isIncentivesExists(){return _.some(e.data)},get groupedIncentivesByIdentifier(){return _.groupBy(e.data,"identifier")},get emailCaptureIncentivesGroups(){return _.map(e.groupedIncentivesByIdentifier,(t=>({data:t,...e.getIncentivesGroupOptions(t)})))},get isAdvocateIncentiveExists(){return _.some(e.advocateIncentives)},get friendIncentives(){return e.data.filter((e=>e.for_friend))},get friendIncentivesGrouped(){return _.groupBy(e.friendIncentives,"identifier")},get friendIncentivesGroupsWithOptions(){return _.map(e.friendIncentivesGrouped,(t=>({data:Object(s.m)(t),isExistingCustomerIncentivesGroup:t.every((e=>"0"===e.new_customer&&"ClickIncentive"===e.type)),...e.getIncentivesGroupOptions(t)})))},get isFriendIncentiveExists(){return _.some(e.friendIncentives)},getById:t=>_.find(e.data,{id:t}),get existingIncentiveMoreThanNewCustomerIncentive(){const{minIncentiveNewCustomerWithPercent:t,minIncentiveNewCustomerWithoutPercent:a}=(e=>{const t=e.filter((e=>"1"===e.new_customer));return{minIncentiveNewCustomerWithPercent:_.minBy(_.filter(t,{percentage_discount:!0}),"amount"),minIncentiveNewCustomerWithoutPercent:_.minBy(_.filter(t,{percentage_discount:!1}),"amount")}})(e.friendIncentives);return e.friendIncentives.some((e=>{return"0"===(r=e).new_customer&&!_.toInteger(r.allow_on_self_referral)&&!_.toInteger(r.allow_on_expired_offer)&&!_.toInteger(r.new_optin)&&e.percentage_discount&&e.amount>(null==t?void 0:t.amount)||!e.percentage_discount&&e.amount>(null==a?void 0:a.amount);var r}))}}))).actions((t=>({apiGet:Object(r.flow)((function*(a){t.network.get.updateLoading(!0);try{var n;const e=yield $.ajax({url:Routes.internal_site_campaign_incentives_path(t.siteCachedSlug,a),data:{no_spinner:!0}});t.dataApplySnapshot(null==e||null==(n=e.result)?void 0:n.incentives),t.network.get.updateLoaded(!0)}catch(xhr){e({name:"Unable to get incentives data",message:"Ajax failure",xhr:xhr})}finally{Object(r.isAlive)(t)&&t.network.get.updateLoading(!1)}}))})))}).call(this,a("B9cq").notifyDevelopers)},"y/HF":function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return o}));var r=a("KAy6"),n=a.n(r),i=a("DXPr");async function o(e){const t=n.a.renderToString(e),a=document.createElement("CANVAS"),r=await i.default.fromString(a.getContext("2d"),t);await r.render();const o=a.toDataURL();return new Promise(((e,t)=>{try{let t=new Image;t.onload=()=>{e({base64:o,height:t.height,width:t.width})},t.src=o}catch(a){t(a)}}))}},yx1D:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("vOnD"),n=a("GaHK"),i=a("Md/s"),o=a("ne91");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const l=Object(r.default)(n.UIIcon).withConfig({displayName:"subheader_referral__Arrow"})(["transform:rotate(180deg);margin-right:0;margin-left:8px;"]);let c=function(t){var a,r;function n(){return t.apply(this,arguments)||this}return r=t,(a=n).prototype=Object.create(r.prototype),a.prototype.constructor=a,s(a,r),n.prototype.render=function(){const{isSitePersisted:t,isReadRole:a,isWriteRole:r,currentSiteCachedSlug:n,locationRouter:s}=this.props;return e.createElement(i.f,{"data-testid":"ac-subheader-referral-container"},e.createElement("div",{className:"App-container-inner"},e.createElement(i.g,null,e.createElement("div",{className:"flex align-items-center"},t&&a&&e.createElement(i.h,{isActive:location.pathname===Routes.site_path(n),href:Routes.site_path(n),locationRouter:s},"Dashboard"),t&&a&&e.createElement(i.h,{className:"mll",isActive:Object(o.a)(Routes.site_campaigns_path(n)),href:Routes.site_campaigns_path(n),locationRouter:s},"Campaigns"),a&&e.createElement(i.h,{className:"mll",isActive:Object(o.a)(Routes.site_reports_metrics_aggregation_path(n)),href:Routes.site_reports_metrics_aggregation_path(n)},"Metrics"),t&&a&&e.createElement(i.h,{className:"mll",isActive:Object(o.a)(Routes.site_offers_path(n)),href:Routes.site_offers_path(n)},"Offers"),t&&a&&e.createElement(i.h,{className:"mll",isActive:Object(o.a)(Routes.site_offer_shares_path(n)),href:Routes.site_offer_shares_path(n)},"Shares"),t&&a&&e.createElement(i.h,{className:"mll",isActive:Object(o.e)(n),href:Routes.site_purchases_path(n)},"Purchases"),t&&a&&e.createElement(i.h,{className:"mll",isActive:Object(o.a)(Routes.site_referrals_path(n)),href:Routes.site_referrals_path(n)},"Referrals"),t&&a&&e.createElement(i.h,{className:"mll",isActive:Object(o.a)(Routes.site_incentive_outcomes_path(n)),href:Routes.site_rewards_path(n)},"Rewards"),t&&a&&e.createElement(i.h,{className:"mll",isActive:Object(o.a)(Routes.site_people_path(n)),href:Routes.site_people_path(n)},"People"),t&&a&&e.createElement(i.h,{className:"mll",isActive:Object(o.f)(n),href:Routes.site_reports_path(n)},"All reports",e.createElement(l,{fill:"#555555",name:"backArrow"}))),t&&r&&e.createElement("div",null,e.createElement(i.h,{className:"mls",isActive:Object(o.a)(Routes.edit_site_path(n,"referral_attribution")),href:Routes.edit_site_path(n,"referral_attribution"),locationRouter:s},"Referral attribution")))))},n}(e.PureComponent)}).call(this,a("q1tI"))},zHjf:function(e,t,a){"use strict";(function(e){var t=a("dhqo"),r=a.n(t);function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Widget.AbTestsModalDeleteConfirmation=function(t){var a,i;function o(e){var a;return(a=t.call(this,e)||this).TRUNCATE_LIMIT=50,a}return i=t,(a=o).prototype=Object.create(i.prototype),a.prototype.constructor=a,n(a,i),o.prototype.render=function(){const{data:t}=this.props,a="finished"===t.status?_.findIndex(t.variants,{winner:!0}):0,n=UI.ALPHABET.charAt(a),i="finished"===t.status?`winner Variant ${n.toUpperCase()}`:" Variant A",o=_.truncate(t.variants[a].value,{length:this.TRUNCATE_LIMIT}),s="custom"===t.type&&t.type;return e.createElement("div",{className:"Locale-entries-assets-uploader-static"},e.createElement("p",null,"Are you sure you want to delete the"," ","ready"===t.status?"ready to run":t.status," ",s," ",e.createElement("strong",null,t.name)," A/B test?"),"localization"===t.type&&e.createElement("p",null,"After deletion"," ",e.createElement("strong",null,t.campaigns.length," ",r()("Campaign",t.campaigns.length))," ","from this A/B Test will preserve ",e.createElement("strong",null,i)," -"," ",o,"."))},o}(e.PureComponent)}).call(this,a("q1tI"))},zSPh:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return p}));var r=a("99Ma"),n=a("B9cq"),i=a("uEXj"),o=a("5OB8"),s=a("aetS");const l=r.types.compose("ActionModal",s.a,r.types.model({body:r.types.maybeNull(r.types.string),payload:r.types.frozen(),code:r.types.maybeNull(r.types.union(r.types.number,r.types.string)),message:r.types.maybeNull(r.types.string)}).views((e=>({get stringifiedPayload(){return JSON.stringify(e.payload,null,2)},get action(){return Object(r.getParent)(e)},get appTitle(){var t;return null==(t=Object(r.getRoot)(e).pages.appStorePage.manifest.get(e.action.app_identifier))?void 0:t.title},get aboutLink(){return e.action.aboutLink}}))).actions((e=>({reset:()=>{Object(r.applySnapshot)(e,{})}})))),c=r.types.model({app_identifier:r.types.string,identifier:r.types.string,app_id:r.types.maybeNull(r.types.number),id:r.types.maybeNull(r.types.number),title:"",description:"",active:!1,configuration:r.types.optional(i.b,{}),defaults:r.types.maybeNull(r.types.frozen()),errorModal:r.types.optional(l,{}),successModal:r.types.optional(l,{}),links:r.types.array(r.types.frozen()),isLoading:!1}).views((e=>({get isValid(){return e.configuration.isValid},get rootStore(){return Object(r.getRoot)(e)},get appStorePage(){return e.rootStore.pages.appStorePage},get appStoreEditPage(){return e.appStorePage.appStoreEditPage},get isPristine(){return e.configuration.isPristine},get valuesForServer(){return{identifier:e.identifier,configuration:e.configuration.valuesForServer}},get variables(){return e.appStorePage.getActionsVariables({actionIdentifier:e.identifier,appIdentifier:e.app_identifier})},get defaultPayload(){var t,a;return(null==(t=e.defaults)?void 0:t.payload)&&Object.entries(null==(a=e.defaults)?void 0:a.payload).map((([e,t])=>({name:e,value:t})))},get isDisabledSendSample(){return e.appStoreEditPage.isDisabledToggleApp||e.isLoading},get aboutLink(){var t;return null==(t=e.links)?void 0:t.find((e=>"about"===e.type))}}))).actions((e=>({updateActive:(t=!1)=>{e.active=t},toggle:()=>{e.id&&(e.active=!e.active,e.appStoreEditPage.toggleAction({actionTitle:e.title,state:e.active}))},updateLoading:(t=!0)=>{e.isLoading=t},handleSendSample:Object(r.flow)((function*(){e.errorModal.reset(),e.successModal.reset();try{e.updateLoading(!0);const{result:{payload:t}}=yield Object(n.ajax)({url:Routes.test_internal_site_store_app_store_app_action_path(e.rootStore.siteCachedSlug,e.app_id,e.id)});Validation.showSuccessFlash(`Action ${e.title} was successfully send`),Object(r.applySnapshot)(e.successModal,{payload:t,code:200,shouldShow:!0})}catch(t){const a=Object(o.a)({response:t});a&&Object(r.applySnapshot)(e.errorModal,{...a,shouldShow:!0})}finally{Object(r.isAlive)(e)&&e.updateLoading(!1)}}))}))),p=r.types.model({data:r.types.array(c)}).views((e=>({get isValid(){return e.data.every((e=>e.isValid))},get isPristine(){return e.data.every((e=>e.isPristine))},get valuesForServer(){return e.data.map((e=>e.valuesForServer))}}))).actions((e=>({resetAll:()=>{e.data.forEach((({configuration:e})=>{e.resetAll()}))},updateErrors:t=>{e.data.forEach(((e,a)=>{e.configuration.updateErrors(t[a])}))},checkRequiredFields:()=>{e.data.forEach((e=>{e.configuration.checkRequiredFields()}))}})))},zeVt:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var r=a("vOnD"),n=a("GaHK");function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const o=Object(r.default)(n.UIButton).withConfig({displayName:"campaigns_filter_show_more__ButtonStyleOverride"})(["",";transition:color 0.275s;&:hover{.svg-path-fill{fill:",";}}"],(({isOpened:e})=>e&&Object(r.css)(["svg{transform:rotate(180deg);}"])),n.Theme.color.orange);let s=function(t){var a,r;function s(){return t.apply(this,arguments)||this}return r=t,(a=s).prototype=Object.create(r.prototype),a.prototype.constructor=a,i(a,r),s.prototype.render=function(){const{onClick:t,hiddenCampaignsCount:a,isOpened:r}=this.props;return r||0!==a?e.createElement("div",{className:"flex justify-center align-items-center mtm"},e.createElement(o,{onClick:t,trait:"action",isOpened:r},r?"Hide":e.createElement(e.Fragment,null,"Show ",a," campaigns"),e.createElement(n.UIIcon,{className:"mls",name:"downArrow"}))):null},s}(e.PureComponent)}).call(this,a("q1tI"))},zfg3:function(e,t,a){"use strict";(function(e){a.d(t,"e",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"i",(function(){return l})),a.d(t,"f",(function(){return d})),a.d(t,"a",(function(){return m})),a.d(t,"h",(function(){return g})),a.d(t,"c",(function(){return h})),a.d(t,"d",(function(){return f})),a.d(t,"b",(function(){return v}));var r=a("vOnD"),n=a("AdbC"),i=a("GaHK");const o=Object(r.default)(i.UIMenuDropdown).withConfig({displayName:"components__MenuDropdownStyleOverride"})(["z-index:3;margin-top:3px;","{right:unset;left:0;}"],i.UIMenuDropdown.CLASS_NAMES.list),s=r.default.div.withConfig({displayName:"components__SiteSelectInner"})(["input{box-shadow:none !important;line-height:unset;display:inline-block;height:auto;padding:0;margin-bottom:0;font-size:inherit;color:unset;border-radius:0;vertical-align:middle;}"]),l={control:(e,t)=>({...e,margin:"12px",boxShadow:t.isFocused?"inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(82, 168, 236, 0.6)":"none",borderRadius:0,borderColor:t.isFocused?"rgba(82, 168, 236, 0.8)":"#ccc"}),menu:()=>({boxShadow:"inset 0 1px 0 rgba(0, 0, 0, 0.1)",minWidth:240}),menuList:e=>({...e,borderTop:`1px solid ${i.Theme.color.black15}`,padding:0}),option:(e,{isFocused:t,isSelected:a,data:r,selectProps:n})=>({...e,paddingTop:12,paddingBottom:12,color:a?"red":i.Theme.color.black100,borderBottom:"1px solid #eee",background:r.value===n.value||t?"rgb(251, 246, 228)":"unset",cursor:"pointer",":active":{backgroundColor:"#fbf6e4"}}),noOptionsMessage:e=>({...e,padding:12}),groupHeading:e=>({...e,textTransform:"capitalize",fontSize:14,borderBottom:"1px solid #eee",marginBottom:0,paddingTop:8,paddingBottom:8}),group:e=>({...e,padding:0}),indicatorsContainer:e=>({...e,order:-1,marginLeft:7,marginRight:-7})},c={display:"flex",alignItems:"center",justifyContent:"space-between"},p=r.default.div.withConfig({displayName:"components__Text"})(["",";color:",";font-size:14px;"],i.Theme.fontWeights.medium,(({color:e})=>e)),u=Object(r.default)(p).withConfig({displayName:"components__HeadText"})(["max-width:170px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-right:8px;color:#555555;"]),d=t=>e.createElement(p,{color:i.Theme.color.black100},e.createElement(n.f.Option,t)),m=t=>t.selectProps.isSearchable?e.createElement(n.f.Control,t):null,g=t=>e.createElement("div",{style:c},e.createElement(p,{color:"#999999"},t.label)),h=()=>e.createElement(i.UIIcon,{name:"searchLite"}),y=r.default.div.withConfig({displayName:"components__HeadContainer"})(["display:flex;align-items:center;cursor:pointer;"]),f=({children:t})=>e.createElement(y,null,e.createElement(u,null,t),e.createElement(i.UIIcon,{name:"downArrow",fill:"#555555"})),_=Object(r.default)(i.UILink).withConfig({displayName:"components__CreateSiteLinkStyleOverride"})(["padding:12px;.sign-svg-fill{fill:",";}"],i.Theme.color.link),b=r.default.div.withConfig({displayName:"components__CrateSiteWrapper"})(["position:relative;z-index:1;background-color:#fff;border-radius:0 4px 4px 0;margin-top:-1px;"]),v=({onClick:t})=>e.createElement(b,null,e.createElement(i.UIDivider,null),e.createElement(_,{onClick:t,href:Routes.new_account_site_path()},e.createElement(i.UIIcon,{fill:i.Theme.color.link,name:"create"}),"Create site"))}).call(this,a("q1tI"))},zzNc:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return c}));var r=a("vOnD");function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const i=r.default.div.withConfig({displayName:"ui_dropdown__Wrapper"})(["position:relative;"]),o=r.default.div.withConfig({displayName:"ui_dropdown__Popover"})(["position:absolute;z-index:3;",";width:",";"],(e=>e.position),(({width:e})=>e)),s=r.default.div.withConfig({displayName:"ui_dropdown__Cover"})(["position:fixed;top:0;right:0;bottom:0;left:0;"]),l=r.default.div.withConfig({displayName:"ui_dropdown__WrapperContent"})(["position:relative;z-index:4;"]);let c=function(t){var a,r;function c(...e){var a;return(a=t.call(this,...e)||this).state={show:!1},a.toggleShow=()=>{a.setState((e=>({show:!e.show})))},a.handleCoverClick=()=>{a.props.hideOnCoverClick&&a.toggleShow()},a.hide=()=>{a.setState({show:!1})},a}return r=t,(a=c).prototype=Object.create(r.prototype),a.prototype.constructor=a,n(a,r),c.prototype.render=function(){const{show:t}=this.state,{children:a,render:r,position:n,width:c,...p}=this.props;return e.createElement(i,p,r(this.toggleShow,t),t&&e.createElement(o,{position:n,width:c},e.createElement(s,{onClick:this.handleCoverClick}),e.createElement(l,null,a(this.toggleShow))))},c}(e.Component);c.defaultProps={position:{top:"auto",bottom:"auto",right:"auto",left:"auto"},width:"auto",render:()=>{},hideOnCoverClick:!0}}).call(this,a("q1tI"))}}]);