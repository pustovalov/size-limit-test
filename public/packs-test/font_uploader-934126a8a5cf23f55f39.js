(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[25],{"3rT1":function(e,t,n){"use strict";(function(e){var o=n("kMSe"),a=n("f2jP"),r=n("Br6Q");t.a=function(){return e.createElement(o.b,{fontUploaderStore:a.a},e.createElement(r.a,null))}}).call(this,n("q1tI"))},Br6Q:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return w}));var o,a,r,l=n("kMSe"),i=n("GaHK"),s=n("x+Tv"),c=n("fRW6"),f=n("jnO1"),u=n("2vnA");function p(e){return(p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return!t||"object"!==p(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=Object(l.c)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e)}))(o=Object(l.d)((r=a=function(t){function n(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(t=d(this,(e=b(n)).call.apply(e,[this].concat(a)))).getFileClassName=function(e){return classNames("Font-uploader-input-file-label","js-font-uploader-file-label",{"is-error":_.some(t.props.fontUploaderStore.errors.get(e))})},t}var o,a,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(n,t),o=n,(a=[{key:"componentDidMount",value:function(){var e=this,t=".js-font-uploader-file-label";$(document).keyup((function(t){27===t.keyCode&&e.props.fontUploaderStore.unmountComponent()})),$(document).on("drag dragstart dragend dragover dragenter dragleave drop",t,(function(e){e.preventDefault(),e.stopPropagation()})).on("dragover dragenter",t,(function(){$(this).addClass("is-dragover")})).on("dragleave dragend drop",t,(function(){$(this).removeClass("is-dragover")})).on("drop",t,(function(t){var n=t.originalEvent.dataTransfer.files;e.props.fontUploaderStore.dragAndDropFiles(n)}))}},{key:"componentWillUnmount",value:function(){this.props.fontUploaderStore.data.clearForm()}},{key:"render",value:function(){var t=this,n=this.props.fontUploaderStore,o=n.data,a=o.FontName,r=o.FontWeight,l=o.FontStyle,p=o.FontWoff,m=o.FontWoff2,d=o.ResponseFontName,b=n.changeInput,h=n.dragAndDropFiles,y=n.isLoader,g=n.isSuccessCreate,w=n.create,F=n.updateStatus,v=n.unmountComponent,E=n.stopPropagation,N=n.errors;return e.createElement("div",{onClick:v,className:"base-modal is-flex is-shown"},e.createElement("div",{onClick:E,className:"base-modal-wrapper is-large Font-uploader"},g?e.createElement(s.a,{updateStatus:F,unmountComponent:v,ResponseFontName:d}):e.createElement("form",{ref:function(e){return t.forms=e},className:"Font-uploader-form"},y&&e.createElement("div",{className:"Font-uploader-loader"},e.createElement(i.UILoader,null)),e.createElement("div",{className:classNames("Font-uploader-wrap",{"is-loader":y})},e.createElement("div",{onClick:v,className:"base-modal-close is-lighten"},"\xd7"),e.createElement("h1",{className:"Font-uploader-head"},"create new font"),e.createElement("div",{className:"Font-uploader-input is-block"},e.createElement(i.UILabel,{id:"font-uploader-name",text:"Font name:"}),e.createElement(i.UIInputText,{id:"font-uploader-name",autoFocus:!0,ref:function(e){return t.input=e},name:"FontName",value:a,disabled:y,size:"medium",maxLength:255,error:N.get("font_name")&&N.get("font_name").length>0,onChange:b,placeholder:"Example \u2018Proxima Nova Regular\u2019",className:"Font-uploader-input-text ac-font-uploader-name"}),e.createElement(f.a,{errors:Object(u.toJS)(N),hideName:!0,name:"font_name"})),e.createElement("div",{className:"Font-uploader-input is-block"},e.createElement(i.UILabel,{id:"font-uploader-weight",text:"Font weight:"}),e.createElement(i.UIInputText,{id:"font-uploader-weight",name:"FontWeight",value:r,disabled:y,size:"medium",maxLength:255,error:N.get("font_weight")&&N.get("font_weight").length>0,onChange:b,placeholder:"Example \u2018normal\u2019",className:"Font-uploader-input-text ac-font-uploader-weight"}),e.createElement(f.a,{errors:Object(u.toJS)(N),hideName:!0,name:"font_weight"})),e.createElement("div",{className:"Font-uploader-input is-block"},e.createElement(i.UILabel,{id:"font-uploader-style",text:"Font style:"}),e.createElement(c.b,{id:"font-uploader-style",className:"ac-font-uploader-style",name:"FontStyle",value:l,disabled:y,width:"100%",onChange:b,options:this.props.options,disableSearch:!0})),e.createElement("div",{className:"Font-uploader-input is-flex"},e.createElement("div",{className:"Font-uploader-input-file-wrap"},e.createElement("input",{type:"file",name:"FontWoff",disabled:y,accept:".woff, .woff2",id:"file-woff",multiple:!0,onChange:function(e){return h(e.target.files,"Woff")},className:"Font-uploader-input-file ac-font-uploader-file-woff"}),e.createElement("label",{htmlFor:"file-woff",className:this.getFileClassName("woff")},p||"Choose *.woff file"),e.createElement(f.a,{errors:Object(u.toJS)(N),hideName:!0,name:"woff"})),e.createElement("div",{className:"Font-uploader-input-file-wrap"},e.createElement("input",{type:"file",name:"FontWoff2",disabled:y,accept:".woff, .woff2",id:"file-woff2",multiple:!0,onChange:function(e){return h(e.target.files,"Woff2")},className:"Font-uploader-input-file ac-font-uploader-file-woff2"}),e.createElement("label",{htmlFor:"file-woff2",className:this.getFileClassName("woff2")},m||"Choose *.woff2 file"),e.createElement(f.a,{errors:Object(u.toJS)(N),hideName:!0,name:"woff2"}))),e.createElement(i.UILink,{href:"/tos",target:"_blank",className:"mbm"},"See terms of service")),e.createElement("div",{className:"base-form-footer is-align-left"},e.createElement(i.UIButton,{trait:"success",disabled:y,size:"big",onClick:w},"Create font"),e.createElement(i.UIButton,{trait:"transparent",target:"_blank",href:"https://developer.mozilla.org/en-US/docs/Learn/CSS/Styling_text/Web_fonts",className:"base-btn is-transparent is-big mll"},"What is custom font?")))))}}])&&m(o.prototype,a),r&&m(o,r),n}(e.Component),a.defaultProps={options:[{label:"Normal",value:"normal"},{label:"Italic",value:"italic"},{label:"Oblique",value:"oblique"}]},o=r))||o)||o}).call(this,n("q1tI"))},RZa4:function(e,t,n){"use strict";n.r(t);var o=n("ho87"),a=n("3rT1");window.FontUploaderRoot=a.a,window.ReactUtils=o.a},f2jP:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n("99Ma"),a=o.types.model("FontData",{FontName:"",FontWeight:"normal",FontStyle:"normal",FontWoff:"",FontWoff2:"",fileFontWoff:o.types.frozen(),fileFontWoff2:o.types.frozen(),ResponseFontName:""}).actions((function(e){return{clearForm:function(){e.FontName="",e.FontWeight="normal",e.FontStyle="normal",e.FontWoff="",e.FontWoff2="",e.fileFontWoff="",e.fileFontWoff2=""}}})),r=o.types.model("FontUploaderStore",{data:o.types.optional(a,{}),isLoader:!1,isSuccessCreate:!1,errors:o.types.optional(o.types.map(o.types.array(o.types.string)),{})}).actions((function(e){return{changeInput:function(t){e.data[t.target.name]=t.target.value,e.errors.set(e.normalizeError(t.target.name),[])},dragAndDropFiles:function(t){["Woff","Woff2"].forEach((function(n){for(var o,a=new RegExp(".*.".concat(n,"$"),"i"),r=0,l=0;l<t.length;l++)a.test(t[l].name)&&(r++,o=l);if(r>1)e.errors.set(n.toLowerCase(),["Only 1 file allowed"]),e.data["Font".concat(n)]="",e.data["fileFont".concat(n)]=[];else if(o>=0){var i=window.Constants.ATTACHMENT_SIZE_LIMIT;if(t[o].size>1e6*window.Constants.ATTACHMENT_SIZE_LIMIT)return e.errors.set(n.toLowerCase(),["Must be less than ".concat(i," MB")]),e.data["Font".concat(n)]="",void(e.data["fileFont".concat(n)]=[]);if(0===e.data.FontName.length){var s=t[o].name.replace(/\.[^/.]+$/,"");e.errors.set("font_name",[]),e.data.FontName=s}e.data["Font".concat(n)]=t[o].name,e.data["fileFont".concat(n)]=t[o],e.errors.set(n.toLowerCase(),[])}}))},normalizeError:function(e){switch(e){case"FontName":return"font_name";case"FontWeight":return"font_weight";case"FontStyle":return"font_style"}},updateErrors:function(t){e.errors.replace(t)},updateStatus:function(t){e.isSuccessCreate=t},updateLoader:function(t){e.isLoader=t},updateResponseName:function(t){e.data.ResponseFontName=t},clearErrors:function(){e.errors.clear()},create:function(t){var n=e.data,o=n.FontName,a=n.FontWeight,r=n.FontStyle,l=n.fileFontWoff,i=void 0===l?"":l,s=n.fileFontWoff2,c=void 0===s?"":s;t.preventDefault();var f=new FormData;f.append("font[font_name]",o),f.append("font[font_weight]",a),f.append("font[font_style]",r),f.append("font[woff]",i),f.append("font[woff2]",c),f.append("site_id",window.Site.id);var u=$("meta[name=csrf-token]").attr("content");return e.updateLoader(!0),$.ajax({type:"POST",url:Routes.font_internal_site_static_assets_path(window.Site),data:f,headers:{"X-CSRF-Token":encodeURI(u)},contentType:!1,processData:!1}).then((function(t){var n=t.result.font_name;e.updateResponseName(n),e.clearErrors(),e.updateLoader(!1),e.updateStatus(!0),e.data.clearForm()})).fail((function(t){e.updateLoader(!1),e.updateErrors(_.get(t,"responseJSON.result.errors",{}))}))},stopPropagation:function(e){e.stopPropagation()},unmountComponent:function(){ReactUtils.unmount("FontUploader")}}})).create()},"x+Tv":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var o=n("GaHK");function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(t){function n(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(t=l(this,(e=i(n)).call.apply(e,[this].concat(a)))).changeLocation=function(){window.location=Routes.editor_site_campaign_path(Site,Campaign)},t}var a,c,f;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,t),a=n,(c=[{key:"render",value:function(){var t=this.props,n=t.ResponseFontName,a=t.updateStatus,r=t.unmountComponent;return e.createElement(e.Fragment,null,e.createElement("div",{className:"Font-uploader-wrap"},e.createElement("div",{onClick:r,className:"base-modal-close is-lighten"},"\xd7"),e.createElement("h1",{className:"Font-uploader-head"},"new font uploaded successfully"),e.createElement("div",{className:"Font-uploader-text"},e.createElement("p",null,"New font created: ",'"',n,'"',"."),e.createElement("p",null,"Here is how to use it inside CSS:"),e.createElement("div",{className:"Font-uploader-example"},e.createElement("p",null,".example ","{"," ",e.createElement("br",null),"\xa0\xa0font-family: ",'"',n,'"',"; ",e.createElement("br",null),"}")))),e.createElement("div",{className:"base-form-footer is-align-left"},e.createElement(o.UIButton,{onClick:this.changeLocation,trait:"success",size:"big"},"Switch to editor"),e.createElement("button",{onClick:a.bind(this,!1),className:"base-btn is-transparent is-big mll",type:"button"},"Create another font")))}}])&&r(a.prototype,c),f&&r(a,f),n}(e.Component)}).call(this,n("q1tI"))}},[["RZa4",0,1]]]);